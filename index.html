<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Théophile L. Mouton">
<meta name="dcterms.date" content="2025-10-24">

<title>Disaster Damage and Response Estimation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="index_files/libs/core-js-2.5.3/shim.min.js"></script>
<script src="index_files/libs/react-18.2.0/react.min.js"></script>
<script src="index_files/libs/react-18.2.0/react-dom.min.js"></script>
<script src="index_files/libs/reactwidget-2.0.0/react-tools.js"></script>
<link href="index_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="index_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="index_files/libs/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="index_files/libs/reactable-binding-0.4.4/reactable.js"></script>


<link rel="stylesheet" href="asset/style.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro"><span class="header-section-number">1</span> Intro</a></li>
  <li><a href="#education" id="toc-education" class="nav-link" data-scroll-target="#education"><span class="header-section-number">2</span> Education</a>
  <ul class="collapse">
  <li><a href="#baseline-number-of-schools-students-and-teachers" id="toc-baseline-number-of-schools-students-and-teachers" class="nav-link" data-scroll-target="#baseline-number-of-schools-students-and-teachers"><span class="header-section-number">2.1</span> Baseline: Number of Schools, Students, and Teachers</a></li>
  <li><a href="#estimating-damage-number-of-damaged-schools-and-students-affected" id="toc-estimating-damage-number-of-damaged-schools-and-students-affected" class="nav-link" data-scroll-target="#estimating-damage-number-of-damaged-schools-and-students-affected"><span class="header-section-number">2.2</span> Estimating damage: Number of damaged schools and students affected</a></li>
  <li><a href="#resources-needed-to-be-sent-to-those-affected" id="toc-resources-needed-to-be-sent-to-those-affected" class="nav-link" data-scroll-target="#resources-needed-to-be-sent-to-those-affected"><span class="header-section-number">2.3</span> Resources needed to be sent to those affected</a></li>
  <li><a href="#estimate-financial-damage-from-cyclone" id="toc-estimate-financial-damage-from-cyclone" class="nav-link" data-scroll-target="#estimate-financial-damage-from-cyclone"><span class="header-section-number">2.4</span> Estimate financial damage from cyclone</a></li>
  </ul></li>
  <li><a href="#emergency-telecommunications" id="toc-emergency-telecommunications" class="nav-link" data-scroll-target="#emergency-telecommunications"><span class="header-section-number">3</span> Emergency Telecommunications</a>
  <ul class="collapse">
  <li><a href="#baseline-number-of-telecommunication-towers" id="toc-baseline-number-of-telecommunication-towers" class="nav-link" data-scroll-target="#baseline-number-of-telecommunication-towers"><span class="header-section-number">3.1</span> Baseline: Number of Telecommunication Towers</a></li>
  <li><a href="#estimating-damage-number-of-damaged-towers" id="toc-estimating-damage-number-of-damaged-towers" class="nav-link" data-scroll-target="#estimating-damage-number-of-damaged-towers"><span class="header-section-number">3.2</span> Estimating Damage: Number of Damaged Towers</a></li>
  </ul></li>
  <li><a href="#energy" id="toc-energy" class="nav-link" data-scroll-target="#energy"><span class="header-section-number">4</span> Energy</a>
  <ul class="collapse">
  <li><a href="#baseline-household-energy-access-and-usage" id="toc-baseline-household-energy-access-and-usage" class="nav-link" data-scroll-target="#baseline-household-energy-access-and-usage"><span class="header-section-number">4.1</span> Baseline: Household Energy Access and Usage</a></li>
  <li><a href="#estimating-damage-households-affected-by-electricity-disruption" id="toc-estimating-damage-households-affected-by-electricity-disruption" class="nav-link" data-scroll-target="#estimating-damage-households-affected-by-electricity-disruption"><span class="header-section-number">4.2</span> Estimating damage: Households affected by electricity disruption</a></li>
  <li><a href="#immediate-response-resources" id="toc-immediate-response-resources" class="nav-link" data-scroll-target="#immediate-response-resources"><span class="header-section-number">4.3</span> Immediate Response Resources</a></li>
  <li><a href="#estimated-financial-damage" id="toc-estimated-financial-damage" class="nav-link" data-scroll-target="#estimated-financial-damage"><span class="header-section-number">4.4</span> Estimated Financial Damage</a>
  <ul class="collapse">
  <li><a href="#table-1-household-electricity-financial-damage" id="toc-table-1-household-electricity-financial-damage" class="nav-link" data-scroll-target="#table-1-household-electricity-financial-damage"><span class="header-section-number">4.4.1</span> Table 1: Household Electricity Financial Damage</a></li>
  <li><a href="#table-2-energy-infrastructure-financial-damage" id="toc-table-2-energy-infrastructure-financial-damage" class="nav-link" data-scroll-target="#table-2-energy-infrastructure-financial-damage"><span class="header-section-number">4.4.2</span> Table 2: Energy Infrastructure Financial Damage</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#food-security" id="toc-food-security" class="nav-link" data-scroll-target="#food-security"><span class="header-section-number">5</span> Food security</a>
  <ul class="collapse">
  <li><a href="#baseline-food-security" id="toc-baseline-food-security" class="nav-link" data-scroll-target="#baseline-food-security"><span class="header-section-number">5.1</span> Baseline: Food Security</a>
  <ul class="collapse">
  <li><a href="#table-1-staple-crops" id="toc-table-1-staple-crops" class="nav-link" data-scroll-target="#table-1-staple-crops"><span class="header-section-number">5.1.1</span> Table 1: Staple crops</a></li>
  <li><a href="#table-2-cash-crops" id="toc-table-2-cash-crops" class="nav-link" data-scroll-target="#table-2-cash-crops"><span class="header-section-number">5.1.2</span> Table 2: Cash Crops</a></li>
  </ul></li>
  <li><a href="#estimated-hazard-damage" id="toc-estimated-hazard-damage" class="nav-link" data-scroll-target="#estimated-hazard-damage"><span class="header-section-number">5.2</span> Estimated Hazard Damage</a>
  <ul class="collapse">
  <li><a href="#table-1-staple-crops-damage" id="toc-table-1-staple-crops-damage" class="nav-link" data-scroll-target="#table-1-staple-crops-damage"><span class="header-section-number">5.2.1</span> Table 1: Staple Crops Damage</a></li>
  <li><a href="#table-2-cash-crops-damage" id="toc-table-2-cash-crops-damage" class="nav-link" data-scroll-target="#table-2-cash-crops-damage"><span class="header-section-number">5.2.2</span> Table 2: Cash Crops Damage</a></li>
  </ul></li>
  <li><a href="#immediate-response-resources-1" id="toc-immediate-response-resources-1" class="nav-link" data-scroll-target="#immediate-response-resources-1"><span class="header-section-number">5.3</span> Immediate Response Resources</a></li>
  <li><a href="#estimated-financial-damage-1" id="toc-estimated-financial-damage-1" class="nav-link" data-scroll-target="#estimated-financial-damage-1"><span class="header-section-number">5.4</span> Estimated Financial Damage</a>
  <ul class="collapse">
  <li><a href="#table-1-staple-crops-financial-damage" id="toc-table-1-staple-crops-financial-damage" class="nav-link" data-scroll-target="#table-1-staple-crops-financial-damage"><span class="header-section-number">5.4.1</span> Table 1: Staple Crops Financial Damage</a></li>
  <li><a href="#table-2-cash-crops-financial-damage" id="toc-table-2-cash-crops-financial-damage" class="nav-link" data-scroll-target="#table-2-cash-crops-financial-damage"><span class="header-section-number">5.4.2</span> Table 2: Cash Crops Financial Damage</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#gender-protection" id="toc-gender-protection" class="nav-link" data-scroll-target="#gender-protection"><span class="header-section-number">6</span> Gender &amp; Protection</a>
  <ul class="collapse">
  <li><a href="#baseline-gender-protection" id="toc-baseline-gender-protection" class="nav-link" data-scroll-target="#baseline-gender-protection"><span class="header-section-number">6.1</span> Baseline : Gender &amp; Protection</a>
  <ul class="collapse">
  <li><a href="#table-1-population-by-sex-and-age" id="toc-table-1-population-by-sex-and-age" class="nav-link" data-scroll-target="#table-1-population-by-sex-and-age"><span class="header-section-number">6.1.1</span> Table 1: Population by Sex and Age</a></li>
  <li><a href="#table-2-marital-status" id="toc-table-2-marital-status" class="nav-link" data-scroll-target="#table-2-marital-status"><span class="header-section-number">6.1.2</span> Table 2: Marital Status</a></li>
  <li><a href="#table-3-employment-status" id="toc-table-3-employment-status" class="nav-link" data-scroll-target="#table-3-employment-status"><span class="header-section-number">6.1.3</span> Table 3: Employment Status</a></li>
  </ul></li>
  <li><a href="#immediate-response-resources-2" id="toc-immediate-response-resources-2" class="nav-link" data-scroll-target="#immediate-response-resources-2"><span class="header-section-number">6.2</span> Immediate Response Resources</a></li>
  </ul></li>
  <li><a href="#health" id="toc-health" class="nav-link" data-scroll-target="#health"><span class="header-section-number">7</span> Health</a>
  <ul class="collapse">
  <li><a href="#baseline-health" id="toc-baseline-health" class="nav-link" data-scroll-target="#baseline-health"><span class="header-section-number">7.1</span> Baseline: Health</a></li>
  <li><a href="#estimated-hazard-damage-1" id="toc-estimated-hazard-damage-1" class="nav-link" data-scroll-target="#estimated-hazard-damage-1"><span class="header-section-number">7.2</span> Estimated Hazard Damage</a></li>
  <li><a href="#immediate-response-resources-3" id="toc-immediate-response-resources-3" class="nav-link" data-scroll-target="#immediate-response-resources-3"><span class="header-section-number">7.3</span> Immediate Response Resources</a></li>
  <li><a href="#estimated-financial-damage-2" id="toc-estimated-financial-damage-2" class="nav-link" data-scroll-target="#estimated-financial-damage-2"><span class="header-section-number">7.4</span> Estimated Financial Damage</a></li>
  </ul></li>
  <li><a href="#logistics" id="toc-logistics" class="nav-link" data-scroll-target="#logistics"><span class="header-section-number">8</span> Logistics</a>
  <ul class="collapse">
  <li><a href="#baseline-logistics-infrastructure" id="toc-baseline-logistics-infrastructure" class="nav-link" data-scroll-target="#baseline-logistics-infrastructure"><span class="header-section-number">8.1</span> Baseline: Logistics Infrastructure</a>
  <ul class="collapse">
  <li><a href="#table-1-infrastructure" id="toc-table-1-infrastructure" class="nav-link" data-scroll-target="#table-1-infrastructure"><span class="header-section-number">8.1.1</span> Table 1: Infrastructure</a></li>
  <li><a href="#table-2-road-surface" id="toc-table-2-road-surface" class="nav-link" data-scroll-target="#table-2-road-surface"><span class="header-section-number">8.1.2</span> Table 2: Road Surface</a></li>
  </ul></li>
  <li><a href="#estimated-hazard-damage-2" id="toc-estimated-hazard-damage-2" class="nav-link" data-scroll-target="#estimated-hazard-damage-2"><span class="header-section-number">8.2</span> Estimated Hazard Damage</a>
  <ul class="collapse">
  <li><a href="#table-1-infrastructure-damage" id="toc-table-1-infrastructure-damage" class="nav-link" data-scroll-target="#table-1-infrastructure-damage"><span class="header-section-number">8.2.1</span> Table 1: Infrastructure Damage</a></li>
  <li><a href="#table-2-road-surface-damage" id="toc-table-2-road-surface-damage" class="nav-link" data-scroll-target="#table-2-road-surface-damage"><span class="header-section-number">8.2.2</span> Table 2: Road Surface Damage</a></li>
  </ul></li>
  <li><a href="#immediate-response-resources-4" id="toc-immediate-response-resources-4" class="nav-link" data-scroll-target="#immediate-response-resources-4"><span class="header-section-number">8.3</span> Immediate Response Resources</a></li>
  <li><a href="#estimated-financial-damage-3" id="toc-estimated-financial-damage-3" class="nav-link" data-scroll-target="#estimated-financial-damage-3"><span class="header-section-number">8.4</span> Estimated Financial Damage</a>
  <ul class="collapse">
  <li><a href="#table-1-infrastructure-financial-damage" id="toc-table-1-infrastructure-financial-damage" class="nav-link" data-scroll-target="#table-1-infrastructure-financial-damage"><span class="header-section-number">8.4.1</span> Table 1: Infrastructure Financial Damage</a></li>
  <li><a href="#table-2-road-surface-financial-damage" id="toc-table-2-road-surface-financial-damage" class="nav-link" data-scroll-target="#table-2-road-surface-financial-damage"><span class="header-section-number">8.4.2</span> Table 2: Road Surface Financial Damage</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#shelter" id="toc-shelter" class="nav-link" data-scroll-target="#shelter"><span class="header-section-number">9</span> Shelter</a>
  <ul class="collapse">
  <li><a href="#baseline" id="toc-baseline" class="nav-link" data-scroll-target="#baseline"><span class="header-section-number">9.1</span> Baseline</a></li>
  <li><a href="#estimated-hazard-damage-3" id="toc-estimated-hazard-damage-3" class="nav-link" data-scroll-target="#estimated-hazard-damage-3"><span class="header-section-number">9.2</span> Estimated Hazard Damage</a></li>
  <li><a href="#immediate-response-resources-5" id="toc-immediate-response-resources-5" class="nav-link" data-scroll-target="#immediate-response-resources-5"><span class="header-section-number">9.3</span> Immediate Response Resources</a></li>
  <li><a href="#estimated-financial-damage-4" id="toc-estimated-financial-damage-4" class="nav-link" data-scroll-target="#estimated-financial-damage-4"><span class="header-section-number">9.4</span> Estimated Financial Damage</a></li>
  </ul></li>
  <li><a href="#wash" id="toc-wash" class="nav-link" data-scroll-target="#wash"><span class="header-section-number">10</span> WASH</a>
  <ul class="collapse">
  <li><a href="#baseline-1" id="toc-baseline-1" class="nav-link" data-scroll-target="#baseline-1"><span class="header-section-number">10.1</span> Baseline</a></li>
  <li><a href="#estimated-hazard-damage-4" id="toc-estimated-hazard-damage-4" class="nav-link" data-scroll-target="#estimated-hazard-damage-4"><span class="header-section-number">10.2</span> Estimated Hazard Damage</a></li>
  <li><a href="#immediate-response-resources-6" id="toc-immediate-response-resources-6" class="nav-link" data-scroll-target="#immediate-response-resources-6"><span class="header-section-number">10.3</span> Immediate Response Resources</a></li>
  <li><a href="#estimated-financial-damage-5" id="toc-estimated-financial-damage-5" class="nav-link" data-scroll-target="#estimated-financial-damage-5"><span class="header-section-number">10.4</span> Estimated Financial Damage</a></li>
  </ul></li>
  <li><a href="#business" id="toc-business" class="nav-link" data-scroll-target="#business"><span class="header-section-number">11</span> Business</a>
  <ul class="collapse">
  <li><a href="#baseline-2" id="toc-baseline-2" class="nav-link" data-scroll-target="#baseline-2"><span class="header-section-number">11.1</span> Baseline</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content"><div class="quarto-title-block"><div class="quarto-title-tools-only"><h1></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>

<div class="header-container">
  <img src="asset/logo.png" class="header-logo">
  <h1>Disaster Estimate</h1>
  <span>Last edit: 29th of September 2025</span>
</div>


<section id="intro" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Intro</h1>
<p>This report runs based on a config file which provides the cyclone intensity applied to each council in Vanuatu. It has 5 columns:</p>
<ul>
<li>National</li>
<li>Province</li>
<li>Area Council</li>
<li>Hazard</li>
<li>Intensity (number from 2 to 3)</li>
</ul>
<p>Let’s load this file to use it later in our analysis:</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>config <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"Ex_hazard_areas.csv"</span>), <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Another file that will be useful: a 2 columns dataframe that provides the list of councils with their Province</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>council_province_lookup <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/council_province_lookup.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>And load the required libs</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required packages</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reactable)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(htmltools)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Order of councils and provinces in the final tables:</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the custom order for regions</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>region_order <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"National"</span>, <span class="co"># Will be displayed as Vanuatu</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Torba"</span>, <span class="st">"Torres"</span>, <span class="st">"Ureparapara"</span>, <span class="st">"Motalava"</span>, <span class="st">"West Vanualava"</span>, <span class="st">"East Vanualava"</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mota"</span>, <span class="st">"East Gaua"</span>, <span class="st">"West Gaua"</span>, <span class="st">"Merelava"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sanma"</span>, <span class="st">"Luganville"</span>, <span class="st">"North West Santo"</span>, <span class="st">"Big Bay Coast"</span>, <span class="st">"Big Bay Inland"</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"West Santo"</span>, <span class="st">"South Santo 1"</span>, <span class="st">"South Santo 2"</span>, <span class="st">"East Santo"</span>, <span class="st">"South East Santo"</span>, </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Canal - Fanafo"</span>, <span class="st">"West Malo"</span>, <span class="st">"East Malo"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Penama"</span>, <span class="st">"West Ambae"</span>, <span class="st">"North Ambae"</span>, <span class="st">"East Ambae"</span>, <span class="st">"South Ambae"</span>, <span class="st">"North Maewo"</span>, </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South Maewo"</span>, <span class="st">"North Pentecost"</span>, <span class="st">"Central Pentecost 1"</span>, <span class="st">"Central Pentecost 2"</span>, </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South Pentecost"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Malampa"</span>, <span class="st">"North West Malekula"</span>, <span class="st">"North East Malekula"</span>, <span class="st">"Central Malekula"</span>, </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South West Malekula"</span>, <span class="st">"South East Malekula"</span>, <span class="st">"South Malekula"</span>, <span class="st">"North Ambrym"</span>, </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"West Ambrym"</span>, <span class="st">"South East Ambrym"</span>, <span class="st">"Paama"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Shefa"</span>, <span class="st">"Port Vila"</span>, <span class="st">"Vermali"</span>, <span class="st">"Vermaul"</span>, <span class="st">"Varisu"</span>, <span class="st">"South Epi"</span>, <span class="st">"North Tongoa"</span>, </span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tongariki"</span>, <span class="st">"Makimae"</span>, <span class="st">"Nguna"</span>, <span class="st">"Emau"</span>, <span class="st">"Malorua"</span>, <span class="st">"North Efate"</span>, <span class="st">"Mele"</span>, </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tanvasoko"</span>, <span class="st">"Ifira"</span>, <span class="st">"Pango"</span>, <span class="st">"Erakor"</span>, <span class="st">"Eratap"</span>, <span class="st">"Eton"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tafea"</span>, <span class="st">"North Erromango"</span>, <span class="st">"South Erromango"</span>, <span class="st">"Aniwa"</span>, <span class="st">"North Tanna"</span>, <span class="st">"West Tanna"</span>, </span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Middle Bush Tanna"</span>, <span class="st">"South West Tanna"</span>, <span class="st">"Whitesands"</span>, <span class="st">"South Tanna"</span>, <span class="st">"Futuna"</span>, <span class="st">"Aneityum"</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Provincial levels (to be bolded)</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>provinces <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"National"</span>, <span class="st">"Torba"</span>, <span class="st">"Sanma"</span>, <span class="st">"Penama"</span>, <span class="st">"Malampa"</span>, <span class="st">"Shefa"</span>, <span class="st">"Tafea"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A function to aggregate a table with one row per council. It adds value per province and for the whole country</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># council_data must be a data frame with a column called "Region"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>compute_council_aggregates <span class="ot">&lt;-</span> <span class="cf">function</span>(council_data) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  province_data <span class="ot">&lt;-</span> council_data <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(council_province_lookup, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Council"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Region =</span> Province)  </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  national_data <span class="ot">&lt;-</span> province_data <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">"National"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    national_data,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    province_data,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    council_data</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add default order and formatting columns</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">default_order =</span> <span class="fu">match</span>(Region, region_order)) <span class="sc">%&gt;%</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(default_order) <span class="sc">%&gt;%</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>default_order)</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>format_table <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Region, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">Region =</span> <span class="fu">ifelse</span>(</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>        Region <span class="sc">%in%</span> provinces, </span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="st">"&lt;b&gt;"</span>, Region, <span class="st">"&lt;/b&gt;"</span>), </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>        Region</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="education" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Education</h1>
<section id="baseline-number-of-schools-students-and-teachers" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="baseline-number-of-schools-students-and-teachers"><span class="header-section-number">2.1</span> Baseline: Number of Schools, Students, and Teachers</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>full_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"1c_input_baseline.csv"</span>), <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Education in Baseline column and Area Council level data</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>education_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Education"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Changed to filter Baseline column</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Filter for the latest year</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to get Schools, Students, Teachers as separate columns</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>education_wide <span class="ot">&lt;-</span> education_data <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">education_level =</span> <span class="fu">tolower</span>(Attribute),  <span class="co"># Keep lowercase for consistency</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Number Schools"</span>, Indicator) <span class="sc">~</span> <span class="st">"schools"</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Students"</span>, Indicator) <span class="sc">~</span> <span class="st">"students"</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Teachers"</span>, Indicator) <span class="sc">~</span> <span class="st">"teachers"</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"other"</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(measure_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"schools"</span>, <span class="st">"students"</span>, <span class="st">"teachers"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, education_level, measure_type, Value) <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="fu">c</span>(education_level, measure_type),</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>education_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(education_wide)</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>  education_aggregated <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Education_01_baseline_education.csv"</span>),</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(education_aggregated)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the reactable with proper case labels</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ECCE columns</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_schools =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_students =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_teachers =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Teachers"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Primary columns  </span></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_schools =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_students =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_teachers =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Teachers"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Secondary columns</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_schools =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_students =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_teachers =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Teachers"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"ECCE"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ecce_schools"</span>, <span class="st">"ecce_students"</span>, <span class="st">"ecce_teachers"</span>)),</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Primary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"primary_schools"</span>, <span class="st">"primary_students"</span>, <span class="st">"primary_teachers"</span>)),</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Secondary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"secondary_schools"</span>, <span class="st">"secondary_students"</span>, <span class="st">"secondary_teachers"</span>))</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-daa40054df2491a1624d" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-daa40054df2491a1624d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"ecce_schools":[1154,66,6,4,8,12,8,2,16,4,6,240,44,14,14,12,16,14,34,14,16,24,14,196,22,22,12,12,12,22,22,14,30,28,236,40,36,34,22,26,20,18,14,16,10,190,60,2,8,10,6,12,2,4,12,6,4,8,16,4,2,6,6,18,4,226,8,6,4,26,44,28,18,56,18,6,12,24],"primary_schools":[870,54,6,4,6,6,8,4,10,4,6,182,26,8,14,18,12,14,18,20,10,14,10,124,20,14,8,10,6,8,18,12,12,16,172,34,16,22,12,16,14,18,16,12,12,188,52,6,10,10,8,12,4,8,8,4,8,10,8,2,2,4,6,20,6,150,5,9,2,18,28,24,10,36,10,2,6,18],"secondary_schools":[272,20,2,2,2,2,4,2,2,2,2,38,10,2,2,2,2,2,2,6,2,2,4,34,8,2,4,2,2,2,6,2,4,2,50,8,8,4,2,4,6,6,6,2,4,82,32,2,2,2,2,4,2,2,2,2,2,4,6,2,2,4,4,4,2,48,2,2,2,6,12,4,2,8,4,2,4,2],"ecce_teachers":[1102,52,7,3,7,11,5,3,10,3,3,255,62,7,10,14,21,13,32,19,23,20,9,174,18,14,4,10,12,12,35,17,21,31,212,45,24,35,19,19,15,18,14,17,6,243,81,8,16,11,17,9,2,9,15,4,8,13,12,2,0,9,8,15,4,166,5,6,2,21,37,22,16,31,15,2,9,25],"primary_teachers":[2174,94,12,6,14,17,11,6,17,4,7,534,181,17,26,38,18,44,48,50,17,38,17,239,24,20,17,13,12,14,47,27,30,35,370,65,51,57,30,42,40,31,18,23,13,587,236,21,18,16,12,22,5,10,18,11,13,35,37,0,6,20,31,57,19,350,14,16,3,34,85,65,31,59,23,6,14,40],"secondary_teachers":[1188,17,1,0,4,0,12,0,0,0,0,270,141,7,0,7,0,11,13,67,15,0,6,135,19,4,29,0,5,0,26,8,44,0,190,21,35,37,7,28,20,15,15,2,10,397,276,17,6,0,2,4,0,3,4,0,12,18,0,0,4,3,45,1,2,179,6,2,0,6,94,14,5,28,8,5,11,3],"ecce_students":[14697,532,43,25,95,86,88,14,156,0,25,2871,965,82,110,68,98,103,281,273,315,196,97,2049,138,177,93,119,121,158,422,217,354,250,2222,336,306,408,184,305,275,129,117,93,69,4221,2338,42,53,120,70,112,26,32,95,54,67,168,283,60,0,141,158,334,68,2802,106,64,29,298,576,379,316,705,185,22,122,283],"primary_students":[58449,2023,235,73,313,285,272,138,452,122,133,13396,4929,455,617,610,386,948,1177,1323,612,702,325,6720,590,460,358,352,470,360,1473,716,1027,914,8139,1264,1253,1396,554,1170,865,614,491,328,204,18133,9065,466,457,493,319,487,92,225,394,237,396,776,1068,148,122,473,891,1637,387,10038,203,293,112,1003,2251,1622,1247,2101,762,130,314,1312],"secondary_students":[26427,758,119,0,141,0,299,0,199,0,0,5327,2696,118,0,69,0,52,455,1199,433,0,186,2704,355,92,590,0,142,83,634,163,645,0,4059,467,581,784,217,678,474,267,342,98,151,9666,6076,207,138,0,140,72,0,124,153,0,264,718,229,14,77,258,814,260,122,3913,147,112,0,233,1942,355,399,315,165,113,132,119]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"ecce_schools","name":"Schools","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"primary_schools","name":"Schools","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"secondary_schools","name":"Schools","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"ecce_teachers","name":"Teachers","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"primary_teachers","name":"Teachers","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"secondary_teachers","name":"Teachers","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"ecce_students","name":"Students","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"primary_students","name":"Students","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"secondary_students","name":"Students","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"ECCE","columns":["ecce_schools","ecce_students","ecce_teachers"]},{"name":"Primary","columns":["primary_schools","primary_students","primary_teachers"]},{"name":"Secondary","columns":["secondary_schools","secondary_students","secondary_teachers"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"6ce468d85202a15319f9849f1ca0baad"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimating-damage-number-of-damaged-schools-and-students-affected" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="estimating-damage-number-of-damaged-schools-and-students-affected"><span class="header-section-number">2.2</span> Estimating damage: Number of damaged schools and students affected</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to baseline values</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>education_with_config <span class="ot">&lt;-</span> education_wide <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the baseline multiplying factors: 2a Input- Damage Multiplier (sheet 6)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Read CSV while preserving column names with spaces</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>baseline_factors <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"2a Input- Damage Multiplier.csv"</span>),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for damage multipliers (now considers council-specific values)</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>get_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, education_level, measure_type, area_council) {</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Education"</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>      Attribute <span class="sc">==</span> education_level,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(measure_type, Indicator, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>),</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council  <span class="co"># Add council-specific filter</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if we got any results</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the value from the intensity column</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>damage_estimates <span class="ot">&lt;-</span> education_with_config <span class="sc">%&gt;%</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ECCE - now passing Region to get council-specific multipliers</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_schools_damaged =</span> <span class="fu">round</span>(ecce_schools <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"ecce"</span>, <span class="st">"schools"</span>, Region)),</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_students_affected =</span> <span class="fu">round</span>(ecce_students <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"ecce"</span>, <span class="st">"students"</span>, Region)),</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Primary</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_schools_damaged =</span> <span class="fu">round</span>(primary_schools <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"primary"</span>, <span class="st">"schools"</span>, Region)),</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_students_affected =</span> <span class="fu">round</span>(primary_students <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"primary"</span>, <span class="st">"students"</span>, Region)),</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Secondary</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_schools_damaged =</span> <span class="fu">round</span>(secondary_schools <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"secondary"</span>, <span class="st">"schools"</span>, Region)),</span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_students_affected =</span> <span class="fu">round</span>(secondary_students <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"secondary"</span>, <span class="st">"students"</span>, Region))</span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">contains</span>(<span class="st">"_damaged"</span>), <span class="fu">contains</span>(<span class="st">"_affected"</span>))</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>damage_estimates_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(damage_estimates)</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>  damage_estimates_full <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Education_02_damage_estimates.csv"</span>),</span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(damage_estimates_full)</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ECCE columns</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_schools_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools Damaged"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_students_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students Affected"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Primary columns  </span></span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_schools_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools Damaged"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_students_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students Affected"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Secondary columns</span></span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_schools_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools Damaged"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_students_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students Affected"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"ECCE"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ecce_schools_damaged"</span>, <span class="st">"ecce_students_affected"</span>)),</span>
<span id="cb7-95"><a href="#cb7-95" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Primary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"primary_schools_damaged"</span>, <span class="st">"primary_students_affected"</span>)),</span>
<span id="cb7-96"><a href="#cb7-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Secondary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"secondary_schools_damaged"</span>, <span class="st">"secondary_students_affected"</span>))</span>
<span id="cb7-97"><a href="#cb7-97" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb7-98"><a href="#cb7-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-99"><a href="#cb7-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-100"><a href="#cb7-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb7-102"><a href="#cb7-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb7-103"><a href="#cb7-103" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb7-104"><a href="#cb7-104" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-105"><a href="#cb7-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb7-106"><a href="#cb7-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb7-107"><a href="#cb7-107" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb7-108"><a href="#cb7-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb7-109"><a href="#cb7-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-110"><a href="#cb7-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb7-111"><a href="#cb7-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb7-112"><a href="#cb7-112" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-b251d19bebd310252154" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b251d19bebd310252154">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"ecce_schools_damaged":[269,24,4,4,3,2,3,2,2,1,2,1,132,42,1,6,7,4,8,1,3,8,4,3,6,11,3,1,4,4,13,3,113,4,3,2,13,22,14,9,28,9,3,6],"primary_schools_damaged":[223,17,3,2,2,1,2,1,2,2,1,1,132,36,4,7,7,6,8,3,6,6,3,6,7,6,1,1,3,4,14,4,74,2,4,1,9,14,12,5,18,5,1,3],"secondary_schools_damaged":[82,5,1,1,0,0,0,1,1,1,0,0,53,22,1,1,1,1,3,1,1,1,1,1,3,4,1,1,3,3,3,1,24,1,1,1,3,6,2,1,4,2,1,2],"ecce_students_affected":[4578,223,34,31,41,18,30,28,13,12,9,7,2955,1637,29,37,84,49,78,18,22,66,38,47,118,198,42,0,99,111,234,48,1400,53,32,14,149,288,190,158,352,92,11,61],"primary_students_affected":[18526,812,126,125,140,55,117,86,61,49,33,20,12694,6346,326,320,345,223,341,64,158,276,166,277,543,748,104,85,331,624,1146,271,5020,102,146,56,502,1126,811,624,1050,381,65,157],"secondary_students_affected":[9130,406,47,58,78,22,68,47,27,34,10,15,6767,4253,145,97,0,98,50,0,87,107,0,185,503,160,10,54,181,570,182,85,1957,74,56,0,116,971,178,200,158,82,56,66]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"ecce_schools_damaged","name":"Schools Damaged","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"primary_schools_damaged","name":"Schools Damaged","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"secondary_schools_damaged","name":"Schools Damaged","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"ecce_students_affected","name":"Students Affected","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"primary_students_affected","name":"Students Affected","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"secondary_students_affected","name":"Students Affected","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"ECCE","columns":["ecce_schools_damaged","ecce_students_affected"]},{"name":"Primary","columns":["primary_schools_damaged","primary_students_affected"]},{"name":"Secondary","columns":["secondary_schools_damaged","secondary_students_affected"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"a067b7e3bd6fe9a9db759932279f27b8"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="resources-needed-to-be-sent-to-those-affected" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="resources-needed-to-be-sent-to-those-affected"><span class="header-section-number">2.3</span> Resources needed to be sent to those affected</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the resource response configuration "3aii Input- Resources Sent" (sheet 10)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>resource_config <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"3aii Input- Resources Sent.csv"</span>), <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get resource multipliers from config</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>get_resource_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type) {</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"Education"</span>, Indicator <span class="sc">==</span> resource_type) <span class="sc">%&gt;%</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(multiplier) <span class="sc">&gt;</span> <span class="dv">0</span>, multiplier, <span class="dv">0</span>))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration parameters</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>days_of_support <span class="ot">&lt;-</span> <span class="dv">14</span>  <span class="co"># Number of days to provide resources</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories from config file to education baseline data</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>education_with_config_resources <span class="ot">&lt;-</span> education_wide <span class="sc">%&gt;%</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate resources needed using council-specific cyclone categories</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>resources_needed <span class="ot">&lt;-</span> education_with_config_resources <span class="sc">%&gt;%</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get damage multiplier for this council's specific cyclone category</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">damage_multiplier =</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"ecce"</span>, <span class="st">"schools"</span>, Region),</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ECCE Resources</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_tents =</span> <span class="fu">round</span>(ecce_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tent"</span>), <span class="dv">0</span>),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_solar_lamps =</span> <span class="fu">round</span>(ecce_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Solar Lamp"</span>), <span class="dv">0</span>),</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_water =</span> <span class="fu">ceiling</span>(ecce_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Water"</span>) <span class="sc">*</span> days_of_support),</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_tin_fish =</span> <span class="fu">round</span>(ecce_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tin Fish"</span>) <span class="sc">*</span> days_of_support, <span class="dv">0</span>),  <span class="co"># Changed to "Tin Fish"</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Primary Resources</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_tents =</span> <span class="fu">round</span>(primary_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tent"</span>), <span class="dv">0</span>),</span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_solar_lamps =</span> <span class="fu">round</span>(primary_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Solar Lamp"</span>), <span class="dv">0</span>),</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_water =</span> <span class="fu">ceiling</span>(primary_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Water"</span>) <span class="sc">*</span> days_of_support),</span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_tin_fish =</span> <span class="fu">round</span>(primary_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tin Fish"</span>) <span class="sc">*</span> days_of_support, <span class="dv">0</span>),  <span class="co"># Changed to "Tin Fish"</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Secondary Resources</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_tents =</span> <span class="fu">round</span>(secondary_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tent"</span>), <span class="dv">0</span>),</span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_solar_lamps =</span> <span class="fu">round</span>(secondary_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Solar Lamp"</span>), <span class="dv">0</span>),</span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_water =</span> <span class="fu">ceiling</span>(secondary_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Water"</span>) <span class="sc">*</span> days_of_support),</span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_tin_fish =</span> <span class="fu">round</span>(secondary_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tin Fish"</span>) <span class="sc">*</span> days_of_support, <span class="dv">0</span>),  <span class="co"># Changed to "Tin Fish"</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total Resources (sum across all education levels)</span></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_tents =</span> ecce_tents <span class="sc">+</span> primary_tents <span class="sc">+</span> secondary_tents,</span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_solar_lamps =</span> ecce_solar_lamps <span class="sc">+</span> primary_solar_lamps <span class="sc">+</span> secondary_solar_lamps,</span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_water =</span> ecce_water <span class="sc">+</span> primary_water <span class="sc">+</span> secondary_water,</span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_tin_fish =</span> ecce_tin_fish <span class="sc">+</span> primary_tin_fish <span class="sc">+</span> secondary_tin_fish</span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">contains</span>(<span class="st">"tents"</span>), <span class="fu">contains</span>(<span class="st">"solar_lamps"</span>), <span class="fu">contains</span>(<span class="st">"water"</span>), <span class="fu">contains</span>(<span class="st">"tin_fish"</span>))</span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(resources_needed)</span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a>  resources_needed_full <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Education_03_resources_needed.csv"</span>),</span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the resources needed reactable</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ECCE columns</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_tents =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tents"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_solar_lamps =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Lamps"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_water =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water (1L bottles)"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_tin_fish =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tinned Fish"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Primary columns  </span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_tents =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tents"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_solar_lamps =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Lamps"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_water =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water (1L bottles)"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_tin_fish =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tinned Fish"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Secondary columns</span></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_tents =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tents"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_solar_lamps =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Lamps"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_water =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water (1L bottles)"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_tin_fish =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tinned Fish"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total columns</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_tents =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tents"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_solar_lamps =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Lamps"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_water =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water (1L bottles)"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_tin_fish =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tinned Fish"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"ECCE"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ecce_tents"</span>, <span class="st">"ecce_solar_lamps"</span>, <span class="st">"ecce_water"</span>, <span class="st">"ecce_tin_fish"</span>)),</span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Primary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"primary_tents"</span>, <span class="st">"primary_solar_lamps"</span>, <span class="st">"primary_water"</span>, <span class="st">"primary_tin_fish"</span>)),</span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Secondary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"secondary_tents"</span>, <span class="st">"secondary_solar_lamps"</span>, <span class="st">"secondary_water"</span>, <span class="st">"secondary_tin_fish"</span>)),</span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Totals"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_tents"</span>, <span class="st">"total_solar_lamps"</span>, <span class="st">"total_water"</span>, <span class="st">"total_tin_fish"</span>))</span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-1712c55e255b6800df41" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1712c55e255b6800df41">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"ecce_tents":[269,24,4,4,3,2,3,2,2,1,2,1,132,42,1,6,7,4,8,1,3,8,4,3,6,11,3,1,4,4,13,3,113,4,3,2,13,22,14,9,28,9,3,6],"primary_tents":[223,17,3,2,2,1,2,1,2,2,1,1,132,36,4,7,7,6,8,3,6,6,3,6,7,6,1,1,3,4,14,4,74,2,4,1,9,14,12,5,18,5,1,3],"secondary_tents":[82,5,1,1,0,0,0,1,1,1,0,0,53,22,1,1,1,1,3,1,1,1,1,1,3,4,1,1,3,3,3,1,24,1,1,1,3,6,2,1,4,2,1,2],"total_tents":[574,46,8,7,5,3,5,4,5,4,3,2,317,100,6,14,15,11,19,5,10,15,8,10,16,21,5,3,10,11,30,8,211,7,8,4,25,42,28,15,50,16,5,11],"ecce_solar_lamps":[2696,236,40,36,34,22,26,20,18,14,16,10,1330,420,14,56,70,42,84,14,28,84,42,28,56,112,28,14,42,42,126,28,1130,40,30,20,130,220,140,90,280,90,30,60],"primary_solar_lamps":[2238,172,34,16,22,12,16,14,18,16,12,12,1316,364,42,70,70,56,84,28,56,56,28,56,70,56,14,14,28,42,140,42,750,25,45,10,90,140,120,50,180,50,10,30],"secondary_solar_lamps":[864,50,8,8,4,2,4,6,6,6,2,4,574,224,14,14,14,14,28,14,14,14,14,14,28,42,14,14,28,28,28,14,240,10,10,10,30,60,20,10,40,20,10,20],"total_solar_lamps":[5798,458,82,60,60,36,46,40,42,36,30,26,3220,1008,70,140,154,112,196,56,98,154,84,98,154,210,56,42,98,112,294,84,2120,75,85,40,250,420,280,150,500,160,50,110],"ecce_water":[32060,1561,236,215,286,129,214,193,91,82,66,49,20690,11457,206,260,588,343,549,128,157,466,265,329,824,1387,294,0,691,775,1637,334,9809,371,224,102,1043,2016,1327,1106,2468,648,77,427],"primary_water":[129699,5701,885,878,978,388,819,606,430,344,230,143,88862,44419,2284,2240,2416,1564,2387,451,1103,1931,1162,1941,3803,5234,726,598,2318,4366,8022,1897,35136,711,1026,392,3511,7879,5677,4365,7354,2667,455,1099],"secondary_water":[63914,2844,327,407,549,152,475,332,187,240,69,106,47371,29773,1015,677,0,686,353,0,608,750,0,1294,3519,1123,69,378,1265,3989,1274,598,13699,515,392,0,816,6797,1243,1397,1103,578,396,462],"total_water":[225673,10106,1448,1500,1813,669,1508,1131,708,666,365,298,156923,85649,3505,3177,3004,2593,3289,579,1868,3147,1427,3564,8146,7744,1089,976,4274,9130,10933,2829,58644,1597,1642,494,5370,16692,8247,6868,10925,3893,928,1988],"ecce_tin_fish":[25636,1244,188,171,228,103,171,154,72,66,52,39,16546,9165,165,208,470,274,439,102,125,372,212,263,659,1109,235,0,553,619,1309,267,7846,297,179,81,834,1613,1061,885,1974,518,62,342],"primary_tin_fish":[103746,4558,708,702,782,310,655,484,344,275,184,114,71081,35535,1827,1791,1933,1250,1909,361,882,1544,929,1552,3042,4187,580,478,1854,3493,6417,1517,28107,568,820,314,2808,6303,4542,3492,5883,2134,364,879],"secondary_tin_fish":[51123,2275,262,325,439,122,380,265,150,192,55,85,37891,23818,811,541,0,549,282,0,486,600,0,1035,2815,898,55,302,1011,3191,1019,478,10957,412,314,0,652,5438,994,1117,882,462,316,370],"total_tin_fish":[180505,8077,1158,1198,1449,535,1206,903,566,533,291,238,125518,68518,2803,2540,2403,2073,2630,463,1493,2516,1141,2850,6516,6194,870,780,3418,7303,8745,2262,46910,1277,1313,395,4294,13354,6597,5494,8739,3114,742,1591]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"ecce_tents","name":"Tents","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"primary_tents","name":"Tents","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"secondary_tents","name":"Tents","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"total_tents","name":"Tents","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"ecce_solar_lamps","name":"Solar Lamps","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"primary_solar_lamps","name":"Solar Lamps","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"secondary_solar_lamps","name":"Solar Lamps","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"total_solar_lamps","name":"Solar Lamps","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"ecce_water","name":"Water (1L bottles)","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"primary_water","name":"Water (1L bottles)","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"secondary_water","name":"Water (1L bottles)","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"total_water","name":"Water (1L bottles)","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"ecce_tin_fish","name":"Tinned Fish","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"primary_tin_fish","name":"Tinned Fish","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"secondary_tin_fish","name":"Tinned Fish","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"total_tin_fish","name":"Tinned Fish","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"ECCE","columns":["ecce_tents","ecce_solar_lamps","ecce_water","ecce_tin_fish"]},{"name":"Primary","columns":["primary_tents","primary_solar_lamps","primary_water","primary_tin_fish"]},{"name":"Secondary","columns":["secondary_tents","secondary_solar_lamps","secondary_water","secondary_tin_fish"]},{"name":"Totals","columns":["total_tents","total_solar_lamps","total_water","total_tin_fish"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"6e6e15e3ecf7e2c1573a1659b16a08f7"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimate-financial-damage-from-cyclone" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="estimate-financial-damage-from-cyclone"><span class="header-section-number">2.4</span> Estimate financial damage from cyclone</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the financial damage estimation config (4a Input- Finance Estimates, sheet 13)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Read CSV while preserving column names with spaces</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>financial_config <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"4a Input- Finance Estimates.csv"</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove empty column if exists</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">""</span> <span class="sc">%in%</span> <span class="fu">names</span>(financial_config)) {</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  financial_config <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean column names to remove any extra spaces</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(financial_config) <span class="ot">&lt;-</span> <span class="fu">trimws</span>(<span class="fu">names</span>(financial_config))</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs from config (now council-specific)</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>get_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(school_type, area_council) {</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">trimws</span>(Cluster) <span class="sc">==</span> <span class="st">"Education"</span>, </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">trimws</span>(<span class="fu">tolower</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(school_type),</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Number Schools"</span>, <span class="fu">trimws</span>(Indicator), <span class="at">ignore.case =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council  <span class="co"># Add council-specific filter</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories from config file to education baseline data</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>education_with_config_financial <span class="ot">&lt;-</span> education_wide <span class="sc">%&gt;%</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate financial damage using council-specific cyclone categories</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>financial_damage <span class="ot">&lt;-</span> education_with_config_financial <span class="sc">%&gt;%</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get council-specific damage multipliers for each education level</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_damage_multiplier =</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"ecce"</span>, <span class="st">"schools"</span>, Region),</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_damage_multiplier =</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"primary"</span>, <span class="st">"schools"</span>, Region),</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_damage_multiplier =</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"secondary"</span>, <span class="st">"schools"</span>, Region),</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate financial damage per education level (in VT) using council-specific values</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_financial_damage =</span> ecce_schools <span class="sc">*</span> <span class="fu">get_unit_cost</span>(<span class="st">"ecce"</span>, Region) <span class="sc">*</span> ecce_damage_multiplier,</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_financial_damage =</span> primary_schools <span class="sc">*</span> <span class="fu">get_unit_cost</span>(<span class="st">"primary"</span>, Region) <span class="sc">*</span> primary_damage_multiplier,</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_financial_damage =</span> secondary_schools <span class="sc">*</span> <span class="fu">get_unit_cost</span>(<span class="st">"secondary"</span>, Region) <span class="sc">*</span> secondary_damage_multiplier,</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total financial damage</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial_damage =</span> ecce_financial_damage <span class="sc">+</span> primary_financial_damage <span class="sc">+</span> secondary_financial_damage</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">contains</span>(<span class="st">"financial_damage"</span>))</span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a>financial_damage_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(financial_damage)</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a>  financial_damage_full <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Education_04_financial_damage.csv"</span>),</span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(financial_damage_full)</span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the financial damage reactable</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb9-79"><a href="#cb9-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb9-80"><a href="#cb9-80" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-81"><a href="#cb9-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-82"><a href="#cb9-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage columns</span></span>
<span id="cb9-83"><a href="#cb9-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_financial_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb9-84"><a href="#cb9-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"ECCE"</span>, </span>
<span id="cb9-85"><a href="#cb9-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb9-86"><a href="#cb9-86" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-87"><a href="#cb9-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_financial_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb9-88"><a href="#cb9-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Primary"</span>, </span>
<span id="cb9-89"><a href="#cb9-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb9-90"><a href="#cb9-90" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-91"><a href="#cb9-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_financial_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb9-92"><a href="#cb9-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Secondary"</span>, </span>
<span id="cb9-93"><a href="#cb9-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb9-94"><a href="#cb9-94" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-95"><a href="#cb9-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb9-96"><a href="#cb9-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total"</span>, </span>
<span id="cb9-97"><a href="#cb9-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb9-98"><a href="#cb9-98" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb9-99"><a href="#cb9-99" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb9-100"><a href="#cb9-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb9-101"><a href="#cb9-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb9-102"><a href="#cb9-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Financial Damage (VT)"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ecce_financial_damage"</span>, <span class="st">"primary_financial_damage"</span>, <span class="st">"secondary_financial_damage"</span>, <span class="st">"total_financial_damage"</span>))</span>
<span id="cb9-103"><a href="#cb9-103" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb9-104"><a href="#cb9-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-105"><a href="#cb9-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-106"><a href="#cb9-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-107"><a href="#cb9-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb9-108"><a href="#cb9-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb9-109"><a href="#cb9-109" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb9-110"><a href="#cb9-110" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb9-112"><a href="#cb9-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb9-113"><a href="#cb9-113" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb9-114"><a href="#cb9-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb9-115"><a href="#cb9-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-116"><a href="#cb9-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb9-117"><a href="#cb9-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb9-118"><a href="#cb9-118" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-ed9126ef0af07c1572cc" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ed9126ef0af07c1572cc">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"ecce_financial_damage":[269600000,23600000,4000000,3600000,3400000,2200000,2600000,2000000,1800000,1400000,1600000,1000000,133000000,42000000,1400000,5600000,7000000,4200000,8400000,1400000,2800000,8400000,4200000,2800000,5600000,11200000,2800000,1400000,4200000,4200000,12600000,2800000,113000000,4000000,3000000,2000000,13000000,22000000,14000000,9000000,28000000,9000000,3000000,6000000],"primary_financial_damage":[1119000000,86000000,17000000,8000000,11000000,6000000,8000000,7000000,9000000,8000000,6000000,6000000,658000000,182000000,21000000,35000000,35000000,28000000,42000000,14000000,28000000,28000000,14000000,28000000,35000000,28000000,7000000,7000000,14000000,21000000,70000000,21000000,375000000,12500000,22500000,5000000,45000000,70000000,60000000,25000000,90000000,25000000,5000000,15000000],"secondary_financial_damage":[864000000,50000000,8000000,8000000,4000000,2000000,4000000,6000000,6000000,6000000,2000000,4000000,574000000,224000000,14000000,14000000,14000000,14000000,28000000,14000000,14000000,14000000,14000000,14000000,28000000,42000000,14000000,14000000,28000000,28000000,28000000,14000000,240000000,10000000,10000000,10000000,30000000,60000000,20000000,10000000,40000000,20000000,10000000,20000000],"total_financial_damage":[2252600000,159600000,29000000,19600000,18400000,10200000,14600000,15000000,16800000,15400000,9600000,11000000,1365000000,448000000,36400000,54600000,56000000,46200000,78400000,29400000,44800000,50400000,32200000,44800000,68600000,81200000,23800000,22400000,46200000,53200000,110600000,37800000,728000000,26500000,35500000,17000000,88000000,152000000,94000000,44000000,158000000,54000000,18000000,41000000]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"ecce_financial_damage","name":"ECCE","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"primary_financial_damage","name":"Primary","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"secondary_financial_damage","name":"Secondary","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"total_financial_damage","name":"Total","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Financial Damage (VT)","columns":["ecce_financial_damage","primary_financial_damage","secondary_financial_damage","total_financial_damage"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"6ae12100ddcd788fc23e530689ab724e"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="emergency-telecommunications" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Emergency Telecommunications</h1>
<section id="baseline-number-of-telecommunication-towers" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="baseline-number-of-telecommunication-towers"><span class="header-section-number">3.1</span> Baseline: Number of Telecommunication Towers</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Emergency Telecommunications in Baseline column and Area Council level data</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>telecom_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Emergency Telecommunications"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to get Digicel and Vodafone as separate columns</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>telecom_wide <span class="ot">&lt;-</span> telecom_data <span class="sc">%&gt;%</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">provider =</span> <span class="fu">tolower</span>(Attribute)  <span class="co"># digicel or vodafone</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(provider <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"digicel"</span>, <span class="st">"vodafone"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, provider, Value) <span class="sc">%&gt;%</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group and sum to handle duplicates (4 councils have duplicate entries)</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, provider) <span class="sc">%&gt;%</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> provider,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"towers_"</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>telecom_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(telecom_wide)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>  telecom_aggregated <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Telecom_01_baseline_towers.csv"</span>),</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(telecom_aggregated)</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the reactable</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_digicel =</span> <span class="fu">colDef</span>(</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Digicel"</span>, </span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_vodafone =</span> <span class="fu">colDef</span>(</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Vodafone"</span>, </span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Number of Towers"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"towers_digicel"</span>, <span class="st">"towers_vodafone"</span>))</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-83b33a9a95becb8351e4" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-83b33a9a95becb8351e4">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Motalava","West Vanualava","East Vanualava","East Gaua","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","Tongariki","Makimae","Nguna","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"towers_digicel":[129,4,0,1,1,1,1,22,6,0,1,0,1,3,0,5,3,1,1,13,2,2,0,0,2,2,3,0,2,22,4,3,3,2,3,2,2,1,1,1,53,20,1,2,2,0,1,1,1,6,3,1,3,0,1,4,3,4,15,1,1,1,5,0,2,3,1,0,1,1],"towers_vodafone":[246,8,1,2,1,2,2,49,13,2,2,1,2,0,5,8,8,2,2,30,4,3,2,1,3,3,0,6,8,34,4,7,6,4,3,3,2,2,1,2,94,39,2,3,1,1,2,2,1,12,4,3,5,1,2,6,5,5,31,2,2,2,10,1,3,6,2,1,2,4]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"towers_digicel","name":"Digicel","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"towers_vodafone","name":"Vodafone","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Number of Towers","columns":["towers_digicel","towers_vodafone"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"a74c643b4498607167eb3906c30ea23a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimating-damage-number-of-damaged-towers" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="estimating-damage-number-of-damaged-towers"><span class="header-section-number">3.2</span> Estimating Damage: Number of Damaged Towers</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to baseline values</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>telecom_with_config <span class="ot">&lt;-</span> telecom_wide <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for damage multipliers (council and provider-specific)</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>get_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, provider, area_council) {</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Emergency Telecommunications"</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>      Attribute <span class="sc">==</span> provider,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Number Towers"</span>, Indicator, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if we got any results</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the value from the intensity column</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>damage_estimates <span class="ot">&lt;-</span> telecom_with_config <span class="sc">%&gt;%</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Digicel towers damaged</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_digicel_damaged =</span> towers_digicel <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"digicel"</span>, Region),</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vodafone towers damaged</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_vodafone_damaged =</span> towers_vodafone <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"vodafone"</span>, Region),</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total towers damaged</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_towers_damaged =</span> towers_digicel_damaged <span class="sc">+</span> towers_vodafone_damaged</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, towers_digicel_damaged, towers_vodafone_damaged, total_towers_damaged)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>damage_estimates_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(damage_estimates)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  damage_estimates_full <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Telecom_02_damage_estimates.csv"</span>),</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(damage_estimates_full)</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_digicel_damaged =</span> <span class="fu">colDef</span>(</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Digicel"</span>, </span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_vodafone_damaged =</span> <span class="fu">colDef</span>(</span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Vodafone"</span>, </span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_towers_damaged =</span> <span class="fu">colDef</span>(</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total"</span>, </span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Damaged Towers"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"towers_digicel_damaged"</span>, <span class="st">"towers_vodafone_damaged"</span>, <span class="st">"total_towers_damaged"</span>))</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-1abd26725f7eaab48a84" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1abd26725f7eaab48a84">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","Tongariki","Makimae","Nguna","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"towers_digicel_damaged":[46.8,2.2,0.4,0.3,0.3,0.2,0.3,0.2,0.2,0.1,0.1,0.1,37.1,14,0.7,1.4,1.4,0,0.7,0.7,0.7,4.2,2.1,0.7,2.1,0,0.7,2.8,2.1,2.8,7.5,0.5,0.5,0.5,2.5,0,1,1.5,0.5,0,0.5],"towers_vodafone_damaged":[84.7,3.4,0.4,0.7,0.6,0.4,0.3,0.3,0.2,0.2,0.1,0.2,65.8,27.3,1.4,2.1,0.7,0.7,1.4,1.4,0.7,8.4,2.8,2.1,3.5,0.7,1.4,4.2,3.5,3.5,15.5,1,1,1,5,0.5,1.5,3,1,0.5,1],"total_towers_damaged":[131.5,5.6,0.8,1,0.9,0.6,0.6,0.5,0.4,0.3,0.2,0.3,102.9,41.3,2.1,3.5,2.1,0.7,2.1,2.1,1.4,12.6,4.9,2.8,5.6,0.7,2.1,7,5.6,6.3,23,1.5,1.5,1.5,7.5,0.5,2.5,4.5,1.5,0.5,1.5]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"towers_digicel_damaged","name":"Digicel","type":"numeric","format":{"cell":{"digits":1},"aggregated":{"digits":1}}},{"id":"towers_vodafone_damaged","name":"Vodafone","type":"numeric","format":{"cell":{"digits":1},"aggregated":{"digits":1}}},{"id":"total_towers_damaged","name":"Total","type":"numeric","format":{"cell":{"digits":1},"aggregated":{"digits":1}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Damaged Towers","columns":["towers_digicel_damaged","towers_vodafone_damaged","total_towers_damaged"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"0dfd3cd6669a80c2dada465861f4c724"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="energy" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Energy</h1>
<section id="baseline-household-energy-access-and-usage" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="baseline-household-energy-access-and-usage"><span class="header-section-number">4.1</span> Baseline: Household Energy Access and Usage</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get total households from Shelter baseline</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>total_households <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"number households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">total_households =</span> Value)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get household electricity data</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>electricity_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Energy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Electricity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape electricity data</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>electricity_wide <span class="ot">&lt;-</span> electricity_data <span class="sc">%&gt;%</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">attribute_clean =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, attribute_clean) <span class="sc">%&gt;%</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> attribute_clean,</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"elec_"</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Get household cooking fuel data</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>cooking_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Energy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Cooking Fuel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape cooking data</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>cooking_wide <span class="ot">&lt;-</span> cooking_data <span class="sc">%&gt;%</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">attribute_clean =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, attribute_clean) <span class="sc">%&gt;%</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> attribute_clean,</span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"cook_"</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all energy data</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>energy_wide <span class="ot">&lt;-</span> total_households <span class="sc">%&gt;%</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(electricity_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cooking_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>energy_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(energy_wide)</span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns to match client's specification before export</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>energy_aggregated_ordered <span class="ot">&lt;-</span> energy_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>    total_households,</span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Electricity in client's order</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp</span><span class="st">`</span>,</span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>    elec_generator,</span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid</span><span class="st">`</span>,</span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access</span><span class="st">`</span>,</span>
<span id="cb12-75"><a href="#cb12-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system</span><span class="st">`</span>,</span>
<span id="cb12-76"><a href="#cb12-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Cooking in client's order</span></span>
<span id="cb12-77"><a href="#cb12-77" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas</span><span class="st">`</span>,</span>
<span id="cb12-78"><a href="#cb12-78" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire</span><span class="st">`</span>,</span>
<span id="cb12-79"><a href="#cb12-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power</span><span class="st">`</span>,</span>
<span id="cb12-80"><a href="#cb12-80" aria-hidden="true" tabindex="-1"></a>    cook_electricity,</span>
<span id="cb12-81"><a href="#cb12-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove</span><span class="st">`</span></span>
<span id="cb12-82"><a href="#cb12-82" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-83"><a href="#cb12-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-84"><a href="#cb12-84" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb12-85"><a href="#cb12-85" aria-hidden="true" tabindex="-1"></a>  energy_aggregated_ordered,</span>
<span id="cb12-86"><a href="#cb12-86" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Energy_01_baseline.csv"</span>),</span>
<span id="cb12-87"><a href="#cb12-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb12-88"><a href="#cb12-88" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-89"><a href="#cb12-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-90"><a href="#cb12-90" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb12-91"><a href="#cb12-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb12-92"><a href="#cb12-92" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(energy_aggregated)</span>
<span id="cb12-93"><a href="#cb12-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-94"><a href="#cb12-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns to match client's specification</span></span>
<span id="cb12-95"><a href="#cb12-95" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> formatted <span class="sc">%&gt;%</span></span>
<span id="cb12-96"><a href="#cb12-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb12-97"><a href="#cb12-97" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb12-98"><a href="#cb12-98" aria-hidden="true" tabindex="-1"></a>    total_households,</span>
<span id="cb12-99"><a href="#cb12-99" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Electricity in client's order</span></span>
<span id="cb12-100"><a href="#cb12-100" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp</span><span class="st">`</span>,</span>
<span id="cb12-101"><a href="#cb12-101" aria-hidden="true" tabindex="-1"></a>    elec_generator,</span>
<span id="cb12-102"><a href="#cb12-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid</span><span class="st">`</span>,</span>
<span id="cb12-103"><a href="#cb12-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access</span><span class="st">`</span>,</span>
<span id="cb12-104"><a href="#cb12-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system</span><span class="st">`</span>,</span>
<span id="cb12-105"><a href="#cb12-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Cooking in client's order</span></span>
<span id="cb12-106"><a href="#cb12-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas</span><span class="st">`</span>,</span>
<span id="cb12-107"><a href="#cb12-107" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire</span><span class="st">`</span>,</span>
<span id="cb12-108"><a href="#cb12-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power</span><span class="st">`</span>,</span>
<span id="cb12-109"><a href="#cb12-109" aria-hidden="true" tabindex="-1"></a>    cook_electricity,</span>
<span id="cb12-110"><a href="#cb12-110" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove</span><span class="st">`</span></span>
<span id="cb12-111"><a href="#cb12-111" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-112"><a href="#cb12-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-113"><a href="#cb12-113" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the reactable with client's specified column order</span></span>
<span id="cb12-114"><a href="#cb12-114" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb12-115"><a href="#cb12-115" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb12-116"><a href="#cb12-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb12-117"><a href="#cb12-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb12-118"><a href="#cb12-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb12-119"><a href="#cb12-119" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb12-120"><a href="#cb12-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-121"><a href="#cb12-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb12-122"><a href="#cb12-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-123"><a href="#cb12-123" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb12-124"><a href="#cb12-124" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-125"><a href="#cb12-125" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total Households</span></span>
<span id="cb12-126"><a href="#cb12-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb12-127"><a href="#cb12-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-128"><a href="#cb12-128" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Electricity columns (in client's order)</span></span>
<span id="cb12-129"><a href="#cb12-129" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Battery Lamp"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb12-130"><a href="#cb12-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">elec_generator =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Generator"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb12-131"><a href="#cb12-131" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Main Grid"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb12-132"><a href="#cb12-132" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"No Access"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb12-133"><a href="#cb12-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar System"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb12-134"><a href="#cb12-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb12-135"><a href="#cb12-135" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Cooking columns (in client's order)</span></span>
<span id="cb12-136"><a href="#cb12-136" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Bottle Gas"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb12-137"><a href="#cb12-137" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Open Fire"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb12-138"><a href="#cb12-138" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Power"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb12-139"><a href="#cb12-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">cook_electricity =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Electricity"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb12-140"><a href="#cb12-140" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood Stove"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb12-141"><a href="#cb12-141" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb12-142"><a href="#cb12-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb12-143"><a href="#cb12-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households"</span>)),</span>
<span id="cb12-144"><a href="#cb12-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Electricity"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"elec_battery lamp"</span>, <span class="st">"elec_generator"</span>, <span class="st">"elec_main grid"</span>, <span class="st">"elec_no access"</span>, <span class="st">"elec_solar system"</span>)),</span>
<span id="cb12-145"><a href="#cb12-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Cooking"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"cook_bottle gas"</span>, <span class="st">"cook_open fire"</span>, <span class="st">"cook_solar power"</span>, <span class="st">"cook_electricity"</span>, <span class="st">"cook_wood stove"</span>))</span>
<span id="cb12-146"><a href="#cb12-146" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb12-147"><a href="#cb12-147" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-148"><a href="#cb12-148" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-149"><a href="#cb12-149" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-150"><a href="#cb12-150" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb12-151"><a href="#cb12-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb12-152"><a href="#cb12-152" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb12-153"><a href="#cb12-153" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb12-154"><a href="#cb12-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb12-155"><a href="#cb12-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb12-156"><a href="#cb12-156" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb12-157"><a href="#cb12-157" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb12-158"><a href="#cb12-158" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb12-159"><a href="#cb12-159" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb12-160"><a href="#cb12-160" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb12-161"><a href="#cb12-161" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-9feed419929deeac4275" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9feed419929deeac4275">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"total_households":[72482.0546920189,2794.95252753011,251.536722793333,95.5562924834146,403.506543031657,352.861855525167,399.483016622889,121.069311546954,736.395575324238,273.387859087372,161.15535111509,15197.264125121,4011.10961674314,313.385436919143,899.778336226117,555.824444268251,506.606466711524,1320.33984160773,1263.23800890242,1761.34327423859,2215.88663450749,776.294122501475,515.73360885726,9200.13931705135,606.924608004948,593.436796206294,476.457889720776,236.189949175808,767.461922591376,620.864206151392,1683.41539017212,1095.50324205733,1539.83327247302,1580.05204049829,10353.2774827892,1188.86767401795,1539.62290420528,1541.65738237234,935.199541294908,1153.86214879327,1202.44366657817,1007.7042284521,385.450635837244,605.948867341972,792.520433895933,24030.8306358174,8958.28660829032,620.505261352837,467.791975723459,610.02408994337,470.290296930793,327.891570980372,237.737908455605,232.625876024746,468.181911066327,197.239389926415,1023.64421567205,872.350722672883,887.60272195239,1904.00050406432,245.525974562536,486.365911492837,3298.47690356345,1825.63717105486,896.651622087837,10905.5906037098,374.158737182642,151.382492979637,140.043923990882,1021.95989506718,3601.9013798503,1581.98340313245,1424.05385466799,1782.97527561199,403.851005201499,87.3229637301334,335.957672295088,1057.72433363789],"elec_battery lamp":[7132.67721839991,402.265667410194,16.9303563418589,52.4018378134854,41.4630783566365,26.0992496690212,42.050843855041,65.237109382378,71.2193147949873,0,86.8638771967858,1209.1444165188,99.6989118706837,10.6082436948302,133.253491260567,138.25866070255,134.676726018237,120.151842098879,59.2017760464013,144.235984662058,236.595583306169,71.3161769165512,42.0786835678518,1114.46837073513,44.8963921673659,147.964101317748,40.5594828662785,9.91006779758636,13.3577233362423,40.1080438436265,220.741351202065,164.845222155653,337.308829962804,94.7771560857643,1474.25300500961,121.331345239537,220.572756320821,89.4547232163757,229.622671962905,54.3003325234527,195.158559498525,233.707675581689,41.9457022596825,87.6068281257728,200.55241028085,786.580575746171,138.053981065191,71.1860720481266,0,19.6359685604089,131.626438791126,2.00082408270948,26.8311849248607,11.7328721692395,43.1358614690324,50.4056218700839,57.0199695732439,17.5490597867415,10.8364372269437,42.2069149392906,1.1212154184573,0.991074697425938,106.947203357859,36.2721964824326,19.0276792829985,2145.96518298,12.5556623215652,7.89821702502455,49.3597437017042,486.871572563648,234.726992120214,619.196812189965,45.0697895493327,524.220735945039,59.5015587600955,3.32658909448127,103.237509708935,19.0683363740196],"elec_generator":[409.446195599467,18.7206271490744,0,1.02748701595069,3.03388378219291,1.04396998676085,8.41016877100819,0.931958705462542,4.27315888769924,0,0,90.325543099112,12.3223374222193,5.78631474263468,1.26908086914826,0,1.73776420668693,2.50316337705997,1.26127672213424,12.4819602111396,31,4.67647061747876,3.23682181291167,95.0720861002026,12.5292257211254,30.3767360321204,4.71621893793936,2.47751694939659,2.42867697022587,0,8.35237545088894,5.83522910285499,23.1628381090338,5.19326882661722,45.1208503472649,0,2.00520687564383,2.12987436229466,0,11.4866088030381,3.63649489748804,2.47309709610252,1.23369712528478,4.80037414387796,17.355497043535,123.917852634246,17.1307859715931,7.11860720481267,3.80318679449967,2.61812914138785,9.59776116185292,0,0,0,3.15628254651457,1.09577438848008,0,46.3796580078165,5.9107839419693,5.83997351969018,0,0,14.0720004418236,3.62721964824326,3.56768986556222,36.2892362695673,2.51113246431303,1.31636950417076,1.1479010163187,2.35203658243308,5.17780129676941,2.38611488319832,16.740207546895,2.46113021570441,0,0,2.19654275976457,14.0503531176986],"elec_main grid":[20720.6104167259,64.1275368789375,0,0,0,0,64.1275368789375,0,0,0,0,4119.4548593813,3042.49713079525,0,0,0,0,0,0,360.589961655145,454.263519947844,1.16911765436969,0,134.633988397462,0,0,68.8567964939147,0,0,65.7771919035475,0,0,0,0,1048.32246954901,0,406.054392317875,529.273779030223,87.3686264053978,19.8405061143385,0,0,0,0,5.78516568117834,13686.8195449594,7719.93831343381,2.37286906827089,2.53545786299978,0,0,0,1.16657325760264,0,0,0,476.524031433539,367.276751251088,733.922339461188,1314.01005865807,236.576453294489,409.313850036913,1649.23845178172,709.725977839598,64.21841758012,1667.25201755975,0,0,0,0,1667.25201755975,0,0,0,0,0,0,260.935129328689],"elec_no access":[9238.07582054719,571.817857969076,96.7448933820511,6.16492209570417,132.479591822424,119.012578490737,58.8711813970573,0.931958705462542,132.467925518676,0,25.1448065569643,1031.61262302683,134.425499151484,24.1096447609779,25.3816173829652,39.8816912136477,139.021136534954,133.919240672709,75.9208914293854,49.9278408445585,278.506800920404,46.7647061747876,49.631267797979,2454.3550565165,103.366112199284,127.386312392763,50.9351645297451,95.7973220433351,420.161115849076,239.043941308014,195.684224849398,366.16062620415,228.733026326708,627.087210814029,1165.55449792978,196.640456077871,74.1926543988216,38.3377385213038,8.96088475952797,108.600665046905,224.250518678429,119.945209160972,53.0489763872455,222.017304154356,119.560090744352,1641.94147293303,234.79253714007,39.1523396264697,191.427068656483,47.1263245449814,191.955223237058,3.00123612406422,18.6651721216422,0,6.31256509302913,3.28732316544025,12.2185649085523,65.1822220650396,31.5241810238363,112.507536494726,1.1212154184573,5.94644818455563,216.708806804083,409.875820251488,51.1368880730586,2372.79431217196,119.278792054869,88.1967567794408,2.2958020326374,243.435786281824,479.809586833965,628.741271722758,382.449357032909,356.863881277139,2.53198122383385,0,69.191096932584,34.1222861429824],"elec_solar system":[34295.1071870593,1443.6854688591,136.652161902147,35.9620455582743,224.507399882275,205.662087391887,214.459303660709,53.1216462113649,524.174156891107,0,49.1466673613393,8660.97873650974,685.570045672567,271.95679290383,739.874146713436,372.798639313488,226.778228972645,1061.34127187343,1126.85406470451,1178.85179771874,1205.96148748059,647.691180520809,419.707895074214,5345.41494475801,443.743410956523,286.12925552836,291.462330364652,128.00504238549,330.300067950719,272.73469813666,1245.69713867544,555.805572046939,942.437975561311,849.099453151916,6566.93784009359,862.916895022569,831.158249954367,872.183551359664,607.099942458019,952.344293488249,778.209908062439,645.478342082758,287.451430191353,290.422635704617,439.672591769554,7652.75451051105,778.946915061263,497.116069802751,270.026262409477,538.025538555204,134.368656265941,319.131441192161,187.818294474025,219.99135317324,415.577201957752,142.450670502411,462.947848201814,367.276751251088,104.423849641458,425.63117812618,5.60607709228648,61.4466312404082,1303.06724091286,661.363049196356,757.539481454378,4625.33568632783,233.535319181112,52.6547801668303,86.0925762239027,289.30049963927,1178.81276189784,329.283853881369,977.370579084101,897.081963624255,341.817465217571,82.3330800884114,157.052807323167,723.59318556148],"cook_bottle gas":[7782.75446226408,13.7345987550835,0,0,0,0,9.46143986738422,0,4.27315888769924,0,0,1005.43077796334,744.941307797806,0,3.80724260744478,0,0,5,23,41.6065340371321,133.845501413204,12.8602941980666,3.23682181291167,137.797433169135,5.22051071713557,10.7788418178492,52.8216521049208,0,15.7864003064682,6.41728701498025,15.5115544087937,7.29403637856873,5.79070952725845,18.1764408931603,77.2159118040127,2.09191974550926,10.0260343782191,37.2728013401566,5.60055297470498,4.17694865565021,1.21216496582935,6.1827427402563,2.46739425056956,2.40018707193898,5.78516568117834,6374.30023428596,4099.29631367298,4.74573813654178,3.80318679449967,0,1.37110873740756,2.00082408270948,0,0,10.5209418217152,1.09577438848008,111.324702500143,60.1682049831134,227.565181765818,618.658374594213,86.3335872212118,156.589802193298,652.940820500614,298.641084372029,39.2445885211845,174.275506286549,1.25556623215652,0,0,0,151.882171371903,5.96528720799581,5.15083309135231,3.69169532355661,6.32995305958464,0,0,37.133076096775],"cook_open fire":[54775.8115326147,2369.04840107254,243.071544622403,94.5288054674639,395.416186279143,346.598035604602,363.739799346104,112.767003360967,660.915241297482,0,152.011785094375,12600.9904174539,2558.5653338499,295.102051874368,875.6657997123,462.90200500403,485.705095768998,1227,1177,1626.81548085186,1908.98836359034,719.00735743736,484.444331332447,8311.91563585423,492.816211697598,555.60030097459,388.616440486203,225.454042395089,739.532137433779,455.627378063598,1499.84799168106,1047.42362396247,1410.03776988743,1496.95973927241,9050.97510782788,1013.53511669924,1147.98093630609,1348.21047133252,893.848254762915,1108.97986807513,992.763107014235,922.465216846241,351.603680706162,548.442745938057,723.145710147292,12945.0085926982,2458.77163356984,595.590136135993,392.995968764966,579.915604817409,327.694988240407,314.129380985388,230.981505005323,227.813267952733,450.296309969412,155.599963164172,669.30583332403,676.892306060026,432.472358420754,910.302302939519,63.9092788520659,226.95610571054,2092.50646569917,1343.28034306609,795.594840020375,9497.87337770792,360.34750862892,61.8693666960257,133.156517892969,950.222779302966,2903.02059372206,1461.49536595898,1249.07702465294,1634.19046322773,379.797183575078,64.8684873423848,299.828086707864,779.794598032275],"cook_solar power":[3108.5777831039,106.060438153824,6.04655583637819,1.02748701595069,5.05647297032152,5.21984993380425,6.30762657825615,7.45566964370034,66.9461559072881,0,8.00062026812501,492.140541918401,49.2893496888774,11.5726294852693,17.7671321680756,76.9478687008945,15.6398778601824,39,42,44.3803029729409,81.1184857049722,30.397059013612,24.8156338989895,368.539377157735,46.9845964542201,23.5174730571254,11.3189254510545,7.43255084818976,9.7147078809035,8.02160876872531,64.4326106211433,35.01137461713,111.471158399725,50.6343710595179,790.359487879581,99.3661879116899,229.596187261218,31.9481154344199,32.4832072532889,27.1501662617264,195.158559498525,65.5370730467167,19.1223054419141,36.0028060790847,53.9948796909978,654.676129958027,121.930888386045,13.0507798754899,64.6541755064944,26.1812914138785,46.6176970718571,7.00288428948318,1.16657325760264,3.9109573897465,1.05209418217152,36.1605548198428,62.4504428659338,20.0560683277044,20.6877437968926,43.1140108763775,1.1212154184573,14.866120461389,74.581602341665,56.8264411558111,39.2445885211845,696.801808036334,1.25556623215652,1.31636950417076,5.73950508159351,69.385079181776,136.348767481595,108.568227185524,163.538950650436,140.284422295151,17.723868566837,20.7911818405079,31.8498700165863,59.2122024245872],"cook_electricity":[4266.97445448625,274.944666748397,268.637040170141,0,0,0,6.30762657825615,0,0,0,0,641.580160668358,492.893496888774,0.964385790439113,0,0,0,1.25158168852999,1.26127672213424,27.737689358088,70.3026876109759,0,0,1.98734593101498,1.04410214342711,0,0.943243787587872,0,0,0,0,0,0,0,216.416901205589,0,135.351464105958,77.7404142237551,0,2.08847432782511,0,1.23654854805126,0,0,0,2807.569832002,1629.44005388624,1.18643453413544,3.80318679449967,0,4.11332621222268,0,0,0,0,0,153.41087051849,90.2523074746701,196.041000741982,223.643491946854,85.2123718027545,75.3216770043713,263.146408262101,68.917173316622,13.0815295070615,324.475547930883,0,0,0,0,324.475547930883,0,0,0,0,0,0,47.1690426094169],"cook_wood stove":[1555.83843970122,3.31185336002769,1.20931116727564,0,0,0,2.10254219275205,0,0,0,0,339.927561619871,120.982949236336,1.92877158087823,2.53816173829652,11.089117524762,0.868882103343466,45,9,4.16065340371321,10.8157980939963,7.01470592621815,1.07894060430389,310.691227619264,55.337413601637,1.95978942142712,0.943243787587872,3.30335593252878,1.21433848511294,147.597601344546,89.4897369738102,1.45880727571375,2.89535476362922,6.49158603327153,103.237241218495,62.7575923652778,4.01041375128765,15.97405771721,1.120110594941,1.04423716391255,2.42432993165869,1.23654854805126,9.86957700227821,4.80037414387796,0,658.943916864851,248.900243234323,2.37286906827089,1.26772893149989,1.30906457069393,87.7509591940839,1.00041204135474,2.33314651520528,0,3.15628254651457,4.38309755392034,5.4304732926899,11.2815384343338,3.94052262797954,71.2295917664571,5.60607709228648,3.96429878970375,160.420805036789,36.2721964824326,8.32460968631185,139.726639018715,3.76669869646955,86.8803872752701,0,2.35203658243308,43.1483441397452,3.57917232479749,0,0,0,0,0,125.449581408023]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"total_households","name":"Total","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"elec_battery lamp","name":"Battery Lamp","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"elec_generator","name":"Generator","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"elec_main grid","name":"Main Grid","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"elec_no access","name":"No Access","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"elec_solar system","name":"Solar System","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cook_bottle gas","name":"Bottle Gas","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cook_open fire","name":"Open Fire","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cook_solar power","name":"Solar Power","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cook_electricity","name":"Electricity","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cook_wood stove","name":"Wood Stove","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Total Households","columns":["total_households"]},{"name":"Household Electricity","columns":["elec_battery lamp","elec_generator","elec_main grid","elec_no access","elec_solar system"]},{"name":"Household Cooking","columns":["cook_bottle gas","cook_open fire","cook_solar power","cook_electricity","cook_wood stove"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"502ddc7f162d445163583dcb7e12104f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimating-damage-households-affected-by-electricity-disruption" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="estimating-damage-households-affected-by-electricity-disruption"><span class="header-section-number">4.2</span> Estimating damage: Households affected by electricity disruption</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to baseline values</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>energy_with_config <span class="ot">&lt;-</span> energy_wide <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for damage multipliers (council-specific, for both electricity and cooking)</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>get_energy_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, indicator_type, attribute_type, area_council) {</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Energy"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator_type,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute_type)),</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if we got any results</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the value from the intensity column</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>damage_estimates <span class="ot">&lt;-</span> energy_with_config <span class="sc">%&gt;%</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total households affected (same as baseline - no damage applied)</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> total_households,</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Damaged households for each electricity type</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">elec_battery lamp</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Electricity"</span>, <span class="st">"battery lamp"</span>, Region),</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">elec_generator_damaged =</span> elec_generator <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Electricity"</span>, <span class="st">"generator"</span>, Region),</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">elec_main grid</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Electricity"</span>, <span class="st">"main grid"</span>, Region),</span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">elec_no access</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Electricity"</span>, <span class="st">"no access"</span>, Region),</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">elec_solar system</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Electricity"</span>, <span class="st">"solar system"</span>, Region),</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Damaged households for each cooking fuel type</span></span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">cook_bottle gas</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Cooking Fuel"</span>, <span class="st">"bottle gas"</span>, Region),</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">cook_open fire</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Cooking Fuel"</span>, <span class="st">"open fire"</span>, Region),</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">cook_solar power</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Cooking Fuel"</span>, <span class="st">"solar power"</span>, Region),</span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">cook_electricity_damaged =</span> cook_electricity <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Cooking Fuel"</span>, <span class="st">"electricity"</span>, Region),</span>
<span id="cb13-49"><a href="#cb13-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">cook_wood stove</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Cooking Fuel"</span>, <span class="st">"wood stove"</span>, Region)</span>
<span id="cb13-50"><a href="#cb13-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb13-51"><a href="#cb13-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-52"><a href="#cb13-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_households_affected, <span class="fu">contains</span>(<span class="st">"_damaged"</span>))</span>
<span id="cb13-53"><a href="#cb13-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-54"><a href="#cb13-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb13-55"><a href="#cb13-55" aria-hidden="true" tabindex="-1"></a>damage_estimates_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(damage_estimates)</span>
<span id="cb13-56"><a href="#cb13-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-57"><a href="#cb13-57" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb13-58"><a href="#cb13-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns to match client's specification before export</span></span>
<span id="cb13-59"><a href="#cb13-59" aria-hidden="true" tabindex="-1"></a>damage_estimates_ordered <span class="ot">&lt;-</span> damage_estimates_full <span class="sc">%&gt;%</span></span>
<span id="cb13-60"><a href="#cb13-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb13-61"><a href="#cb13-61" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb13-62"><a href="#cb13-62" aria-hidden="true" tabindex="-1"></a>    total_households_affected,</span>
<span id="cb13-63"><a href="#cb13-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Electricity in client's order</span></span>
<span id="cb13-64"><a href="#cb13-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp_damaged</span><span class="st">`</span>,</span>
<span id="cb13-65"><a href="#cb13-65" aria-hidden="true" tabindex="-1"></a>    elec_generator_damaged,</span>
<span id="cb13-66"><a href="#cb13-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid_damaged</span><span class="st">`</span>,</span>
<span id="cb13-67"><a href="#cb13-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access_damaged</span><span class="st">`</span>,</span>
<span id="cb13-68"><a href="#cb13-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system_damaged</span><span class="st">`</span>,</span>
<span id="cb13-69"><a href="#cb13-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Cooking in client's order</span></span>
<span id="cb13-70"><a href="#cb13-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas_damaged</span><span class="st">`</span>,</span>
<span id="cb13-71"><a href="#cb13-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire_damaged</span><span class="st">`</span>,</span>
<span id="cb13-72"><a href="#cb13-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power_damaged</span><span class="st">`</span>,</span>
<span id="cb13-73"><a href="#cb13-73" aria-hidden="true" tabindex="-1"></a>    cook_electricity_damaged,</span>
<span id="cb13-74"><a href="#cb13-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove_damaged</span><span class="st">`</span></span>
<span id="cb13-75"><a href="#cb13-75" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-76"><a href="#cb13-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-77"><a href="#cb13-77" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb13-78"><a href="#cb13-78" aria-hidden="true" tabindex="-1"></a>  damage_estimates_ordered,</span>
<span id="cb13-79"><a href="#cb13-79" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Energy_02_damage_estimates.csv"</span>),</span>
<span id="cb13-80"><a href="#cb13-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb13-81"><a href="#cb13-81" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-82"><a href="#cb13-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-83"><a href="#cb13-83" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb13-84"><a href="#cb13-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb13-85"><a href="#cb13-85" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(damage_estimates_ordered)</span>
<span id="cb13-86"><a href="#cb13-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-87"><a href="#cb13-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb13-88"><a href="#cb13-88" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb13-89"><a href="#cb13-89" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb13-90"><a href="#cb13-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb13-91"><a href="#cb13-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb13-92"><a href="#cb13-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb13-93"><a href="#cb13-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb13-94"><a href="#cb13-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb13-95"><a href="#cb13-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb13-96"><a href="#cb13-96" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-97"><a href="#cb13-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total Households</span></span>
<span id="cb13-98"><a href="#cb13-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb13-99"><a href="#cb13-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-100"><a href="#cb13-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Electricity columns (in client's order)</span></span>
<span id="cb13-101"><a href="#cb13-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Battery Lamp"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb13-102"><a href="#cb13-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">elec_generator_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Generator"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb13-103"><a href="#cb13-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Main Grid"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb13-104"><a href="#cb13-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"No Access"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb13-105"><a href="#cb13-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar System"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb13-106"><a href="#cb13-106" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb13-107"><a href="#cb13-107" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Cooking columns (in client's order)</span></span>
<span id="cb13-108"><a href="#cb13-108" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Bottle Gas"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb13-109"><a href="#cb13-109" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Open Fire"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb13-110"><a href="#cb13-110" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Power"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb13-111"><a href="#cb13-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">cook_electricity_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Electricity"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb13-112"><a href="#cb13-112" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood Stove"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb13-113"><a href="#cb13-113" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-114"><a href="#cb13-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb13-115"><a href="#cb13-115" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households_affected"</span>)),</span>
<span id="cb13-116"><a href="#cb13-116" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Electricity Affected"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"elec_battery lamp_damaged"</span>, <span class="st">"elec_generator_damaged"</span>, <span class="st">"elec_main grid_damaged"</span>, <span class="st">"elec_no access_damaged"</span>, <span class="st">"elec_solar system_damaged"</span>)),</span>
<span id="cb13-117"><a href="#cb13-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Cooking Affected"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"cook_bottle gas_damaged"</span>, <span class="st">"cook_open fire_damaged"</span>, <span class="st">"cook_solar power_damaged"</span>, <span class="st">"cook_electricity_damaged"</span>, <span class="st">"cook_wood stove_damaged"</span>))</span>
<span id="cb13-118"><a href="#cb13-118" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-119"><a href="#cb13-119" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-120"><a href="#cb13-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-121"><a href="#cb13-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-122"><a href="#cb13-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb13-123"><a href="#cb13-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb13-124"><a href="#cb13-124" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb13-125"><a href="#cb13-125" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb13-126"><a href="#cb13-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb13-127"><a href="#cb13-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb13-128"><a href="#cb13-128" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb13-129"><a href="#cb13-129" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb13-130"><a href="#cb13-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-131"><a href="#cb13-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb13-132"><a href="#cb13-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb13-133"><a href="#cb13-133" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-145e4816b4d06009f32d" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-145e4816b4d06009f32d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"total_households_affected":[45289.6987223164,10353.2774827892,1188.86767401795,1539.62290420528,1541.65738237234,935.199541294908,1153.86214879327,1202.44366657817,1007.7042284521,385.450635837244,605.948867341972,792.520433895933,24030.8306358174,8958.28660829032,620.505261352837,467.791975723459,610.02408994337,470.290296930793,327.891570980372,237.737908455605,232.625876024746,468.181911066327,197.239389926415,1023.64421567205,872.350722672883,887.60272195239,1904.00050406432,245.525974562536,486.365911492837,3298.47690356345,1825.63717105486,896.651622087837,10905.5906037098,374.158737182642,151.382492979637,140.043923990882,1021.95989506718,3601.9013798503,1581.98340313245,1424.05385466799,1782.97527561199,403.851005201499,87.3229637301334,335.957672295088],"elec_battery lamp_damaged":[1771.01429501328,147.425300500961,12.1331345239537,22.0572756320821,8.94547232163757,22.9622671962905,5.43003325234527,19.5158559498525,23.3707675581689,4.19457022596825,8.76068281257728,20.055241028085,550.60640302232,96.6377867456337,49.8302504336886,0,13.7451779922862,92.1385071537882,1.40057685789664,18.7818294474025,8.21301051846765,30.1951030283227,35.2839353090587,39.9139787012707,12.284341850719,7.58550605886059,29.5448404575034,0.78485079292011,0.693752288198157,74.8630423505013,25.3905375377028,13.3193754980989,1072.98259149,6.2778311607826,3.94910851251228,24.6798718508521,243.435786281824,117.363496060107,309.598406094983,22.5348947746663,262.110367972519,29.7507793800477,1.66329454724064,51.6187548544675],"elec_generator_damaged":[109.399200013482,4.51208503472649,0,0.200520687564383,0.212987436229466,0,1.14866088030381,0.363649489748804,0.247309709610252,0.123369712528478,0.480037414387796,1.7355497043535,86.7424968439721,11.9915501801152,4.98302504336887,2.66223075614977,1.83269039897149,6.71843281329704,0,0,0,2.2093977825602,0.767042071936056,0,32.4657606054716,4.13754875937851,4.08798146378313,0,0,9.85040030927652,2.53905375377028,2.49738290589355,18.1446181347836,1.25556623215652,0.65818475208538,0.57395050815935,1.17601829121654,2.5889006483847,1.19305744159916,8.3701037734475,1.23056510785221,0,0,1.09827137988228],"elec_main grid_damaged":[10519.2319372064,104.832246954901,0,40.6054392317875,52.9273779030223,8.73686264053978,1.98405061143385,0,0,0,0,0.578516568117834,9580.77368147159,5403.95681940367,1.66100834778962,1.77482050409985,0,0,0,0.816601280321848,0,0,0,333.566822003477,257.093725875762,513.745637622832,919.807041060649,165.603517306142,286.519695025839,1154.4669162472,496.808184487719,44.952892306084,833.626008779875,0,0,0,0,833.626008779875,0,0,0,0,0,0],"elec_no access_damaged":[2452.31163693208,116.555449792978,19.6640456077871,7.41926543988216,3.83377385213038,0.896088475952797,10.8600665046905,22.4250518678429,11.9945209160972,5.30489763872455,22.2017304154356,11.9560090744352,1149.35903105312,164.354775998049,27.4066377385288,133.998948059538,32.988427181487,134.368656265941,2.10086528684495,13.0656204851495,0,4.41879556512039,2.30112621580817,8.55299543598661,45.6275554455277,22.0669267166854,78.7552755463082,0.78485079292011,4.16251372918894,151.696164762858,286.913074176042,35.795821651141,1186.39715608598,59.6393960274345,44.0983783897204,1.1479010163187,121.717893140912,239.904793416982,314.370635861379,191.224678516455,178.43194063857,1.26599061191693,0,34.595548466292],"elec_solar system_damaged":[8326.28978453101,656.693784009359,86.2916895022569,83.1158249954367,87.2183551359664,60.7099942458019,95.2344293488249,77.8209908062439,64.5478342082758,28.7451430191353,29.0422635704617,43.9672591769554,5356.92815735774,545.262840542884,347.981248861926,189.018383686634,376.617876988643,94.0580593861587,223.392008834513,131.472806131817,153.993947221268,290.904041370426,99.7154693516877,324.06349374127,257.093725875762,73.0966947490206,297.941824688326,3.92425396460054,43.0126418682857,912.147068639002,462.954134437449,530.277637018065,2312.66784316391,116.767659590556,26.3273900834151,43.0462881119513,144.650249819635,589.40638094892,164.641926940684,488.68528954205,448.540981812127,170.908732608785,41.1665400442057,78.5264036615835],"cook_bottle gas_damaged":[4556.86950832385,7.72159118040127,0.209191974550926,1.00260343782191,3.72728013401566,0.560055297470498,0.417694865565021,0.121216496582935,0.61827427402563,0.246739425056956,0.240018707193898,0.578516568117834,4462.01016400017,2869.50741957109,3.32201669557925,2.66223075614977,0,0.959776116185292,1.40057685789664,0,0,7.36465927520064,0.767042071936056,77.9272917501001,42.1177434881794,159.295627236073,433.060862215949,60.4335110548483,109.612861535309,457.05857435043,209.04875906042,27.4712119648291,87.1377531432745,0.62778311607826,0,0,0,75.9410856859515,2.9826436039979,2.57541654567616,1.84584766177831,3.16497652979232,0,0],"cook_open fire_damaged":[14715.5402145255,905.097510782788,101.353511669924,114.798093630609,134.821047133252,89.3848254762915,110.897986807513,99.2763107014235,92.2465216846241,35.1603680706162,54.8442745938057,72.3145710147292,9061.50601488875,1721.14014349889,416.913095295195,275.097178135476,405.940923372186,229.386491768285,219.890566689772,161.687053503726,159.469287566913,315.207416978588,108.91997421492,468.514083326821,473.824614242018,302.730650894528,637.211612057663,44.7364951964461,158.869273997378,1464.75452598942,940.296240146263,556.916388014262,4748.93668885396,180.17375431446,30.9346833480129,66.5782589464845,475.111389651483,1451.51029686103,730.74768297949,624.53851232647,817.095231613865,189.898591787539,32.4342436711924,149.914043353932],"cook_solar power_damaged":[885.710143776744,79.0359487879581,9.93661879116899,22.9596187261218,3.19481154344199,3.24832072532889,2.71501662617264,19.5158559498525,6.55370730467167,1.91223054419141,3.60028060790847,5.39948796909978,458.273290970619,85.3516218702315,9.13554591284293,45.2579228545461,18.3269039897149,32.6323879503,4.90201900263823,0.816601280321848,2.73767017282255,0.736465927520064,25.31238837389,43.7153100061537,14.0392478293931,14.4814206578248,30.1798076134642,0.78485079292011,10.4062843229723,52.2071216391655,39.7785088090678,27.4712119648291,348.400904018167,0.62778311607826,0.65818475208538,2.86975254079676,34.692539590888,68.1743837407975,54.284113592762,81.769475325218,70.1422111475755,8.8619342834185,10.3955909202539,15.9249350082932],"cook_electricity_damaged":[2149.1783464874,21.6416901205589,0,13.5351464105958,7.77404142237551,0,0.208847432782511,0,0.123654854805126,0,0,0,1965.2988824014,1140.60803772037,0.830504173894808,2.66223075614977,0,2.87932834855588,0,0,0,0,0,107.387609362943,63.1766152322691,137.228700519387,156.550444362798,59.6486602619281,52.7251739030599,184.202485783471,48.2420213216354,9.15707065494305,162.237773965442,0,0,0,0,162.237773965442,0,0,0,0,0,0],"cook_wood stove_damaged":[541.447785436603,10.3237241218495,6.27575923652778,0.401041375128765,1.597405771721,0.1120110594941,0.104423716391255,0.242432993165869,0.123654854805126,0.986957700227821,0.480037414387796,0,461.260741805395,174.230170264026,1.66100834778962,0.887410252049923,0.916345199485751,61.4256714358587,0.700288428948318,1.6332025606437,0,2.2093977825602,3.06816828774424,3.80133130488293,7.89707690403366,2.75836583958568,49.86071423652,3.92425396460054,2.77500915279262,112.294563525752,25.3905375377028,5.82722678041829,69.8633195093577,1.88334934823477,43.440193637635,0,1.17601829121654,21.5741720698726,1.78958616239875,0,0,0,0,0]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_households_affected","name":"Total","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"elec_battery lamp_damaged","name":"Battery Lamp","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"elec_generator_damaged","name":"Generator","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"elec_main grid_damaged","name":"Main Grid","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"elec_no access_damaged","name":"No Access","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"elec_solar system_damaged","name":"Solar System","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cook_bottle gas_damaged","name":"Bottle Gas","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cook_open fire_damaged","name":"Open Fire","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cook_solar power_damaged","name":"Solar Power","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cook_electricity_damaged","name":"Electricity","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cook_wood stove_damaged","name":"Wood Stove","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Total Households","columns":["total_households_affected"]},{"name":"Household Electricity Affected","columns":["elec_battery lamp_damaged","elec_generator_damaged","elec_main grid_damaged","elec_no access_damaged","elec_solar system_damaged"]},{"name":"Household Cooking Affected","columns":["cook_bottle gas_damaged","cook_open fire_damaged","cook_solar power_damaged","cook_electricity_damaged","cook_wood stove_damaged"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"e41e11eb374eb5c693de8f3e0632f01b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="immediate-response-resources" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="immediate-response-resources"><span class="header-section-number">4.3</span> Immediate Response Resources</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we need to get infrastructure baseline data and calculate damage</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>energy_infra_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Energy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Energy Infrastructure"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape infrastructure data</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>energy_infra_wide <span class="ot">&lt;-</span> energy_infra_data <span class="sc">%&gt;%</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">attribute_clean =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, attribute_clean) <span class="sc">%&gt;%</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> attribute_clean,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"infra_"</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone config to infrastructure data</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>energy_infra_with_config <span class="ot">&lt;-</span> energy_infra_wide <span class="sc">%&gt;%</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for infrastructure damage multipliers</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>get_infra_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, attribute_type, area_council) {</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Energy"</span>,</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Energy Infrastructure"</span>,</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute_type)),</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damaged infrastructure</span></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>infra_damage <span class="ot">&lt;-</span> energy_infra_with_config <span class="sc">%&gt;%</span></span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate damaged poles</span></span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_low voltage poles_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_low voltage poles</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"low voltage poles"</span>, Region),</span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_high voltage poles_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_high voltage poles</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"high voltage poles"</span>, Region),</span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total damaged poles for power line cable calculation</span></span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_poles_damaged =</span> <span class="st">`</span><span class="at">infra_low voltage poles_damaged</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">infra_high voltage poles_damaged</span><span class="st">`</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">contains</span>(<span class="st">"_damaged"</span>), total_poles_damaged)</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Now calculate resources needed</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Join household damage data with infrastructure damage data</span></span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>resources_base <span class="ot">&lt;-</span> damage_estimates <span class="sc">%&gt;%</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(infra_damage, <span class="at">by =</span> <span class="st">"Region"</span>)</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total electricity households affected</span></span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>resources_needed <span class="ot">&lt;-</span> resources_base <span class="sc">%&gt;%</span></span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total households with electricity affected (for solar lamps)</span></span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_elec_affected =</span> <span class="st">`</span><span class="at">elec_battery lamp_damaged</span><span class="st">`</span> <span class="sc">+</span> elec_generator_damaged <span class="sc">+</span> </span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">elec_main grid_damaged</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">elec_no access_damaged</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">elec_solar system_damaged</span><span class="st">`</span>,</span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Resource calculations based on specifications</span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_lamp =</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">*</span> total_elec_affected, <span class="dv">0</span>),</span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">low_voltage_poles_support =</span> <span class="fu">round</span>(<span class="fl">0.2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">infra_low voltage poles_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">high_voltage_pole_support =</span> <span class="fu">round</span>(<span class="fl">0.2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">infra_high voltage poles_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">power_line_cable =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> total_poles_damaged, <span class="dv">0</span>)</span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, solar_lamp, low_voltage_poles_support, high_voltage_pole_support, power_line_cable)</span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(resources_needed)</span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>  resources_needed_full,</span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Energy_03_resources_needed.csv"</span>),</span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the resources needed reactable</span></span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_lamp =</span> <span class="fu">colDef</span>(</span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Solar Lamp"</span>, </span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">low_voltage_poles_support =</span> <span class="fu">colDef</span>(</span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Low Voltage Poles Support"</span>, </span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">high_voltage_pole_support =</span> <span class="fu">colDef</span>(</span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"High Voltage Pole Support"</span>, </span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">power_line_cable =</span> <span class="fu">colDef</span>(</span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Power Line Cable (metres)"</span>, </span>
<span id="cb14-122"><a href="#cb14-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb14-123"><a href="#cb14-123" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb14-124"><a href="#cb14-124" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb14-125"><a href="#cb14-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb14-126"><a href="#cb14-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb14-127"><a href="#cb14-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Electricity"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"solar_lamp"</span>)),</span>
<span id="cb14-128"><a href="#cb14-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Non-renewable"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"low_voltage_poles_support"</span>, <span class="st">"high_voltage_pole_support"</span>, <span class="st">"power_line_cable"</span>))</span>
<span id="cb14-129"><a href="#cb14-129" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb14-130"><a href="#cb14-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-131"><a href="#cb14-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-132"><a href="#cb14-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-133"><a href="#cb14-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb14-134"><a href="#cb14-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb14-135"><a href="#cb14-135" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb14-136"><a href="#cb14-136" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb14-137"><a href="#cb14-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb14-138"><a href="#cb14-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb14-139"><a href="#cb14-139" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb14-140"><a href="#cb14-140" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb14-141"><a href="#cb14-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-142"><a href="#cb14-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb14-143"><a href="#cb14-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb14-144"><a href="#cb14-144" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-c3f2a3d075cc24ede4fd" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c3f2a3d075cc24ede4fd">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"solar_lamp":[23176,1028,118,153,153,93,115,120,100,38,60,78,16724,6222,432,327,425,327,227,164,162,328,138,706,605,621,1330,171,334,2303,1275,627,5424,184,75,69,511,1783,790,711,890,202,43,166],"low_voltage_poles_support":[1131,0,0,"NA",0,0,0,0,0,0,"NA",0,1131,550,0,0,0,0,0,0,0,0,"NA",105,53,42,108,14,46,90,114,9,0,0,"NA",0,0,0,0,0,0,"NA",0,0],"high_voltage_pole_support":[85,0,0,"NA",0,0,0,0,0,0,"NA",0,85,21,0,0,0,0,0,0,0,0,"NA",30,6,4,5,0,2,9,7,1,0,0,"NA",0,0,0,0,0,0,"NA",0,0],"power_line_cable":[607950,0,0,"NA",0,0,0,0,0,0,"NA",0,607950,285250,0,0,0,0,0,0,0,0,"NA",67760,29540,23170,56280,7350,23800,49070,60620,5110,0,0,"NA",0,0,0,0,0,0,"NA",0,0]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"solar_lamp","name":"Solar Lamp","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"low_voltage_poles_support","name":"Low Voltage Poles Support","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"high_voltage_pole_support","name":"High Voltage Pole Support","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"power_line_cable","name":"Power Line Cable (metres)","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Household Electricity","columns":["solar_lamp"]},{"name":"Non-renewable","columns":["low_voltage_poles_support","high_voltage_pole_support","power_line_cable"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"b5e67aeadd21ac4ac7eff9110a4d40c7"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimated-financial-damage" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="estimated-financial-damage"><span class="header-section-number">4.4</span> Estimated Financial Damage</h2>
<section id="table-1-household-electricity-financial-damage" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="table-1-household-electricity-financial-damage"><span class="header-section-number">4.4.1</span> Table 1: Household Electricity Financial Damage</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for household electricity</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>get_household_elec_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(electricity_type, area_council) {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Energy"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Household Electricity"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(electricity_type)),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories from config file</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>energy_damage_with_config <span class="ot">&lt;-</span> damage_estimates <span class="sc">%&gt;%</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate household electricity financial damage</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>household_elec_financial <span class="ot">&lt;-</span> energy_damage_with_config <span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each electricity type (in VT)</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">battery_lamp_damage =</span> <span class="st">`</span><span class="at">elec_battery lamp_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_household_elec_unit_cost</span>(<span class="st">"battery lamp"</span>, Region),</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">generator_damage =</span> elec_generator_damaged <span class="sc">*</span> <span class="fu">get_household_elec_unit_cost</span>(<span class="st">"generator"</span>, Region),</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">main_grid_damage =</span> <span class="st">`</span><span class="at">elec_main grid_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_household_elec_unit_cost</span>(<span class="st">"electricity poles"</span>, Region),  <span class="co"># Using "electricity poles" as proxy for main grid</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total household electricity financial damage</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_household_elec_damage =</span> battery_lamp_damage <span class="sc">+</span> generator_damage <span class="sc">+</span> main_grid_damage</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, battery_lamp_damage, generator_damage, main_grid_damage, total_household_elec_damage)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>household_elec_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(household_elec_financial)</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>  household_elec_financial_full,</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Energy_04a_financial_damage_household_electricity.csv"</span>),</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(household_elec_financial_full)</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">battery_lamp_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Battery Lamp"</span>,</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">generator_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Generator"</span>,</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">main_grid_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Main Grid"</span>,</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_household_elec_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Electricity"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"battery_lamp_damage"</span>, <span class="st">"generator_damage"</span>, <span class="st">"main_grid_damage"</span>, <span class="st">"total_household_elec_damage"</span>))</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb15-83"><a href="#cb15-83" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb15-84"><a href="#cb15-84" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb15-85"><a href="#cb15-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb15-86"><a href="#cb15-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb15-87"><a href="#cb15-87" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb15-88"><a href="#cb15-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb15-89"><a href="#cb15-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-90"><a href="#cb15-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb15-91"><a href="#cb15-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb15-92"><a href="#cb15-92" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-8972ef5e58329aa03223" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8972ef5e58329aa03223">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"battery_lamp_damage":[309927501.627325,25799427.5876682,2123298.5416919,3860023.23561437,1565457.65628657,4018396.75935084,950255.819160422,3415274.79122419,4089884.32267956,734049.789544444,1533119.49220102,3509667.17991488,96356120.528906,16911612.6804859,8720293.82589551,0,2405406.14865009,16124238.7519129,245100.950131911,3286820.15329544,1437276.84073184,5284143.02995647,6174688.67908528,6984946.27272238,2149759.82387583,1327463.5603006,5170347.0800631,137348.888761019,121406.650434677,13101032.4113377,4443344.06909799,2330890.71216732,187771953.51075,1098620.45313695,691093.989689648,4318977.57389912,42601262.5993192,20538611.8105187,54179721.0666219,3943606.58556661,45869314.3951909,5206386.39150836,291076.545767111,9033282.09953181],"generator_damage":[109399.200013482,4512.08503472649,0,200.520687564383,212.987436229466,0,1148.66088030381,363.649489748804,247.309709610252,123.369712528478,480.037414387796,1735.5497043535,86742.4968439721,11991.5501801152,4983.02504336887,2662.23075614977,1832.69039897149,6718.43281329704,0,0,0,2209.3977825602,767.042071936056,0,32465.7606054716,4137.54875937851,4087.98146378313,0,0,9850.40030927652,2539.05375377028,2497.38290589355,18144.6181347836,1255.56623215652,658.18475208538,573.95050815935,1176.01829121654,2588.9006483847,1193.05744159916,8370.1037734475,1230.56510785221,0,0,1098.27137988228],"main_grid_damage":[1683077109.95302,16773159.5127842,0,6496870.277086,8468380.46448357,1397898.02248636,317448.097829416,0,0,0,0,92562.6508988534,1532923789.03545,864633091.104587,265761.33564634,283971.280655975,0,0,0,130656.204851496,0,0,0,53370691.5205564,41134996.1401219,82199302.0196531,147169126.569704,26496562.7689828,45843151.2041342,184714706.599553,79489309.518035,7192462.76897344,133380161.40478,0,0,0,0,133380161.40478,0,0,0,0,0,0],"total_household_elec_damage":[1993114010.78036,42577099.1854871,2123298.5416919,10357094.0333879,10034051.1082064,5416294.7818372,1268852.57787014,3415638.44071394,4090131.63238917,734173.159256972,1533599.52961541,3603965.38051808,1629366652.0612,881556695.335253,8991038.18658522,286633.511412125,2407238.83904906,16130957.1847262,245100.950131911,3417476.35814693,1437276.84073184,5286352.42773903,6175455.72115721,60355637.7932787,43317221.7246032,83530903.128713,152343561.631231,26633911.6577438,45964557.8545689,197825589.4112,83935192.6408867,9525850.86404665,321170259.533665,1099876.01936911,691752.174441734,4319551.52440728,42602438.6176104,153921362.115947,54180914.1240635,3951976.68934006,45870544.9602988,5206386.39150836,291076.545767111,9034380.3709117]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"battery_lamp_damage","name":"Battery Lamp","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"generator_damage","name":"Generator","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"main_grid_damage","name":"Main Grid","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"total_household_elec_damage","name":"Total Value","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Household Electricity","columns":["battery_lamp_damage","generator_damage","main_grid_damage","total_household_elec_damage"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"ffa520090998caa300618b822301890d"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-2-energy-infrastructure-financial-damage" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="table-2-energy-infrastructure-financial-damage"><span class="header-section-number">4.4.2</span> Table 2: Energy Infrastructure Financial Damage</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for infrastructure</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>get_infrastructure_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(infrastructure_type, area_council) {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Energy"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Energy Infrastructure"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(infrastructure_type)),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Join infrastructure baseline with config</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>energy_infra_with_config <span class="ot">&lt;-</span> energy_infra_wide <span class="sc">%&gt;%</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate infrastructure financial damage</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>infrastructure_financial <span class="ot">&lt;-</span> energy_infra_with_config <span class="sc">%&gt;%</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate damaged infrastructure units and their financial cost</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">hydro_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_hydro"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) infra_hydro <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"hydro"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">hydro_financial =</span> hydro_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"hydro"</span>, Region),</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_solar"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) infra_solar <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"solar"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_financial =</span> solar_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"solar"</span>, Region),</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">pole_support_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_electrcity pole support"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_electrcity pole support</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"electrcity pole support"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">pole_support_financial =</span> pole_support_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"electrcity pole support"</span>, Region),</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">terminals_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_electrical terminals"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_electrical terminals</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"electrical terminals"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">terminals_financial =</span> terminals_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"electrical terminals"</span>, Region),</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_poles_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_high voltage poles"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_high voltage poles</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"high voltage poles"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_poles_financial =</span> hv_poles_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"high voltage poles"</span>, Region),</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_support_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_high voltage support poles"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_high voltage support poles</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"high voltage support poles"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_support_financial =</span> hv_support_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"high voltage support poles"</span>, Region),</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_transformer_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_high voltage transformer substation"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_high voltage transformer substation</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"high voltage transformer substation"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_transformer_financial =</span> hv_transformer_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"high voltage transformer substation"</span>, Region),</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_poles_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_low voltage poles"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_low voltage poles</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"low voltage poles"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_poles_financial =</span> lv_poles_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"low voltage poles"</span>, Region),</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_distribution_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_low voltage street distrbution boxes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_low voltage street distrbution boxes</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"low voltage street distrbution boxes"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_distribution_financial =</span> lv_distribution_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"low voltage street distrbution boxes"</span>, Region),</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total infrastructure financial damage</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_infrastructure_damage =</span> hydro_financial <span class="sc">+</span> solar_financial <span class="sc">+</span> pole_support_financial <span class="sc">+</span> </span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>                                  terminals_financial <span class="sc">+</span> hv_poles_financial <span class="sc">+</span> hv_support_financial <span class="sc">+</span></span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>                                  hv_transformer_financial <span class="sc">+</span> lv_poles_financial <span class="sc">+</span> lv_distribution_financial</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, hydro_financial, solar_financial, pole_support_financial, terminals_financial,</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>         hv_poles_financial, hv_support_financial, hv_transformer_financial, </span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>         lv_poles_financial, lv_distribution_financial, total_infrastructure_damage)</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>infrastructure_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(infrastructure_financial)</span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a>  infrastructure_financial_full,</span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Energy_04b_financial_damage_infrastructure.csv"</span>),</span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb16-70"><a href="#cb16-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-71"><a href="#cb16-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-72"><a href="#cb16-72" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb16-73"><a href="#cb16-73" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(infrastructure_financial_full)</span>
<span id="cb16-74"><a href="#cb16-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-75"><a href="#cb16-75" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb16-76"><a href="#cb16-76" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb16-77"><a href="#cb16-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb16-78"><a href="#cb16-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb16-79"><a href="#cb16-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb16-80"><a href="#cb16-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb16-81"><a href="#cb16-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb16-82"><a href="#cb16-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb16-83"><a href="#cb16-83" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-84"><a href="#cb16-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">hydro_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Hydro"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb16-85"><a href="#cb16-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb16-86"><a href="#cb16-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">pole_support_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Electricity Pole Support"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb16-87"><a href="#cb16-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">terminals_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Electrical Terminals"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb16-88"><a href="#cb16-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_poles_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"High Voltage Poles"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb16-89"><a href="#cb16-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_support_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"High Voltage Support Poles"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb16-90"><a href="#cb16-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_transformer_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"HV Transformer Substation"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb16-91"><a href="#cb16-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_poles_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Low Voltage Poles"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb16-92"><a href="#cb16-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_distribution_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"LV Street Distribution Boxes"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb16-93"><a href="#cb16-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_infrastructure_damage =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total Value"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb16-94"><a href="#cb16-94" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb16-95"><a href="#cb16-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb16-96"><a href="#cb16-96" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb16-97"><a href="#cb16-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Renewable"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"hydro_financial"</span>, <span class="st">"solar_financial"</span>)),</span>
<span id="cb16-98"><a href="#cb16-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Non-renewable"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"pole_support_financial"</span>, <span class="st">"terminals_financial"</span>, </span>
<span id="cb16-99"><a href="#cb16-99" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"hv_poles_financial"</span>, <span class="st">"hv_support_financial"</span>,</span>
<span id="cb16-100"><a href="#cb16-100" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"hv_transformer_financial"</span>, <span class="st">"lv_poles_financial"</span>,</span>
<span id="cb16-101"><a href="#cb16-101" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"lv_distribution_financial"</span>)),</span>
<span id="cb16-102"><a href="#cb16-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_infrastructure_damage"</span>))</span>
<span id="cb16-103"><a href="#cb16-103" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb16-104"><a href="#cb16-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-105"><a href="#cb16-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-106"><a href="#cb16-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-107"><a href="#cb16-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb16-108"><a href="#cb16-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb16-109"><a href="#cb16-109" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb16-110"><a href="#cb16-110" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-111"><a href="#cb16-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb16-112"><a href="#cb16-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb16-113"><a href="#cb16-113" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb16-114"><a href="#cb16-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb16-115"><a href="#cb16-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-116"><a href="#cb16-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb16-117"><a href="#cb16-117" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb16-118"><a href="#cb16-118" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-c3c686a15a68b196c722" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c3c686a15a68b196c722">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","Futuna","Aneityum"],"hydro_financial":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"solar_financial":[145500000,15000000,500000,2000000,1500000,1500000,2500000,1500000,2500000,3000000,63000000,3500000,7000000,3500000,7000000,3500000,3500000,3500000,17500000,10500000,0,0,0,0,0,0,0,3500000,0,67500000,5000000,5000000,5000000,5000000,15000000,7500000,15000000,5000000,5000000],"pole_support_financial":[192640000,0,0,0,0,0,0,0,0,0,192640000,155680000,0,0,0,0,0,0,0,0,5740000,0,7420000,4060000,700000,5740000,8260000,5040000,0,0,0,0,0,0,0,0,0,0,0],"terminals_financial":[316120000,0,0,0,0,0,0,0,0,0,316120000,123760000,0,0,0,0,0,0,0,0,36260000,0,2240000,56700000,10920000,14280000,22680000,48580000,700000,0,0,0,0,0,0,0,0,0,0],"hv_poles_financial":[84280000,0,0,0,0,0,0,0,0,0,84280000,20580000,0,0,0,0,0,0,0,0,30240000,5740000,3920000,5040000,420000,1680000,8540000,7000000,1120000,0,0,0,0,0,0,0,0,0,0],"hv_support_financial":[155960000,0,0,0,0,0,0,0,0,0,155960000,13860000,0,0,0,0,0,0,0,0,51660000,11060000,6580000,15260000,420000,1400000,14980000,39200000,1540000,0,0,0,0,0,0,0,0,0,0],"hv_transformer_financial":[21280000,0,0,0,0,0,0,0,0,0,21280000,13020000,0,0,0,0,0,0,0,0,3080000,0,280000,980000,420000,1260000,1120000,1120000,0,0,0,0,0,0,0,0,0,0,0],"lv_poles_financial":[1131620000,0,0,0,0,0,0,0,0,0,1131620000,549920000,0,0,0,0,0,0,0,0,105280000,53340000,42420000,107520000,14280000,45920000,89600000,114240000,9100000,0,0,0,0,0,0,0,0,0,0],"lv_distribution_financial":[10500000,0,0,0,0,0,0,0,0,0,10500000,4760000,0,0,0,0,0,0,0,0,0,0,0,1120000,140000,280000,3920000,280000,0,0,0,0,0,0,0,0,0,0,0],"total_infrastructure_damage":[2057900000,15000000,500000,2000000,1500000,1500000,2500000,1500000,2500000,3000000,1975400000,885080000,7000000,3500000,7000000,3500000,3500000,3500000,17500000,10500000,232260000,70140000,62860000,190680000,27300000,70560000,149100000,218960000,12460000,67500000,5000000,5000000,5000000,5000000,15000000,7500000,15000000,5000000,5000000]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"hydro_financial","name":"Hydro","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"solar_financial","name":"Solar","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"pole_support_financial","name":"Electricity Pole Support","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"terminals_financial","name":"Electrical Terminals","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"hv_poles_financial","name":"High Voltage Poles","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"hv_support_financial","name":"High Voltage Support Poles","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"hv_transformer_financial","name":"HV Transformer Substation","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"lv_poles_financial","name":"Low Voltage Poles","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"lv_distribution_financial","name":"LV Street Distribution Boxes","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"total_infrastructure_damage","name":"Total Value","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Renewable","columns":["hydro_financial","solar_financial"]},{"name":"Non-renewable","columns":["pole_support_financial","terminals_financial","hv_poles_financial","hv_support_financial","hv_transformer_financial","lv_poles_financial","lv_distribution_financial"]},{"name":"Total","columns":["total_infrastructure_damage"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"a6e36156d7295d9d95135c47312fd455"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
</section>
<section id="food-security" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Food security</h1>
<section id="baseline-food-security" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="baseline-food-security"><span class="header-section-number">5.1</span> Baseline: Food Security</h2>
<section id="table-1-staple-crops" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="table-1-staple-crops"><span class="header-section-number">5.1.1</span> Table 1: Staple crops</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get total households from Shelter baseline (for both tables)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>total_households <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"number households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">total_households =</span> Value)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># === TABLE 1: STAPLE CROPS ===</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Get staple crop data</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>staple_crop_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Food Security"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Stable Crop Households"</span>, <span class="st">"Staple Crop Production"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Indicator, Attribute, Value)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape staple crop data</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>staple_crop_wide <span class="ot">&lt;-</span> staple_crop_data <span class="sc">%&gt;%</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">crop =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)),</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Households"</span>, Indicator) <span class="sc">~</span> <span class="st">"households"</span>,</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Production"</span>, Indicator) <span class="sc">~</span> <span class="st">"production"</span>,</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"other"</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, crop, metric) <span class="sc">%&gt;%</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="fu">c</span>(crop, metric),</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with total households</span></span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>staple_crop_full <span class="ot">&lt;-</span> total_households <span class="sc">%&gt;%</span></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(staple_crop_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>staple_crop_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(staple_crop_full)</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to client's specification</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>staple_crop_ordered <span class="ot">&lt;-</span> staple_crop_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    total_households,</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Island Cabbage</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_households</span><span class="st">`</span>,</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_production</span><span class="st">`</span>,</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banana</span></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>    banana_households,</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>    banana_production,</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Taro</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>    taro_households,</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>    taro_production,</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kumala</span></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a>    kumala_households,</span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>    kumala_production,</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manioc</span></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>    manioc_households,</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a>    manioc_production,</span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Yam</span></span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a>    yam_households,</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a>    yam_production</span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>  staple_crop_ordered,</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_01a_baseline_staple_crops.csv"</span>),</span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(staple_crop_ordered)</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-97"><a href="#cb17-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Island Cabbage</span></span>
<span id="cb17-98"><a href="#cb17-98" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_households</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_production</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banana</span></span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Taro</span></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kumala</span></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manioc</span></span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Yam</span></span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households"</span>)),</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Island Cabbage"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"island cabbage_households"</span>, <span class="st">"island cabbage_production"</span>)),</span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Banana"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"banana_households"</span>, <span class="st">"banana_production"</span>)),</span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Taro"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"taro_households"</span>, <span class="st">"taro_production"</span>)),</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Kumala"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"kumala_households"</span>, <span class="st">"kumala_production"</span>)),</span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Manioc"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"manioc_households"</span>, <span class="st">"manioc_production"</span>)),</span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Yam"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"yam_households"</span>, <span class="st">"yam_production"</span>))</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-f9a584bd37a1bdbaa758" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f9a584bd37a1bdbaa758">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"total_households":[72482.0546920189,2794.95252753011,251.536722793333,95.5562924834146,403.506543031657,352.861855525167,399.483016622889,121.069311546954,736.395575324238,273.387859087372,161.15535111509,15197.264125121,4011.10961674314,313.385436919143,899.778336226117,555.824444268251,506.606466711524,1320.33984160773,1263.23800890242,1761.34327423859,2215.88663450749,776.294122501475,515.73360885726,9200.13931705135,606.924608004948,593.436796206294,476.457889720776,236.189949175808,767.461922591376,620.864206151392,1683.41539017212,1095.50324205733,1539.83327247302,1580.05204049829,10353.2774827892,1188.86767401795,1539.62290420528,1541.65738237234,935.199541294908,1153.86214879327,1202.44366657817,1007.7042284521,385.450635837244,605.948867341972,792.520433895933,24030.8306358174,8958.28660829032,620.505261352837,467.791975723459,610.02408994337,470.290296930793,327.891570980372,237.737908455605,232.625876024746,468.181911066327,197.239389926415,1023.64421567205,872.350722672883,887.60272195239,1904.00050406432,245.525974562536,486.365911492837,3298.47690356345,1825.63717105486,896.651622087837,10905.5906037098,374.158737182642,151.382492979637,140.043923990882,1021.95989506718,3601.9013798503,1581.98340313245,1424.05385466799,1782.97527561199,403.851005201499,87.3229637301334,335.957672295088,1057.72433363789],"island cabbage_households":[55300.8075752383,2540.10889167884,191.071164429551,83.2264482920063,377.212883585985,337.202305723754,367.944883731608,118.529395920095,682.571490873357,259.51162491588,122.838694206607,12604.6208339406,2446.36655088065,256.070106273164,767.026949672711,525.203186008873,449.600991484669,1224.23406549267,1120.02632923288,1637.9105565951,1929.26798501659,761.095592994669,496.31267797979,7822.85407961802,498.602105788845,459.103566705538,324.281225323263,202.987528205408,564.667395577516,542.456097642585,1428.13856301117,1045.51287247192,1422.43463645114,1334.67008844063,9190.20955755478,1023.30388720001,1241.66169502756,1236.40922066262,836.418418678219,1104.91673273435,1158.4808052507,938.165316803471,358.888187732073,576.202286581553,715.763006884227,13618.5401363933,3463.54428223629,543.387016634033,396.799155559466,572.061217393246,449.72366586968,204.814792188315,128.096224647312,142.4608077981,318.739917132208,141.354896113931,500.961161250643,626.653079587201,658.37790390406,897.960576728674,107.899307206854,338.048386007892,2217.7472696314,1282.71892737515,627.191549128798,9524.47407605282,360.34750862892,147.433384467125,66.5782589464847,916.758141163193,3161.55431526494,1419.27189695441,1317.40131065881,1348.67583388952,392.528079822018,74.0166073522083,319.908738905193,991.505842308793],"island cabbage_production":[6199095.7733402,249384.490720518,13314.5456888646,4929.61607615389,24606.4426077482,58394.4774369819,49656.2934037214,20889.1188012505,50657.3505353217,20756.2181900247,6180.4279804511,1553105.99982266,171921.58589621,28409.7284623034,72687.7580118013,109650.796774337,19643.426383626,84666.8400987964,153811.275743816,211413.505556796,210021.46324304,94493.5956981012,63415.6943315883,1103954.64848057,37722.9928011651,40119.2029641258,34004.0003945946,29135.2403913529,49800.3747013543,46344.5033162567,147571.702548836,515279.639999199,106735.057373609,97241.9339900721,1240575.07476426,92403.5531234737,110854.858226078,94843.5806239523,79394.8834684768,190826.130203681,118330.731100699,153917.382693648,32377.4881562848,302810.001182896,64816.4659850681,1361572.66409091,183110.761395275,40273.1326143009,27309.0903132251,49113.5672410562,34381.2027525041,28381.1894072138,16004.7969871287,12457.37702569,34505.7696674393,10410.5415495536,74089.0584725256,90885.7541259715,49945.5719601709,69720.5920938823,3565.87481500957,26245.5973833369,210849.314600587,205506.006231897,194817.465454144,690502.895461284,33687.0273943773,8106.65421815759,3695.8420026275,101532.238488363,206400.402428987,104994.519359619,84514.5655604209,92398.4203541319,26961.6788453511,4601.31331083781,23610.2334984113,332970.329622247],"banana_households":[58044.6888509575,2640.79867665967,191.071164429551,88.3638833717597,395.416186279143,342.422155657559,379.508865791745,117.682757377809,702.438436553662,274.009481056432,149.885746142006,12826.8385037727,2447.47551123917,269.936718526224,738.43437294261,525.203186008873,476.301433507705,1288.47605110763,1188.42488368985,1651.77940127414,1964.41932882208,769.279416575257,501.707381001309,7803.75073659389,482.672326051182,460.683957640841,336.962614023056,222.607140597009,535.523271934805,523.254111885325,1461.07750845129,1018.37524326842,1401.95813016825,1360.63643257371,9747.31710015892,1131.02008585265,1417.43061022072,1420.38033495905,902.988305659027,1112.20647555163,1166.79810333968,963.784915831914,358.297911107513,573.998836154855,700.411521481885,14817.8814067035,3899.66639337999,583.725790794639,444.972854956461,572.061217393246,449.72366586968,242.395488002685,155.235255292929,163.198773490229,349.046335482484,170.940804602893,544.404947592162,702.347808012586,709.692652296582,1127.20686803335,135.424640677991,323.601873785332,2331.73047321017,1249.30857391793,663.196989912118,10208.1024270688,352.814111235981,146.117014962954,133.156517892969,999.9946937026,3388.60827044175,1516.66126561572,1334.36876084209,1538.82856242746,391.269977002076,83.1647273620318,323.118525583172,1005.40081907789],"banana_production":[10433175.6904421,481755.422865787,19710.2058695074,22632.3264386984,76937.8968450013,87203.4404579615,93371.5802233176,18953.104399186,108602.654630454,46399.4957220617,7944.71827959911,1846560.41824789,229170.612323545,32094.3408333654,54583.5180836957,148936.516106349,27652.4816147369,128750.925743931,130755.036134105,262302.585203145,297686.414080593,168222.744042605,106561.808862481,1298897.72634747,57575.9268330603,70542.065747263,50382.949412658,81530.6005124935,67477.2748905941,50893.2035035071,222707.520182976,292374.032631275,285571.194021584,119842.958612063,2882954.68113027,306774.346114412,466249.418139062,344724.358553769,149373.792887416,446578.039687071,213130.987188536,222724.916352591,82595.0274009087,591105.705948147,59698.0888583598,2294276.48214246,188183.340884103,190471.374797764,105423.415337569,102040.365166557,62565.4388197772,44355.2686775455,24306.5950610916,27745.309462209,69634.6164606955,40549.1312457055,180332.237076718,169343.868074544,114440.423665403,126601.913620645,6927.02821579625,29411.3719457387,385689.00507903,186515.153918679,239740.624632888,1628730.95970818,82217.6789968309,16182.4729314915,17700.1844929758,200602.700614556,492966.211170453,377633.847415261,149042.462569179,183494.420072675,48577.7268279587,18801.1398225479,41512.1147942493,259843.435219336],"taro_households":[84930.5917444382,3741.26845372117,256.373967462435,118.16100683433,644.194656418961,532.424693248033,538.250801344524,56.7247823331884,1180.66420042959,408.839543163565,5.63480248654159,20094.1676533974,3323.55419446478,486.255869673951,1389.84786018491,973.457998253655,783.787169063312,2329.68106324446,1921.26653858595,2608.72968412818,2551.17637542137,1247.44853721246,702.390333401833,12856.7517590639,641.173634440927,799.677813263346,522.654377127159,335.042611610414,943.541002932752,974.500777180927,2316.31369898599,1589.69375281592,2398.48143593537,2335.6726547711,13569.4216550932,1299.57598929982,986.937759105937,1499.51874725417,1541.84447910388,1907.82983446685,2143.48653607412,1845.83111095403,614.477966166263,1017.99409713452,711.925135533642,17658.1413574325,3624.61745935416,998.977877742044,773.314648214933,1048.56072112584,851.458525930095,415.266688748785,242.080153358904,243.445684211944,351.136433299744,199.430938703375,495.530687957953,805.342274558601,722.279288694748,1079.64539680831,38.5354668595909,301.450555044074,2883.35289052965,1681.25671504333,902.458951246437,17010.84086573,621.505284917475,288.284921413396,84.944675207584,1747.96760332755,4274.46271677551,2992.94157349382,2532.99792021796,3011.92531745909,764.926514524958,83.1647273620318,607.719611030601,1776.5720297625],"taro_production":[19897637.1348358,482997.95957327,14695.8605536734,6896.01942666386,44972.9884747657,101751.89656851,73926.2086729677,1907.67620057049,174860.477090016,63477.3892522792,509.443333823523,3711908.29504071,384271.274535982,103265.274776121,145673.001691615,354473.329602855,228034.459535272,250158.812196523,331243.474236125,559599.622856044,671104.575370479,159948.550945236,97622.984797233,2932094.85424207,70850.7124835376,146343.713964293,66636.8070742721,63239.7337028036,101908.179687693,160089.605745137,601125.385089943,405202.319102667,875839.330300084,440859.06709164,3937792.80513414,353011.865293876,75531.2983943593,239592.876232246,342274.467433408,802562.433336467,436159.310083259,936904.141884996,117517.732921947,549565.911532281,84672.7680213014,3870104.46394505,392866.749920215,335813.45820487,280670.646212747,220838.471146089,185084.053003531,110900.176638361,87433.979210905,76313.2404849716,48010.004896127,43547.169972587,79254.7314007895,202059.903555464,85088.2808381542,132305.351992973,1499.67741437094,27487.1275140422,542782.210114464,488294.511692833,529854.719731558,4962738.75690054,181004.812760862,34531.4484318979,5752.1070384031,865746.37970929,610599.794785864,1342476.62712286,987614.784248358,624238.799999987,169576.728800899,9706.16656889938,131491.107433222,426512.934497222],"kumala_households":[24073.2280095718,1617.60990385719,31.4420903491666,54.4568118453868,167.874902614674,185.826657643431,217.613116949837,105.829817785799,556.274479048557,226.16655579261,72.1254718277324,4378.14199645264,611.037157540906,112.781779658217,290.898389341028,256.494579213636,107.663072673532,349.08852560583,366.420827448051,737.822536925142,639.484062307531,294.617648901162,179.104140314446,1934.138187241,121.066326006237,89.2920878446226,111.415057862462,94.3250595750039,253.796743388604,187.219361133282,208.221190817938,171.39555286425,296.226790892416,401.18001685618,3946.83381274415,311.180129440939,183.288440976817,386.442117181334,138.508313234262,638.373192428044,626.173727556022,403.813679924511,225.485670581664,425.265932352733,608.302609067828,5945.56739445876,1140.69951748386,169.660138381369,209.175273697482,263.121978709479,323.581662028184,185.084926885771,106.385000130819,124.427794152771,87.784108324936,43.8309755392034,149.338015548972,210.952521841236,306.920287555275,517.468806928388,13.2121600661454,98.2362831134044,1017.40563194384,754.119406605668,224.162905521959,6250.93671481802,249.857680199147,109.258668846173,18.3664162610992,537.569401817005,2040.0453851492,1019.02534526099,643.551146237195,1240.68786459636,95.6158143156198,9.14812000982349,287.810872125408,432.729276523157],"kumala_production":[4263499.3987993,180882.01009363,1422.62572727377,4460.30162699484,13213.1573541931,34361.4877844506,33779.0684434325,22689.8826961844,41637.4957892834,22889.8164053238,6428.1742664937,542748.415664938,48731.4762176333,8294.05066793253,16326.390223481,70909.1838677602,5328.39025499118,21746.9185025514,32841.6530712513,121837.054301259,60198.7780864452,21367.3187152548,19309.6545359568,238151.44097956,8345.94347497273,13681.2660511118,12065.4355343739,57405.4246614314,14319.4899890505,19605.8998681243,21519.2205939935,31944.7388502457,31434.4926585304,27829.5292977258,833934.373085658,26023.6536286514,24363.9684946146,32823.3705278321,10924.1003812402,178292.009129265,86359.1650514794,264161.626653179,28548.1093194163,81647.5528456749,100790.817054305,1307082.31949697,119558.45922824,29170.5487251206,29892.6637856171,25028.3224585196,35820.5940807285,41332.0234885713,25114.6832489634,106950.018519355,11137.1990249587,4889.89320859238,50717.5398723531,77496.7706206904,73491.7552599243,73160.8186275616,642.080799153603,6911.5214107531,159249.758593362,322618.871963719,113898.796580791,1160700.83947854,42942.0715301019,7785.96496799082,543.506176856985,66223.1122810409,284069.666099122,338139.193132812,98899.5167009842,247044.035958558,10057.7397287778,1308.04629968471,63687.9866026154,115857.547220421],"manioc_households":[46255.8151504332,2390.73536068272,112.465938556634,82.1989612760556,348.896634952185,331.98245578995,359.5347149606,115.14284175095,648.513869707119,242.114197547218,149.885746142006,9510.50571226028,2011.65409034338,158.079379684878,274.737367710971,400.620104676536,227.384409486499,859.388071717131,914.830665861967,1206.58948707683,1539.89925363272,674.580886571312,373.313449089146,6365.06189246057,350.455154228581,326.350728140081,279.89636487399,179.594913430807,365.515884018994,454.446996255145,1177.5672994845,811.27228355745,1112.55684137013,1307.40542710089,7268.05998480509,777.950323602349,883.544279580554,1010.29947124801,609.866061372565,856.024085115583,1056.29685730039,658.789689302828,243.193969318444,502.386697287166,669.708550677199,12141.3706402402,2902.14303333424,257.456293907391,289.042196381975,502.680795146468,426.414817333751,248.972109770199,160.663061422053,150.575663938498,315.604770406318,156.695737552652,481.954504726229,573.294500533241,627.395414308575,1031.13269615877,81.4749870745636,310.11846237761,1986.96646238549,1176.52173245758,462.263401024559,8580.08155998434,328.958352825007,138.21879793793,126.269111795057,831.209462164358,3120.27177796007,1010.71161866795,982.900149902759,1326.37397066593,349.752583943978,39.0874218601549,326.32831226115,869.428546408912],"manioc_production":[6863664.28487471,350870.144478335,7427.74778759287,11186.1340871724,43918.1977678604,91811.7078913346,72202.5373828628,12066.9214361542,62866.6971795502,30826.0666188485,18564.1343269591,886185.610337175,161329.541783714,13414.2346181216,16614.1951793436,69430.8969232661,8253.17547408103,50258.8281141146,72937.9799711787,130444.050354727,135614.972319998,63030.3450890367,35982.7143447644,1169522.77579797,36726.1815241538,52005.4118446164,35953.6079884741,50841.7643953777,24416.9939114458,68761.1023611181,341765.34361338,212557.712449391,180965.798755838,165528.858954171,1069616.9301574,108883.993642015,88664.2324203418,84383.6613647093,46985.179314154,123231.219706181,178326.880903969,252839.100474812,22954.3686492311,91936.765603552,71411.5280784372,1989224.51952703,272809.344872557,24538.5673413368,43188.1691441509,58873.6219691007,60525.3817036075,82253.8780401881,48979.445919564,41295.7990783331,49568.1638795759,30347.4716889559,89821.1369532986,238910.913401353,87466.8722884589,142323.644904432,4449.27873577743,32188.7923339063,312157.799893812,237503.438204876,132022.799173748,1398244.3045768,77921.6200942944,11170.6755474752,9915.96824887967,148930.216737492,431816.852015546,154539.624460569,131849.506459997,223430.725487754,45511.8503037386,7431.55508316447,155725.710137889,128874.676164829],"yam_households":[40618.0784974468,2251.41602181368,240.652922287852,86.3089093398583,286.196370120198,251.596766809365,237.587267780981,109.216371954945,641.418531964152,240.664411933162,157.774469623165,9908.30378076264,1517.05777044639,247.750138921329,604.173577862135,455.583228793743,262.697897323418,1004.84162405289,1023.53551133822,1392.43200577602,1406.05375221952,747.066181142232,465.023400454977,5268.92040812334,242.132652012474,162.780266336215,206.525473110905,135.073485311406,284.155205516427,300.831110197068,1119.92414496428,601.312731298744,1060.68302545349,1155.50231392233,7837.63332002738,1058.21191454114,1099.7306458609,1172.68738219123,692.541566171311,1045.55739836502,898.268193609777,731.988543669808,139.305283396002,375.688297752026,623.654094470171,8488.43195739405,1431.76157438106,574.234314521555,372.712305860968,446.391018606629,379.797120261894,200.117205211519,140.037398131384,131.640999610903,292.613694416453,146.833768056331,416.78882521395,544.753865225309,457.959924333265,507.956512683381,26.4243201322909,217.660784153229,1204.5632378201,684.91224587287,311.272842900959,6863.3730093257,347.791846307355,146.117014962954,114.79010163187,886.700497190629,3201.11674684878,543.955254230225,826.557216071124,277.012616882442,251.620563988473,14.1380036515454,253.573147560304,782.088692431761],"yam_production":[13932189.4959076,854522.856664811,91459.7872608184,28336.6742279615,59962.4767120675,80980.0919541875,53437.1755008637,172589.951898743,0,76879.7089105526,290876.990199617,1748966.65657712,114307.427600981,85268.3850391484,82118.6031336808,83672.3235228517,15801.4180655639,147544.346679894,189041.219046145,245849.044832208,202855.154111256,189770.347255966,139934.873750685,2749300.09917315,30972.3503928364,14477.3850938116,20636.8663433307,20453.381923857,36070.8191085247,48527.6822793684,849742.95869945,353198.029453976,952163.233619637,423057.392258357,2482686.47568405,424721.035169588,255071.05603062,261999.650311911,146359.849758973,341161.874870611,306956.106474039,374956.975906081,14902.0388725075,242120.240357955,114437.647931763,2436236.41244111,148203.174340187,402698.340913586,133267.755499028,72505.0904788883,57075.8927069401,88197.3259778761,109597.687178115,93505.1247527539,102002.630864377,43150.2257003601,238084.515506826,238104.699847581,243826.835827406,74174.5086455518,4168.87243508426,41065.5560127288,145545.848887471,110261.1149972,90801.2118691521,3660476.99536732,160924.440890555,33931.3895080282,18298.0412875185,1158327.79040272,1767142.95987771,196315.174556684,172276.393059441,76691.0316362042,28568.6050778801,902.899215711571,47098.2698548715,252803.513538745]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_households","name":"Total","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"island cabbage_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"island cabbage_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"banana_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"banana_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"taro_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"taro_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"kumala_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"kumala_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"manioc_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"manioc_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"yam_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"yam_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Total Households","columns":["total_households"]},{"name":"Island Cabbage","columns":["island cabbage_households","island cabbage_production"]},{"name":"Banana","columns":["banana_households","banana_production"]},{"name":"Taro","columns":["taro_households","taro_production"]},{"name":"Kumala","columns":["kumala_households","kumala_production"]},{"name":"Manioc","columns":["manioc_households","manioc_production"]},{"name":"Yam","columns":["yam_households","yam_production"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"1599698d947ca68df5f439acdaab86b3"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-2-cash-crops" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="table-2-cash-crops"><span class="header-section-number">5.1.2</span> Table 2: Cash Crops</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get cash crop data</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>cash_crop_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Food Security"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Cash Crop Households"</span>, <span class="st">"Cash Crop Production"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Indicator, Attribute, Value)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape cash crop data</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>cash_crop_wide <span class="ot">&lt;-</span> cash_crop_data <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">crop =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Households"</span>, Indicator) <span class="sc">~</span> <span class="st">"households"</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Production"</span>, Indicator) <span class="sc">~</span> <span class="st">"production"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"other"</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, crop, metric) <span class="sc">%&gt;%</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="fu">c</span>(crop, metric),</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with total households</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>cash_crop_full <span class="ot">&lt;-</span> total_households <span class="sc">%&gt;%</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cash_crop_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>cash_crop_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(cash_crop_full)</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to client's specification</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>cash_crop_ordered <span class="ot">&lt;-</span> cash_crop_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    total_households,</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kava</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    kava_households,</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>    kava_production,</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coconut</span></span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    coconut_households,</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    coconut_production,</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cocoa</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>    cocoa_households,</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>    cocoa_production,</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coffee</span></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>    coffee_households,</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>    coffee_production,</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vanilla</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>    vanilla_households,</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>    vanilla_production,</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tahitian Lime</span></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_households</span><span class="st">`</span>,</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_production</span><span class="st">`</span>,</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pepper</span></span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a>    pepper_households,</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a>    pepper_production,</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Noni</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>    noni_households,</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    noni_production</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>  cash_crop_ordered,</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_01b_baseline_cash_crops.csv"</span>),</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(cash_crop_ordered)</span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kava</span></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coconut</span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cocoa</span></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coffee</span></span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vanilla</span></span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tahitian Lime</span></span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_households</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_production</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pepper</span></span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Noni</span></span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households"</span>)),</span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Kava"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"kava_households"</span>, <span class="st">"kava_production"</span>)),</span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Coconut"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"coconut_households"</span>, <span class="st">"coconut_production"</span>)),</span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Cocoa"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"cocoa_households"</span>, <span class="st">"cocoa_production"</span>)),</span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Coffee"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"coffee_households"</span>, <span class="st">"coffee_production"</span>)),</span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Vanilla"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"vanilla_households"</span>, <span class="st">"vanilla_production"</span>)),</span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Tahitian Lime"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"tahitian lime_households"</span>, <span class="st">"tahitian lime_production"</span>)),</span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Pepper"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"pepper_households"</span>, <span class="st">"pepper_production"</span>)),</span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Noni"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"noni_households"</span>, <span class="st">"noni_production"</span>))</span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-c3a7899bd2b4b968c61d" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c3a7899bd2b4b968c61d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"total_households":[72482.0546920189,2794.95252753011,251.536722793333,95.5562924834146,403.506543031657,352.861855525167,399.483016622889,121.069311546954,736.395575324238,273.387859087372,161.15535111509,15197.264125121,4011.10961674314,313.385436919143,899.778336226117,555.824444268251,506.606466711524,1320.33984160773,1263.23800890242,1761.34327423859,2215.88663450749,776.294122501475,515.73360885726,9200.13931705135,606.924608004948,593.436796206294,476.457889720776,236.189949175808,767.461922591376,620.864206151392,1683.41539017212,1095.50324205733,1539.83327247302,1580.05204049829,10353.2774827892,1188.86767401795,1539.62290420528,1541.65738237234,935.199541294908,1153.86214879327,1202.44366657817,1007.7042284521,385.450635837244,605.948867341972,792.520433895933,24030.8306358174,8958.28660829032,620.505261352837,467.791975723459,610.02408994337,470.290296930793,327.891570980372,237.737908455605,232.625876024746,468.181911066327,197.239389926415,1023.64421567205,872.350722672883,887.60272195239,1904.00050406432,245.525974562536,486.365911492837,3298.47690356345,1825.63717105486,896.651622087837,10905.5906037098,374.158737182642,151.382492979637,140.043923990882,1021.95989506718,3601.9013798503,1581.98340313245,1424.05385466799,1782.97527561199,403.851005201499,87.3229637301334,335.957672295088,1057.72433363789],"kava_households":[35688.0034554228,2238.32733292214,239.443611120576,82.1989612760556,187.089499901896,282.91586641219,300.663533563543,111.756287581804,603.103708152134,301.555407723481,129.600457190457,8211.81323078178,646.523889013337,216.319151147727,610.389355412157,599.708754256643,435.820118182457,1071.50783554012,930.708901718049,1499.22210980466,790.905235623479,154.323530376799,85.2363077400074,7614.76993481271,216.645004432214,434.60750720834,261.780095302858,173.558109618007,653.31410499076,542.456097642585,1405.78713574823,1005.5205768036,1483.8641552998,1437.23714776632,5119.3051560152,525.615154536459,62.0360877152303,167.526768884461,798.838643769698,743.553767363171,817.471583602548,785.667703538928,164.687178252053,553.066057101223,500.84221125143,4612.68455705313,370.18572284984,391.523396264697,541.470715868872,459.481664313568,267.366203794474,237.697901025888,122.668418518189,100.083225731577,52.2524454315095,65.7464633088051,69.2385344817962,174.966503409496,274.969595159931,136.025807703602,0,3.85240325934919,606.503219042596,478.48399058366,260.168346305279,7891.10324383781,227.257488020329,117.156885871198,0,957.220354203183,2215.49616869491,1497.65846197448,1205.90092374013,1044.66622468379,317.041910625476,46.5722473227378,262.13257870158,1171.14804196634],"kava_production":[181728775.461829,1727639.55816235,12714.7174375092,100364.346440649,6917.58737373589,179994.083480261,259868.167663719,74220.32591281,540252.909096499,552501.644001594,805.776755575442,79023874.246081,0,5668705.26534757,7623520.3368718,20934446.1778206,5120362.28927652,23175267.3381419,3556802.43552301,2273983.79528826,2948963.81637738,17689.5149539386,8905.41192971731,57470701.2819984,162216.929513554,603527.524872494,807245.528712299,292712.791253304,1110020.17871195,5106544.30176399,5691031.43549586,5317376.30157436,32757862.6264541,5622163.66364653,22999017.0507592,5255422.05154138,300229.286142195,95721.2251064416,2902196.2791907,2329581.98958085,3190019.73412193,5848704.92230318,0,2895535.40939853,181606.153374038,10763617.5988864,138506.068070926,1960831.39662962,2571342.02514869,1650660.86408762,2593093.5791366,455182.476756202,75479.7000422166,48901.6334620423,4209.8230903418,4205.03421579232,19577.3770230149,88631.1966946462,34664.9524237584,6240.11870057541,0,0,253383.451798614,150070.721353977,708637.180251716,9743925.72594177,130869.31156838,27587.4983156267,0,7827969.84562588,275539.949386155,416680.272707471,510395.636745981,43715.960807332,122696.717610836,0,388470.533174107,7695227.86455034],"coconut_households":[31971.7168423883,1041.41177604689,84.6517817092947,29.7971234625701,220.462221506018,130.496248345106,129.306344854251,4.23319271143197,299.423252753177,136.279847721188,6.76176298384991,7240.76806223632,1117.83204138155,257.918987906905,436.347584011542,260.158787488116,231.690932393441,769.691714443411,378.634855029653,1336.95662705984,1041.02056654714,627.816180396524,391.655439362313,2773.11750382611,246.11509694689,184.905739430457,78.8057726344243,110.171669583605,91.0753863834703,222.423001688258,430.559072538787,441.343548625444,487.340849532684,480.377366462093,4568.10338403735,614.381281203906,1036.75461742271,826.328356951577,362.913254830857,814.368411873949,462.204136658999,47.5792553385375,194.791286104579,93.6466431346692,115.13614051757,8903.72089480919,2462.25312857374,183.897352790994,265.690599712055,146.61523191772,117.91535141705,142.806644094605,94.4438266467473,101.88652709611,212.144928451929,120.535182732809,343.477435762636,328.837754634868,396.963147942154,510.810200956883,115.606400578773,281.225437932491,1635.1664513399,993.958015352091,449.487276875639,7444.59522143239,313.891558039129,146.117014962954,5.73950508159351,578.031614856994,2318.7025119571,1300.50437419672,962.29681753735,1349.84961616444,216.393685030087,46.5722473227378,206.496276283285,391.044346215881],"coconut_production":[776592745.742163,19628868.2176406,461327.429349111,1690983.50495966,2390525.93644156,1356144.46009092,1261014.98987628,1932.15010186073,9465083.11188464,2985921.49760617,15935.1373304099,468613740.48744,0,11248726.6973441,87763426.892069,27964766.0027996,13461552.8185066,34499123.9020792,23105109.5376473,130796824.177115,92869399.9877076,13204036.6411176,30289515.4851568,25747934.689636,1693370.10063631,809111.012571688,3267878.04260644,6129671.6668612,2658112.86926462,2291598.68588466,641929.292295401,3343384.93014003,4159996.07130523,752882.01807047,179113210.604877,30031039.5725298,14575537.4236904,23857255.8679766,17783996.6090158,76886614.1511261,12494571.1914048,1183530.07800169,0,2208236.97610473,92428.7350266046,53124493.3518935,3209733.44224101,20057462.8402901,5193538.72139357,308178.603270058,2260336.95268766,402415.743634946,831584.756883598,225613.354420999,913240.784773464,342087.066903626,672582.919165889,5041440.92282503,933497.144009869,725851.645108512,128105.975869777,463971.050016792,3970730.33156697,4914422.29873869,2529698.79809291,30364498.390676,2665284.81913152,884465.063360537,1509.73938015829,4063936.3772015,5683384.87165266,4555546.61479114,7207244.51395774,4301415.52016881,796912.098050281,86238.4507314257,118560.322250186,3411258.34589769],"cocoa_households":[6246.63884283028,58.8508105415167,3.62793350182691,4.10994806380278,0,28.1871896425429,5.25635548188012,3.38655416914557,9.9334728401528,4.34935684216558,0,1981.86457405617,128.639401587559,258.843428723776,134.260795080475,107.483442718095,87.853067301602,84.8479055291949,157.560955802662,262.121164433932,98.6941576077161,457.125002858549,185.577783940269,210.341579640779,88.4102775440284,20.5450821589397,0.905813478556601,16.6012104852007,24.2867697022587,9.60099287862982,3.52917272572776,7.14148136934375,34.1275104714765,5.19326882661722,3181.54393456944,515.641432438993,790.490148007708,663.940446008356,300.638199268166,776.878305956478,98.6193916264702,9.75984724893078,3.54165974735598,22.034504266981,0,782.188161889237,116.80160212056,84.2368519236165,240.466808600151,5.23625828277571,4.11332621222268,4.69758697679622,2.17112245164936,1.80330136453292,3.13514672589057,0,29.8676031097944,14.8907662476167,30.9824895954852,25.6831944615193,1.10101333884545,4.81550407418649,156.199204904242,52.5019840041921,3.48439749515999,31.8497821331402,5.02226492862606,2.63273900834152,0,1.15606322971399,10.3206343262185,3.56302568273073,2.42392145475403,3.5213468247768,0,0,3.20978667797853,18.8574684723394],"cocoa_production":[4074231.76299718,1208.56389103735,0,14.5148798708983,0,5.36681658242589,10.8086999132253,0,11.4174120481103,1166.45608262269,0,1194503.6823273,0,653448.906451999,125985.861639459,55354.0482788793,105034.752568596,34529.121228677,60422.3029060489,24970.3171756402,7284.39760645179,63405.3368450916,63949.210689253,39915.6533878678,17527.4888560111,905.107234402227,320.747067816761,2366.072459058,7387.9990945171,5371.70444648232,5.47098828660853,1138.17359323916,4820.069248671,72.820399383495,2370661.45662549,588690.787697825,252923.87894161,438870.221810077,109354.171025654,896363.504000716,81802.469890259,0,0,2656.42325934869,0,467539.8240624,119.473768312351,58922.6148282391,402674.46419959,118.923693378072,9.38223570814664,936.385670708041,20.3475442989287,29.3321804230985,154.471424832474,0,346.29330211564,301.48151697957,169.23047639945,46.7035911061777,0,301.99299113519,3057.26675282718,170.271658220396,161.188228126101,402.582703088515,222.20994323468,123.342019294903,0,0,57.0307405589323,0,0,0,0,0,0,119.426937202505],"coffee_households":[850.279816068263,0,0,0,0,0,0,0,0,0,0,20.1187307017991,3.32688107554032,0,0,0,0,0,3.66420827448051,0,0,2.33823530873938,10.7894060430389,7.7696901359244,0,0,0,0.754600476600031,0,0,0,4.28488882160625,2.73020083771812,0,3.06943752455532,0,0.939940722958036,1.02777158824823,0,0,0,0,0,1.10172521334905,0,91.3866288322029,10.3614324461787,2.37286906827089,20.1790328895232,0,0,0,3.25668367747404,0.901650682266458,5.22524454315095,0,1.35761832317247,2.48179437460278,1.93640559971782,0.951229424500714,0,3.85240325934919,26.7368008394648,5.96613454593092,5.80732915859998,727.935328873782,12.5556623215652,3.94910851251228,0,53.1789085668435,151.369303451205,263.663900522074,126.04391564721,65.7318073958337,33.9687761384439,2.49494182086095,14.9790044972331,0],"coffee_production":[18412.9991174294,0,0,0,0,0,0,0,0,0,0,154.893253004271,0,0,0,0,0,0,4.3508749470559,0,0,39.6625895828221,110.879788474393,21.434514943404,0,0,0,1.25189018997778,0,0,0,19.1592554861925,1.02336926723376,0,1.33279344342024,0,0,1.33279344342024,0,0,0,0,0,0,0,2686.29422686944,9.89191415059253,6.84138091762848,1326.64359381421,0,0,0,67.0500031183747,5.86643608461969,91.0618584660571,0,0.655858526734167,742.780549080101,7.27873016771829,1.2973219751716,0,13.269389004425,48.9006198468839,6.02321512072151,358.733356596201,15549.0443291689,104.932473194154,21.5848533766081,0,2393.92537996331,2410.77087591258,5821.09026937115,3852.1216447684,399.049931580835,420.190015335604,3.47268929119835,121.906196375038,0],"vanilla_households":[868.780921673508,5.21984993380425,0,0,0,5.21984993380425,0,0,0,0,0,197.865536048061,3.32688107554032,1.84888163374126,3.72946653001318,21.9852496468831,6.02913206971779,9.69690348905084,13.4354303397619,11.0950757432352,2.70394952349907,85.3455887689874,36.6839805463323,29.7477206508261,1.59297797376628,3.95097733825764,0.905813478556601,0.754600476600031,2.42867697022587,14.4014893179447,0,5.713185095475,0,0,77.024542282218,16.9553275656922,2.81982216887411,13.361030647227,13.9582021088791,13.5380938035311,3.56455632384832,1.21998090611635,0.59027662455933,11.0172521334905,0,192.476523389506,34.8520909553284,0,8.40793037063465,6.54532285346963,9.59776116185292,6.5766217675147,1.08556122582468,1.80330136453292,9.40544017767171,5.47887194240042,8.14570993903485,7.44538312380833,7.7456223988713,3.80491769800286,1.10101333884545,1.9262016296746,54.880801723112,16.7051767286066,6.96879499031998,366.446749369092,2.51113246431303,2.63273900834152,0,5.78031614856994,94.6058146570032,11.8767522757691,2.42392145475403,0,22.6458507589626,2.49494182086095,221.475280780518,1.98499668129889],"vanilla_production":[3707.83825665019,19.8572213549758,0,0,0,19.8572213549758,0,0,0,0,0,1000.0971841303,0,0.774696684551089,3.10310004038076,134.878998449968,125.304617099378,26.6951614131347,22.927219286225,13.4119767956314,1.0073497122146,352.723014849999,291.170593986461,30.3060001033239,0.564232798308013,9.35421830769765,0,0,4.68897775348608,10.3491553556081,0,5.34941588822405,0,0,363.398586735162,42.8121520679774,10.929630726556,29.108208804298,194.693797492293,60.5747603572765,1.45362007801438,1.02204522849135,0,22.8043719802549,0,384.191571991149,22.8156357551329,0,8.32915418204078,2.68537372144034,6.37992028153972,9.30383198459913,0,0.527979247615772,181.475318358743,14.7929542444811,5.1156965085265,23.6815916236126,2.62034286037858,5.44875229572073,2.23332451879514,1.92177357995121,66.5439634876396,26.3399830471552,3.97597629377716,1909.98769233528,2.96279924312906,0,0,38.5586095378101,613.650768414112,15.2486915976273,2.62982480942931,0,57.2481921113878,6.9453785823967,1172.74342803939,28.100455812354],"tahitian lime_households":[1337.01818754601,7.63847226835553,2.41862233455128,0,0,5.21984993380425,0,0,0,0,0,293.847752928046,69.8645025863468,41.5998367591783,2.48631102000879,15.8782358560822,0,2.42422587226271,0,19.4163825506616,10.8157980939963,1.16911765436969,26.9735151075973,5.75866259135851,0,0,0,0,0,1.60016547977164,0,1.42829627386875,2.73020083771812,0,4.72656541571511,0.997372209746601,0,0,0,0,0,1.21998090611635,0.59027662455933,0,1.91893567529283,968.037367703305,285.410366472014,0,0,0,0,0.939517395359243,2.17112245164936,1.80330136453292,10.4504890863019,4.38309755392034,57.0199695732439,35.9860184317403,56.1557623918169,19.0245884900143,7.70709337191818,29.8561252599562,289.883209101566,87.1055643705914,80.1411423886798,57.0093666392271,0,0,0,0,5.16031716310927,0,2.42392145475403,1.1737822749256,6.29051409971183,6.65317818896254,35.3076534577638,103.219827427542],"tahitian lime_production":[1035586.40692706,1266.93211878921,766.029237762793,0,0,500.902881026416,0,0,0,0,0,84230.8039257417,0,5603.63935158621,144.811335217769,6544.76152816301,0,919.875463603096,0,4871.33119463972,1028.3361645524,302.877956814278,23671.4202125769,8835.2744468072,0,0,0,0,0,344.971845186938,0,132.786919211235,8357.51568240903,0,575.020941288765,184.30815773422,0,0,0,0,0,238.477219981314,0,0,152.235563573231,927328.690226416,195590.120704898,0,0,0,0,700.288428948322,271.300590652383,136.883508641126,11613.962681849,1534.08414387212,66936.9212384891,67593.0299662893,36430.0444894301,4177.37676005256,7469.22977952597,5316.90690453167,132129.47482628,85135.8291101982,312293.237092758,13349.6852680211,0,0,0,0,2091.12715382752,0,266.793821246452,913.979393395779,755.293864689823,972.353001535538,8350.13803332599,41143.7507185883],"pepper_households":[504.983931069257,0,0,0,0,0,0,0,0,0,0,275.922446752824,3.32688107554032,2.77332245061189,0,12.2140275816017,0,0,0,2.7737689358088,2.70394952349907,79.500000497139,172.630496688623,6.96435553784649,0,0,0,0.754600476600031,2.42867697022587,0,2.35278181715184,1.42829627386875,0,0,190.856977161789,153.595320300977,7.51952578366429,14.3888022354752,0,6.24835098624513,2.37637088256555,1.21998090611635,0,5.50862606674525,0,16.2611471195652,3.76779361679226,0,0,0,0,0,0,0,1.04504890863019,0,1.35761832317247,2.48179437460278,1.93640559971782,0,0,0.963100814837298,0,2.38645381837237,2.32293166343999,14.9790044972331,0,0,0,0,0,0,0,0,0,0,14.9790044972331,0],"pepper_production":[1766.69483819393,0,0,0,0,0,0,0,0,0,0,1028.0327714509,0,15.7091272145082,0,10.6199934734943,0,0,0,15.8160103722069,1.20672100942373,179.45518941246,805.225729968802,2.27063349696303,0,0,0,0,0,0,1.32215550259706,0.948477994365967,0,0,715.184238580498,684.244035588293,9.94692270070341,5.79765147887804,0,0.856206666800246,0,4.59920352821106,0,9.74021861761186,0,12.9152457474609,0.995614735936261,0,0,0,0,0,0,0,0.715145485335527,0,0,3.67749193417109,0,0,0,0,0,0.810817420097126,6.71617617192088,8.29194891811118,0,0,0,0,0,0,0,0,0,0,8.29194891811118,0],"noni_households":[1518.82548771421,26.3741074937637,1.20931116727564,0,0,9.39572988084764,15.7690664456404,0,0,0,0,717.804620683566,76.5182647374275,12.9421714361888,18.6473326500659,63.5129434243288,0,55.7571950620423,107.483442718095,120.658948707683,73.0066371344749,88.8529417320965,76.6047829055763,29.9756665329527,5.57542290818197,0,3.6232539142264,0.754600476600031,3.64301545533881,0,2.35278181715184,9.99807391708125,2.73020083771812,1.29831720665431,69.3196493208448,11.9684665169592,4.69970361479018,14.3888022354752,2.14741570905833,20.8278366208171,5.94092720641387,0,0,5.50862606674525,3.83787135058567,621.129716955086,299.539592534985,1.18643453413544,3.36317214825386,0,0,0,3.25668367747404,1.80330136453292,1.04504890863019,0,14.9338015548972,8.68628031110972,14.5230419978837,14.2684413675107,12.1111467273,53.9336456308887,160.420805036789,26.250992002096,5.80732915859998,54.2217267279921,0,0,0,0,18.9211629314006,0,15.7554894559012,4.6951290997024,6.29051409971183,0,8.55943114127607,23.8199601755866],"noni_production":[4461825.50451146,75892.1180089975,344.713156993257,0,0,5409.7511150853,70137.6537369189,0,0,0,0,3342087.31565779,0,15509.4276247128,16682.265817087,557272.216380627,0,94615.7619706041,441666.774299443,1132185.93929235,63198.6025700632,611692.321582116,382118.965806052,242170.438083037,4231.7459873101,0,6062.11958173679,1261.9053114976,10327.1875887754,0,229.781508037558,213202.677485559,6447.22638357268,407.794236547572,106571.901770892,14099.5740666678,4077.03988286663,22838.7484464492,2910.01405504496,8255.32132302707,763.150540957547,0,0,25403.5799694022,28224.473486477,677314.947997769,197154.841670537,15393.1070646641,10747.6194324888,0,0,0,17091.9372111001,1847.9273666552,120.144441536369,0,6115.22490326937,7523.93003244667,235699.840291054,5721.18991050677,13600.9463194624,72297.1220777643,52495.7934180267,34735.4182769609,6769.90558129625,17788.782992974,0,0,0,0,4448.39776359672,0,3361.60214770529,6786.29699596366,1359.52895644168,0,1832.95712926668,27145.040314734]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_households","name":"Total","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"kava_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"kava_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"coconut_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"coconut_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cocoa_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cocoa_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"coffee_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"coffee_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"vanilla_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"vanilla_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"tahitian lime_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"tahitian lime_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"pepper_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"pepper_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"noni_households","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"noni_production","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Total Households","columns":["total_households"]},{"name":"Kava","columns":["kava_households","kava_production"]},{"name":"Coconut","columns":["coconut_households","coconut_production"]},{"name":"Cocoa","columns":["cocoa_households","cocoa_production"]},{"name":"Coffee","columns":["coffee_households","coffee_production"]},{"name":"Vanilla","columns":["vanilla_households","vanilla_production"]},{"name":"Tahitian Lime","columns":["tahitian lime_households","tahitian lime_production"]},{"name":"Pepper","columns":["pepper_households","pepper_production"]},{"name":"Noni","columns":["noni_households","noni_production"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"48259322bc2ba8f9fcb239bc4c98c8cd"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="estimated-hazard-damage" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="estimated-hazard-damage"><span class="header-section-number">5.2</span> Estimated Hazard Damage</h2>
<section id="table-1-staple-crops-damage" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="table-1-staple-crops-damage"><span class="header-section-number">5.2.1</span> Table 1: Staple Crops Damage</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for food security damage multipliers</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>get_food_security_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, indicator_type, crop_type, area_council) {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Food Security"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator_type,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(crop_type)),</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories from config file</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>staple_crop_with_config <span class="ot">&lt;-</span> staple_crop_full <span class="sc">%&gt;%</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate staple crop damage estimates</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>staple_damage <span class="ot">&lt;-</span> staple_crop_with_config <span class="sc">%&gt;%</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total households affected (same as baseline)</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> total_households,</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Island Cabbage</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_households_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">island cabbage_households</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"island cabbage"</span>, Region),</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_production_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">island cabbage_production</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"island cabbage"</span>, Region),</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banana</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_households_damaged =</span> banana_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"banana"</span>, Region),</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_production_damaged =</span> banana_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"banana"</span>, Region),</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Taro</span></span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_households_damaged =</span> taro_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"taro"</span>, Region),</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_production_damaged =</span> taro_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"taro"</span>, Region),</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kumala</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_households_damaged =</span> kumala_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"kumala"</span>, Region),</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_production_damaged =</span> kumala_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"kumala"</span>, Region),</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manioc</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_households_damaged =</span> manioc_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"manioc"</span>, Region),</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_production_damaged =</span> manioc_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"manioc"</span>, Region),</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Yam</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_households_damaged =</span> yam_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"yam"</span>, Region),</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_production_damaged =</span> yam_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"yam"</span>, Region)</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_households_affected, <span class="fu">contains</span>(<span class="st">"_damaged"</span>))</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>staple_damage_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(staple_damage)</span>
<span id="cb19-62"><a href="#cb19-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-63"><a href="#cb19-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to client's specification</span></span>
<span id="cb19-64"><a href="#cb19-64" aria-hidden="true" tabindex="-1"></a>staple_damage_ordered <span class="ot">&lt;-</span> staple_damage_full <span class="sc">%&gt;%</span></span>
<span id="cb19-65"><a href="#cb19-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb19-66"><a href="#cb19-66" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb19-67"><a href="#cb19-67" aria-hidden="true" tabindex="-1"></a>    total_households_affected,</span>
<span id="cb19-68"><a href="#cb19-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Island Cabbage</span></span>
<span id="cb19-69"><a href="#cb19-69" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_households_damaged</span><span class="st">`</span>,</span>
<span id="cb19-70"><a href="#cb19-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_production_damaged</span><span class="st">`</span>,</span>
<span id="cb19-71"><a href="#cb19-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banana</span></span>
<span id="cb19-72"><a href="#cb19-72" aria-hidden="true" tabindex="-1"></a>    banana_households_damaged,</span>
<span id="cb19-73"><a href="#cb19-73" aria-hidden="true" tabindex="-1"></a>    banana_production_damaged,</span>
<span id="cb19-74"><a href="#cb19-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Taro</span></span>
<span id="cb19-75"><a href="#cb19-75" aria-hidden="true" tabindex="-1"></a>    taro_households_damaged,</span>
<span id="cb19-76"><a href="#cb19-76" aria-hidden="true" tabindex="-1"></a>    taro_production_damaged,</span>
<span id="cb19-77"><a href="#cb19-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kumala</span></span>
<span id="cb19-78"><a href="#cb19-78" aria-hidden="true" tabindex="-1"></a>    kumala_households_damaged,</span>
<span id="cb19-79"><a href="#cb19-79" aria-hidden="true" tabindex="-1"></a>    kumala_production_damaged,</span>
<span id="cb19-80"><a href="#cb19-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manioc</span></span>
<span id="cb19-81"><a href="#cb19-81" aria-hidden="true" tabindex="-1"></a>    manioc_households_damaged,</span>
<span id="cb19-82"><a href="#cb19-82" aria-hidden="true" tabindex="-1"></a>    manioc_production_damaged,</span>
<span id="cb19-83"><a href="#cb19-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Yam</span></span>
<span id="cb19-84"><a href="#cb19-84" aria-hidden="true" tabindex="-1"></a>    yam_households_damaged,</span>
<span id="cb19-85"><a href="#cb19-85" aria-hidden="true" tabindex="-1"></a>    yam_production_damaged</span>
<span id="cb19-86"><a href="#cb19-86" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-87"><a href="#cb19-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-88"><a href="#cb19-88" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb19-89"><a href="#cb19-89" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb19-90"><a href="#cb19-90" aria-hidden="true" tabindex="-1"></a>  staple_damage_ordered,</span>
<span id="cb19-91"><a href="#cb19-91" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_02a_damage_staple_crops.csv"</span>),</span>
<span id="cb19-92"><a href="#cb19-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb19-93"><a href="#cb19-93" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-94"><a href="#cb19-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-95"><a href="#cb19-95" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb19-96"><a href="#cb19-96" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(staple_damage_ordered)</span>
<span id="cb19-97"><a href="#cb19-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-98"><a href="#cb19-98" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb19-99"><a href="#cb19-99" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb19-100"><a href="#cb19-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb19-101"><a href="#cb19-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb19-102"><a href="#cb19-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb19-103"><a href="#cb19-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb19-104"><a href="#cb19-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb19-105"><a href="#cb19-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb19-106"><a href="#cb19-106" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-107"><a href="#cb19-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-108"><a href="#cb19-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-109"><a href="#cb19-109" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Island Cabbage</span></span>
<span id="cb19-110"><a href="#cb19-110" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_households_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-111"><a href="#cb19-111" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_production_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-112"><a href="#cb19-112" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-113"><a href="#cb19-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banana</span></span>
<span id="cb19-114"><a href="#cb19-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-115"><a href="#cb19-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-116"><a href="#cb19-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-117"><a href="#cb19-117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Taro</span></span>
<span id="cb19-118"><a href="#cb19-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-119"><a href="#cb19-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-120"><a href="#cb19-120" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-121"><a href="#cb19-121" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kumala</span></span>
<span id="cb19-122"><a href="#cb19-122" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-123"><a href="#cb19-123" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-124"><a href="#cb19-124" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-125"><a href="#cb19-125" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manioc</span></span>
<span id="cb19-126"><a href="#cb19-126" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-127"><a href="#cb19-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-128"><a href="#cb19-128" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb19-129"><a href="#cb19-129" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Yam</span></span>
<span id="cb19-130"><a href="#cb19-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb19-131"><a href="#cb19-131" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb19-132"><a href="#cb19-132" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb19-133"><a href="#cb19-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb19-134"><a href="#cb19-134" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households_affected"</span>)),</span>
<span id="cb19-135"><a href="#cb19-135" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Island Cabbage"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"island cabbage_households_damaged"</span>, <span class="st">"island cabbage_production_damaged"</span>)),</span>
<span id="cb19-136"><a href="#cb19-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Banana"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"banana_households_damaged"</span>, <span class="st">"banana_production_damaged"</span>)),</span>
<span id="cb19-137"><a href="#cb19-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Taro"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"taro_households_damaged"</span>, <span class="st">"taro_production_damaged"</span>)),</span>
<span id="cb19-138"><a href="#cb19-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Kumala"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"kumala_households_damaged"</span>, <span class="st">"kumala_production_damaged"</span>)),</span>
<span id="cb19-139"><a href="#cb19-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Manioc"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"manioc_households_damaged"</span>, <span class="st">"manioc_production_damaged"</span>)),</span>
<span id="cb19-140"><a href="#cb19-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Yam"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"yam_households_damaged"</span>, <span class="st">"yam_production_damaged"</span>))</span>
<span id="cb19-141"><a href="#cb19-141" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb19-142"><a href="#cb19-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-143"><a href="#cb19-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-144"><a href="#cb19-144" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-145"><a href="#cb19-145" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb19-146"><a href="#cb19-146" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb19-147"><a href="#cb19-147" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb19-148"><a href="#cb19-148" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-149"><a href="#cb19-149" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb19-150"><a href="#cb19-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb19-151"><a href="#cb19-151" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb19-152"><a href="#cb19-152" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb19-153"><a href="#cb19-153" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-154"><a href="#cb19-154" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb19-155"><a href="#cb19-155" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb19-156"><a href="#cb19-156" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-9c2844bee9073065b4be" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9c2844bee9073065b4be">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"total_households_affected":[45289.6987223164,10353.2774827892,1188.86767401795,1539.62290420528,1541.65738237234,935.199541294908,1153.86214879327,1202.44366657817,1007.7042284521,385.450635837244,605.948867341972,792.520433895933,24030.8306358174,8958.28660829032,620.505261352837,467.791975723459,610.02408994337,470.290296930793,327.891570980372,237.737908455605,232.625876024746,468.181911066327,197.239389926415,1023.64421567205,872.350722672883,887.60272195239,1904.00050406432,245.525974562536,486.365911492837,3298.47690356345,1825.63717105486,896.651622087837,10905.5906037098,374.158737182642,151.382492979637,140.043923990882,1021.95989506718,3601.9013798503,1581.98340313245,1424.05385466799,1782.97527561199,403.851005201499,87.3229637301334,335.957672295088],"island cabbage_households_damaged":[15214.2360892572,919.020955755478,102.330388720001,124.166169502756,123.640922066262,83.6418418678219,110.491673273435,115.84808052507,93.8165316803471,35.8888187732073,57.6202286581553,71.5763006884227,9532.97809547528,2424.4809975654,380.370911643823,277.759408891626,400.442852175272,314.806566108776,143.370354531821,89.6673572531184,99.72256545867,223.117941992546,98.9484272797517,350.67281287545,438.657155711041,460.864532732842,628.572403710072,75.5295150447978,236.633870205524,1552.42308874198,897.903249162605,439.034084390159,4762.23703802641,180.17375431446,73.7166922335625,33.2891294732423,458.379070581597,1580.77715763247,709.635948477205,658.700655329405,674.33791694476,196.264039911009,37.0083036761041,159.954369452596],"island cabbage_production_damaged":[1422409.82007071,124057.507476426,9240.35531234737,11085.4858226078,9484.35806239523,7939.48834684768,19082.6130203681,11833.0731100699,15391.7382693648,3237.74881562848,30281.0001182896,6481.64659850681,953100.864863638,128177.532976692,28191.1928300106,19116.3632192576,34379.4970687393,24066.8419267529,19866.8325850497,11203.3578909901,8720.163917983,24154.0387672075,7287.37908468752,51862.3409307679,63620.02788818,34961.9003721196,48804.4144657176,2496.1123705067,18371.9181683358,147594.520220411,143854.204362328,136372.225817901,345251.447730642,16843.5136971886,4053.32710907879,1847.92100131375,50766.1192441815,103200.201214493,52497.2596798095,42257.2827802105,46199.210177066,13480.8394226755,2300.6566554189,11805.1167492057],"banana_households_damaged":[16451.2999082427,974.731710015892,113.102008585265,141.743061022072,142.038033495905,90.2988305659027,111.220647555163,116.679810333968,96.3784915831914,35.8297911107513,57.3998836154855,70.0411521481885,10372.5169846924,2729.76647536599,408.608053556247,311.480998469523,400.442852175272,314.806566108776,169.676841601879,108.66467870505,114.23914144316,244.332434837739,119.658563222025,381.083463314513,491.64346560881,496.784856607607,789.044807623345,94.7972484745937,226.521311649732,1632.21133124712,874.516001742551,464.237892938483,5104.0512135344,176.40705561799,73.058507481477,66.5782589464845,499.9973468513,1694.30413522087,758.33063280786,667.184380421045,769.41428121373,195.634988501038,41.5823636810159,161.559262791586],"banana_production_damaged":[2708654.48546684,288295.468113027,30677.4346114412,46624.9418139062,34472.4358553769,14937.3792887416,44657.8039687071,21313.0987188536,22272.4916352591,8259.50274009087,59110.5705948147,5969.80888583598,1605993.53749972,131728.338618872,133329.962358435,73796.3907362983,71428.2556165899,43795.807173844,31048.6880742818,17014.6165427641,19421.7166235463,48744.2315224868,28384.3918719939,126232.565953703,118540.707652181,80108.2965657821,88621.3395344515,4848.91975105737,20587.9603620171,269982.303555321,130560.607743075,167818.437243022,814365.479854089,41108.8394984155,8091.23646574575,8850.0922464879,100301.350307278,246483.105585226,188816.923707631,74521.2312845895,91747.2100363375,24288.8634139794,9400.56991127395,20756.0573971246],"taro_households_damaged":[22223.0615485771,1356.94216550932,129.957598929982,98.6937759105937,149.951874725417,154.184447910388,190.782983446685,214.348653607412,184.583111095403,61.4477966166263,101.799409713452,71.1925135533642,12360.6989502028,2537.23222154791,699.284514419431,541.320253750453,733.992504788088,596.020968151066,290.686682124149,169.456107351233,170.411978948361,245.795503309821,139.601657092363,346.871481570567,563.739592191021,505.595502086324,755.751777765817,26.9748268017136,211.015388530852,2018.34702337075,1176.87970053033,631.721265872506,8505.42043286499,310.752642458738,144.142460706698,42.472337603792,873.983801663775,2137.23135838775,1496.47078674691,1266.49896010898,1505.96265872954,382.463257262479,41.5823636810159,303.8598055153],"taro_production_damaged":[5584221.78372522,393779.280513414,35301.1865293876,7553.12983943593,23959.2876232246,34227.4467433408,80256.2433336467,43615.9310083259,93690.4141884996,11751.7732921947,54956.5911532281,8467.27680213014,2709073.12476154,275006.72494415,235069.420743409,196469.452348923,154586.929802262,129558.837102472,77630.1236468527,61203.7854476335,53419.2683394801,33607.0034272889,30483.0189808109,55478.3119805527,141441.932488825,59561.7965867079,92613.7463950811,1049.77419005966,19240.9892598295,379947.547080125,341806.158184983,370898.303812091,2481369.37845027,90502.406380431,17265.724215949,2876.05351920155,432873.189854645,305299.897392932,671238.31356143,493807.392124179,312119.399999994,84788.3644004495,4853.08328444969,65745.553716611],"kumala_households_damaged":[7682.04891480456,394.683381274415,31.1180129440939,18.3288440976817,38.6442117181334,13.8508313234262,63.8373192428044,62.6173727556022,40.3813679924511,22.5485670581664,42.5265932352733,60.8302609067828,4161.89717612113,798.489662238702,118.762096866958,146.422691588237,184.185385096635,226.507163419729,129.55944882004,74.4695000915733,87.0994559069397,61.4488758274552,30.6816828774424,104.53661088428,147.666765288865,214.844201288693,362.228164849872,9.24851204630178,68.7653981793831,712.183942360688,527.883584623968,156.914033865371,3125.46835740901,124.928840099574,54.6293344230865,9.1832081305496,268.784700908502,1020.0226925746,509.512672630495,321.775573118597,620.34393229818,47.8079071578099,4.57406000491175,143.905436062704],"kumala_production_damaged":[1578701.48069572,83393.4373085658,2602.36536286514,2436.39684946146,3282.33705278321,1092.41003812402,17829.2009129265,8635.91650514794,26416.1626653179,2854.81093194163,8164.75528456749,10079.0817054305,914957.623647882,83690.921459768,20419.3841075844,20924.864649932,17519.8257209637,25074.4158565099,28932.4164419999,17580.2782742744,74865.0129635485,7796.03931747109,3422.92524601467,35502.2779106472,54247.7394344833,51444.228681947,51212.5730392931,449.456559407522,4838.06498752717,111474.831015353,225833.210374603,79729.1576065537,580350.419739272,21471.035765051,3892.98248399541,271.753088428493,33111.5561405204,142034.833049561,169069.596566406,49449.7583504921,123522.017979279,5028.8698643889,654.023149842355,31843.9933013077],"manioc_households_damaged":[13515.8062266408,726.805998480509,77.7950323602349,88.3544279580554,101.029947124801,60.9866061372565,85.6024085115583,105.629685730039,65.8789689302828,24.3193969318444,50.2386697287166,66.9708550677199,8498.95944816811,2031.50012333397,180.219405735174,202.329537467382,351.876556602528,298.490372133626,174.280476839139,112.464142995437,105.402964756949,220.923339284423,109.687016286856,337.36815330836,401.306150373269,439.176790016002,721.792887311139,57.0324909521945,217.082923664327,1390.87652366984,823.565212720306,323.584380717191,4290.04077999217,164.479176412504,69.109398968965,63.1345558975285,415.604731082179,1560.13588898003,505.355809333975,491.45007495138,663.186985332965,174.876291971989,19.5437109300774,163.164156130575],"manioc_production_damaged":[2198541.00897306,106961.69301574,10888.3993642015,8866.42324203418,8438.36613647093,4698.5179314154,12323.1219706181,17832.6880903969,25283.9100474812,2295.43686492311,9193.6765603552,7141.15280784372,1392457.16366892,190966.54141079,17176.9971389358,30231.7184009056,41211.5353783705,42367.7671925252,57577.7146281317,34285.6121436948,28907.0593548332,34697.7147157031,21243.2301822691,62874.795867309,167237.639380947,61226.8106019212,99626.5514331024,3114.4951150442,22532.1546337344,218510.459925668,166252.406743413,92415.9594216236,699122.1522884,38960.8100471472,5585.3377737376,4957.98412443983,74465.108368746,215908.426007773,77269.8122302845,65924.7532299985,111715.362743877,22755.9251518693,3715.77754158223,77862.8550689445],"yam_households_damaged":[10157.3522068414,783.763332002738,105.821191454114,109.97306458609,117.268738219123,69.2541566171311,104.555739836502,89.8268193609777,73.1988543669808,13.9305283396002,37.5688297752026,62.3654094470171,5941.90237017583,1002.23310206674,401.964020165088,260.898614102678,312.47371302464,265.857984183326,140.082043648063,98.0261786919688,92.1486997276321,204.829586091517,102.783637639432,291.752177649765,381.327705657716,320.571947033285,355.569558878367,18.4970240926036,152.36254890726,843.19426647407,479.438572111009,217.890990030671,3431.68650466285,173.895923153678,73.058507481477,57.395050815935,443.350248595314,1600.55837342439,271.977627115113,413.278608035562,138.506308441221,125.810281994237,7.0690018257727,126.786573780152],"yam_production_damaged":[3783872.63396085,248268.647568405,42472.1035169588,25507.105603062,26199.9650311911,14635.9849758973,34116.1874870611,30695.6106474039,37495.6975906081,1490.20388725075,24212.0240357955,11443.7647931763,1705365.48870878,103742.222038131,281888.83863951,93287.4288493196,50753.5633352218,39953.1248948581,61738.1281845133,76718.3810246805,65453.5873269277,71401.8416050639,30205.1579902521,166659.160854778,166673.289893307,170678.785079184,51922.1560518863,2918.21070455898,28745.8892089102,101882.09422123,77182.78049804,63560.8483084065,1830238.49768366,80462.2204452775,16965.6947540141,9149.02064375925,579163.89520136,883571.479938855,98157.587278342,86138.1965297205,38345.5158181021,14284.30253894,451.449607855785,23549.1349274357]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_households_affected","name":"Total","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"island cabbage_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"island cabbage_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"banana_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"banana_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"taro_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"taro_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"kumala_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"kumala_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"manioc_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"manioc_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"yam_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"yam_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Total Households","columns":["total_households_affected"]},{"name":"Island Cabbage","columns":["island cabbage_households_damaged","island cabbage_production_damaged"]},{"name":"Banana","columns":["banana_households_damaged","banana_production_damaged"]},{"name":"Taro","columns":["taro_households_damaged","taro_production_damaged"]},{"name":"Kumala","columns":["kumala_households_damaged","kumala_production_damaged"]},{"name":"Manioc","columns":["manioc_households_damaged","manioc_production_damaged"]},{"name":"Yam","columns":["yam_households_damaged","yam_production_damaged"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"bddcd7320559f0d80c4fe6bc255bd216"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-2-cash-crops-damage" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="table-2-cash-crops-damage"><span class="header-section-number">5.2.2</span> Table 2: Cash Crops Damage</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories from config file</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>cash_crop_with_config <span class="ot">&lt;-</span> cash_crop_full <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cash crop damage estimates</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>cash_damage <span class="ot">&lt;-</span> cash_crop_with_config <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total households affected (same as baseline)</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> total_households,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kava</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_households_damaged =</span> kava_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"kava"</span>, Region),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_production_damaged =</span> kava_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"kava"</span>, Region),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coconut</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_households_damaged =</span> coconut_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"coconut"</span>, Region),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_production_damaged =</span> coconut_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"coconut"</span>, Region),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cocoa</span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_households_damaged =</span> cocoa_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"cocoa"</span>, Region),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_production_damaged =</span> cocoa_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"cocoa"</span>, Region),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coffee</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_households_damaged =</span> coffee_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"coffee"</span>, Region),</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_production_damaged =</span> coffee_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"coffee"</span>, Region),</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vanilla</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_households_damaged =</span> vanilla_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"vanilla"</span>, Region),</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_production_damaged =</span> vanilla_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"vanilla"</span>, Region),</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tahitian Lime</span></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_households_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">tahitian lime_households</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"tahitian lime"</span>, Region),</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_production_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">tahitian lime_production</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"tahitian lime"</span>, Region),</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pepper</span></span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_households_damaged =</span> pepper_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"pepper"</span>, Region),</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_production_damaged =</span> pepper_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"pepper"</span>, Region),</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Noni</span></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_households_damaged =</span> noni_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"noni"</span>, Region),</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_production_damaged =</span> noni_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"noni"</span>, Region)</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_households_affected, <span class="fu">contains</span>(<span class="st">"_damaged"</span>))</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>cash_damage_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(cash_damage)</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to client's specification</span></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>cash_damage_ordered <span class="ot">&lt;-</span> cash_damage_full <span class="sc">%&gt;%</span></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>    total_households_affected,</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kava</span></span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>    kava_households_damaged,</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>    kava_production_damaged,</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coconut</span></span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>    coconut_households_damaged,</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>    coconut_production_damaged,</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cocoa</span></span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>    cocoa_households_damaged,</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>    cocoa_production_damaged,</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coffee</span></span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>    coffee_households_damaged,</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>    coffee_production_damaged,</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vanilla</span></span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>    vanilla_households_damaged,</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>    vanilla_production_damaged,</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tahitian Lime</span></span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_households_damaged</span><span class="st">`</span>,</span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_production_damaged</span><span class="st">`</span>,</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pepper</span></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>    pepper_households_damaged,</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>    pepper_production_damaged,</span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Noni</span></span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>    noni_households_damaged,</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>    noni_production_damaged</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>  cash_damage_ordered,</span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_02b_damage_cash_crops.csv"</span>),</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(cash_damage_ordered)</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kava</span></span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coconut</span></span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cocoa</span></span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coffee</span></span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vanilla</span></span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tahitian Lime</span></span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_households_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_production_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pepper</span></span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Noni</span></span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb20-136"><a href="#cb20-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households_affected"</span>)),</span>
<span id="cb20-137"><a href="#cb20-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Kava"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"kava_households_damaged"</span>, <span class="st">"kava_production_damaged"</span>)),</span>
<span id="cb20-138"><a href="#cb20-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Coconut"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"coconut_households_damaged"</span>, <span class="st">"coconut_production_damaged"</span>)),</span>
<span id="cb20-139"><a href="#cb20-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Cocoa"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"cocoa_households_damaged"</span>, <span class="st">"cocoa_production_damaged"</span>)),</span>
<span id="cb20-140"><a href="#cb20-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Coffee"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"coffee_households_damaged"</span>, <span class="st">"coffee_production_damaged"</span>)),</span>
<span id="cb20-141"><a href="#cb20-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Vanilla"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"vanilla_households_damaged"</span>, <span class="st">"vanilla_production_damaged"</span>)),</span>
<span id="cb20-142"><a href="#cb20-142" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Tahitian Lime"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"tahitian lime_households_damaged"</span>, <span class="st">"tahitian lime_production_damaged"</span>)),</span>
<span id="cb20-143"><a href="#cb20-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Pepper"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"pepper_households_damaged"</span>, <span class="st">"pepper_production_damaged"</span>)),</span>
<span id="cb20-144"><a href="#cb20-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Noni"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"noni_households_damaged"</span>, <span class="st">"noni_production_damaged"</span>))</span>
<span id="cb20-145"><a href="#cb20-145" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-146"><a href="#cb20-146" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-147"><a href="#cb20-147" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-148"><a href="#cb20-148" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-149"><a href="#cb20-149" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb20-150"><a href="#cb20-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb20-151"><a href="#cb20-151" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb20-152"><a href="#cb20-152" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb20-153"><a href="#cb20-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb20-154"><a href="#cb20-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb20-155"><a href="#cb20-155" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-156"><a href="#cb20-156" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb20-157"><a href="#cb20-157" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-158"><a href="#cb20-158" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb20-159"><a href="#cb20-159" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb20-160"><a href="#cb20-160" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-0c914ab48d1c1ee8e7b5" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0c914ab48d1c1ee8e7b5">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"total_households_affected":[45289.6987223164,10353.2774827892,1188.86767401795,1539.62290420528,1541.65738237234,935.199541294908,1153.86214879327,1202.44366657817,1007.7042284521,385.450635837244,605.948867341972,792.520433895933,24030.8306358174,8958.28660829032,620.505261352837,467.791975723459,610.02408994337,470.290296930793,327.891570980372,237.737908455605,232.625876024746,468.181911066327,197.239389926415,1023.64421567205,872.350722672883,887.60272195239,1904.00050406432,245.525974562536,486.365911492837,3298.47690356345,1825.63717105486,896.651622087837,10905.5906037098,374.158737182642,151.382492979637,140.043923990882,1021.95989506718,3601.9013798503,1581.98340313245,1424.05385466799,1782.97527561199,403.851005201499,87.3229637301334,335.957672295088],"kava_households_damaged":[7686.36132745762,511.93051560152,52.5615154536459,6.20360877152303,16.7526768884461,79.8838643769698,74.3553767363171,81.7471583602548,78.5667703538928,16.4687178252053,55.3066057101223,50.084221125143,3228.87918993719,259.130005994888,274.066377385288,379.02950110821,321.637165019498,187.156342656132,166.388530718122,85.8678929627323,70.0582580121039,36.5767118020566,46.0225243161636,48.4669741372573,122.476552386647,192.478716611952,95.2180653925214,0,2.69668228154443,424.552253329817,334.938793408562,182.117842413695,3945.55162191891,113.628744010164,58.578442935599,0,478.610177101591,1107.74808434746,748.82923098724,602.950461870065,522.333112341895,158.520955312738,23.2861236613689,131.06628935079],"kava_production_damaged":[14706396.8872673,2299901.70507592,525542.205154138,30022.9286142195,9572.12251064416,290219.62791907,232958.198958085,319001.973412193,584870.492230318,0,289553.540939853,18160.6153374038,7534532.31922045,96954.2476496482,1372581.97764073,1799939.41760408,1155462.60486133,1815165.50539562,318627.733729341,52835.7900295516,34231.1434234296,2946.87616323926,2943.52395105462,13704.1639161104,62041.8376862523,24265.4666966309,4368.08309040279,0,0,177368.41625903,105049.504947784,496046.026176201,4871962.86297088,65434.65578419,13793.7491578134,0,3913984.92281294,137769.974693077,208340.136353735,255197.81837299,21857.980403666,61348.358805418,0,194235.266587054],"coconut_households_damaged":[10411.7125754864,456.810338403735,61.4381281203906,103.675461742271,82.6328356951577,36.2913254830857,81.4368411873949,46.2204136658999,4.75792553385375,19.4791286104579,9.36466431346692,11.513614051757,6232.60462636644,1723.57719000162,128.728146953696,185.983419798438,102.630662342404,82.540745991935,99.9646508662235,66.1106786527231,71.320568967277,148.50144991635,84.3746279129663,240.434205033845,230.186428244408,277.874203559508,357.567140669818,80.9244804051411,196.857806552744,1144.61651593793,695.770610746464,314.641093812947,3722.29761071619,156.945779019564,73.058507481477,2.86975254079676,289.015807428497,1159.35125597855,650.25218709836,481.148408768675,674.92480808222,108.196842515043,23.2861236613689,103.248138141642],"coconut_production_damaged":[70280715.6021511,17911321.0604877,3003103.95725298,1457553.74236904,2385725.58679766,1778399.66090158,7688661.41511261,1249457.11914048,118353.007800169,0,220823.697610473,9242.87350266046,37187145.3463254,2246813.40956871,14040223.9882031,3635477.1049755,215725.022289041,1582235.86688136,281691.020544462,582109.329818519,157929.348094699,639268.549341425,239460.946832538,470808.043416122,3529008.64597752,653448.000806908,508096.151575958,89674.1831088439,324779.735011754,2779511.23209688,3440095.60911708,1770789.15866504,15182249.195338,1332642.40956576,442232.531680269,754.869690079145,2031968.18860075,2841692.43582633,2277773.30739557,3603622.25697887,2150707.76008441,398456.049025141,43119.2253657129,59280.161125093],"cocoa_households_damaged":[881.61099784598,318.154393456944,51.5641432438993,79.0490148007708,66.3940446008356,30.0638199268166,77.6878305956478,9.86193916264702,0.975984724893078,0.354165974735598,2.2034504266981,0,547.531713322466,81.761121484392,58.9657963465315,168.326766020106,3.665380797943,2.87932834855588,3.28831088375735,1.51978571615455,1.26231095517304,2.1946027081234,0,20.9073221768561,10.4235363733317,21.6877427168396,17.9782361230635,0.770709337191815,3.37085285193054,109.339443432969,36.7513888029345,2.43907824661199,15.9248910665701,2.51113246431303,1.31636950417076,0,0.578031614856995,5.16031716310925,1.78151284136536,1.21196072737701,1.7606734123884,0,0,1.60489333898927],"cocoa_production_damaged":[564545.313857773,237066.145662549,58869.0787697825,25292.387894161,43887.0221810077,10935.4171025654,89636.3504000716,8180.2469890259,0,0,265.642325934869,0,327277.87684368,83.6316378186457,41245.8303797674,281872.124939713,83.2465853646504,6.56756499570265,655.469969495629,14.2432810092501,20.5325262961689,108.129997382732,0,242.405311480948,211.037061885699,118.461333479615,32.6925137743244,0,211.395093794633,2140.08672697903,119.190160754277,112.831759688271,201.291351544258,111.10497161734,61.6710096474515,0,0,28.5153702794662,0,0,0,0,0,0],"coffee_households_damaged":[428.245248371888,0.306943752455532,0,0.0939940722958036,0.102777158824823,0,0,0,0,0,0.110172521334905,0,63.970640182542,7.25300271232509,1.66100834778962,14.1253230226662,0,0,0,2.27967857423183,0.631155477586521,3.65767118020566,0,0.950332826220729,1.73725606222195,1.35548391980247,0.6658605971505,0,2.69668228154443,18.7157605876254,4.17629418215164,4.06513041101999,363.967664436891,6.2778311607826,1.97455425625614,0,26.5894542834218,75.6846517256025,131.831950261037,63.021957823605,32.8659036979168,16.9843880692219,1.24747091043048,7.48950224861655],"coffee_production_damaged":[9655.06140273739,0.133279344342024,0,0,0.133279344342024,0,0,0,0,0,0,0,1880.40595880861,6.92433990541477,4.78896664233994,928.650515669947,0,0,0,46.9350021828623,4.10650525923378,63.74330092624,0,0.459100968713917,519.946384356071,5.0951111174028,0.90812538262012,0,9.2885723030975,34.2304338928187,4.21625058450506,251.113349617341,7774.52216458444,52.466236597077,10.792426688304,0,1196.96268998166,1205.38543795629,2910.54513468557,1926.0608223842,199.524965790417,210.095007667802,1.73634464559917,60.953098187519],"vanilla_households_damaged":[325.659395285422,7.7024542282218,1.69553275656922,0.281982216887411,1.3361030647227,1.39582021088791,1.35380938035311,0.356455632384832,0.121998090611635,0.059027662455933,1.10172521334905,0,134.733566372654,24.3964636687299,0,5.88555125944425,4.58172599742874,6.71843281329704,4.60363523726029,0.759892858077276,1.26231095517304,6.5838081243702,3.83521035968029,5.70199695732439,5.21176818666583,5.42193567920991,2.663442388602,0.770709337191815,1.34834114077222,38.4165612061784,11.6936237100246,4.87815649322399,183.223374684546,1.25556623215652,1.31636950417076,0,2.89015807428497,47.3029073285016,5.93837613788455,1.21196072737701,0,11.3229253794813,1.24747091043048,110.737640390259],"vanilla_production_damaged":[1260.26780523496,36.3398586735162,4.28121520679774,1.0929630726556,2.9108208804298,19.4693797492293,6.05747603572765,0.145362007801438,0.102204522849135,0,2.28043719802549,0,268.934100393805,15.970945028593,0,5.83040792742855,1.87976160500824,4.4659441970778,6.51268238921939,0,0.36958547333104,127.03272285112,10.3550679711368,3.58098755596855,16.5771141365288,1.83424000226501,3.81412660700451,1.5633271631566,1.34524150596585,46.5807744413477,18.4379881330086,2.78318340564401,954.993846167641,1.48139962156453,0,0,19.279304768905,306.825384207056,7.62434579881365,1.31491240471465,0,28.6240960556939,3.47268929119835,586.371714019695],"tahitian lime_households_damaged":[706.603497253498,0.472656541571511,0.0997372209746601,0,0,0,0,0,0.121998090611635,0.059027662455933,0,0.191893567529283,677.626157392313,199.78725653041,0,0,0,0,0.65766217675147,1.51978571615455,1.26231095517304,7.31534236041133,3.06816828774424,39.9139787012707,25.1902129022182,39.3090336742718,13.31721194301,5.39496536034273,20.8992876819693,202.918246371096,60.973895059414,56.0987996720759,28.5046833196135,0,0,0,0,2.58015858155464,0,1.21196072737701,0.5868911374628,3.14525704985591,3.32658909448127,17.6538267288819],"tahitian lime_production_damaged":[655862.427886631,57.5020941288765,18.430815773422,0,0,0,0,0,23.8477219981314,0,0,15.2235563573231,649130.083158491,136913.084493429,0,0,0,0,490.201900263825,189.910413456668,95.8184560487882,8129.7738772943,1073.85890071048,46855.8448669424,47315.1209764025,25501.0311426011,2924.16373203679,5228.46084566818,3721.83483317217,92490.632378396,59595.0803771387,218605.265964931,6674.84263401055,0,0,0,0,1045.56357691376,0,133.396910623226,456.989696697889,377.646932344911,486.176500767769,4175.06901666299],"pepper_households_damaged":[37.958002948491,19.0856977161789,15.3595320300977,0.751952578366429,1.43888022354752,0,0.624835098624513,0.237637088256555,0.121998090611635,0,0.550862606674525,0,11.3828029836956,2.63745553175458,0,0,0,0,0,0,0,0.731534236041133,0,0.950332826220729,1.73725606222195,1.35548391980247,0,0,0.674170570386109,0,1.67051767286066,1.62605216440799,7.48950224861655,0,0,0,0,0,0,0,0,0,0,7.48950224861655],"pepper_production_damaged":[84.705070340328,71.5184238580498,68.4244035588293,0.994692270070341,0.579765147887804,0,0.0856206666800246,0,0.459920352821106,0,0.974021861761186,0,9.04067202322262,0.696930315155383,0,0,0,0,0,0,0,0.500601839734869,0,0,2.57424435391976,0,0,0,0,0,0.567572194067988,4.70132332034462,4.14597445905559,0,0,0,0,0,0,0,0,0,0,4.14597445905559],"noni_households_damaged":[468.833630164641,6.93196493208448,1.19684665169592,0.469970361479018,1.43888022354752,0.214741570905833,2.08278366208171,0.594092720641387,0,0,0.550862606674525,0.383787135058567,434.79080186856,209.677714774489,0.830504173894808,2.3542205037777,0,0,0,2.27967857423183,1.26231095517304,0.731534236041133,0,10.453661088428,6.0803962177768,10.1661293985186,9.98790895725749,8.47780270911,37.7535519416221,112.294563525752,18.3756944014672,4.06513041101999,27.110863363996,0,0,0,0,9.4605814657003,0,7.8777447279506,2.3475645498512,3.14525704985591,0,4.27971557063803],"noni_production_damaged":[493672.045272014,10657.1901770892,1409.95740666678,407.703988286663,2283.87484464492,291.001405504496,825.532132302707,76.3150540957547,0,0,2540.35799694022,2822.4473486477,474120.463598438,138008.389169376,10775.1749452649,7523.33360274216,0,0,0,11964.3560477701,1293.54915665864,84.1011090754583,0,4280.65743228856,5266.75102271267,164989.888203738,4004.83293735474,9520.66242362368,50607.985454435,36747.0553926187,24314.7927938726,4738.93390690737,8894.39149648701,0,0,0,0,2224.19888179836,0,1680.80107385265,3393.14849798183,679.76447822084,0,916.47856463334]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_households_affected","name":"Total","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"kava_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"kava_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"coconut_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"coconut_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cocoa_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"cocoa_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"coffee_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"coffee_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"vanilla_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"vanilla_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"tahitian lime_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"tahitian lime_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"pepper_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"pepper_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"noni_households_damaged","name":"Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"noni_production_damaged","name":"Production","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Total Households","columns":["total_households_affected"]},{"name":"Kava","columns":["kava_households_damaged","kava_production_damaged"]},{"name":"Coconut","columns":["coconut_households_damaged","coconut_production_damaged"]},{"name":"Cocoa","columns":["cocoa_households_damaged","cocoa_production_damaged"]},{"name":"Coffee","columns":["coffee_households_damaged","coffee_production_damaged"]},{"name":"Vanilla","columns":["vanilla_households_damaged","vanilla_production_damaged"]},{"name":"Tahitian Lime","columns":["tahitian lime_households_damaged","tahitian lime_production_damaged"]},{"name":"Pepper","columns":["pepper_households_damaged","pepper_production_damaged"]},{"name":"Noni","columns":["noni_households_damaged","noni_production_damaged"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"5833984fd3a03b02f881bc0d217dcc6a"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="immediate-response-resources-1" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="immediate-response-resources-1"><span class="header-section-number">5.3</span> Immediate Response Resources</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Resources needed for Food Security restoration</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># === Staple Crops Resources ===</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get resource multipliers</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>get_food_security_resource_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Food Security"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> resource_type,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(multiplier) <span class="sc">&gt;</span> <span class="dv">0</span>, multiplier, <span class="dv">0</span>))</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate resources needed based on total affected households</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>resources_needed <span class="ot">&lt;-</span> staple_damage <span class="sc">%&gt;%</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Number of affected households (for the first column)</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_households_affected =</span> total_households_affected,</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Resources = total affected households * resource multiplier</span></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">island_cabbage_cuttings =</span> <span class="fu">round</span>(total_households_affected <span class="sc">*</span> <span class="fu">get_food_security_resource_multiplier</span>(<span class="st">"Island Cabbage Cuttings"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_seedlings =</span> <span class="fu">round</span>(total_households_affected <span class="sc">*</span> <span class="fu">get_food_security_resource_multiplier</span>(<span class="st">"Taro Seedlings"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_cuttings =</span> <span class="fu">round</span>(total_households_affected <span class="sc">*</span> <span class="fu">get_food_security_resource_multiplier</span>(<span class="st">"Kumala Cuttings"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_cuttings =</span> <span class="fu">round</span>(total_households_affected <span class="sc">*</span> <span class="fu">get_food_security_resource_multiplier</span>(<span class="st">"Manioc Cuttings"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_cuttings =</span> <span class="fu">round</span>(total_households_affected <span class="sc">*</span> <span class="fu">get_food_security_resource_multiplier</span>(<span class="st">"Yam Cuttings"</span>, Region), <span class="dv">0</span>)</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, num_households_affected, island_cabbage_cuttings, taro_seedlings, kumala_cuttings, manioc_cuttings, yam_cuttings)</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(resources_needed)</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>  resources_needed_full,</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_03_resources_needed.csv"</span>),</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_households_affected =</span> <span class="fu">colDef</span>(</span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Number of Households"</span>, </span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">island_cabbage_cuttings =</span> <span class="fu">colDef</span>(</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Island Cabbage Cuttings"</span>, </span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_seedlings =</span> <span class="fu">colDef</span>(</span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Taro Seedlings"</span>, </span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_cuttings =</span> <span class="fu">colDef</span>(</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Kumala Cuttings"</span>, </span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_cuttings =</span> <span class="fu">colDef</span>(</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Manioc Cuttings"</span>, </span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_cuttings =</span> <span class="fu">colDef</span>(</span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Yam Cuttings"</span>, </span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Staple Crops Resources"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"num_households_affected"</span>, <span class="st">"island_cabbage_cuttings"</span>, <span class="st">"taro_seedlings"</span>, <span class="st">"kumala_cuttings"</span>, <span class="st">"manioc_cuttings"</span>, <span class="st">"yam_cuttings"</span>))</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-5494df9c429e48dc8fc9" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5494df9c429e48dc8fc9">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"num_households_affected":[45289.6987223164,10353.2774827892,1188.86767401795,1539.62290420528,1541.65738237234,935.199541294908,1153.86214879327,1202.44366657817,1007.7042284521,385.450635837244,605.948867341972,792.520433895933,24030.8306358174,8958.28660829032,620.505261352837,467.791975723459,610.02408994337,470.290296930793,327.891570980372,237.737908455605,232.625876024746,468.181911066327,197.239389926415,1023.64421567205,872.350722672883,887.60272195239,1904.00050406432,245.525974562536,486.365911492837,3298.47690356345,1825.63717105486,896.651622087837,10905.5906037098,374.158737182642,151.382492979637,140.043923990882,1021.95989506718,3601.9013798503,1581.98340313245,1424.05385466799,1782.97527561199,403.851005201499,87.3229637301334,335.957672295088],"island_cabbage_cuttings":[905795,207064,23777,30792,30833,18704,23077,24049,20154,7709,12119,15850,480619,179166,12410,9356,12200,9406,6558,4755,4653,9364,3945,20473,17447,17752,38080,4911,9727,65970,36513,17933,218112,7483,3028,2801,20439,72038,31640,28481,35660,8077,1746,6719],"taro_seedlings":[1811587,414131,47555,61585,61666,37408,46154,48098,40308,15418,24238,31701,961234,358331,24820,18712,24401,18812,13116,9510,9305,18727,7890,40946,34894,35504,76160,9821,19455,131939,73025,35866,436222,14966,6055,5602,40878,144076,63279,56962,71319,16154,3493,13438],"kumala_cuttings":[4528969,1035327,118887,153962,154166,93520,115386,120244,100770,38545,60595,79252,2403084,895829,62051,46779,61002,47029,32789,23774,23263,46818,19724,102364,87235,88760,190400,24553,48637,329848,182564,89665,1090558,37416,15138,14004,102196,360190,158198,142405,178298,40385,8732,33596],"manioc_cuttings":[2264485,517663,59443,76981,77083,46760,57693,60122,50385,19273,30297,39626,1201542,447914,31025,23390,30501,23515,16395,11887,11631,23409,9862,51182,43618,44380,95200,12276,24318,164924,91282,44833,545280,18708,7569,7002,51098,180095,79099,71203,89149,20193,4366,16798],"yam_cuttings":[679347,155300,17833,23094,23125,14028,17308,18037,15116,5782,9089,11888,360462,134374,9308,7017,9150,7054,4918,3566,3489,7023,2959,15355,13085,13314,28560,3683,7295,49477,27385,13450,163585,5612,2271,2101,15329,54029,23730,21361,26745,6058,1310,5039]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"num_households_affected","name":"Number of Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"island_cabbage_cuttings","name":"Island Cabbage Cuttings","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"taro_seedlings","name":"Taro Seedlings","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"kumala_cuttings","name":"Kumala Cuttings","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"manioc_cuttings","name":"Manioc Cuttings","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"yam_cuttings","name":"Yam Cuttings","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Staple Crops Resources","columns":["num_households_affected","island_cabbage_cuttings","taro_seedlings","kumala_cuttings","manioc_cuttings","yam_cuttings"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"2ea74068af75db739caa27a9dae30479"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimated-financial-damage-1" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="estimated-financial-damage-1"><span class="header-section-number">5.4</span> Estimated Financial Damage</h2>
<section id="table-1-staple-crops-financial-damage" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="table-1-staple-crops-financial-damage"><span class="header-section-number">5.4.1</span> Table 1: Staple Crops Financial Damage</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for food security</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>get_food_security_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(indicator_type, crop_type, area_council) {</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Food Security"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator_type,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(crop_type)),</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate staple crops financial damage</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>staple_financial <span class="ot">&lt;-</span> staple_damage <span class="sc">%&gt;%</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each crop (damaged production * unit cost)</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">island_cabbage_financial =</span> <span class="st">`</span><span class="at">island cabbage_production_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"island cabbage"</span>, Region),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_financial =</span> banana_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"banana"</span>, Region),</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_financial =</span> taro_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"taro"</span>, Region),</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_financial =</span> kumala_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"kumala"</span>, Region),</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_financial =</span> manioc_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"manioc"</span>, Region),</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_financial =</span> yam_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"yam"</span>, Region),</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total staple crops financial damage</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_staple_financial =</span> island_cabbage_financial <span class="sc">+</span> banana_financial <span class="sc">+</span> taro_financial <span class="sc">+</span> </span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>                             kumala_financial <span class="sc">+</span> manioc_financial <span class="sc">+</span> yam_financial</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_staple_financial, island_cabbage_financial, banana_financial, </span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>         taro_financial, kumala_financial, manioc_financial, yam_financial)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>staple_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(staple_financial)</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>staple_financial_ordered <span class="ot">&lt;-</span> staple_financial_full <span class="sc">%&gt;%</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_staple_financial, island_cabbage_financial, banana_financial, </span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>         taro_financial, kumala_financial, manioc_financial, yam_financial)</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>  staple_financial_ordered,</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_04a_financial_damage_staple_crops.csv"</span>),</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(staple_financial_ordered)</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_staple_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">island_cabbage_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Island Cabbage"</span>,</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Banana"</span>,</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Taro"</span>,</span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Kumala"</span>,</span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Manioc"</span>,</span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Yam"</span>,</span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Staple Crops Financial Damage (VT)"</span>, </span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_staple_financial"</span>, <span class="st">"island_cabbage_financial"</span>, <span class="st">"banana_financial"</span>, </span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"taro_financial"</span>, <span class="st">"kumala_financial"</span>, <span class="st">"manioc_financial"</span>, <span class="st">"yam_financial"</span>))</span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-7411efd2ac299ad89731" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7411efd2ac299ad89731">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"total_staple_financial":[2158147110.46319,153928934.142171,16931467.9228893,11126293.8719369,12681279.5626876,10127183.7941262,26375860.2238576,16741355.561451,28391009.2846838,3482127.76798838,22046528.385208,6025827.76734183,1109880254.0432,102989286.848401,101252012.132527,57440245.102627,45475309.8604903,37422303.7913355,33035695.2161853,28763858.3522059,32154001.1994674,26534878.3117916,14158587.5082137,60212600.1935128,80426406.4719643,57803796.5317225,45856162.3636801,1522350.62118008,13239119.7825796,135636884.463803,126301812.955615,109654942.3359,894337922.277817,36979808.40321,7362935.24693954,3158163.41977793,187105017.388616,257486768.675201,161965895.623153,108587507.036457,85475573.960294,20238478.6780663,2026704.8789595,23951068.9671427],"island_cabbage_financial":[177801227.508838,15507188.4345532,1155044.41404342,1385685.72782598,1185544.7577994,992436.04335596,2385326.62754601,1479134.13875874,1923967.2836706,404718.60195356,3785125.0147862,810205.824813351,119137608.107955,16022191.6220866,3523899.10375133,2389545.4024072,4297437.13359242,3008355.24084411,2483354.07313121,1400419.73637376,1090020.48974787,3019254.84590094,910922.38558594,6482792.61634599,7952503.48602251,4370237.54651495,6100551.8082147,312014.046313337,2296489.77104198,18449315.0275514,17981775.545291,17046528.2272376,43156430.9663303,2105439.21214858,506665.888634849,230990.125164219,6345764.90552269,12900025.1518117,6562157.45997619,5282160.34752631,5774901.27213324,1685104.92783444,287582.081927363,1475639.59365071],"banana_financial":[203149086.410013,21622160.108477,2300807.59585809,3496870.63604297,2585432.68915327,1120303.44665562,3349335.29765303,1598482.40391402,1670436.87264443,619462.705506815,4433292.7946111,447735.666437699,120449515.312479,9879625.39641541,9999747.17688261,5534729.30522237,5357119.17124424,3284685.5380383,2328651.60557114,1276096.24070731,1456628.74676597,3655817.36418651,2128829.39039954,9467442.4465277,8890553.07391356,6008122.24243366,6646600.46508386,363668.981329303,1544097.02715128,20248672.7666491,9792045.58073064,12586382.7932266,61077410.9890567,3083162.96238116,606842.734930931,663756.918486592,7522601.27304585,18486232.918892,14161269.2780723,5589092.34634421,6881040.75272531,1821664.75604845,705042.743345546,1556704.30478435],"taro_financial":[837633267.558783,59066892.0770121,5295177.97940814,1132969.47591539,3593893.14348369,5134117.01150112,12038436.500047,6542389.65124889,14053562.1282749,1762765.99382921,8243488.67298422,1270091.52031952,406360968.71423,41251008.7416226,35260413.1115113,29470417.8523384,23188039.4703393,19433825.5653708,11644518.5470279,9180567.81714503,8012890.25092202,5041050.51409333,4572452.84712163,8321746.7970829,21216289.8733237,8934269.48800619,13892061.9592622,157466.128508949,2886148.38897443,56992132.0620187,51270923.7277475,55634745.5718136,372205406.767541,13575360.9570646,2589858.63239234,431408.027880232,64930978.4781967,45794984.6089398,100685747.034214,74071108.8186269,46817909.999999,12718254.6600674,727962.492667453,9861833.05749165],"kumala_financial":[189444177.683486,10007212.4770279,312283.843543817,292367.621935375,393880.446333985,131089.204574882,2139504.10955118,1036309.98061775,3169939.51983815,342577.311832996,979770.634148099,1209489.80465166,109794914.837746,10042910.5751722,2450326.09291013,2510983.75799184,2102379.08651565,3008929.90278119,3471889.97303999,2109633.39291293,8983801.55562582,935524.718096531,410751.02952176,4260273.34927766,6509728.73213799,6173307.44183364,6145508.76471517,53934.7871289027,580567.79850326,13376979.7218424,27099985.2449524,9567498.91278644,69642050.3687127,2576524.29180611,467157.898079449,32610.3706114191,3973386.73686245,17044179.9659473,20288351.5879687,5933971.00205905,14822642.1575135,603464.383726668,78482.7779810826,3821279.19615692],"manioc_financial":[87941640.3589225,4278467.72062961,435535.97456806,354656.929681367,337534.645458837,187940.717256616,492924.878824724,713307.523615876,1011356.40189925,91817.4745969244,367747.062414208,285646.112313749,55698286.5467569,7638661.65643159,687079.88555743,1209268.73603623,1648461.41513482,1694710.68770101,2303108.58512527,1371424.48574779,1156282.37419333,1387908.58862813,849729.207290765,2514991.83469236,6689505.57523788,2449072.42407685,3985062.0573241,124579.804601768,901286.185349376,8740418.39702673,6650096.26973653,3696638.37686494,27964886.091536,1558432.40188589,223413.510949504,198319.364977593,2978604.33474984,8636337.04031092,3090792.48921138,2636990.12919994,4468614.50975508,910237.006074772,148631.101663289,3114514.20275778],"yam_financial":[662177710.943148,43447013.3244708,7432618.11546779,4463743.48053585,4584993.88045844,2561297.37078203,5970332.81023569,5371731.86329568,6561747.07835642,260785.680268881,4237104.20626421,2002658.83880585,298438960.524036,18154888.8566729,49330546.7619143,16325300.0486309,8881873.58366382,6991796.85660016,10804172.4322898,13425716.6793191,11454377.7822124,12495322.2808862,5285902.64829411,29165353.1495862,29167825.7313287,29868787.3888572,9086377.3090801,510686.873297822,5030530.61155928,17829366.4887152,13506986.587157,11123148.4539711,320291737.094641,14080888.5779236,2968996.58195247,1601078.61265787,101353681.660238,154625008.9893,17177577.7737099,15074184.3927011,6710465.26816787,2499752.94431451,79003.6813747625,4121098.61230126]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_staple_financial","name":"Total Value","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"island_cabbage_financial","name":"Island Cabbage","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"banana_financial","name":"Banana","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"taro_financial","name":"Taro","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"kumala_financial","name":"Kumala","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"manioc_financial","name":"Manioc","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"yam_financial","name":"Yam","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Staple Crops Financial Damage (VT)","columns":["total_staple_financial","island_cabbage_financial","banana_financial","taro_financial","kumala_financial","manioc_financial","yam_financial"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"4f1cab1b25c5b9a20be2e7bc4b416e80"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-2-cash-crops-financial-damage" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="table-2-cash-crops-financial-damage"><span class="header-section-number">5.4.2</span> Table 2: Cash Crops Financial Damage</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cash crops financial damage</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cash_financial <span class="ot">&lt;-</span> cash_damage <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each crop (damaged production * unit cost)</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_financial =</span> kava_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"kava"</span>, Region),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_financial =</span> coconut_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"coconut"</span>, Region),</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_financial =</span> cocoa_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"cocoa"</span>, Region),</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_financial =</span> coffee_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"coffee"</span>, Region),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_financial =</span> vanilla_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"vanilla"</span>, Region),</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">tahitian_lime_financial =</span> <span class="st">`</span><span class="at">tahitian lime_production_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"tahitian lime"</span>, Region),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_financial =</span> pepper_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"pepper"</span>, Region),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_financial =</span> noni_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"noni"</span>, Region),</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total cash crops financial damage</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_cash_financial =</span> kava_financial <span class="sc">+</span> coconut_financial <span class="sc">+</span> cocoa_financial <span class="sc">+</span> </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>                           coffee_financial <span class="sc">+</span> vanilla_financial <span class="sc">+</span> tahitian_lime_financial <span class="sc">+</span> </span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>                           pepper_financial <span class="sc">+</span> noni_financial</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_cash_financial, kava_financial, coconut_financial, cocoa_financial,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>         coffee_financial, vanilla_financial, tahitian_lime_financial, pepper_financial, noni_financial)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>cash_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(cash_financial)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>cash_financial_ordered <span class="ot">&lt;-</span> cash_financial_full <span class="sc">%&gt;%</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_cash_financial, kava_financial, coconut_financial, cocoa_financial,</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>         coffee_financial, vanilla_financial, tahitian_lime_financial, pepper_financial, noni_financial)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>  cash_financial_ordered,</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_04b_financial_damage_cash_crops.csv"</span>),</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(cash_financial_ordered)</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_cash_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Kava"</span>,</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Coconut"</span>,</span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Cocoa"</span>,</span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Coffee"</span>,</span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Vanilla"</span>,</span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb23-74"><a href="#cb23-74" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-75"><a href="#cb23-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">tahitian_lime_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb23-76"><a href="#cb23-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Tahitian Lime"</span>,</span>
<span id="cb23-77"><a href="#cb23-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb23-78"><a href="#cb23-78" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-79"><a href="#cb23-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb23-80"><a href="#cb23-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Pepper"</span>,</span>
<span id="cb23-81"><a href="#cb23-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb23-82"><a href="#cb23-82" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-83"><a href="#cb23-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb23-84"><a href="#cb23-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Noni"</span>,</span>
<span id="cb23-85"><a href="#cb23-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb23-86"><a href="#cb23-86" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-87"><a href="#cb23-87" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb23-88"><a href="#cb23-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb23-89"><a href="#cb23-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb23-90"><a href="#cb23-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Cash Crops Financial Damage (VT)"</span>, </span>
<span id="cb23-91"><a href="#cb23-91" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_cash_financial"</span>, <span class="st">"kava_financial"</span>, <span class="st">"coconut_financial"</span>, <span class="st">"cocoa_financial"</span>,</span>
<span id="cb23-92"><a href="#cb23-92" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"coffee_financial"</span>, <span class="st">"vanilla_financial"</span>, <span class="st">"tahitian_lime_financial"</span>, </span>
<span id="cb23-93"><a href="#cb23-93" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"pepper_financial"</span>, <span class="st">"noni_financial"</span>))</span>
<span id="cb23-94"><a href="#cb23-94" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb23-95"><a href="#cb23-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-96"><a href="#cb23-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-97"><a href="#cb23-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-98"><a href="#cb23-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb23-99"><a href="#cb23-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb23-100"><a href="#cb23-100" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb23-101"><a href="#cb23-101" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb23-102"><a href="#cb23-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb23-103"><a href="#cb23-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb23-104"><a href="#cb23-104" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb23-105"><a href="#cb23-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb23-106"><a href="#cb23-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb23-107"><a href="#cb23-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb23-108"><a href="#cb23-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb23-109"><a href="#cb23-109" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-9a285e6a62c65f2bb481" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9a285e6a62c65f2bb481">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"total_cash_financial":[31829459043.3384,5757379842.16089,1184605656.07132,223481851.811535,305058876.971591,667151263.40942,1291918167.76542,648109503.512158,926607268.502418,0,479550563.685622,30896690.4314031,16629944056.7647,522915441.210226,3834081410.44483,3265527936.72927,1828432458.66954,3021571545.9388,531076937.532729,158508463.430035,73047069.9294605,84494975.9282698,33672379.915921,90673175.8825486,534097275.737786,207003715.917841,70546784.9797001,16856080.0831344,65905431.2690854,650584585.019062,602814285.664229,1038134102.48225,9442135144.41277,262046013.558235,74595896.5073453,90584.3628094974,6350515754.37436,561049947.658835,600049558.332708,832530637.541836,294145408.778908,144357109.050381,5319396.00247181,317434838.244883],"kava_financial":[22941979144.1369,3587846659.91844,819845840.040455,46835768.6381824,14932511.1166049,452742619.553749,363414790.374613,497643078.523021,912397967.879296,0,451703523.866171,28330559.9263499,11753870417.9839,151248626.333451,2141227885.11955,2807905491.46237,1802521663.58368,2831658188.41717,497059264.617773,82423832.4461005,53400583.7405502,4597126.81465324,4591897.36364521,21378495.7091323,96785266.7905536,37854128.0467442,6814209.62102835,0,0,276694729.364086,163877227.718543,773831800.834874,7600262066.23458,102078063.023336,21518248.6861888,0,6105816479.58819,214921160.521201,325010612.711827,398108596.661865,34098449.429719,95703439.7364521,0,303007015.875803],"coconut_financial":[8433685872.25813,2149358527.25852,360372474.870358,174906449.084285,286287070.415719,213407959.30819,922639369.813513,149934854.296858,14202360.9360203,0,26498843.7132568,1109144.82031926,4462457441.55905,269617609.148245,1684826878.58437,436257252.59706,25887002.6746849,189868304.025763,33802922.4653355,69853119.5782222,18951521.7713639,76712225.920971,28735313.6199046,56496965.2099347,423481037.517303,78413760.096829,60971538.189115,10760901.9730613,38973568.2014105,333541347.851625,412811473.09405,212494699.039804,1821869903.44056,159917089.147891,53067903.8016322,90584.3628094974,243836182.63209,341003092.29916,273332796.887468,432434670.837464,258084931.210129,47814725.8830169,5174307.04388554,7113619.33501116],"cocoa_financial":[33872718.8314664,14223968.7397529,3532144.72618695,1517543.27364966,2633221.33086046,656125.026153924,5378181.0240043,490814.819341554,0,0,15938.5395560921,0,19636672.6106208,5017.89826911874,2474749.82278604,16912327.4963828,4994.79512187902,394.053899742159,39328.1981697377,854.596860555005,1231.95157777014,6487.79984296391,0,14544.3186888569,12662.2237131419,7107.6800087769,1961.55082645946,0,12683.705627678,128405.203618742,7151.40964525663,6769.90558129624,12077.4810926555,6666.2982970404,3700.26057884709,0,0,1710.92221676797,0,0,0,0,0,0],"coffee_financial":[5406834.38553294,74.6364328315335,0,0,74.6364328315335,0,0,0,0,0,0,0,1053027.33693282,3877.63034703227,2681.82131971036,520044.28877517,0,0,0,26283.6012224029,2299.64294517092,35696.2485186944,0,257.096542479793,291169.9752394,2853.26222574557,508.550214267267,0,5201.6004897346,19169.0429799785,2361.10032732283,140623.475785711,4353732.41216729,29381.0924943631,6043.75894545027,0,670299.106389727,675015.845255522,1629905.27542392,1078594.06053515,111733.980842634,117653.204293969,972.353001535538,34133.7349850106],"vanilla_financial":[12602678.0523496,363398.586735162,42812.1520679774,10929.630726556,29108.208804298,194693.797492293,60574.7603572765,1453.62007801438,1022.04522849135,0,22804.3719802549,0,2689341.00393805,159709.45028593,0,58304.0792742855,18797.6160500824,44659.441970778,65126.8238921939,0,3695.8547333104,1270327.2285112,103550.679711368,35809.8755596855,165771.141365288,18342.4000226501,38141.2660700451,15633.271631566,13452.4150596585,465807.744413477,184379.881330086,27831.8340564401,9549938.46167641,14813.9962156453,0,0,192793.04768905,3068253.84207056,76243.4579881365,13149.1240471465,0,286240.960556939,34726.8929119835,5863717.14019695],"tahitian_lime_financial":[147569046.274492,12937.9711789972,4146.93354901995,0,0,0,0,0,5365.73744957957,0,0,3425.3001803977,146054268.71066,30805444.0110214,0,0,0,0,110295.427559361,42729.8430277503,21559.1526109773,1829199.12239122,241618.252659859,10542565.095062,10645902.2196906,5737732.00708524,657936.839708278,1176403.69027534,837412.837463738,20810392.2851391,13408893.0848562,49186184.8421094,1501839.59265237,0,0,0,0,235251.804805596,0,30014.3048902259,102822.681757025,84970.5597776051,109389.712672748,939390.528749174],"pepper_financial":[101646.084408394,85822.1086296597,82109.2842705952,1193.63072408441,695.718177465365,0,102.74480001603,0,551.904423385327,0,1168.82623411342,0,10848.8064278671,836.316378186459,0,0,0,0,0,0,0,600.722207681843,0,0,3089.09322470372,0,0,0,0,0,681.086632881586,5641.58798441354,4975.16935086671,0,0,0,0,0,0,0,0,0,0,4975.16935086671],"noni_financial":[254241103.315087,5488452.94120096,726128.064433392,209967.553967631,1176195.54499213,149865.723834815,425149.048135894,39302.2528593137,0,0,1308284.36842421,1453560.38455357,244172038.753196,71074320.4222286,5549215.09681141,3874516.80541221,0,0,0,6161643.36460159,666177.8156792,43312.071173861,0,2204538.57762861,2712376.77669702,84969792.424925,2062488.96273769,4903141.1481662,26063112.509034,18924733.5271986,12522118.2888444,2440550.9620573,4580611.62069081,0,0,0,0,1145462.42412616,0,865612.553034112,1747471.47646064,350078.706283733,0,471986.46078617]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_cash_financial","name":"Total Value","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"kava_financial","name":"Kava","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"coconut_financial","name":"Coconut","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"cocoa_financial","name":"Cocoa","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"coffee_financial","name":"Coffee","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"vanilla_financial","name":"Vanilla","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"tahitian_lime_financial","name":"Tahitian Lime","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"pepper_financial","name":"Pepper","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"noni_financial","name":"Noni","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Cash Crops Financial Damage (VT)","columns":["total_cash_financial","kava_financial","coconut_financial","cocoa_financial","coffee_financial","vanilla_financial","tahitian_lime_financial","pepper_financial","noni_financial"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"d347564f737961bec6f6f98013113917"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
</section>
<section id="gender-protection" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Gender &amp; Protection</h1>
<section id="baseline-gender-protection" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="baseline-gender-protection"><span class="header-section-number">6.1</span> Baseline : Gender &amp; Protection</h2>
<section id="table-1-population-by-sex-and-age" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="table-1-population-by-sex-and-age"><span class="header-section-number">6.1.1</span> Table 1: Population by Sex and Age</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get total population from the data</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>total_population <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Population Sex"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_population =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get population by sex</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>population_sex <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Population Sex"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape sex data</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>sex_wide <span class="ot">&lt;-</span> population_sex <span class="sc">%&gt;%</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, sex) <span class="sc">%&gt;%</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> sex,</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"sex_"</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Get population by age</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>population_age <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Population Age"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape age data</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>age_wide <span class="ot">&lt;-</span> population_age <span class="sc">%&gt;%</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, age_group) <span class="sc">%&gt;%</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> age_group,</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"age_"</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all population data</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>population_full <span class="ot">&lt;-</span> total_population <span class="sc">%&gt;%</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sex_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(age_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>population_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(population_full)</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>population_ordered <span class="ot">&lt;-</span> population_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>    total_population,</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>    sex_male,</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a>    sex_female,</span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_0-4</span><span class="st">`</span>,</span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_5-11</span><span class="st">`</span>,</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_12-18</span><span class="st">`</span>,</span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_19-35</span><span class="st">`</span>,</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_36-54</span><span class="st">`</span>,</span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_55+</span><span class="st">`</span></span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true" tabindex="-1"></a>  population_ordered,</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"GenderProtection_01a_baseline_population.csv"</span>),</span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb24-87"><a href="#cb24-87" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(population_ordered)</span>
<span id="cb24-88"><a href="#cb24-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-89"><a href="#cb24-89" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb24-90"><a href="#cb24-90" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb24-91"><a href="#cb24-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb24-92"><a href="#cb24-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb24-93"><a href="#cb24-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb24-94"><a href="#cb24-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb24-95"><a href="#cb24-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb24-96"><a href="#cb24-96" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb24-97"><a href="#cb24-97" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-98"><a href="#cb24-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_population =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb24-99"><a href="#cb24-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex_male =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Male"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb24-100"><a href="#cb24-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex_female =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Female"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb24-101"><a href="#cb24-101" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_0-4</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"0-4"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb24-102"><a href="#cb24-102" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_5-11</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"5-11"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb24-103"><a href="#cb24-103" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_12-18</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"12-18"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb24-104"><a href="#cb24-104" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_19-35</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"19-35"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb24-105"><a href="#cb24-105" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_36-54</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"36-54"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb24-106"><a href="#cb24-106" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_55+</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"55+"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb24-107"><a href="#cb24-107" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb24-108"><a href="#cb24-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb24-109"><a href="#cb24-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Population"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_population"</span>)),</span>
<span id="cb24-110"><a href="#cb24-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Sex"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"sex_male"</span>, <span class="st">"sex_female"</span>)),</span>
<span id="cb24-111"><a href="#cb24-111" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Age Group"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"age_0-4"</span>, <span class="st">"age_5-11"</span>, <span class="st">"age_12-18"</span>, <span class="st">"age_19-35"</span>, <span class="st">"age_36-54"</span>, <span class="st">"age_55+"</span>))</span>
<span id="cb24-112"><a href="#cb24-112" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb24-113"><a href="#cb24-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-114"><a href="#cb24-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-115"><a href="#cb24-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-116"><a href="#cb24-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb24-117"><a href="#cb24-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb24-118"><a href="#cb24-118" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb24-119"><a href="#cb24-119" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb24-120"><a href="#cb24-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb24-121"><a href="#cb24-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb24-122"><a href="#cb24-122" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb24-123"><a href="#cb24-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb24-124"><a href="#cb24-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-125"><a href="#cb24-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb24-126"><a href="#cb24-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb24-127"><a href="#cb24-127" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-9287208f062506021802" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9287208f062506021802">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo","luganville"],"total_population":[348052.878886167,13286.7717523727,1439.13464556176,478.808949433024,1712.08513698758,1588.68847204886,1836.24167878944,505.452383157247,3586.499645509,1410.71739912728,729.143441758482,70430.4751235044,1473.64619089702,3769.62188424037,2568.23581172683,2348.02855663561,5385.79622343122,5123.54881934176,8440.53089261334,10249.3026150994,3117.21473717594,2306.75070457123,41745.4100652423,2645.10505223571,2567.26198287333,1879.53843588359,913.813235198296,3350.35988042659,3032.31358416725,7934.75162543353,5029.19747204516,6762.75439616066,7630.31440081816,47625.9886857346,5488.43875478311,6406.6908905057,6582.92043905141,4053.30947912852,5529.91817138101,5329.04745680728,4513.88336760198,5559.5187269909,2537.43817757296,1624.82322191172,113793.897787538,38801.5043907089,2829.45074358279,2239.22502473362,1699.16581276072,2557.04851226475,1508.90770450048,1144.18153201921,1001.72014723783,1870.63754644804,807.585724309822,5055.7706354943,4405.19640161633,6888.0832089431,9144.25681252584,1410.42274951096,2204.51295765632,16493.9106462183,9125.80659223213,4606.5106447749,61170.3354717748,2246.28685916169,1013.60451821149,538.365576653472,5434.67125257786,22741.9667093492,8186.60994297228,7905.67316763517,8995.93549801614,2014.3550298725,473.963108572271,1618.90380875273,5998.13939485167,19649.6592929199],"sex_male":[175343.919744804,6683.05128338438,722.411153066221,249.679344876019,850.290892355458,823.867096414311,947.141712735172,260.532854495409,1758.7592281174,716.503405169579,353.865596154812,36182.4672471664,783.455674662661,1969.03552252787,1328.56170866985,1194.15278550692,2832.77042450403,2613.09418540267,4330.33630962588,5230.25716180785,1619.3290189188,1195.72089208989,21093.2722996181,1348.67421640021,1301.55606619794,1008.0976767781,466.666054837029,1696.43086370277,1547.36001893917,4128.01449477825,2529.64865917045,3349.33289493893,3717.49135387529,24107.3775313191,2783.44902416143,3208.94030387054,3271.51962862304,2058.12225252326,2822.7475996644,2728.71894058529,2246.97275109937,2821.95086636375,1340.33502906495,824.62113536307,56675.5088336129,19469.4230257093,1343.94396854073,1099.3048561665,403.191887773729,1313.83635981556,769.535993748132,574.261888461257,539.455583816146,933.22867540676,413.106944456992,2578.11719570453,2171.30820320049,3450.64656643998,4617.38768840385,682.816773419033,1083.76040849159,8307.07417601141,4579.77916632101,2345.3294717259,30602.2425497031,1188.8582123083,504.169520097401,247.94661952484,2689.85014891445,11427.374160149,4068.44523882712,3928.60484986564,4425.11126140022,1011.04169273916,252.698996846721,858.141849030269,3143.85055387512,9941.90300957481],"sex_female":[172708.959141363,6603.7204689883,716.72349249554,229.129604557005,861.794244632125,764.821375634549,889.099966054273,244.919528661838,1827.7404173916,694.213993957701,375.27784560367,34248.007876338,690.190516234355,1800.5863617125,1239.67410305698,1153.87577112869,2553.02579892719,2510.45463393909,4110.19458298746,5019.04545329157,1497.88571825714,1111.02981248134,20652.1377656241,1296.4308358355,1265.70591667539,871.440759105489,447.147180361267,1653.92901672382,1484.95356522808,3806.73713065528,2499.54881287471,3413.42150122173,3912.82304694287,23518.6111544155,2704.98973062168,3197.75058663516,3311.40081042837,1995.18722660526,2707.17057171661,2600.32851622199,2266.91061650261,2737.56786062715,1197.10314850801,800.202086548649,57118.3889539255,19332.0813649996,1485.50677504206,1139.92016856712,1295.97392498699,1243.21215244919,739.371710752352,569.919643557958,462.264563421685,937.408871041281,394.47877985283,2477.65343978977,2233.88819841584,3437.43664250312,4526.86912412199,727.605976091927,1120.75254916473,8186.8364702069,4546.02742591112,2261.181173049,30568.0929220717,1057.42864685339,509.434998114084,290.418957128632,2744.82110366341,11314.5925492002,4118.16470414516,3977.06831776953,4570.82423661592,1003.31333713334,221.26411172555,760.76195972246,2854.28884097655,9707.75628334513],"age_0-4":[46194.986834679,1912.95944869368,227.482181676272,59.5942469251403,232.009636458006,239.07166338718,267.034737735584,68.238679746914,515.253865689214,227.641123258403,76.6333138169656,7331.44207411958,227.306056008024,565.702263558333,391.709592557003,352.743396116213,804.980442255356,756.913299683292,1138.26824457559,1430.56550530001,465.970762922987,319.7074778336,6268.85328110812,347.786825214907,331.53870554934,249.998662758234,141.415746050512,488.164071015401,488.050471330349,1211.973882974,782.374719851041,1025.44466071378,1202.10553565056,6296.25403804729,763.767305651398,818.926409790983,863.489104569403,552.206335222721,842.299933325045,682.789311010339,596.40533849521,676.873726402084,306.174570364837,193.322003215274,14669.3669074337,4545.81715243585,344.172135346184,355.350052849074,417.591598051363,350.845281457248,176.74584334334,138.951836905559,106.737299128251,207.964732817408,108.481664459528,650.299176799615,504.012812817665,884.738436801677,1232.01398037737,188.852206279129,285.111272705792,2250.02067581993,1225.56225729857,696.098491740104,9716.11108527667,345.526494270336,130.320580912905,83.7967741912653,978.695197202925,3508.21274931775,1232.35663112211,1399.14558571852,1378.49263275578,329.755372813878,77.9205750537817,251.888491917416,877.575033309168,0],"age_5-11":[60509.2627355603,2611.17362346028,330.814216804578,99.6662405472174,292.372558925114,306.695926764282,295.575293225349,115.504985214986,726.399762509611,286.370169845978,157.774469623165,9887.19640902752,279.451872263342,753.955903126165,530.520159318832,517.481639014923,1218.05696974981,1070.35135440374,1541.93217308823,1858.56780841454,596.218921567719,415.029448929873,8022.68604159544,485.276936755855,476.098954308126,342.122715354301,206.730622686369,605.954904071356,622.464371631167,1554.71989067294,943.705685752396,1326.10710562038,1459.50485474255,8986.35587521167,1116.46725507321,1266.98207606025,1278.16359590753,790.403813069006,1165.46655415134,1011.56175389361,755.706428123224,896.077950353449,441.522127221396,264.004321358657,18544.9799385328,5583.57698085824,542.108804930334,456.32827256016,511.844247141325,495.852892120271,315.594326066112,216.026683939112,179.001840200209,381.44285165002,172.036578991373,864.802871860867,751.183503065664,1059.06132052711,1369.10648787227,207.012870602618,362.248911826955,2742.26833912396,1500.84305662565,834.639098570503,12456.8708477327,472.409635943267,184.291730583906,99.8673884197271,1174.03696539648,4421.1431687299,1710.72967462275,1714.27057313585,1813.75487935524,464.228074719536,83.5626232473673,318.57613357863,1105.63015915035,0],"age_12-18":[48481.3403305758,1958.94042203515,213.820958236128,59.5942469251403,217.841945237788,239.082113060888,306.671418232614,56.7809457032753,548.413104820172,211.928363569466,104.807326249674,7421.87230313733,186.751928173689,504.073333384895,392.121123671877,317.900101527776,737.057511518492,740.707028274335,1358.75011339243,1552.43958015148,351.178254845965,404.673393146555,6768.33886424081,473.078006716241,556.851999597625,265.602086185444,142.887237885861,468.734655253594,417.643190220397,1299.55535844777,772.335787054132,1095.42528756796,1276.22525531179,7230.55032279996,961.060630459814,955.149819349851,783.014192970496,533.375507701936,752.915209825412,810.491951449259,728.104218163011,1059.1599443419,324.571325665728,322.70752287255,15277.9758989624,4779.97905690999,480.613545303578,271.728852440499,268.358236992255,481.511917415235,232.420789846622,179.117602261072,172.512583462709,229.910759898642,105.194341294088,729.041039543619,777.174334920478,910.312280382213,1175.74926396458,176.666328966153,272.943495481486,2294.81035871949,1185.77661060306,554.154500556606,9823.66251940018,376.313527508867,242.21198876742,64.2824569138473,876.109835888471,3640.59944341149,1349.41643480817,1220.52445763172,1466.06576699949,260.666882107125,102.123036344213,225.348689019371,876.219935049841,0],"age_19-35":[86469.9332009094,3345.47654332088,313.253920609545,120.215980866231,444.760045993952,382.312837279279,489.660707377223,104.935506895294,947.220764213876,379.70750797577,163.409272109706,13454.418698869,394.053222482837,1053.76328312654,728.956244949557,618.13363932936,1366.4811713784,1301.31941094567,2157.08577622248,2751.3648990042,789.336309109724,568.834926023193,9636.38755544649,585.999502431119,538.012889360655,466.121588035067,208.013992800191,820.892815936346,744.076948093811,1644.10365916233,1238.61688336464,1461.74800193305,1928.80127432928,11161.3748631798,1223.96064585785,1356.22841740982,1614.1213213317,934.438112663385,1356.87055900965,1215.77545851135,1107.38558412555,1345.51806070228,650.45670528152,356.619998286742,33835.8315276601,12634.3084069307,712.979313761321,619.601168971088,678.095447619454,640.834438807262,338.195424036678,263.791377875398,236.19505707609,403.388878731254,218.059103307537,1296.52549862971,1102.34011256703,1960.56992240617,2963.7728940448,416.717859808625,619.208854569091,4775.34081958484,2649.65250029879,1306.2544486343,15036.4440124331,546.863835742065,222.466446204858,115.938002648189,1261.80358906871,5780.93282484167,2048.95213720335,1960.66799749697,2098.36153628723,446.157440113248,119.813689067574,434.486513759245,1725.08981629701,0],"age_36-54":[56827.2000221218,2252.34783040876,220.510435336955,95.5562924834146,307.164458948439,269.239869169705,346.088097318862,95.5959936559428,573.90132327048,218.071784526425,126.219575698532,8396.00444919233,265.557674645858,618.033075684672,341.224490349775,371.620702804005,842.374459735658,852.809159055933,1467.23895210109,1810.85139242404,509.593703037411,372.497199161592,6905.45754263775,440.324935558954,403.929191971424,328.170137324591,141.785318687246,626.598658318276,494.451133249436,1325.31136884532,808.917627187194,1205.46201528366,1130.50715621165,8463.86217878275,901.742067590212,1135.83537286555,1299.80300656528,786.706911417659,912.405997128443,992.693951533173,784.701789891259,908.379995055742,494.084285223943,247.508801511489,21829.6937277516,7907.22834363419,434.190992089521,369.46313194184,459.481664313568,354.84964870631,244.568897438242,173.689796131949,183.274776739289,320.830014949469,107.385890071048,1000.56470417811,769.926754480503,1337.75084601304,1734.7126108621,262.472230968891,454.987885525072,3112.71812541909,1797.21762014941,804.379794140003,8979.83429334858,325.423996322327,139.5351674421,101.015289436046,771.869810587607,3485.5288457536,1138.37338403719,1090.26251064534,1312.3922547814,302.916543644714,58.1935097039888,254.322980994266,944.203640192291,0],"age_55+":[30848.6232500229,1205.87388445394,133.252932898284,44.1819416858799,217.936491424285,152.286062387524,131.211424899813,64.396271940835,275.310825005645,86.9984499512371,100.29948426044,4289.88189623869,120.525437323266,274.094025359773,183.704200879786,170.149077843329,416.845668793515,401.448566978792,777.255633233517,845.513429805142,404.916785692135,226.008259476418,4143.68678021369,312.638845558641,260.830242086153,227.523246225956,72.9803170881164,340.014775831622,265.627469642092,899.087465331177,483.246768835749,648.56732504185,633.170324572332,5487.59140771307,521.440850150635,873.568795029255,744.329217706988,456.178799053811,499.95991794112,615.735030409562,541.580008803719,673.509050135435,320.629163815537,240.660574667007,10564.1765678198,3350.59444993994,315.385952151845,166.753545970961,291.921399264746,233.154333758431,201.38242376949,172.604234906124,123.998590631284,327.10030840125,96.4281461862474,514.537344482368,500.558883764993,735.650402812903,668.901575404721,158.701252885545,210.012537547922,1318.752327551,766.754547256647,410.984311133385,5157.41271358366,179.74936937483,94.7786043002946,73.4656650443969,372.155854433661,1905.54967729486,706.781681178703,520.802043006777,926.868427837002,210.630716473988,32.3496751553457,134.280999483801,469.420810853015,0]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_population","name":"Total","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"sex_male","name":"Male","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"sex_female","name":"Female","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"age_0-4","name":"0-4","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"age_5-11","name":"5-11","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"age_12-18","name":"12-18","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"age_19-35","name":"19-35","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"age_36-54","name":"36-54","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"age_55+","name":"55+","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Total Population","columns":["total_population"]},{"name":"Sex","columns":["sex_male","sex_female"]},{"name":"Age Group","columns":["age_0-4","age_5-11","age_12-18","age_19-35","age_36-54","age_55+"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"a1ce46963a380c0ba6721d0ce7140676"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-2-marital-status" class="level3" data-number="6.1.2">
<h3 data-number="6.1.2" class="anchored" data-anchor-id="table-2-marital-status"><span class="header-section-number">6.1.2</span> Table 2: Marital Status</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get marital status data</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>marital_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Marital Status"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape marital status data</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>marital_wide <span class="ot">&lt;-</span> marital_data <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, status) <span class="sc">%&gt;%</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> status,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"marital_"</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with total population</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>marital_full <span class="ot">&lt;-</span> total_population <span class="sc">%&gt;%</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(marital_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>marital_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(marital_full)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>marital_ordered <span class="ot">&lt;-</span> marital_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    total_population,</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    marital_defacto,</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    marital_married,</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">marital_never married</span><span class="st">`</span>,</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    marital_separated,</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    marital_widowed</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>  marital_ordered,</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"GenderProtection_01b_baseline_marital_status.csv"</span>),</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(marital_ordered)</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_population =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">marital_defacto =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Defacto"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">marital_married =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Married"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">marital_never married</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Never Married"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">marital_separated =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Separated"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">marital_widowed =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Widow"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Marital Status"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_population"</span>, <span class="st">"marital_defacto"</span>, <span class="st">"marital_married"</span>, <span class="st">"marital_never married"</span>, <span class="st">"marital_separated"</span>, <span class="st">"marital_widowed"</span>))</span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-bdf309dcf90f9d922c69" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bdf309dcf90f9d922c69">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo","luganville"],"total_population":[348052.878886167,13286.7717523727,1439.13464556176,478.808949433024,1712.08513698758,1588.68847204886,1836.24167878944,505.452383157247,3586.499645509,1410.71739912728,729.143441758482,70430.4751235044,1473.64619089702,3769.62188424037,2568.23581172683,2348.02855663561,5385.79622343122,5123.54881934176,8440.53089261334,10249.3026150994,3117.21473717594,2306.75070457123,41745.4100652423,2645.10505223571,2567.26198287333,1879.53843588359,913.813235198296,3350.35988042659,3032.31358416725,7934.75162543353,5029.19747204516,6762.75439616066,7630.31440081816,47625.9886857346,5488.43875478311,6406.6908905057,6582.92043905141,4053.30947912852,5529.91817138101,5329.04745680728,4513.88336760198,5559.5187269909,2537.43817757296,1624.82322191172,113793.897787538,38801.5043907089,2829.45074358279,2239.22502473362,1699.16581276072,2557.04851226475,1508.90770450048,1144.18153201921,1001.72014723783,1870.63754644804,807.585724309822,5055.7706354943,4405.19640161633,6888.0832089431,9144.25681252584,1410.42274951096,2204.51295765632,16493.9106462183,9125.80659223213,4606.5106447749,61170.3354717748,2246.28685916169,1013.60451821149,538.365576653472,5434.67125257786,22741.9667093492,8186.60994297228,7905.67316763517,8995.93549801614,2014.3550298725,473.963108572271,1618.90380875273,5998.13939485167,19649.6592929199],"marital_defacto":[41358.4162882693,909.768425080055,95.5536262828609,29.7971234625701,116.286444597005,168.203375420164,230.778932433566,22.8613151067404,131.965151958566,29.8004185204584,84.5220372981238,7682.36229516868,54.5582089891188,227.644149865582,13.4676949238559,46.5104473949658,444.480939143744,582.169160436253,997.141591520522,1249.21367762597,210.441177786544,166.148098934161,2584.08800394761,281.160612369748,334.198596265836,214.663784873358,83.0024454859018,189.436803677618,220.822836208486,537.608933449429,41.4274405360283,320.809727437973,360.956823643232,4027.76309034001,504.624127922743,765.144544809038,746.186779364219,83.755652064443,619.699603584875,312.50325386025,342.797173092023,447.11201234323,127.463233156177,78.4767101430132,20445.0082254626,7690.06677187301,293.049329931455,319.467690737972,208.141266740334,394.825824623026,171.016400500842,144.379643034683,95.5684079615243,261.262227157548,149.025316833291,752.120551037551,637.829397642225,969.60238590623,1946.21540252846,155.256454262985,413.147003211618,3305.63207737836,1719.44675040822,818.955323693237,5709.4262482704,96.6955741736556,27.6437595875859,64.2824569138473,843.9401410592,2298.06124330466,530.879348427939,598.728798446838,804.040858324037,305.819488403636,21.6055384002561,117.729041228743,459.084310701833,3231.50283784613],"marital_married":[99728.6806224758,4376.25029478109,367.700030253034,160.287974488308,627.946800823826,509.866481742372,532.566767154384,182.890520853924,1305.14985453527,520.797790333726,169.044074596248,21438.0366526588,554.82924395714,1352.4081021571,990.997884813732,861.304581388255,1731.97981334618,1529.66282154994,2375.66557200925,3114.92241693749,1210.03677227263,804.8472844473,13968.0080193225,734.362845906254,643.115029220781,533.489321900455,273.153502417241,1244.69694724076,1012.90474869545,2477.47136508643,1972.80328897432,2401.29493856764,2674.71603131316,15385.3990139031,1611.60591052006,1956.10048863343,2156.33589959522,1519.41343168188,1595.5962902387,1783.52617507314,1368.74885483719,1830.66463422936,1068.32586140177,495.081467692342,27535.8191672743,8570.7885297982,838.809215633759,618.651718571946,952.999007465179,651.188426027561,373.041269224364,316.983877940807,280.394102604095,535.065041218657,159.983060718092,1402.41972783717,1121.78555538632,1924.49153378657,1903.41007842593,379.882813622196,505.599479454778,3553.3082142956,2254.01451181203,1193.003003451,17025.1674745361,675.61323253801,311.97957248847,171.037251431487,1150.30197308754,6192.38059573112,2587.88836739257,2354.91914044981,2515.41541516556,471.943654943883,108.858674247444,484.829597060186,2105.15933918087,4806.22282059888],"marital_never married":[55564.4257318623,2016.43683631521,279.403641409378,79.1165002282035,256.841364588167,200.792779407821,297.610840468626,68.5839453202213,494.506778218364,204.345726997429,135.235259676998,10579.5642698497,228.404705429023,546.12167972679,384.951613240215,285.091816439512,594.065870586351,706.080394584153,1220.42364469827,1538.53372850471,363.595590508974,309.639638922755,5465.46456203894,450.812766575856,301.015756920292,239.119152770323,111.67601756285,450.5195779769,398.441204463138,985.812442517772,685.695567492883,875.059724628684,967.312351130244,7193.31414587471,720.03679913087,864.782532216603,949.69226464537,598.10125897301,762.386739200216,925.62750858226,860.042729643687,869.277860907654,365.306998117702,278.059454457343,21504.3280674122,8462.46446331542,399.828438003645,296.648569970974,331.193336385563,286.522907452127,264.981455721085,187.80209206767,199.251114712235,295.748841142344,107.385890071048,775.200062531483,673.815881166786,1408.05687907779,1843.48262468238,368.871717575176,435.297075644875,2932.71062122456,1582.22511522644,652.840981440566,8805.31785037165,360.410776465444,156.64797099632,53.951347766979,676.308195232373,3398.92890476797,1218.52843733124,999.901333438544,1332.24288204056,224.015921546696,114.67554997059,269.706530814938,816.286274376254,3586.36931283266],"marital_separated":[3254.60644989021,83.7331351641243,2.41907914640154,4.10994806380278,21.2349159698879,5.25635548188012,15.6637284457172,1.69343074864744,21.7524975755878,7.09533774296629,4.50784198923327,619.974832653884,2.7741462197857,14.5781967894215,17.9569265651412,15.5034824649886,29.9169862885213,39.5234108920025,81.8238579968161,93.2854369655758,21.0441177786544,9.70995383381461,225.015831553651,34.249026435975,10.2708788450493,16.3035785979766,3.77283843117736,9.7147078809035,6.40066191908655,49.4082608421795,27.14211621326,31.3983988556314,36.3553635324119,343.090561479016,36.8993927532441,61.0987658631296,37.0009973238456,32.2137123324781,28.120822347549,43.9643360944078,36.5975629635612,42.2165848564424,6.57026975031839,18.4081171940401,1505.21082796035,737.545600487085,26.1015597509798,7.60637358899934,7.85438742416356,6.85461501081643,15.0344088352389,11.9411734840715,19.8349525957881,7.31534236041133,5.47887194240042,38.0133130488293,21.0955248247428,45.6110378802627,136.025807703602,15.4155344658282,20.2239791781911,256.119641584871,107.390844924872,19.7478588691986,477.581261079181,6.27893338789972,1.31636950417076,3.44370304895611,60.1162840206553,147.929092009132,62.9454260999569,81.2041082913727,66.9055896707593,30.2043939164085,3.32392898465478,13.913432145215,68.7398967895792,225.118420069583],"marital_widowed":[7500.52944981691,331.243248028623,9.67631658560616,19.5222533030632,57.6376290611242,29.4355906985287,22.9734683870518,21.167884358093,91.360489817469,41.1529589092045,38.3166569084828,1432.40908925362,36.9886162638093,59.4341869107184,39.2807768612464,74.0721939993899,126.078727930197,80.1150220783835,194.158307111089,181.163022512857,67.8088239534421,26.9720939828184,929.721626991831,35.0455154228581,50.5643266217813,33.5129115625074,20.3733275283577,94.7184018388091,51.2052953526924,229.395496767262,127.139386472639,176.104063146802,111.662902278122,1118.02886057714,142.611166586862,144.757076044953,105.863964565447,104.157669875012,107.275729696205,153.281063680503,146.390251854245,103.622526465813,53.8762119526108,56.1931998554909,2353.18019160579,700.809612723361,81.8639828553457,53.2446151229954,60.2169702519206,56.2078430886947,73.2927430717895,19.5401020648443,36.0635501741601,50.1623476142491,32.8732316544025,105.894229207453,122.850409273502,203.042684757299,156.952855042618,16.5166440705303,44.3001448665139,299.744415700975,143.187793233162,96.4160168319697,1335.94643335991,31.3946669394986,3.94910851251228,4.59160406527481,119.076485656298,438.626958864288,198.337474692317,118.776158396336,320.442561054689,59.1502714196333,11.6337514462917,29.9673923127709,99.4273507134986,446.909966936167]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_population","name":"Total","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"marital_defacto","name":"Defacto","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"marital_married","name":"Married","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"marital_never married","name":"Never Married","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"marital_separated","name":"Separated","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"marital_widowed","name":"Widow","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Marital Status","columns":["total_population","marital_defacto","marital_married","marital_never married","marital_separated","marital_widowed"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"89fbdb401bda176ec41389bb57f7ed4f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-3-employment-status" class="level3" data-number="6.1.3">
<h3 data-number="6.1.3" class="anchored" data-anchor-id="table-3-employment-status"><span class="header-section-number">6.1.3</span> Table 3: Employment Status</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get employment status data</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>employment_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Employment Status"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape employment status data</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>employment_wide <span class="ot">&lt;-</span> employment_data <span class="sc">%&gt;%</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, status) <span class="sc">%&gt;%</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> status,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"employ_"</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with total population</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>employment_full <span class="ot">&lt;-</span> total_population <span class="sc">%&gt;%</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(employment_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>employment_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(employment_full)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>employment_ordered <span class="ot">&lt;-</span> employment_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>    total_population,</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    employ_government,</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>    employ_private,</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    employ_employer,</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">employ_self-employed</span><span class="st">`</span>,</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    employ_voluntary,</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>    employ_unpaid,</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">employ_own consumption</span><span class="st">`</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 3 TO CSV ===</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>  employment_ordered,</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"GenderProtection_01c_baseline_employment_status.csv"</span>),</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 3 ===</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>formatted3 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(employment_ordered)</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>  formatted3,</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_population =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">employ_government =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Government"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">employ_private =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Private"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">employ_employer =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Employer"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">employ_self-employed</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Self Employed"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">employ_voluntary =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Voluntary"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">employ_unpaid =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Unpaid"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">employ_own consumption</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Own Consumption"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Employment Status"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_population"</span>, <span class="st">"employ_government"</span>, <span class="st">"employ_private"</span>, <span class="st">"employ_employer"</span>, <span class="st">"employ_self-employed"</span>, <span class="st">"employ_voluntary"</span>, <span class="st">"employ_unpaid"</span>, <span class="st">"employ_own consumption"</span>))</span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-73079dc42986469c5ef6" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-73079dc42986469c5ef6">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo","luganville"],"total_population":[348052.878886167,13286.7717523727,1439.13464556176,478.808949433024,1712.08513698758,1588.68847204886,1836.24167878944,505.452383157247,3586.499645509,1410.71739912728,729.143441758482,70430.4751235044,1473.64619089702,3769.62188424037,2568.23581172683,2348.02855663561,5385.79622343122,5123.54881934176,8440.53089261334,10249.3026150994,3117.21473717594,2306.75070457123,41745.4100652423,2645.10505223571,2567.26198287333,1879.53843588359,913.813235198296,3350.35988042659,3032.31358416725,7934.75162543353,5029.19747204516,6762.75439616066,7630.31440081816,47625.9886857346,5488.43875478311,6406.6908905057,6582.92043905141,4053.30947912852,5529.91817138101,5329.04745680728,4513.88336760198,5559.5187269909,2537.43817757296,1624.82322191172,113793.897787538,38801.5043907089,2829.45074358279,2239.22502473362,1699.16581276072,2557.04851226475,1508.90770450048,1144.18153201921,1001.72014723783,1870.63754644804,807.585724309822,5055.7706354943,4405.19640161633,6888.0832089431,9144.25681252584,1410.42274951096,2204.51295765632,16493.9106462183,9125.80659223213,4606.5106447749,61170.3354717748,2246.28685916169,1013.60451821149,538.365576653472,5434.67125257786,22741.9667093492,8186.60994297228,7905.67316763517,8995.93549801614,2014.3550298725,473.963108572271,1618.90380875273,5998.13939485167,19649.6592929199],"employ_government":[11392.3281945444,287.256508023608,24.7775963176616,4.10994806380278,15.2440630096476,26.3690064366195,115.231920763325,8.81533879772485,74.9011849819285,15.5535286582812,2.25392099461664,2214.70639066401,29.7181757191045,58.438580935577,6.6700881242021,29.0620750680264,69.953894518392,87.3901164989329,199.0501510165,363.773850789694,71.4543754258918,35.6738986801133,796.837598002056,58.3703215535557,60.3833954083604,126.969720532261,8.34056681507336,68.0029551663245,65.6067846706371,151.823906401279,90.5269679703137,55.0328224701853,111.780157014066,1125.72716917681,108.961919632573,132.061217012654,319.338242941685,47.3289243929045,97.6143649701726,90.6124567668014,115.623309982721,123.351473117307,36.793510601783,54.0417497582133,5639.24751551571,2948.13594714772,76.4303562972461,35.5799510543319,35.344743408736,32.8638775660073,38.3080578433415,30.3957143230911,29.7410136578986,41.8019563452076,19.7239389926415,166.987053750214,122.144982422648,150.958287566319,558.629982264061,98.998325301626,84.1687660369129,673.469302039336,419.156394662634,76.4088648357398,1328.55301316216,69.7397721385575,10.5309560333661,8.03530711423091,70.3949342321734,819.981054862349,66.5763400940509,60.2087214390587,113.195620093606,45.1369843374925,8.99581163619769,55.7575111810735,53.312566222822,1210.20861766475],"employ_private":[21410.1476345087,298.888610297968,10.7512800937834,6.16492209570417,10.8317675016696,11.1889261881493,105.414351924455,5.37263007322825,133.581059120156,14.4567128035136,1.12696049730832,4814.14383790279,24.5183126468087,12.2768210916885,26.743676685203,22.1769885788887,42.8170587156327,215.533981344571,316.654640255302,819.407991589487,65.9144608745659,46.9092319194165,561.787070436631,53.0416617701774,18.2101724160429,43.4719131644236,2.02371720584213,83.7893554727927,70.407281109952,92.8847601834621,32.5387510522226,53.9722066583274,111.447251403388,815.398007002206,40.3979149131376,141.62930097272,368.84515624325,30.3457531845206,33.0817012556017,41.7707343560363,41.2013487848953,43.6890641616417,53.8762119526108,20.5608211777916,13744.4059461277,6445.59579644388,13.2381359224257,11.6799117067343,3.92719371208178,8.66314950023968,14.1565647071408,10.8556122582468,20.666192147243,41.8019563452076,1.09577438848008,496.888306281126,153.962920946968,969.399439285454,1448.90895586513,72.8391105104439,461.026819448773,2313.89349445194,982.528052955666,273.278559250483,1175.52416274149,54.7609894436886,7.89821702502455,8.03530711423091,36.0778939504151,765.781002939865,64.7702728609276,45.0009075766083,68.1047978366648,49.4564740822341,8.32536814010969,67.3129317717195,323.978248507544,2897.21242569368],"employ_employer":[3503.02571144868,59.4497542912183,0,1.02748701595069,12.111173681745,2.11684301382049,9.23849186483283,1.77319188469224,33.182566830177,0,0,707.65720959747,0,2.17756534351493,3.38382551869242,4.18690555885604,16.2801266238695,24.8733314094855,34.7615960664449,123.750163619892,8.1612633693122,7.42145722877183,208.849892036744,37.3051062650043,0,6.2929102749588,0,3.64301545533881,70.407281109952,19.9255825208865,14.2957141099971,19.6742595573038,37.3060227433029,237.963616879248,25.8764256713231,10.7733821376287,87.5969812493989,4.78949644913776,4.2197348878113,10.9407588372015,33.5310343546199,15.2205690002525,10.5124316005094,34.5028026913648,1888.71391521631,1306.27387296212,7.17845941884739,2.7142394580787,6.54532285346963,1.56700747529782,4.78148741827167,4.34224490329873,0.848639634275508,18.8108803553434,3.28732316544025,70.5961528049687,17.3350571840531,35.584689267788,102.949889627425,53.6851331743204,8.26659367444155,126.56313519232,84.5934385349878,32.7903481115614,400.391323427692,6.40475869740534,2.63273900834152,9.18320813054962,49.5752854398324,235.21619489151,24.4659259725373,40.6593362926833,13.9933721058506,12.5252409141835,0.66130943734903,5.07395253744973,122.51351988701,360.147454971621],"employ_self-employed":[22732.5078461825,524.73730905538,8.51787651888039,6.16492209570417,72.3578936913508,109.056870900821,69.1603521388267,1.79629372044599,172.945994983147,80.2292630169708,4.50784198923327,7500.39287648895,20.8341179921238,429.488986651723,187.068765725757,168.577734025333,233.959031079668,547.809325536101,1146.88629852167,1131.29180028187,625.630011345677,344.202316869142,1850.51392628572,193.346617620421,279.543109078102,59.5753518228668,6.02829787911511,26.7154466724846,184.019030173738,248.881097783279,380.572492513803,155.621061634862,316.21142110705,3224.94527059778,388.093737542878,501.066441529027,433.767860089801,388.195874781088,674.425043386556,236.887254669951,324.211118691475,98.1652504094125,23.6529711011462,156.479718396442,7986.43706764551,1722.35401889744,453.139795930474,392.429563756796,15.7087748483271,4.47222786730312,365.310924613563,175.860918583598,23.8300555815871,51.2073965228793,21.9154877696017,746.690077744861,219.769883003528,644.843527593934,378.798848221633,44.6183180663401,61.4492733184278,976.993376442409,1172.26853655874,514.776062324071,1645.48139610917,106.079264834449,19.7455425625614,20.6622182937366,17.1272097829528,714.139535749099,375.117136776971,34.96959949668,41.2316843236311,169.494104038222,4.95125410120422,141.963846149666,1777.72931801969,886.915170440198],"employ_voluntary":[2061.70918982367,99.349653211265,0,4.10994806380278,38.0755068361882,1.00231053008215,16.5507318215365,2.6515538160283,27.701048305723,1.36983035674584,7.88872348115823,317.013684667801,4.84164138000287,24.3687826334763,0,10.4006057325922,13.0503992100796,45.2852320719712,48.2598305528338,54.3318934021798,17.9472871436425,6.99697980244587,598.725238611398,52.8798315085677,10.1589290061182,36.3652098280383,2.36868709005396,35.2158160682752,6.40066191908655,34.2102717414723,33.7915992579687,349.969619305737,37.3646128860796,284.41560545537,23.5662723971516,63.812711780114,16.9723239910032,4.41832886379363,77.9774590623896,2.37054651128872,3.55037315182096,29.3519944433326,52.5621580025471,9.83343725192826,560.133060496281,116.841012259989,7.23139048358336,2.51713308439595,0,1.33033384578208,2.79486690150281,5.42780612912341,0.975284499561429,2.09009781726038,2.19154877696017,10.8609465853798,16.1460830632407,251.109448768152,23.3626514303991,19.8858933417869,7.49815616937915,47.548339056162,36.4215206032352,5.90054768038791,202.071947381553,15.6240143895865,3.94910851251228,2.2958020326374,16.2930935160198,93.6875116784689,16.20980364442,12.0217173439701,27.1050639163713,11.1970613250263,0,3.68877102254091,6.067845986894,85.4631867516833],"employ_unpaid":[9171.61055831158,583.039001906487,14.487518870518,13.357331207359,71.9797728598313,99.3411552748315,48.3797623454008,0,244.444798883208,78.6520969949469,12.3965654703915,1207.54972780417,142.924689555959,257.575625722391,4.31766140788205,16.7568194142633,114.708612758636,114.05613287511,36.1299170440483,133.225560001604,51.7192771247676,189.831989393568,1789.88676463176,42.8210411326675,24.973252202847,96.8979276639044,54.1059901097519,274.440497635524,33.6034750752044,131.571241484287,888.940666597912,141.510174241475,101.022498488185,3559.86439821709,480.471566072102,319.094623828166,302.047032609306,8.45904604416702,229.516932071605,54.4750898447856,404.695363411144,1589.01592202322,148.488096357196,23.6007259553987,1640.91455967472,282.990260395805,7.16340789182021,0,0,24.0234890528722,0.821562417300868,37.9946429038639,5.96924993437571,31.3514672589057,61.3633657548847,147.9803972258,98.0014754290006,8.70706674368439,11.8069750861529,8.27926321705841,3.82077228050358,529.334279305333,205.842810400496,175.464074376863,390.35610607735,39.3699250128305,1.31636950417076,4.59160406527481,39.267962036947,88.9023839048883,26.2614368917149,18.6755508186614,150.920488632217,16.6963130206361,0,4.35407219000954,25.2200344240375,121.083408081902],"employ_own consumption":[18847.1696681762,899.703213368882,10.8751032125257,95.5562924834146,135.57320424136,112.60010085816,80.3164183171284,0,180.553392637345,128.7081529904,155.520548628548,6325.31444684683,108.084386337815,775.540367049572,252.139534606466,391.275652661714,1062.29614307063,516.634088571128,832.942892894676,536.211480336745,713.390500349629,432.330908511284,3764.49263217526,87.4164938701487,144.973100592698,92.8348995828924,359.006907845755,1170.62229964887,400.041369942909,368.130576573649,422.646254906022,63.6229725276911,655.197756684625,4214.33598456439,957.498927381249,557.51086396762,510.145792275298,222.324533898139,35.0932881461702,54.5278201366705,1074.8735457674,589.710370155616,157.686474007641,54.9643688285898,1598.22351653236,192.641629394808,221.281482442625,17.5346744675283,7.85438742416356,13.2751999832109,4.17643034005188,146.550765486332,4.70018366149147,22.9910759898642,122.726731509769,58.3775878964164,102.884529901368,30.2483426986309,29.46048924279,10.2409489022322,6.64467885130462,189.422804380154,143.323258148179,273.888315811441,2045.09987468845,206.191186809302,155.33160149215,9.18320813054962,78.9900560807105,906.796118525086,27.9734073106257,55.1374470469253,539.240290493999,55.3903215302317,0.802336740033638,10.0639005288391,520.075857070902,184.392635386265]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_population","name":"Total","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"employ_government","name":"Government","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"employ_private","name":"Private","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"employ_employer","name":"Employer","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"employ_self-employed","name":"Self Employed","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"employ_voluntary","name":"Voluntary","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"employ_unpaid","name":"Unpaid","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"employ_own consumption","name":"Own Consumption","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Employment Status","columns":["total_population","employ_government","employ_private","employ_employer","employ_self-employed","employ_voluntary","employ_unpaid","employ_own consumption"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"2d47ae3801134b93a380139f4dc694c9"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="immediate-response-resources-2" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="immediate-response-resources-2"><span class="header-section-number">6.2</span> Immediate Response Resources</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Resources needed for Gender &amp; Protection</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration parameters</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>days_of_support <span class="ot">&lt;-</span> <span class="dv">14</span>  <span class="co"># Number of days to provide resources (adjust as needed)</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get resource multipliers</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>get_gender_protection_resource_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> resource_type,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(multiplier) <span class="sc">&gt;</span> <span class="dv">0</span>, multiplier, <span class="dv">0</span>))</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories to population data</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>population_with_config <span class="ot">&lt;-</span> population_full <span class="sc">%&gt;%</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate resources needed based on total population in affected areas</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>resources_needed <span class="ot">&lt;-</span> population_with_config <span class="sc">%&gt;%</span></span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total population affected</span></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_affected =</span> total_population,</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Resources = population * resource multiplier * days of support</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">water =</span> <span class="fu">ceiling</span>(total_population <span class="sc">*</span> <span class="fu">get_gender_protection_resource_multiplier</span>(<span class="st">"Water"</span>, Region) <span class="sc">*</span> days_of_support),</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">tin_fish =</span> <span class="fu">round</span>(total_population <span class="sc">*</span> <span class="fu">get_gender_protection_resource_multiplier</span>(<span class="st">"Tin Fish"</span>, Region) <span class="sc">*</span> days_of_support, <span class="dv">0</span>),</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">rice =</span> <span class="fu">round</span>(total_population <span class="sc">*</span> <span class="fu">get_gender_protection_resource_multiplier</span>(<span class="st">"Rice"</span>, Region) <span class="sc">*</span> days_of_support, <span class="dv">0</span>)</span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, population_affected, water, tin_fish, rice)</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(resources_needed)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>  resources_needed_full,</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"GenderProtection_02_resources_needed.csv"</span>),</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_affected =</span> <span class="fu">colDef</span>(</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Population"</span>, </span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">water =</span> <span class="fu">colDef</span>(</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Water (litres)"</span>, </span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">tin_fish =</span> <span class="fu">colDef</span>(</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Tin Fish (kg)"</span>, </span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">rice =</span> <span class="fu">colDef</span>(</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Rice (kg)"</span>, </span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Resources Needed"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"population_affected"</span>, <span class="st">"water"</span>, <span class="st">"tin_fish"</span>, <span class="st">"rice"</span>))</span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-afd3673a90b5272aef7e" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-afd3673a90b5272aef7e">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"population_affected":[222590.221945048,47625.9886857346,5488.43875478311,6406.6908905057,6582.92043905141,4053.30947912852,5529.91817138101,5329.04745680728,4513.88336760198,5559.5187269909,2537.43817757296,1624.82322191172,113793.897787538,38801.5043907089,2829.45074358279,2239.22502473362,1699.16581276072,2557.04851226475,1508.90770450048,1144.18153201921,1001.72014723783,1870.63754644804,807.585724309822,5055.7706354943,4405.19640161633,6888.0832089431,9144.25681252584,1410.42274951096,2204.51295765632,16493.9106462183,9125.80659223213,4606.5106447749,61170.3354717748,2246.28685916169,1013.60451821149,538.365576653472,5434.67125257786,22741.9667093492,8186.60994297228,7905.67316763517,8995.93549801614,2014.3550298725,473.963108572271,1618.90380875273],"water":[1558154,333388,38420,44847,46081,28374,38710,37304,31598,38917,17763,11374,796568,271611,19807,15675,11895,17900,10563,8010,7013,13095,5654,35391,30837,48217,64010,9873,15432,115458,63881,32246,428198,15725,7096,3769,38043,159194,57307,55340,62972,14101,3318,11333],"tin_fish":[1246503,266706,30735,35877,36864,22699,30968,29843,25278,31133,14210,9099,637244,217288,15845,12540,9515,14319,8450,6407,5610,10476,4522,28312,24669,38573,51208,7898,12345,92366,51105,25796,342553,12579,5676,3015,30434,127355,45845,44272,50377,11280,2654,9066],"rice":[623256,133354,15368,17939,18432,11349,15484,14921,12639,15567,7105,4550,318624,108644,7922,6270,4758,7160,4225,3204,2805,5238,2261,14156,12335,19287,25604,3949,6173,46183,25552,12898,171278,6290,2838,1507,15217,63678,22923,22136,25189,5640,1327,4533]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"population_affected","name":"Total Population","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"water","name":"Water (litres)","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"tin_fish","name":"Tin Fish (kg)","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"rice","name":"Rice (kg)","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Resources Needed","columns":["population_affected","water","tin_fish","rice"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"8b71a2f03f3d4bbec0e2707049a294dd"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="health" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Health</h1>
<section id="baseline-health" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="baseline-health"><span class="header-section-number">7.1</span> Baseline: Health</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get health facility data</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>health_facility_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Health"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Health Facility"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape health facility data</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>facility_wide <span class="ot">&lt;-</span> health_facility_data <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">facility_type =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, facility_type) <span class="sc">%&gt;%</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> facility_type,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"facility_"</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Get health professionals data</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>health_professionals_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Health"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Health Professionals"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape health professionals data</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>professionals_wide <span class="ot">&lt;-</span> health_professionals_data <span class="sc">%&gt;%</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">professional_type =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, professional_type) <span class="sc">%&gt;%</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> professional_type,</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"prof_"</span></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Get hospital staff data</span></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>hospital_staff_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Health"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Hospital Staff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape hospital staff data</span></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>hospital_staff_wide <span class="ot">&lt;-</span> hospital_staff_data <span class="sc">%&gt;%</span></span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">staff_type =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, staff_type) <span class="sc">%&gt;%</span></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> staff_type,</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"staff_"</span></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all health data</span></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>health_full <span class="ot">&lt;-</span> facility_wide <span class="sc">%&gt;%</span></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(professionals_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(hospital_staff_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>health_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(health_full)</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to client's specification</span></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>health_ordered <span class="ot">&lt;-</span> health_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Facility</span></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>    facility_hospital,</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">facility_health centre</span><span class="st">`</span>,</span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>    facility_dispensary,</span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>    facility_aidpost,</span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Professional</span></span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>    prof_doctor,</span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_nurse practitioner</span><span class="st">`</span>,</span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_registered nurse</span><span class="st">`</span>,</span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>    prof_midwife,</span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_nurse aid</span><span class="st">`</span>,</span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Hospital Staff</span></span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_clinical medical services</span><span class="st">`</span>,</span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_nonclinical medical services</span><span class="st">`</span>,</span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_clinical nursing services</span><span class="st">`</span>,</span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_nonclinical nursing services</span><span class="st">`</span>,</span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_pharmacy services</span><span class="st">`</span></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a>  health_ordered,</span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Health_01_baseline.csv"</span>),</span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(health_ordered)</span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Facility</span></span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_hospital =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Hospital"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">facility_health centre</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Health Centre"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_dispensary =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Dispensary"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_aidpost =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Aidpost"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Professional</span></span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">prof_doctor =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Doctor"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_nurse practitioner</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Nurse Practitioner"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_registered nurse</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Registered Nurse"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a>    <span class="at">prof_midwife =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Midwife"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_nurse aid</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Nurse Aid"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Hospital Staff</span></span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_clinical medical services</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Clinical Medical"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_nonclinical medical services</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Nonclinical Medical"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-133"><a href="#cb28-133" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_clinical nursing services</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Clinical Nursing"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-134"><a href="#cb28-134" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_nonclinical nursing services</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Nonclinical Nursing"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_pharmacy services</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Pharmacy"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb28-136"><a href="#cb28-136" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb28-137"><a href="#cb28-137" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Health Facility"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"facility_hospital"</span>, <span class="st">"facility_health centre"</span>, <span class="st">"facility_dispensary"</span>, <span class="st">"facility_aidpost"</span>)),</span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Health Professional"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"prof_doctor"</span>, <span class="st">"prof_nurse practitioner"</span>, <span class="st">"prof_registered nurse"</span>, <span class="st">"prof_midwife"</span>, <span class="st">"prof_nurse aid"</span>)),</span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Hospital Staff"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"staff_clinical medical services"</span>, <span class="st">"staff_nonclinical medical services"</span>, <span class="st">"staff_clinical nursing services"</span>, <span class="st">"staff_nonclinical nursing services"</span>, <span class="st">"staff_pharmacy services"</span>))</span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb28-147"><a href="#cb28-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb28-148"><a href="#cb28-148" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb28-150"><a href="#cb28-150" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb28-151"><a href="#cb28-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb28-152"><a href="#cb28-152" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb28-153"><a href="#cb28-153" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb28-154"><a href="#cb28-154" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb28-155"><a href="#cb28-155" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb28-156"><a href="#cb28-156" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb28-157"><a href="#cb28-157" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-843886aea60569e45715" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-843886aea60569e45715">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"facility_hospital":[6,1,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0],"facility_health centre":[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"facility_dispensary":[47,1,0,0,0,1,0,0,0,0,0,7,0,1,0,1,1,2,0,0,0,1,6,0,0,0,0,0,1,2,1,1,1,12,2,1,2,1,2,2,0,1,0,1,9,1,0,0,0,1,1,1,1,0,2,0,0,0,1,1,0,0,12,3,0,1,1,0,1,2,1,1,1,1,1],"facility_aidpost":[169,20,2,1,2,5,3,0,4,2,1,33,0,4,4,0,2,12,1,5,1,2,30,4,6,1,1,2,2,1,1,5,7,26,4,4,4,4,3,2,1,1,1,2,25,5,3,0,3,0,1,2,2,2,2,1,0,1,0,1,1,1,35,0,1,0,4,8,6,7,4,3,2,0,2],"prof_doctor":[3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"prof_nurse practitioner":[14,1,0,0,0,0,1,0,0,0,0,4,0,1,0,0,0,1,0,0,1,0,3,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,3,1,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,3,2,0,0,0,0,0,0,1,0,0,0,1],"prof_registered nurse":[76,2,1,0,0,0,0,0,0,1,0,14,1,3,0,0,2,4,2,0,1,1,13,2,0,0,0,2,1,3,1,2,2,20,2,3,2,3,2,2,0,2,2,2,18,3,1,1,1,1,2,1,1,1,2,1,1,0,1,1,0,0,9,1,0,1,1,0,1,2,1,0,1,1,0],"prof_midwife":[21,3,0,0,1,1,0,0,1,0,0,4,0,1,0,0,0,0,1,0,1,0,4,1,0,0,0,1,0,1,0,0,1,3,0,0,0,0,0,1,1,1,0,0,5,0,1,0,0,0,0,1,0,0,0,1,1,0,0,1,0,0,2,0,0,0,0,0,0,0,1,1,0,0,1],"prof_nurse aid":[92,4,0,1,0,1,0,1,0,0,1,19,0,3,0,0,4,4,4,0,0,2,19,1,2,0,0,1,2,6,2,2,3,23,3,2,3,3,3,3,2,2,1,1,14,2,1,1,0,1,2,1,1,0,2,1,1,0,1,0,0,0,13,3,0,1,1,1,1,2,1,1,1,1,2],"staff_clinical medical services":[185,1,0,0,0,0,1,0,0,0,0,32,32,0,0,0,0,0,0,0,0,0,3,0,0,3,0,0,0,0,0,0,0,3,0,0,3,0,0,0,0,0,0,0,143,143,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,3,0,0,0,0,0,0,0],"staff_nonclinical medical services":[13,2,0,0,0,0,2,0,0,0,0,3,3,0,0,0,0,0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0,2,0,0,2,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,0,0,0],"staff_clinical nursing services":[739,32,0,0,0,0,32,0,0,0,0,243,243,0,0,0,0,0,0,0,0,0,66,0,0,66,0,0,0,0,0,0,0,72,0,0,72,0,0,0,0,0,0,0,253,253,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,73,0,0,0,0,73,0,0,0,0,0,0,0],"staff_nonclinical nursing services":[7,1,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0],"staff_pharmacy services":[81,10,0,0,0,0,10,0,0,0,0,20,20,0,0,0,0,0,0,0,0,0,10,0,0,10,0,0,0,0,0,0,0,10,0,0,10,0,0,0,0,0,0,0,21,21,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,10,0,0,0,0,0,0,0]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"facility_hospital","name":"Hospital","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"facility_health centre","name":"Health Centre","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"facility_dispensary","name":"Dispensary","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"facility_aidpost","name":"Aidpost","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"prof_doctor","name":"Doctor","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"prof_nurse practitioner","name":"Nurse Practitioner","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"prof_registered nurse","name":"Registered Nurse","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"prof_midwife","name":"Midwife","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"prof_nurse aid","name":"Nurse Aid","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"staff_clinical medical services","name":"Clinical Medical","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"staff_nonclinical medical services","name":"Nonclinical Medical","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"staff_clinical nursing services","name":"Clinical Nursing","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"staff_nonclinical nursing services","name":"Nonclinical Nursing","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"staff_pharmacy services","name":"Pharmacy","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Health Facility","columns":["facility_hospital","facility_health centre","facility_dispensary","facility_aidpost"]},{"name":"Health Professional","columns":["prof_doctor","prof_nurse practitioner","prof_registered nurse","prof_midwife","prof_nurse aid"]},{"name":"Hospital Staff","columns":["staff_clinical medical services","staff_nonclinical medical services","staff_clinical nursing services","staff_nonclinical nursing services","staff_pharmacy services"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"3a858b4aba87d195e3535f4c751640d5"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimated-hazard-damage-1" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="estimated-hazard-damage-1"><span class="header-section-number">7.2</span> Estimated Hazard Damage</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to baseline values</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>health_with_config <span class="ot">&lt;-</span> health_full <span class="sc">%&gt;%</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for health damage multipliers (council-specific)</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>get_health_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, indicator_type, attribute_type, area_council) {</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Health"</span>,</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator_type,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute_type)),</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if we got any results</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the value from the intensity column</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates for Health Facilities only</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep UNROUNDED values for aggregation first</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>damage_estimates_raw <span class="ot">&lt;-</span> health_with_config <span class="sc">%&gt;%</span></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Facility Damage - keep as decimals for now</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_hospital_damaged =</span> facility_hospital <span class="sc">*</span> <span class="fu">get_health_damage_multiplier</span>(Intensity, <span class="st">"Health Facility"</span>, <span class="st">"hospital"</span>, Region),</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">facility_health centre</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_health_damage_multiplier</span>(Intensity, <span class="st">"Health Facility"</span>, <span class="st">"health centre"</span>, Region),</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_dispensary_damaged =</span> facility_dispensary <span class="sc">*</span> <span class="fu">get_health_damage_multiplier</span>(Intensity, <span class="st">"Health Facility"</span>, <span class="st">"dispensary"</span>, Region),</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_aidpost_damaged =</span> facility_aidpost <span class="sc">*</span> <span class="fu">get_health_damage_multiplier</span>(Intensity, <span class="st">"Health Facility"</span>, <span class="st">"aidpost"</span>, Region)</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, facility_hospital_damaged, <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span>, </span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>         facility_dispensary_damaged, facility_aidpost_damaged)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels FIRST</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>damage_estimates_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(damage_estimates_raw)</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a><span class="co"># NOW round all values (council, province, and national)</span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>damage_estimates_full <span class="ot">&lt;-</span> damage_estimates_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_hospital_damaged =</span> <span class="fu">round</span>(facility_hospital_damaged, <span class="dv">0</span>),</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_dispensary_damaged =</span> <span class="fu">round</span>(facility_dispensary_damaged, <span class="dv">0</span>),</span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_aidpost_damaged =</span> <span class="fu">round</span>(facility_aidpost_damaged, <span class="dv">0</span>)</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>  damage_estimates_full,</span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Health_02_damage_estimates.csv"</span>),</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(damage_estimates_full)</span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Facility - showing as whole numbers</span></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_hospital_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Hospital"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Health Centre"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_dispensary_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Dispensary"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_aidpost_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Aidpost"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Health Facility"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"facility_hospital_damaged"</span>, <span class="st">"facility_health centre_damaged"</span>, <span class="st">"facility_dispensary_damaged"</span>, <span class="st">"facility_aidpost_damaged"</span>))</span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-f0607bbe23c68d2f1f7b" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f0607bbe23c68d2f1f7b">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"facility_hospital_damaged":[1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"facility_health centre_damaged":[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"facility_dispensary_damaged":[14,1,0,0,0,0,0,0,0,0,0,0,6,1,0,0,0,1,1,1,1,0,1,0,0,0,1,1,0,0,6,2,0,0,0,0,0,1,0,0,0,0],"facility_aidpost_damaged":[38,3,0,0,0,0,0,0,0,0,0,0,18,4,2,0,2,0,1,1,1,1,1,1,0,1,0,1,1,1,18,0,0,0,2,4,3,4,2,2,1,0]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"facility_hospital_damaged","name":"Hospital","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"facility_health centre_damaged","name":"Health Centre","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"facility_dispensary_damaged","name":"Dispensary","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"facility_aidpost_damaged","name":"Aidpost","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Health Facility","columns":["facility_hospital_damaged","facility_health centre_damaged","facility_dispensary_damaged","facility_aidpost_damaged"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"e699da62d787088c3d2354b31b1e7108"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="immediate-response-resources-3" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="immediate-response-resources-3"><span class="header-section-number">7.3</span> Immediate Response Resources</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get resource multipliers from config</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>get_health_resource_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Health"</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> resource_type,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(multiplier) <span class="sc">&gt;</span> <span class="dv">0</span>, multiplier, <span class="dv">0</span>))</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total damaged facilities (this is what we need for resources)</span></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>health_facilities_damaged <span class="ot">&lt;-</span> damage_estimates_raw <span class="sc">%&gt;%</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total damaged facilities</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_facilities_damaged =</span> facility_hospital_damaged <span class="sc">+</span> <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span> <span class="sc">+</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>                                 facility_dispensary_damaged <span class="sc">+</span> facility_aidpost_damaged</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_facilities_damaged)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate resources needed based on FACILITIES with multipliers from config</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>resources_needed <span class="ot">&lt;-</span> health_facilities_damaged <span class="sc">%&gt;%</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ALL resources based on damaged facilities with multipliers from config file</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">medical_tent =</span> <span class="fu">round</span>(<span class="fu">get_health_resource_multiplier</span>(<span class="st">"Medical Tent"</span>, Region) <span class="sc">*</span> total_facilities_damaged, <span class="dv">0</span>),</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">emergency_health_kits =</span> <span class="fu">round</span>(<span class="fu">get_health_resource_multiplier</span>(<span class="st">"Emergency Health Kits"</span>, Region) <span class="sc">*</span> total_facilities_damaged, <span class="dv">0</span>),</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">trauma_surgical_kits =</span> <span class="fu">round</span>(<span class="fu">get_health_resource_multiplier</span>(<span class="st">"Trauma and Surgical Kits"</span>, Region) <span class="sc">*</span> total_facilities_damaged, <span class="dv">0</span>),</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">essential_ncd_medicines =</span> <span class="fu">round</span>(<span class="fu">get_health_resource_multiplier</span>(<span class="st">"Essential NCD Medicines"</span>, Region) <span class="sc">*</span> total_facilities_damaged, <span class="dv">0</span>),</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">mosquito_nets =</span> <span class="fu">round</span>(<span class="fu">get_health_resource_multiplier</span>(<span class="st">"Mosquito Nets"</span>, Region) <span class="sc">*</span> total_facilities_damaged, <span class="dv">0</span>)</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, medical_tent, emergency_health_kits, trauma_surgical_kits,</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>         essential_ncd_medicines, mosquito_nets)</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(resources_needed)</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>  resources_needed_full,</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Health_03_resources_needed.csv"</span>),</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the resources needed reactable</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">medical_tent =</span> <span class="fu">colDef</span>(</span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Medical Tent"</span>,</span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">emergency_health_kits =</span> <span class="fu">colDef</span>(</span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Emergency Health Kits"</span>,</span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">trauma_surgical_kits =</span> <span class="fu">colDef</span>(</span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Trauma and Surgical Kits"</span>,</span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">essential_ncd_medicines =</span> <span class="fu">colDef</span>(</span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Essential NCD Medicines"</span>,</span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">mosquito_nets =</span> <span class="fu">colDef</span>(</span>
<span id="cb30-86"><a href="#cb30-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Mosquito Nets"</span>,</span>
<span id="cb30-87"><a href="#cb30-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb30-88"><a href="#cb30-88" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb30-89"><a href="#cb30-89" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb30-90"><a href="#cb30-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb30-91"><a href="#cb30-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb30-92"><a href="#cb30-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Resources Needed"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"medical_tent"</span>, <span class="st">"emergency_health_kits"</span>, <span class="st">"trauma_surgical_kits"</span>, <span class="st">"essential_ncd_medicines"</span>, <span class="st">"mosquito_nets"</span>))</span>
<span id="cb30-93"><a href="#cb30-93" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb30-94"><a href="#cb30-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-95"><a href="#cb30-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-96"><a href="#cb30-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-97"><a href="#cb30-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb30-98"><a href="#cb30-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb30-99"><a href="#cb30-99" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb30-100"><a href="#cb30-100" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb30-101"><a href="#cb30-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb30-102"><a href="#cb30-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb30-103"><a href="#cb30-103" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb30-104"><a href="#cb30-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb30-105"><a href="#cb30-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb30-106"><a href="#cb30-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb30-107"><a href="#cb30-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb30-108"><a href="#cb30-108" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-a6d0f674996033a96363" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a6d0f674996033a96363">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"medical_tent":[50,2,1,0,1,0,0,0,0,0,0,0,26,5,2,0,2,1,1,2,2,1,3,1,1,1,1,1,1,1,22,2,0,0,2,4,4,4,2,2,2,0],"emergency_health_kits":[266,18,3,2,4,2,2,2,0,1,0,2,130,24,10,0,10,4,7,10,10,7,14,7,4,4,4,7,4,4,118,8,2,2,12,22,18,22,12,10,8,2],"trauma_surgical_kits":[266,18,3,2,4,2,2,2,0,1,0,2,130,24,10,0,10,4,7,10,10,7,14,7,4,4,4,7,4,4,118,8,2,2,12,22,18,22,12,10,8,2],"essential_ncd_medicines":[50,2,1,0,1,0,0,0,0,0,0,0,26,5,2,0,2,1,1,2,2,1,3,1,1,1,1,1,1,1,22,2,0,0,2,4,4,4,2,2,2,0],"mosquito_nets":[1076,78,12,10,14,10,10,8,2,4,2,6,518,98,42,0,42,14,28,42,42,28,56,28,14,14,14,28,14,14,480,30,10,10,50,90,70,90,50,40,30,10]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"medical_tent","name":"Medical Tent","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"emergency_health_kits","name":"Emergency Health Kits","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"trauma_surgical_kits","name":"Trauma and Surgical Kits","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"essential_ncd_medicines","name":"Essential NCD Medicines","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"mosquito_nets","name":"Mosquito Nets","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Resources Needed","columns":["medical_tent","emergency_health_kits","trauma_surgical_kits","essential_ncd_medicines","mosquito_nets"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"a4e1541e46d046f16ee116903f65317b"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimated-financial-damage-2" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="estimated-financial-damage-2"><span class="header-section-number">7.4</span> Estimated Financial Damage</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for health facilities</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>get_health_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(facility_type, area_council) {</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Health"</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Health Facility"</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(facility_type)),</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the raw damage estimates (before rounding) for financial calculations</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>health_financial <span class="ot">&lt;-</span> damage_estimates_raw <span class="sc">%&gt;%</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each facility type (in VT)</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">hospital_financial =</span> facility_hospital_damaged <span class="sc">*</span> <span class="fu">get_health_unit_cost</span>(<span class="st">"hospital"</span>, Region),</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">health_centre_financial =</span> <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_health_unit_cost</span>(<span class="st">"health centre"</span>, Region),</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">dispensary_financial =</span> facility_dispensary_damaged <span class="sc">*</span> <span class="fu">get_health_unit_cost</span>(<span class="st">"dispensary"</span>, Region),</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">aidpost_financial =</span> facility_aidpost_damaged <span class="sc">*</span> <span class="fu">get_health_unit_cost</span>(<span class="st">"aidpost"</span>, Region),</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total financial damage</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial_damage =</span> hospital_financial <span class="sc">+</span> health_centre_financial <span class="sc">+</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>                              dispensary_financial <span class="sc">+</span> aidpost_financial</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial_damage, hospital_financial, health_centre_financial,</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>         dispensary_financial, aidpost_financial)</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>health_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(health_financial)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns to match specification</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>health_financial_ordered <span class="ot">&lt;-</span> health_financial_full <span class="sc">%&gt;%</span></span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial_damage, hospital_financial, health_centre_financial,</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>         dispensary_financial, aidpost_financial)</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>  health_financial_ordered,</span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Health_04_financial_damage.csv"</span>),</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(health_financial_ordered)</span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the financial damage reactable</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">hospital_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Hospital"</span>,</span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">health_centre_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Health Centre"</span>,</span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">dispensary_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Dispensary"</span>,</span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">aidpost_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Aidpost"</span>,</span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Health Facility Financial Damage (VT)"</span>, </span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_financial_damage"</span>, <span class="st">"hospital_financial"</span>,</span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"health_centre_financial"</span>, <span class="st">"dispensary_financial"</span>,</span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"aidpost_financial"</span>))</span>
<span id="cb31-93"><a href="#cb31-93" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb31-94"><a href="#cb31-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb31-95"><a href="#cb31-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb31-96"><a href="#cb31-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb31-97"><a href="#cb31-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb31-98"><a href="#cb31-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb31-99"><a href="#cb31-99" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb31-100"><a href="#cb31-100" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb31-101"><a href="#cb31-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb31-102"><a href="#cb31-102" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb31-103"><a href="#cb31-103" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb31-104"><a href="#cb31-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb31-105"><a href="#cb31-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb31-106"><a href="#cb31-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb31-107"><a href="#cb31-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb31-108"><a href="#cb31-108" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-02f03a3fe0dbf66d634c" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-02f03a3fe0dbf66d634c">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"total_financial_damage":[548900000,39200000,5800000,5300000,7800000,5300000,4600000,3400000,1200000,1700000,1200000,2900000,259700000,59500000,25200000,0,25200000,3500000,11900000,20300000,20300000,16800000,23800000,10500000,2100000,8400000,3500000,11900000,8400000,8400000,250000000,7500000,6000000,2500000,26500000,58000000,38500000,47000000,26500000,20500000,14500000,2500000],"hospital_financial":[26000000,2000000,0,0,2000000,0,0,0,0,0,0,0,14000000,14000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10000000,0,0,0,0,10000000,0,0,0,0,0,0],"health_centre_financial":[4200000,0,0,0,0,0,0,0,0,0,0,0,4200000,0,0,0,0,0,0,0,0,0,0,2100000,2100000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"dispensary_financial":[67500000,6000000,1000000,500000,1000000,500000,1000000,1000000,0,500000,0,500000,31500000,3500000,0,0,0,3500000,3500000,3500000,3500000,0,7000000,0,0,0,3500000,3500000,0,0,30000000,7500000,0,2500000,2500000,0,2500000,5000000,2500000,2500000,2500000,2500000],"aidpost_financial":[451200000,31200000,4800000,4800000,4800000,4800000,3600000,2400000,1200000,1200000,1200000,2400000,210000000,42000000,25200000,0,25200000,0,8400000,16800000,16800000,16800000,16800000,8400000,0,8400000,0,8400000,8400000,8400000,210000000,0,6000000,0,24000000,48000000,36000000,42000000,24000000,18000000,12000000,0]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_financial_damage","name":"Total Value","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"hospital_financial","name":"Hospital","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"health_centre_financial","name":"Health Centre","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"dispensary_financial","name":"Dispensary","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"aidpost_financial","name":"Aidpost","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Health Facility Financial Damage (VT)","columns":["total_financial_damage","hospital_financial","health_centre_financial","dispensary_financial","aidpost_financial"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"50466dd7868e03fb84957e503142d43c"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="logistics" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Logistics</h1>
<section id="baseline-logistics-infrastructure" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="baseline-logistics-infrastructure"><span class="header-section-number">8.1</span> Baseline: Logistics Infrastructure</h2>
<section id="table-1-infrastructure" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="table-1-infrastructure"><span class="header-section-number">8.1.1</span> Table 1: Infrastructure</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get logistics infrastructure data</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>logistics_infrastructure_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Logistics"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Infrastructure"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape infrastructure data</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>infrastructure_wide <span class="ot">&lt;-</span> logistics_infrastructure_data <span class="sc">%&gt;%</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">infrastructure_type =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, infrastructure_type) <span class="sc">%&gt;%</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> infrastructure_type,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"infra_"</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>infrastructure_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(infrastructure_wide)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to specification</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>infrastructure_ordered <span class="ot">&lt;-</span> infrastructure_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>    infra_airport,</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>    infra_wharf,</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_permanent bridge</span><span class="st">`</span>,</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_temporary bridge</span><span class="st">`</span>,</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_police stations</span><span class="st">`</span>,</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_fire hydrants</span><span class="st">`</span>,</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_main water valves</span><span class="st">`</span></span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a>  infrastructure_ordered,</span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_01a_baseline_infrastructure.csv"</span>),</span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(infrastructure_ordered)</span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_airport =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Airport"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_wharf =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wharf"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_permanent bridge</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Permanent Bridge"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_temporary bridge</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Temporary Bridge"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_police stations</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Police Stations"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_fire hydrants</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Fire Hydrants"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_main water valves</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Main Water Valves"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Infrastructure"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"infra_airport"</span>, <span class="st">"infra_wharf"</span>, <span class="st">"infra_permanent bridge"</span>, </span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"infra_temporary bridge"</span>, <span class="st">"infra_police stations"</span>, </span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"infra_fire hydrants"</span>, <span class="st">"infra_main water valves"</span>))</span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-7b8fa568b09f9273d73f" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7b8fa568b09f9273d73f">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","West Santo","South Santo 1","South Santo 2","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","West Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"infra_airport":[28,4,1,0,1,0,1,0,1,0,0,2,1,1,0,0,0,0,0,0,0,5,1,0,1,0,1,0,1,0,0,1,6,0,0,1,1,0,1,0,1,1,1,5,1,1,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,6,2,0,1,0,0,1,0,1,1,0],"infra_wharf":[102,26,6,3,2,3,2,2,3,3,2,14,0,2,2,2,1,2,1,1,1,17,1,1,1,2,2,5,0,1,1,3,18,1,0,2,2,1,3,2,2,2,3,13,2,3,3,2,2,0,0,0,0,0,0,0,1,0,0,0,0,14,3,1,1,2,0,1,0,2,4,2],"infra_permanent bridge":[67,1,0,0,0,0,1,0,0,0,0,19,1,0,0,0,8,5,4,0,0,5,0,0,0,0,0,0,0,0,2,3,5,1,1,3,0,0,0,0,0,0,0,20,1,0,0,0,0,0,0,0,4,1,3,1,0,0,0,1,9,17,0,0,0,4,9,0,4,0,0,1],"infra_temporary bridge":[12,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,8,0,0,1,3,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0],"infra_police stations":[13,1,0,0,0,1,0,0,0,0,0,5,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,1,0,3,0,0,0,0,0,0,0,0,2,0,0,0,1,0,0,0,0,1,3],"infra_fire hydrants":[210,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,210,186,0,0,0,0,0,0,0,0,0,0,6,0,2,13,3,0,0,0,0,0,0,0,0,0,0,0,0],"infra_main water valves":[52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,52,36,0,0,0,0,0,0,0,0,0,0,2,0,2,9,3,0,0,0,0,0,0,0,0,0,0,0,0]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"infra_airport","name":"Airport","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_wharf","name":"Wharf","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_permanent bridge","name":"Permanent Bridge","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_temporary bridge","name":"Temporary Bridge","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_police stations","name":"Police Stations","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_fire hydrants","name":"Fire Hydrants","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_main water valves","name":"Main Water Valves","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Infrastructure","columns":["infra_airport","infra_wharf","infra_permanent bridge","infra_temporary bridge","infra_police stations","infra_fire hydrants","infra_main water valves"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"c690aa9d0b7062bc00181d0371555735"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-2-road-surface" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="table-2-road-surface"><span class="header-section-number">8.1.2</span> Table 2: Road Surface</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get logistics road surface data</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>logistics_road_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Logistics"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Road Surface"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape road surface data</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>road_wide <span class="ot">&lt;-</span> logistics_road_data <span class="sc">%&gt;%</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">road_type =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, road_type) <span class="sc">%&gt;%</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> road_type,</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"road_"</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>road_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(road_wide)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to specification</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>road_ordered <span class="ot">&lt;-</span> road_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>    road_asphalt,</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">road_chips seal</span><span class="st">`</span>,</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    road_concrete,</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    road_earth,</span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    road_gravel</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>  road_ordered,</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_01b_baseline_road_surface.csv"</span>),</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(road_ordered)</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_asphalt =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Asphalt"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">road_chips seal</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Chips Seal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_concrete =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_earth =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Earth"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_gravel =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Gravel"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Road Surface"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"road_asphalt"</span>, <span class="st">"road_chips seal"</span>, <span class="st">"road_concrete"</span>, </span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"road_earth"</span>, <span class="st">"road_gravel"</span>))</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-2694ebaad3a8dd9844b0" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2694ebaad3a8dd9844b0">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Motalava","<b>Sanma<\/b>","Luganville","<b>Malampa<\/b>","Paama","<b>Shefa<\/b>","Port Vila","Tongariki","Nguna","<b>Tafea<\/b>","Aniwa","Futuna","Aneityum",null,"Ambae","Ambrym","Aore","Efate Rural","Emae","Epi","Erromango","Espiritu Santo","Gaua","Maewo","Malekula","Malo","Pentecost","Tanna","Tongoa","Vanua Lava","pentecost"],"road_asphalt":[16.98,0,0,0,0,0,0,16.98,16.98,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"road_chips seal":[3872.993,0,0,63.243,63.243,0,0,165.829,165.829,0,0,0,0,0,0,3643.921,0,0,0,2892.41,0,0,0,704.91,0,0,0,0,0,46.601,0,0,0],"road_concrete":[503.674,12.48,12.48,2.959,2.959,0,0,7.666,6.229,0,1.437,0.56,0.56,0,0,480.009,95.35,6.017,0,25,0,63.96,1.17,2.469,13.28,4.59,54.973,1.083,112.169,26.208,14.69,59.05,0],"road_earth":[4128.778,98.52,98.52,6.968,6.968,22.709,22.709,108.024,6.749,4.883,96.392,43.3,10.19,4.46,28.65,3849.257,896.147999999999,411.612,43.47,9.267,24,619.965,122.539,130.598,87.866,31.75,215.281,31.118,276.91,558.342999999999,154.04,233.68,2.67],"road_gravel":[10130.141,59.76,59.76,262.688,262.688,0,0,213.002,213.002,0,0,47.61,47.61,0,0,9547.081,677.205,0,200.53,119.674,0,1014.63,71.957,1197.861,6.272,225.38,3334.07,122.707,2155.126,261.119,0,160.55,0]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"road_asphalt","name":"Asphalt","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"road_chips seal","name":"Chips Seal","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"road_concrete","name":"Concrete","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"road_earth","name":"Earth","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"road_gravel","name":"Gravel","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Road Surface","columns":["road_asphalt","road_chips seal","road_concrete","road_earth","road_gravel"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"eb7d4cebc39fe33e6a12377f51d4f9f0"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="estimated-hazard-damage-2" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="estimated-hazard-damage-2"><span class="header-section-number">8.2</span> Estimated Hazard Damage</h2>
<section id="table-1-infrastructure-damage" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="table-1-infrastructure-damage"><span class="header-section-number">8.2.1</span> Table 1: Infrastructure Damage</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to baseline values</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>infrastructure_with_config <span class="ot">&lt;-</span> infrastructure_wide <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for infrastructure damage multipliers (council-specific)</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>get_logistics_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, indicator_type, attribute_type, area_council) {</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Logistics"</span>,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator_type,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute_type)),</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if we got any results</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the value from the intensity column</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates for Infrastructure</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep UNROUNDED values for aggregation first</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>infrastructure_damage_raw <span class="ot">&lt;-</span> infrastructure_with_config <span class="sc">%&gt;%</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Infrastructure Damage - keep as decimals for now</span></span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_airport_damaged =</span> infra_airport <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"airport"</span>, Region),</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_wharf_damaged =</span> infra_wharf <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"wharf"</span>, Region),</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_permanent bridge</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"permanent bridge"</span>, Region),</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_temporary bridge</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"temporary bridge"</span>, Region),</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_police stations</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"police stations"</span>, Region),</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_fire hydrants</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"fire hydrants"</span>, Region),</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_main water valves</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"main water valves"</span>, Region)</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, infra_airport_damaged, infra_wharf_damaged, <span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span>,</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span>, <span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span>, </span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span>, <span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span>)</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels FIRST</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>infrastructure_damage_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(infrastructure_damage_raw)</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a><span class="co"># NOW round all values (council, province, and national)</span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>infrastructure_damage_full <span class="ot">&lt;-</span> infrastructure_damage_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_airport_damaged =</span> <span class="fu">round</span>(infra_airport_damaged, <span class="dv">0</span>),</span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_wharf_damaged =</span> <span class="fu">round</span>(infra_wharf_damaged, <span class="dv">0</span>),</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span>, <span class="dv">0</span>)</span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>  infrastructure_damage_full,</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_02a_damage_infrastructure.csv"</span>),</span>
<span id="cb34-69"><a href="#cb34-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb34-70"><a href="#cb34-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-71"><a href="#cb34-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-72"><a href="#cb34-72" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb34-73"><a href="#cb34-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb34-74"><a href="#cb34-74" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(infrastructure_damage_full)</span>
<span id="cb34-75"><a href="#cb34-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-76"><a href="#cb34-76" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb34-77"><a href="#cb34-77" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb34-78"><a href="#cb34-78" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb34-79"><a href="#cb34-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb34-80"><a href="#cb34-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb34-81"><a href="#cb34-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb34-82"><a href="#cb34-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb34-83"><a href="#cb34-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb34-84"><a href="#cb34-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb34-85"><a href="#cb34-85" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-86"><a href="#cb34-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-87"><a href="#cb34-87" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Infrastructure</span></span>
<span id="cb34-88"><a href="#cb34-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_airport_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Airport"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb34-89"><a href="#cb34-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_wharf_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wharf"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb34-90"><a href="#cb34-90" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Permanent Bridge"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb34-91"><a href="#cb34-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Temporary Bridge"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb34-92"><a href="#cb34-92" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Police Stations"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb34-93"><a href="#cb34-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Fire Hydrants"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb34-94"><a href="#cb34-94" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Main Water Valves"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb34-95"><a href="#cb34-95" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb34-96"><a href="#cb34-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb34-97"><a href="#cb34-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb34-98"><a href="#cb34-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Infrastructure"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"infra_airport_damaged"</span>, <span class="st">"infra_wharf_damaged"</span>, </span>
<span id="cb34-99"><a href="#cb34-99" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"infra_permanent bridge_damaged"</span>, <span class="st">"infra_temporary bridge_damaged"</span>,</span>
<span id="cb34-100"><a href="#cb34-100" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"infra_police stations_damaged"</span>, <span class="st">"infra_fire hydrants_damaged"</span>,</span>
<span id="cb34-101"><a href="#cb34-101" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"infra_main water valves_damaged"</span>))</span>
<span id="cb34-102"><a href="#cb34-102" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb34-103"><a href="#cb34-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-104"><a href="#cb34-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-105"><a href="#cb34-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-106"><a href="#cb34-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb34-107"><a href="#cb34-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb34-108"><a href="#cb34-108" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb34-109"><a href="#cb34-109" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-110"><a href="#cb34-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb34-111"><a href="#cb34-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb34-112"><a href="#cb34-112" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb34-113"><a href="#cb34-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb34-114"><a href="#cb34-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb34-115"><a href="#cb34-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb34-116"><a href="#cb34-116" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb34-117"><a href="#cb34-117" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-5b766487d8286b66509d" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5b766487d8286b66509d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","West Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"infra_airport_damaged":[7,1,0,0,0,0,0,0,0,0,0,0,4,1,1,1,0,0,1,0,1,0,0,0,0,0,0,0,0,0,3,1,0,0,0,0,0,0,0,0],"infra_wharf_damaged":[18,2,0,0,0,0,0,0,0,0,0,0,9,1,2,2,1,1,0,0,0,0,0,0,0,1,0,0,0,0,7,2,0,0,1,0,0,0,1,2],"infra_permanent bridge_damaged":[23,0,0,0,0,0,0,0,0,0,0,0,14,1,0,0,0,0,0,0,0,3,1,2,1,0,0,0,1,6,8,0,0,0,2,4,0,2,0,0],"infra_temporary bridge_damaged":[1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"infra_police stations_damaged":[4,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,1,0,2,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0],"infra_fire hydrants_damaged":[147,0,0,0,0,0,0,0,0,0,0,0,147,130,0,0,0,0,0,0,0,0,0,0,4,0,1,9,2,0,0,0,0,0,0,0,0,0,0,0],"infra_main water valves_damaged":[36,0,0,0,0,0,0,0,0,0,0,0,36,25,0,0,0,0,0,0,0,0,0,0,1,0,1,6,2,0,0,0,0,0,0,0,0,0,0,0]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"infra_airport_damaged","name":"Airport","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_wharf_damaged","name":"Wharf","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_permanent bridge_damaged","name":"Permanent Bridge","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_temporary bridge_damaged","name":"Temporary Bridge","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_police stations_damaged","name":"Police Stations","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_fire hydrants_damaged","name":"Fire Hydrants","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"infra_main water valves_damaged","name":"Main Water Valves","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Infrastructure","columns":["infra_airport_damaged","infra_wharf_damaged","infra_permanent bridge_damaged","infra_temporary bridge_damaged","infra_police stations_damaged","infra_fire hydrants_damaged","infra_main water valves_damaged"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"2fec6617bdcca14361d36e18e7f4b2c2"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-2-road-surface-damage" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="table-2-road-surface-damage"><span class="header-section-number">8.2.2</span> Table 2: Road Surface Damage</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to road baseline values</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>road_with_config <span class="ot">&lt;-</span> road_wide <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates for Road Surface</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep UNROUNDED values for aggregation first</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>road_damage_raw <span class="ot">&lt;-</span> road_with_config <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Road Surface Damage - keep as decimals for now</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_asphalt_damaged =</span> road_asphalt <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Road Surface"</span>, <span class="st">"asphalt"</span>, Region),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">road_chips seal</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Road Surface"</span>, <span class="st">"chips seal"</span>, Region),</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_concrete_damaged =</span> road_concrete <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Road Surface"</span>, <span class="st">"concrete"</span>, Region),</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_earth_damaged =</span> road_earth <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Road Surface"</span>, <span class="st">"earth"</span>, Region),</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_gravel_damaged =</span> road_gravel <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Road Surface"</span>, <span class="st">"gravel"</span>, Region)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, road_asphalt_damaged, <span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span>, road_concrete_damaged,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>         road_earth_damaged, road_gravel_damaged)</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels FIRST</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>road_damage_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(road_damage_raw)</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="co"># NOW round all values (council, province, and national)</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>road_damage_full <span class="ot">&lt;-</span> road_damage_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_asphalt_damaged =</span> <span class="fu">round</span>(road_asphalt_damaged, <span class="dv">0</span>),</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_concrete_damaged =</span> <span class="fu">round</span>(road_concrete_damaged, <span class="dv">0</span>),</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_earth_damaged =</span> <span class="fu">round</span>(road_earth_damaged, <span class="dv">0</span>),</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_gravel_damaged =</span> <span class="fu">round</span>(road_gravel_damaged, <span class="dv">0</span>)</span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>  road_damage_full,</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_02b_damage_road_surface.csv"</span>),</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(road_damage_full)</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Road Surface</span></span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_asphalt_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Asphalt"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Chips Seal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_concrete_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_earth_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Earth"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_gravel_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Gravel"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Road Surface"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"road_asphalt_damaged"</span>, <span class="st">"road_chips seal_damaged"</span>, </span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"road_concrete_damaged"</span>, <span class="st">"road_earth_damaged"</span>, </span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"road_gravel_damaged"</span>))</span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-a7b4361f813aa68c11bf" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a7b4361f813aa68c11bf">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","Paama","<b>Shefa<\/b>","Port Vila","Tongariki","Nguna","<b>Tafea<\/b>","Aniwa","Futuna","Aneityum"],"road_asphalt_damaged":[12,0,0,12,12,0,0,0,0,0,0],"road_chips seal_damaged":[116,0,0,116,116,0,0,0,0,0,0],"road_concrete_damaged":[6,0,0,5,4,0,1,0,0,0,0],"road_earth_damaged":[100,2,2,76,5,3,67,22,5,2,14],"road_gravel_damaged":[173,0,0,149,149,0,0,24,24,0,0]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"road_asphalt_damaged","name":"Asphalt","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"road_chips seal_damaged","name":"Chips Seal","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"road_concrete_damaged","name":"Concrete","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"road_earth_damaged","name":"Earth","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"road_gravel_damaged","name":"Gravel","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Road Surface","columns":["road_asphalt_damaged","road_chips seal_damaged","road_concrete_damaged","road_earth_damaged","road_gravel_damaged"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"75293a52898337f6bd3d314673c4d150"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="immediate-response-resources-4" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="immediate-response-resources-4"><span class="header-section-number">8.3</span> Immediate Response Resources</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get resource multipliers</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>get_logistics_resource_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Logistics"</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> resource_type,</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(multiplier) <span class="sc">&gt;</span> <span class="dv">0</span>, multiplier, <span class="dv">0</span>))</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine which councils are affected (have cyclone intensity assigned)</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>affected_councils <span class="ot">&lt;-</span> config <span class="sc">%&gt;%</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>, Province) <span class="sc">%&gt;%</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of affected councils</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>num_affected_councils <span class="ot">&lt;-</span> <span class="fu">nrow</span>(affected_councils)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of affected provinces</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>num_affected_provinces <span class="ot">&lt;-</span> affected_councils <span class="sc">%&gt;%</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Create council-level resources (for councils that are affected)</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>resources_needed_councils <span class="ot">&lt;-</span> affected_councils <span class="sc">%&gt;%</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Resources = multiplier * 1 (per affected council)</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">truck =</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">*</span> <span class="fu">get_logistics_resource_multiplier</span>(<span class="st">"Truck"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">fibreglass_boat =</span> <span class="fu">round</span>(<span class="dv">10</span> <span class="sc">*</span> <span class="fu">get_logistics_resource_multiplier</span>(<span class="st">"Fibreglass Boat"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuel =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">get_logistics_resource_multiplier</span>(<span class="st">"Fuel"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">chainsaw =</span> <span class="fu">round</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">get_logistics_resource_multiplier</span>(<span class="st">"Chainsaw"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">ship =</span> <span class="dv">0</span>  <span class="co"># Ships only at province/national level</span></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, truck, fibreglass_boat, ship, fuel, chainsaw)</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province level</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>province_resources <span class="ot">&lt;-</span> resources_needed_councils <span class="sc">%&gt;%</span></span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(council_province_lookup, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Council"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">truck =</span> <span class="fu">sum</span>(truck, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">fibreglass_boat =</span> <span class="fu">sum</span>(fibreglass_boat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">ship =</span> <span class="dv">1</span>,  <span class="co"># 1 ship per affected province</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuel =</span> <span class="fu">sum</span>(fuel, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">chainsaw =</span> <span class="fu">sum</span>(chainsaw, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Region =</span> Province)</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a><span class="co"># National level - sum of provinces</span></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>national_resources <span class="ot">&lt;-</span> province_resources <span class="sc">%&gt;%</span></span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">truck =</span> <span class="fu">sum</span>(truck, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">fibreglass_boat =</span> <span class="fu">sum</span>(fibreglass_boat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">ship =</span> <span class="fu">sum</span>(ship, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuel =</span> <span class="fu">sum</span>(fuel, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">chainsaw =</span> <span class="fu">sum</span>(chainsaw, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">"National"</span>)</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all levels</span></span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>  national_resources,</span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>  province_resources,</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>  resources_needed_councils</span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">default_order =</span> <span class="fu">match</span>(Region, region_order)) <span class="sc">%&gt;%</span></span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(default_order) <span class="sc">%&gt;%</span></span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>default_order)</span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a>  resources_needed_full,</span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_03_resources_needed.csv"</span>),</span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the resources needed reactable</span></span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a>    <span class="at">truck =</span> <span class="fu">colDef</span>(</span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Truck"</span>,</span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">fibreglass_boat =</span> <span class="fu">colDef</span>(</span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Fibreglass Boat"</span>,</span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">ship =</span> <span class="fu">colDef</span>(</span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Ship"</span>,</span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuel =</span> <span class="fu">colDef</span>(</span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Fuel (litres)"</span>,</span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">chainsaw =</span> <span class="fu">colDef</span>(</span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Chainsaw"</span>,</span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Resources Needed"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"truck"</span>, <span class="st">"fibreglass_boat"</span>, <span class="st">"ship"</span>, <span class="st">"fuel"</span>, <span class="st">"chainsaw"</span>))</span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-24136d8cd23d315896a3" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-24136d8cd23d315896a3">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"truck":[40,10,1,1,1,1,1,1,1,1,1,1,19,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,11,1,1,1,1,1,1,1,1,1,1,1],"fibreglass_boat":[4000,1000,100,100,100,100,100,100,100,100,100,100,1900,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,1100,100,100,100,100,100,100,100,100,100,100,100],"ship":[3,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],"fuel":[400000,100000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,190000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,110000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000,10000],"chainsaw":[160,40,4,4,4,4,4,4,4,4,4,4,76,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,44,4,4,4,4,4,4,4,4,4,4,4]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"truck","name":"Truck","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"fibreglass_boat","name":"Fibreglass Boat","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"ship","name":"Ship","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"fuel","name":"Fuel (litres)","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"chainsaw","name":"Chainsaw","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Resources Needed","columns":["truck","fibreglass_boat","ship","fuel","chainsaw"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"fb7360964f058cc9a39810291ea2a6ba"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimated-financial-damage-3" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="estimated-financial-damage-3"><span class="header-section-number">8.4</span> Estimated Financial Damage</h2>
<section id="table-1-infrastructure-financial-damage" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="table-1-infrastructure-financial-damage"><span class="header-section-number">8.4.1</span> Table 1: Infrastructure Financial Damage</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for infrastructure</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>get_infrastructure_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(infrastructure_type, area_council) {</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Logistics"</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Infrastructure"</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(infrastructure_type)),</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the raw damage estimates (before rounding) for financial calculations</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>infrastructure_financial <span class="ot">&lt;-</span> infrastructure_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each infrastructure type (in VT)</span></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">airport_financial =</span> infra_airport_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"airport"</span>, Region),</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">wharf_financial =</span> infra_wharf_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"wharf"</span>, Region),</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">permanent_bridge_financial =</span> <span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"permanent bridge"</span>, Region),</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">temporary_bridge_financial =</span> <span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"temporary bridge"</span>, Region),</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">police_stations_financial =</span> <span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"police stations"</span>, Region),</span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">fire_hydrants_financial =</span> <span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"fire hydrants"</span>, Region),</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">main_water_valves_financial =</span> <span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"main water valves"</span>, Region),</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total infrastructure financial damage</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_infrastructure_financial =</span> airport_financial <span class="sc">+</span> wharf_financial <span class="sc">+</span> permanent_bridge_financial <span class="sc">+</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>                                      temporary_bridge_financial <span class="sc">+</span> police_stations_financial <span class="sc">+</span> </span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>                                      fire_hydrants_financial <span class="sc">+</span> main_water_valves_financial</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_infrastructure_financial, airport_financial, wharf_financial, </span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>         permanent_bridge_financial, temporary_bridge_financial, police_stations_financial,</span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>         fire_hydrants_financial, main_water_valves_financial)</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a>infrastructure_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(infrastructure_financial)</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a>infrastructure_financial_ordered <span class="ot">&lt;-</span> infrastructure_financial_full <span class="sc">%&gt;%</span></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_infrastructure_financial, airport_financial, wharf_financial,</span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a>         permanent_bridge_financial, temporary_bridge_financial, police_stations_financial,</span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a>         fire_hydrants_financial, main_water_valves_financial)</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>  infrastructure_financial_ordered,</span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_04a_financial_damage_infrastructure.csv"</span>),</span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(infrastructure_financial_ordered)</span>
<span id="cb37-58"><a href="#cb37-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-59"><a href="#cb37-59" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_infrastructure_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">airport_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Airport"</span>,</span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">wharf_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Wharf"</span>,</span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">permanent_bridge_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Permanent Bridge"</span>,</span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">temporary_bridge_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb37-86"><a href="#cb37-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Temporary Bridge"</span>,</span>
<span id="cb37-87"><a href="#cb37-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb37-88"><a href="#cb37-88" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-89"><a href="#cb37-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">police_stations_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb37-90"><a href="#cb37-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Police Stations"</span>,</span>
<span id="cb37-91"><a href="#cb37-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb37-92"><a href="#cb37-92" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-93"><a href="#cb37-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">fire_hydrants_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb37-94"><a href="#cb37-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Fire Hydrants"</span>,</span>
<span id="cb37-95"><a href="#cb37-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb37-96"><a href="#cb37-96" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-97"><a href="#cb37-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">main_water_valves_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb37-98"><a href="#cb37-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Main Water Valves"</span>,</span>
<span id="cb37-99"><a href="#cb37-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb37-100"><a href="#cb37-100" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-101"><a href="#cb37-101" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb37-102"><a href="#cb37-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb37-103"><a href="#cb37-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb37-104"><a href="#cb37-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Infrastructure"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_infrastructure_financial"</span>, <span class="st">"airport_financial"</span>, </span>
<span id="cb37-105"><a href="#cb37-105" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"wharf_financial"</span>, <span class="st">"permanent_bridge_financial"</span>,</span>
<span id="cb37-106"><a href="#cb37-106" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"temporary_bridge_financial"</span>, <span class="st">"police_stations_financial"</span>,</span>
<span id="cb37-107"><a href="#cb37-107" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"fire_hydrants_financial"</span>, <span class="st">"main_water_valves_financial"</span>))</span>
<span id="cb37-108"><a href="#cb37-108" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb37-109"><a href="#cb37-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-110"><a href="#cb37-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-111"><a href="#cb37-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-112"><a href="#cb37-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb37-113"><a href="#cb37-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb37-114"><a href="#cb37-114" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb37-115"><a href="#cb37-115" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb37-116"><a href="#cb37-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb37-117"><a href="#cb37-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb37-118"><a href="#cb37-118" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb37-119"><a href="#cb37-119" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb37-120"><a href="#cb37-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-121"><a href="#cb37-121" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb37-122"><a href="#cb37-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb37-123"><a href="#cb37-123" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-5d6046ca17f720869617" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5d6046ca17f720869617">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","West Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"total_infrastructure_financial":[38214800000,42500000,8800000,7000000,21700000,700000,300000,1000000,600000,700000,700000,1000000,37533300000,25319000000,7000000,14000000,4200000,4200000,700000,10500000,700000,227500000,49000000,147000000,1451100000,2100000,1400700000,6304550000,2150050000,441000000,639000000,5500000,1500000,2000000,155500000,315000000,2000000,140000000,3500000,14000000],"airport_financial":[7100000,600000,0,0,100000,100000,0,100000,0,100000,100000,100000,3500000,700000,700000,700000,0,0,700000,0,700000,0,0,0,0,0,0,0,0,0,3000000,1000000,0,500000,0,0,500000,0,500000,500000],"wharf_financial":[53700000,5400000,300000,0,600000,600000,300000,900000,600000,600000,600000,900000,27300000,4200000,6300000,6300000,4200000,4200000,0,0,0,0,0,0,0,2100000,0,0,0,0,21000000,4500000,1500000,1500000,3000000,0,1500000,0,3000000,6000000],"permanent_bridge_financial":[1610000000,35000000,7000000,7000000,21000000,0,0,0,0,0,0,0,980000000,49000000,0,0,0,0,0,0,0,196000000,49000000,147000000,49000000,0,0,0,49000000,441000000,595000000,0,0,0,140000000,315000000,0,140000000,0,0],"temporary_bridge_financial":[12000000,0,0,0,0,0,0,0,0,0,0,0,7000000,0,0,7000000,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5000000,0,0,0,5000000,0,0,0,0,0],"police_stations_financial":[58500000,1500000,1500000,0,0,0,0,0,0,0,0,0,42000000,0,0,0,0,0,0,10500000,0,31500000,0,0,0,0,0,0,0,0,15000000,0,0,0,7500000,0,0,0,0,7500000],"fire_hydrants_financial":[73500000,0,0,0,0,0,0,0,0,0,0,0,73500000,65100000,0,0,0,0,0,0,0,0,0,0,2100000,0,700000,4550000,1050000,0,0,0,0,0,0,0,0,0,0,0],"main_water_valves_financial":[36400000000,0,0,0,0,0,0,0,0,0,0,0,36400000000,25200000000,0,0,0,0,0,0,0,0,0,0,1400000000,0,1400000000,6300000000,2100000000,0,0,0,0,0,0,0,0,0,0,0]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_infrastructure_financial","name":"Total Value","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"airport_financial","name":"Airport","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"wharf_financial","name":"Wharf","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"permanent_bridge_financial","name":"Permanent Bridge","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"temporary_bridge_financial","name":"Temporary Bridge","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"police_stations_financial","name":"Police Stations","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"fire_hydrants_financial","name":"Fire Hydrants","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"main_water_valves_financial","name":"Main Water Valves","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Infrastructure","columns":["total_infrastructure_financial","airport_financial","wharf_financial","permanent_bridge_financial","temporary_bridge_financial","police_stations_financial","fire_hydrants_financial","main_water_valves_financial"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"2f47e603ba9be375ae5195bd73644470"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="table-2-road-surface-financial-damage" class="level3" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="table-2-road-surface-financial-damage"><span class="header-section-number">8.4.2</span> Table 2: Road Surface Financial Damage</h3>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for road surface</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>get_road_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(road_type, area_council) {</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Logistics"</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Road Surface"</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(road_type)),</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the raw damage estimates (before rounding) for financial calculations</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>road_financial <span class="ot">&lt;-</span> road_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each road surface type (in VT)</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">asphalt_financial =</span> road_asphalt_damaged <span class="sc">*</span> <span class="fu">get_road_unit_cost</span>(<span class="st">"asphalt"</span>, Region),</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">chips_seal_financial =</span> <span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_road_unit_cost</span>(<span class="st">"chips seal"</span>, Region),</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">concrete_financial =</span> road_concrete_damaged <span class="sc">*</span> <span class="fu">get_road_unit_cost</span>(<span class="st">"concrete"</span>, Region),</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">earth_financial =</span> road_earth_damaged <span class="sc">*</span> <span class="fu">get_road_unit_cost</span>(<span class="st">"earth"</span>, Region),</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">gravel_financial =</span> road_gravel_damaged <span class="sc">*</span> <span class="fu">get_road_unit_cost</span>(<span class="st">"gravel"</span>, Region),</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total road surface financial damage</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_road_financial =</span> asphalt_financial <span class="sc">+</span> chips_seal_financial <span class="sc">+</span> concrete_financial <span class="sc">+</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>                            earth_financial <span class="sc">+</span> gravel_financial</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_road_financial, asphalt_financial, chips_seal_financial,</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>         concrete_financial, earth_financial, gravel_financial)</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>road_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(road_financial)</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>road_financial_ordered <span class="ot">&lt;-</span> road_financial_full <span class="sc">%&gt;%</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_road_financial, asphalt_financial, chips_seal_financial,</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>         concrete_financial, earth_financial, gravel_financial)</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  road_financial_ordered,</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_04b_financial_damage_road_surface.csv"</span>),</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(road_financial_ordered)</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_road_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">asphalt_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Asphalt"</span>,</span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">chips_seal_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Chips Seal"</span>,</span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">concrete_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Concrete"</span>,</span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">earth_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Earth"</span>,</span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">gravel_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Gravel"</span>,</span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Road Surface"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_road_financial"</span>, <span class="st">"asphalt_financial"</span>, </span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"chips_seal_financial"</span>, <span class="st">"concrete_financial"</span>,</span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"earth_financial"</span>, <span class="st">"gravel_financial"</span>))</span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-c80ab698c68a2cd57dec" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-c80ab698c68a2cd57dec">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","Paama","<b>Shefa<\/b>","Port Vila","Tongariki","Nguna","<b>Tafea<\/b>","Aniwa","Futuna","Aneityum"],"total_road_financial":[7863458.5,34063.5,34063.5,7238595,6074617.5,51271.5,1112706,590800,342475,33450,214875],"asphalt_financial":[594300,0,0,594300,594300,0,0,0,0,0,0],"chips_seal_financial":[3482409,0,0,3482409,3482409,0,0,0,0,0,0],"concrete_financial":[564620,0,0,536620,436030,0,100590,28000,28000,0,0],"earth_financial":[1493065.5,34063.5,34063.5,1134252,70864.5,51271.5,1012116,324750,76425,33450,214875],"gravel_financial":[1729064,0,0,1491014,1491014,0,0,238050,238050,0,0]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_road_financial","name":"Total Value","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"asphalt_financial","name":"Asphalt","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"chips_seal_financial","name":"Chips Seal","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"concrete_financial","name":"Concrete","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"earth_financial","name":"Earth","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"gravel_financial","name":"Gravel","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Road Surface","columns":["total_road_financial","asphalt_financial","chips_seal_financial","concrete_financial","earth_financial","gravel_financial"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"1c444201fc744c4d00f5f53a0a3b5822"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
</section>
<section id="shelter" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Shelter</h1>
<section id="baseline" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="baseline"><span class="header-section-number">9.1</span> Baseline</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Shelter baseline at Area Council level</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>shelter_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get total households</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>total_households <span class="ot">&lt;-</span> shelter_data <span class="sc">%&gt;%</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"number households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">total_households =</span> Value)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Get roof materials</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>roof_materials <span class="ot">&lt;-</span> shelter_data <span class="sc">%&gt;%</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Roof Material"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">material =</span> <span class="fu">paste0</span>(<span class="st">"roof_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, material, Value) <span class="sc">%&gt;%</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> material,</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Get wall materials</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>wall_materials <span class="ot">&lt;-</span> shelter_data <span class="sc">%&gt;%</span></span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Wall Material"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">material =</span> <span class="fu">paste0</span>(<span class="st">"wall_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, material, Value) <span class="sc">%&gt;%</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> material,</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all data</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>shelter_wide <span class="ot">&lt;-</span> total_households <span class="sc">%&gt;%</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(roof_materials, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(wall_materials, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>shelter_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(shelter_wide)</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a>  shelter_aggregated <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Shelter_01_baseline.csv"</span>),</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(shelter_aggregated)</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the reactable</span></span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_concrete =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_metal =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_wood =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_concrete =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_metal =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb39-75"><a href="#cb39-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_wood =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb39-76"><a href="#cb39-76" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb39-77"><a href="#cb39-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb39-78"><a href="#cb39-78" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb39-79"><a href="#cb39-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households"</span>)),</span>
<span id="cb39-80"><a href="#cb39-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Roof Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"roof_concrete"</span>, <span class="st">"roof_metal"</span>, <span class="st">"roof_wood"</span>)),</span>
<span id="cb39-81"><a href="#cb39-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Wall Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"wall_concrete"</span>, <span class="st">"wall_metal"</span>, <span class="st">"wall_wood"</span>))</span>
<span id="cb39-82"><a href="#cb39-82" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb39-83"><a href="#cb39-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-84"><a href="#cb39-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-85"><a href="#cb39-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-86"><a href="#cb39-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb39-87"><a href="#cb39-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb39-88"><a href="#cb39-88" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb39-89"><a href="#cb39-89" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb39-90"><a href="#cb39-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb39-91"><a href="#cb39-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb39-92"><a href="#cb39-92" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb39-93"><a href="#cb39-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb39-94"><a href="#cb39-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb39-95"><a href="#cb39-95" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb39-96"><a href="#cb39-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb39-97"><a href="#cb39-97" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-19f0857c0cc81b7e7a10" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-19f0857c0cc81b7e7a10">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"total_households":[72482.0546920189,2794.95252753011,251.536722793333,95.5562924834146,403.506543031657,352.861855525167,399.483016622889,121.069311546954,736.395575324238,273.387859087372,161.15535111509,15197.264125121,4011.10961674314,313.385436919143,899.778336226117,555.824444268251,506.606466711524,1320.33984160773,1263.23800890242,1761.34327423859,2215.88663450749,776.294122501475,515.73360885726,9200.13931705135,606.924608004948,593.436796206294,476.457889720776,236.189949175808,767.461922591376,620.864206151392,1683.41539017212,1095.50324205733,1539.83327247302,1580.05204049829,10353.2774827892,1188.86767401795,1539.62290420528,1541.65738237234,935.199541294908,1153.86214879327,1202.44366657817,1007.7042284521,385.450635837244,605.948867341972,792.520433895933,24030.8306358174,8958.28660829032,620.505261352837,467.791975723459,610.02408994337,470.290296930793,327.891570980372,237.737908455605,232.625876024746,468.181911066327,197.239389926415,1023.64421567205,872.350722672883,887.60272195239,1904.00050406432,245.525974562536,486.365911492837,3298.47690356345,1825.63717105486,896.651622087837,10905.5906037098,374.158737182642,151.382492979637,140.043923990882,1021.95989506718,3601.9013798503,1581.98340313245,1424.05385466799,1782.97527561199,403.851005201499,87.3229637301334,335.957672295088,1057.72433363789],"roof_concrete":[1877.35951210822,81.5249281381653,3.62793350182691,3.08246104785208,7.07906215845013,0,2.10254219275205,0,45.5803614687919,2.9083814796529,17.1441862888393,198.203130195671,0,4.82192895219557,19.0362130372239,6.21916507835088,5.21417923445196,41.3021957214896,11.2993372366029,18.0294980827572,56.7829399934805,9.35294123495753,15.1051684602545,252.456642578948,12.5292257211254,11.7587365285627,9.43243787587872,5.78087288192537,2.42867697022587,4.81296526123518,59.6598246492067,49.5994473742674,66.5931595634721,29.861295753049,230.885759758154,18.8272777095833,65.1692234584244,58.5715449631032,15.681548329174,11.4866088030381,10.9094846924641,3.70964564415378,10.4864255649206,26.4020577913288,9.64194280196391,723.033635051859,379.888387391587,8.30504173894811,7.60637358899934,23.5631622724907,0,0,1.16657325760264,0.977739347436624,17.8856010969159,4.38309755392034,20.3642748475871,15.0420512457784,21.6728744538874,53.4664915176639,41.48497048292,13.8750457639631,59.102401855659,44.7357089950002,9.51383964149926,391.255416385427,5.02226492862606,0,3.44370304895611,15.288237785815,198.482383042827,36.9847806895741,84.9887460073132,33.2252579120095,8.86193428341849,1.66329454724064,3.29481413964686,11.039563163906],"roof_metal":[35462.9623715556,581.784470195177,37.4886461855448,6.16492209570417,102.140754000495,30.2751296160646,115.639820601363,13.9793805819381,203.687240313664,39.2631499753141,33.1454268250893,4385.79467686419,0,75.2220916542508,208.129262540314,83.4012107042888,21.7257468102165,294.121696804547,598.311492179073,850.160178825399,1429.03732316926,206.933824823435,137.025456746594,3204.20921900432,270.422455147622,329.244622799757,249.959603710786,71.0221525493688,187.008126707392,194.122932203152,366.311323346129,401.172000821281,593.54772654399,541.398275174845,2971.21314483437,183.04297773206,363.945047929355,498.390600776951,344.994063241827,170.210657717746,366.073819680463,358.599078934865,93.1441329590005,151.211785532155,441.600980329947,20490.6158488078,8117.72108442076,349.998187569956,277.632635998476,248.722268431846,319.468335815962,263.108366876296,202.983746822859,194.570130139888,404.004165953865,177.515450933774,889.240001677971,779.679656239511,795.985570851866,1765.63345719199,197.333913648484,427.153194590579,2963.56329304805,1489.5782022119,626.724186383763,3829.34501184976,204.657295841512,48.7056716543181,78.0572691096717,398.670200722408,1506.7401773599,544.034193369218,342.530400574929,275.646584158893,197.49453545904,54.888720058941,177.919963540931,481.72639260681],"roof_wood":[1033.00941663945,3.87625960775018,0,1.02748701595069,0,0,0,0,2.84877259179949,0,0,91.1061220732974,0,8.67947211395202,0,0,1.73805974481732,2.50316337705997,17.6578741098794,42.9934185050365,13.5197476174954,0,0,31.5903425763928,0,0.979894710713562,0,0,0,0,3.5795894789524,16.0468800328512,5.79070952725845,5.19326882661722,47.094036420036,0,18.0468618807945,3.19481154344199,2.24022118988199,2.08847432782511,2.42432993165869,0,13.5706683781325,3.60028060790847,1.92838856039278,346.979859399625,174.325440368023,110.338411674596,6.33864465749945,0,1.37110873740756,0,0,0,0,1.09577438848008,4.07285496951742,0,18.7174824829028,9.84388089127191,4.48486167382918,0,5.62880017672943,3.62721964824326,7.13537973112444,512.362796562349,5.02226492862606,3.94910851251228,1.1479010163187,32.9285121540632,226.097323292265,122.884916484714,91.4272873715035,24.6113021570441,1.26599061191693,0.831647273620318,2.19654275976457,4.01438660505675],"wall_concrete":[22076.040378248,405.903255968896,15.7210451745833,6.16492209570417,117.310172911459,10.4396998676085,90.6668906823217,3.72783482185017,122.497221447378,13.087716658438,26.2877523095536,3792.23297660327,0,56.8987616359077,158.635108643533,56.0456659942339,20.8567169378079,332.920729148977,517.951028484635,834.90444967845,982.885651791913,412.698531992501,171.551556084319,1661.47159641341,172.276853665474,165.602206110592,183.932538579635,47.8986610216674,97.147078809035,73.7988006722728,330.515428556606,126.916232987096,212.808575126748,250.575220884281,2786.12479526903,191.410656714098,502.304322348779,538.858213660549,220.661787203377,199.449298307298,390.31711899705,276.986874763482,140.641472282465,150.011691996187,175.483358995743,11341.3034212217,4964.74823522109,259.829162975662,139.450182464988,178.032781614374,82.2665242444536,102.042028218184,87.4929943201981,82.1301051846764,257.763074632023,110.673213236489,448.014046646917,438.726494668536,540.836730690191,883.712521299483,112.12154184573,270.563392397281,1359.35524268016,773.806858291896,249.738290589355,2089.00433277175,52.7337817505737,9.21458652919531,28.6975254079676,85.8493352588076,1095.96794114953,283.9476711006,243.376863566397,174.740245315013,88.6193428341849,4.98988364172191,20.8671562177634,246.884776210991],"wall_metal":[14366.2390292872,216.092994118753,4.83724466910255,0,20.2258918812861,6.2638199205651,63.2559702434802,0.931958705462542,85.4631777539848,14.5419073982645,20.5730235466072,664.204978812968,0,5.78631474263468,27.9197791212617,9.97408181786575,5.21417923445196,30.0379605247196,94.996502049215,102.629450624926,274.450876635156,12.8602941980666,14.0262278559506,1262.5560596849,72.0430478964709,45.0751566928239,38.6729952911028,9.08422881445416,38.858831523614,59.3599048885673,70.398593086064,239.244393217055,444.436956217086,245.381952057664,755.513276499978,23.0111172006019,70.182240647534,56.4416706008085,53.7653085571679,67.875415654316,101.821857129665,51.935039018153,62.301704826881,25.2019642553593,242.976958609491,9354.17158476428,2920.20304154063,157.795793040014,166.072490026486,73.3076159588599,226.232941672247,181.074579485208,134.155924624304,108.529067565465,165.178786600929,82.1830791360063,433.080245092019,376.051281144459,272.881191987583,803.944274669279,69.5153559443523,178.393445536668,1629.53765116317,875.369008442708,500.665811133898,2113.70013540635,81.6118050901735,13.1636950417076,86.0925762239027,174.050707100049,738.699651672437,294.685188074993,139.072493466512,363.0167068164,103.811230177188,34.9291854920533,84.566896250936,86.3093120087202],"wall_wood":[4656.25537513887,122.513426305331,4.83724466910255,1.02748701595069,3.03388378219291,10.4396998676085,35.8450498046388,1.86391741092508,48.4291340605914,10.1793351787851,6.85767451553572,1731.04979141606,0,189.019614926066,158.635108643533,22.3831398589371,4.3451493620433,48.8116858526694,134.174310329284,353.655539315623,563.773475649556,14.0294118524363,62.5785550496257,319.224638510573,29.2348600159592,10.7788418178492,10.3756816634666,9.91006779758636,12.1433848511294,11.2302522762154,23.8639298596827,166.304029431367,24.6105154908484,20.7730753064689,375.517951543406,43.9303146556945,25.0650859455478,102.233969390144,66.0865251015188,56.3888068512778,18.1824744874401,12.3654854805126,22.206548255126,25.2019642553593,3.85677712078556,1310.28458191621,409.110571037094,41.5252086947405,109.024688108991,104.725165655514,67.1843281329704,15.0061806203211,3.49971977280792,30.3099197705353,14.7293185504013,1.09577438848008,38.0133130488293,33.8446153030013,23.6431357678772,51.4977153394095,35.8788933906335,13.8750457639631,167.456805257701,73.7534661809463,76.1107171319941,797.66498544728,128.067755679965,73.7166922335625,3.44370304895611,27.0484206979805,103.556025935388,36.9847806895741,178.991449924493,114.442555030255,58.2355681481786,14.9696509251657,58.2083831337611,179.64380057629]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"total_households","name":"Total Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"roof_concrete","name":"Concrete","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"roof_metal","name":"Metal","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"roof_wood","name":"Wood","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"wall_concrete","name":"Concrete","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"wall_metal","name":"Metal","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"wall_wood","name":"Wood","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Total Households","columns":["total_households"]},{"name":"Main Roof Materials","columns":["roof_concrete","roof_metal","roof_wood"]},{"name":"Main Wall Materials","columns":["wall_concrete","wall_metal","wall_wood"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"0536c19daa26fb97a4e480cdb0e6a1c4"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimated-hazard-damage-3" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="estimated-hazard-damage-3"><span class="header-section-number">9.2</span> Estimated Hazard Damage</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load damage multiplier configuration</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>baseline_factors <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"2a Input- Damage Multiplier.csv"</span>),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Shelter damage functions</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>shelter_damage_functions <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"Shelter"</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get damage rate for a given indicator, attribute, area council, and intensity</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>get_shelter_damage_rate <span class="ot">&lt;-</span> <span class="cf">function</span>(indicator, attribute, area_council, intensity) {</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intensity <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, intensity)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  rate <span class="ot">&lt;-</span> shelter_damage_functions <span class="sc">%&gt;%</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator,</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute)),</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="sc">!!</span>intensity_col)</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(rate) <span class="sc">&gt;</span> <span class="dv">0</span>, rate, <span class="dv">0</span>))</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Get baseline shelter data at council level</span></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>shelter_baseline <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Get private households</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>private_households <span class="ot">&lt;-</span> shelter_baseline <span class="sc">%&gt;%</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"private households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">private_households =</span> Value)</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Get roof materials</span></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a>roof_materials <span class="ot">&lt;-</span> shelter_baseline <span class="sc">%&gt;%</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Roof Material"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">material =</span> <span class="fu">paste0</span>(<span class="st">"roof_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, material, Value) <span class="sc">%&gt;%</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> material,</span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Get wall materials</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a>wall_materials <span class="ot">&lt;-</span> shelter_baseline <span class="sc">%&gt;%</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Wall Material"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">material =</span> <span class="fu">paste0</span>(<span class="st">"wall_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, material, Value) <span class="sc">%&gt;%</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> material,</span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine baseline data</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a>shelter_baseline_wide <span class="ot">&lt;-</span> private_households <span class="sc">%&gt;%</span></span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(roof_materials, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(wall_materials, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with hazard intensity from config</span></span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a>shelter_with_intensity <span class="ot">&lt;-</span> shelter_baseline_wide <span class="sc">%&gt;%</span></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a>    config <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>, Intensity),</span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>)</span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intensity =</span> <span class="fu">replace_na</span>(Intensity, <span class="dv">0</span>))</span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage for each household type/material</span></span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a>shelter_damage_raw <span class="ot">&lt;-</span> shelter_with_intensity <span class="sc">%&gt;%</span></span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Private households damaged</span></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">private_households_damaged =</span> private_households <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Type"</span>, <span class="st">"private households"</span>, Region, Intensity),</span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Roof materials damaged</span></span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_concrete_damaged =</span> roof_concrete <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"concrete"</span>, Region, Intensity),</span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_metal_damaged =</span> roof_metal <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"metal"</span>, Region, Intensity),</span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_wood_damaged =</span> roof_wood <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"wood"</span>, Region, Intensity),</span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Wall materials damaged</span></span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_concrete_damaged =</span> wall_concrete <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"concrete"</span>, Region, Intensity),</span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_metal_damaged =</span> wall_metal <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"metal"</span>, Region, Intensity),</span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_wood_damaged =</span> wall_wood <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"wood"</span>, Region, Intensity)</span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Round for presentation</span></span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a>shelter_damage_rounded <span class="ot">&lt;-</span> shelter_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Intensity <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">ends_with</span>(<span class="st">"_damaged"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a>shelter_damage_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(shelter_damage_rounded)</span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a>shelter_damage_ordered <span class="ot">&lt;-</span> shelter_damage_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, private_households_damaged,</span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a>         roof_concrete_damaged, roof_metal_damaged, roof_wood_damaged,</span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a>         wall_concrete_damaged, wall_metal_damaged, wall_wood_damaged)</span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a>  shelter_damage_ordered,</span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Shelter_02_estimated_damage.csv"</span>),</span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-118"><a href="#cb40-118" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb40-119"><a href="#cb40-119" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(shelter_damage_ordered)</span>
<span id="cb40-120"><a href="#cb40-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-121"><a href="#cb40-121" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb40-122"><a href="#cb40-122" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb40-123"><a href="#cb40-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb40-124"><a href="#cb40-124" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb40-125"><a href="#cb40-125" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb40-126"><a href="#cb40-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb40-127"><a href="#cb40-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-128"><a href="#cb40-128" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb40-129"><a href="#cb40-129" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-130"><a href="#cb40-130" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb40-131"><a href="#cb40-131" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-132"><a href="#cb40-132" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-133"><a href="#cb40-133" aria-hidden="true" tabindex="-1"></a>    <span class="at">private_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total Private Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb40-134"><a href="#cb40-134" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-135"><a href="#cb40-135" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_concrete_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb40-136"><a href="#cb40-136" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_metal_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb40-137"><a href="#cb40-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_wood_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb40-138"><a href="#cb40-138" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb40-139"><a href="#cb40-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_concrete_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb40-140"><a href="#cb40-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_metal_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb40-141"><a href="#cb40-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_wood_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb40-142"><a href="#cb40-142" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb40-143"><a href="#cb40-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb40-144"><a href="#cb40-144" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb40-145"><a href="#cb40-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Number of Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"private_households_damaged"</span>)),</span>
<span id="cb40-146"><a href="#cb40-146" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Roof Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"roof_concrete_damaged"</span>, <span class="st">"roof_metal_damaged"</span>, <span class="st">"roof_wood_damaged"</span>)),</span>
<span id="cb40-147"><a href="#cb40-147" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Wall Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"wall_concrete_damaged"</span>, <span class="st">"wall_metal_damaged"</span>, <span class="st">"wall_wood_damaged"</span>))</span>
<span id="cb40-148"><a href="#cb40-148" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb40-149"><a href="#cb40-149" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-150"><a href="#cb40-150" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-151"><a href="#cb40-151" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-152"><a href="#cb40-152" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb40-153"><a href="#cb40-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb40-154"><a href="#cb40-154" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb40-155"><a href="#cb40-155" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb40-156"><a href="#cb40-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb40-157"><a href="#cb40-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb40-158"><a href="#cb40-158" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb40-159"><a href="#cb40-159" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb40-160"><a href="#cb40-160" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb40-161"><a href="#cb40-161" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb40-162"><a href="#cb40-162" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb40-163"><a href="#cb40-163" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-8af11405fe97ad6ff1d8" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8af11405fe97ad6ff1d8">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"private_households_damaged":[23176,1028,118,153,153,93,115,120,100,38,60,78,16724,6222,432,327,425,327,227,164,162,328,138,706,605,621,1330,171,334,2303,1275,627,5424,184,75,69,511,1783,790,711,890,202,43,166],"roof_concrete_damaged":[726,24,2,7,6,2,1,1,0,1,3,1,506,266,6,5,16,0,0,1,1,13,3,14,11,15,37,29,10,41,31,7,196,3,0,2,8,99,18,42,17,4,1,2],"roof_metal_damaged":[16551,296,18,36,50,34,17,37,36,9,15,44,14342,5682,245,194,174,224,184,142,136,283,124,622,546,557,1236,138,299,2074,1043,439,1913,102,24,39,199,753,272,171,138,99,27,89],"roof_wood_damaged":[502,3,0,2,0,0,0,0,0,1,0,0,243,122,77,4,0,1,0,0,0,0,1,3,0,13,7,3,0,4,3,5,256,3,2,1,16,113,61,46,12,1,0,1],"wall_concrete_damaged":[9261,279,19,50,54,22,20,39,28,14,15,18,7939,3475,182,98,125,58,71,61,57,180,77,314,307,379,619,78,189,952,542,175,1043,26,5,14,43,548,142,122,87,44,2,10],"wall_metal_damaged":[7680,75,2,7,6,5,7,10,5,6,3,24,6548,2044,110,116,51,158,127,94,76,116,58,303,263,191,563,49,125,1141,613,350,1057,41,7,43,87,369,147,70,182,52,17,42],"wall_wood_damaged":[1353,38,4,3,10,7,6,2,1,2,3,0,917,286,29,76,73,47,11,2,21,10,1,27,24,17,36,25,10,117,52,53,398,64,37,2,14,52,18,89,57,29,7,29]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"private_households_damaged","name":"Total Private Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"roof_concrete_damaged","name":"Concrete","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"roof_metal_damaged","name":"Metal","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"roof_wood_damaged","name":"Wood","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"wall_concrete_damaged","name":"Concrete","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"wall_metal_damaged","name":"Metal","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"wall_wood_damaged","name":"Wood","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Number of Households","columns":["private_households_damaged"]},{"name":"Main Roof Materials","columns":["roof_concrete_damaged","roof_metal_damaged","roof_wood_damaged"]},{"name":"Main Wall Materials","columns":["wall_concrete_damaged","wall_metal_damaged","wall_wood_damaged"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"fa56b1e4eadcb1694340126652602f7f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="immediate-response-resources-5" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="immediate-response-resources-5"><span class="header-section-number">9.3</span> Immediate Response Resources</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load resources configuration</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>resource_config <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"3aii Input- Resources Sent.csv"</span>),</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Shelter resources</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>shelter_resources <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"Shelter"</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get resource quantity per household</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>get_shelter_resource_quantity <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  quantity <span class="ot">&lt;-</span> shelter_resources <span class="sc">%&gt;%</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Indicator)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(resource_type)),</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(quantity) <span class="sc">&gt;</span> <span class="dv">0</span>, quantity, <span class="dv">0</span>))</span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the damaged households from previous section</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>shelter_resources_calc <span class="ot">&lt;-</span> shelter_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Intensity <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span>  <span class="co"># &lt;-- ADD THIS LINE</span></span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, private_households_damaged) <span class="sc">%&gt;%</span></span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate resource needs based on damaged households</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">tent =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"tent"</span>, Region),</span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_lamp =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"solar lamp"</span>, Region),</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">kitchen_set =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"kitchen set"</span>, Region),</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">jerrycan_10l =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"jerrycan 10l"</span>, Region),</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">sleeping_mat =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"sleeping mat"</span>, Region),</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">blanket =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"blanket"</span>, Region)</span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Round for presentation</span></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a>shelter_resources_rounded <span class="ot">&lt;-</span> shelter_resources_calc <span class="sc">%&gt;%</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>shelter_resources_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(shelter_resources_rounded)</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a>shelter_resources_ordered <span class="ot">&lt;-</span> shelter_resources_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, private_households_damaged, tent, solar_lamp, kitchen_set, </span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>         jerrycan_10l, sleeping_mat, blanket)</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a>  shelter_resources_ordered,</span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Shelter_03_resources.csv"</span>),</span>
<span id="cb41-57"><a href="#cb41-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb41-58"><a href="#cb41-58" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-59"><a href="#cb41-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-60"><a href="#cb41-60" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb41-61"><a href="#cb41-61" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(shelter_resources_ordered)</span>
<span id="cb41-62"><a href="#cb41-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-63"><a href="#cb41-63" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb41-64"><a href="#cb41-64" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb41-65"><a href="#cb41-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb41-66"><a href="#cb41-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb41-67"><a href="#cb41-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb41-68"><a href="#cb41-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb41-69"><a href="#cb41-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-70"><a href="#cb41-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb41-71"><a href="#cb41-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-72"><a href="#cb41-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb41-73"><a href="#cb41-73" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-74"><a href="#cb41-74" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb41-75"><a href="#cb41-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">private_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Number of Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb41-76"><a href="#cb41-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">tent =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tent"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb41-77"><a href="#cb41-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_lamp =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Lamp"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb41-78"><a href="#cb41-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">kitchen_set =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Kitchen Set"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb41-79"><a href="#cb41-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">jerrycan_10l =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Jerrycan 10L"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb41-80"><a href="#cb41-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">sleeping_mat =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sleeping Mat"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb41-81"><a href="#cb41-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">blanket =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Blanket"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb41-82"><a href="#cb41-82" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb41-83"><a href="#cb41-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb41-84"><a href="#cb41-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb41-85"><a href="#cb41-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Number of Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"private_households_damaged"</span>)),</span>
<span id="cb41-86"><a href="#cb41-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Resources"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"tent"</span>, <span class="st">"solar_lamp"</span>, <span class="st">"kitchen_set"</span>, </span>
<span id="cb41-87"><a href="#cb41-87" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"jerrycan_10l"</span>, <span class="st">"sleeping_mat"</span>, <span class="st">"blanket"</span>))</span>
<span id="cb41-88"><a href="#cb41-88" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb41-89"><a href="#cb41-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-90"><a href="#cb41-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-91"><a href="#cb41-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-92"><a href="#cb41-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb41-93"><a href="#cb41-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb41-94"><a href="#cb41-94" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb41-95"><a href="#cb41-95" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb41-96"><a href="#cb41-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb41-97"><a href="#cb41-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb41-98"><a href="#cb41-98" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb41-99"><a href="#cb41-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb41-100"><a href="#cb41-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-101"><a href="#cb41-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb41-102"><a href="#cb41-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb41-103"><a href="#cb41-103" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-29e7be7ada9ed6e235ab" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-29e7be7ada9ed6e235ab">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"private_households_damaged":[23176,1028,118,153,153,93,115,120,100,38,60,78,16724,6222,432,327,425,327,227,164,162,328,138,706,605,621,1330,171,334,2303,1275,627,5424,184,75,69,511,1783,790,711,890,202,43,166],"tent":[23176,1028,118,153,153,93,115,120,100,38,60,78,16724,6222,432,327,425,327,227,164,162,328,138,706,605,621,1330,171,334,2303,1275,627,5424,184,75,69,511,1783,790,711,890,202,43,166],"solar_lamp":[23176,1028,118,153,153,93,115,120,100,38,60,78,16724,6222,432,327,425,327,227,164,162,328,138,706,605,621,1330,171,334,2303,1275,627,5424,184,75,69,511,1783,790,711,890,202,43,166],"kitchen_set":[23176,1028,118,153,153,93,115,120,100,38,60,78,16724,6222,432,327,425,327,227,164,162,328,138,706,605,621,1330,171,334,2303,1275,627,5424,184,75,69,511,1783,790,711,890,202,43,166],"jerrycan_10l":[23176,1028,118,153,153,93,115,120,100,38,60,78,16724,6222,432,327,425,327,227,164,162,328,138,706,605,621,1330,171,334,2303,1275,627,5424,184,75,69,511,1783,790,711,890,202,43,166],"sleeping_mat":[23176,1028,118,153,153,93,115,120,100,38,60,78,16724,6222,432,327,425,327,227,164,162,328,138,706,605,621,1330,171,334,2303,1275,627,5424,184,75,69,511,1783,790,711,890,202,43,166],"blanket":[23176,1028,118,153,153,93,115,120,100,38,60,78,16724,6222,432,327,425,327,227,164,162,328,138,706,605,621,1330,171,334,2303,1275,627,5424,184,75,69,511,1783,790,711,890,202,43,166]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"private_households_damaged","name":"Number of Households","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"tent","name":"Tent","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"solar_lamp","name":"Solar Lamp","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"kitchen_set","name":"Kitchen Set","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"jerrycan_10l","name":"Jerrycan 10L","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"sleeping_mat","name":"Sleeping Mat","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"blanket","name":"Blanket","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Number of Households","columns":["private_households_damaged"]},{"name":"Resources","columns":["tent","solar_lamp","kitchen_set","jerrycan_10l","sleeping_mat","blanket"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"de2fa6c1a060310709ef8e2d50c5f638"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimated-financial-damage-4" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="estimated-financial-damage-4"><span class="header-section-number">9.4</span> Estimated Financial Damage</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Load financial configuration</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>financial_config <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"4a Input- Finance Estimates.csv"</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Shelter financial costs</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>shelter_financial <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"Shelter"</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get unit cost for shelter items</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>get_shelter_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(indicator, attribute, area_council) {</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> shelter_financial <span class="sc">%&gt;%</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator,</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute)),</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Get baseline appliance data at council level</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>appliance_baseline <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>, Indicator <span class="sc">==</span> <span class="st">"Household Appliances"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value) <span class="sc">%&gt;%</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> Attribute,</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"appliance_"</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Get baseline private households (needed for damage rate calculation)</span></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>baseline_private_households <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>, Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"private households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">private_households_baseline =</span> Value)</span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the raw damage estimates (before rounding) for financial calculations</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>shelter_financial_calc <span class="ot">&lt;-</span> shelter_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Intensity <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span>  <span class="co"># &lt;-- ADD THIS LIN</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(appliance_baseline, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(baseline_private_households, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for roof materials</span></span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_concrete_financial =</span> roof_concrete_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"concrete"</span>, Region),</span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_metal_financial =</span> roof_metal_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"metal"</span>, Region),</span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_wood_financial =</span> roof_wood_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"wood"</span>, Region),</span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for wall materials</span></span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_concrete_financial =</span> wall_concrete_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"concrete"</span>, Region),</span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_metal_financial =</span> wall_metal_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"metal"</span>, Region),</span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_wood_financial =</span> wall_wood_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"wood"</span>, Region),</span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate damaged appliances based on household damage rate</span></span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">damage_rate =</span> <span class="fu">ifelse</span>(private_households_baseline <span class="sc">&gt;</span> <span class="dv">0</span>, private_households_damaged <span class="sc">/</span> private_households_baseline, <span class="dv">0</span>),</span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">freezer_damaged =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(appliance_freezer), appliance_freezer <span class="sc">*</span> damage_rate, <span class="dv">0</span>),</span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a>    <span class="at">refrigerator_damaged =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(appliance_refrigerator), appliance_refrigerator <span class="sc">*</span> damage_rate, <span class="dv">0</span>),</span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">tv_damaged =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(appliance_tv), appliance_tv <span class="sc">*</span> damage_rate, <span class="dv">0</span>),</span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate financial damage for appliances</span></span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">freezer_financial =</span> freezer_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Appliances"</span>, <span class="st">"freezer"</span>, Region),</span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">refrigerator_financial =</span> refrigerator_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Appliances"</span>, <span class="st">"refridgerator"</span>, Region),</span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">tv_financial =</span> tv_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Appliances"</span>, <span class="st">"tv"</span>, Region),</span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total household financial damage (sum of all components)</span></span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">private_households_financial =</span> roof_concrete_financial <span class="sc">+</span> roof_metal_financial <span class="sc">+</span> roof_wood_financial <span class="sc">+</span></span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a>                                   wall_concrete_financial <span class="sc">+</span> wall_metal_financial <span class="sc">+</span> wall_wood_financial <span class="sc">+</span></span>
<span id="cb42-80"><a href="#cb42-80" aria-hidden="true" tabindex="-1"></a>                                   freezer_financial <span class="sc">+</span> refrigerator_financial <span class="sc">+</span> tv_financial,</span>
<span id="cb42-81"><a href="#cb42-81" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-82"><a href="#cb42-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total financial damage (same as private households since that's the sum of all components)</span></span>
<span id="cb42-83"><a href="#cb42-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial =</span> private_households_financial</span>
<span id="cb42-84"><a href="#cb42-84" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb42-85"><a href="#cb42-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb42-86"><a href="#cb42-86" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial, private_households_financial,</span>
<span id="cb42-87"><a href="#cb42-87" aria-hidden="true" tabindex="-1"></a>         roof_concrete_financial, roof_metal_financial, roof_wood_financial,</span>
<span id="cb42-88"><a href="#cb42-88" aria-hidden="true" tabindex="-1"></a>         wall_concrete_financial, wall_metal_financial, wall_wood_financial,</span>
<span id="cb42-89"><a href="#cb42-89" aria-hidden="true" tabindex="-1"></a>         freezer_financial, refrigerator_financial, tv_financial)</span>
<span id="cb42-90"><a href="#cb42-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-91"><a href="#cb42-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb42-92"><a href="#cb42-92" aria-hidden="true" tabindex="-1"></a>shelter_financial_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(shelter_financial_calc)</span>
<span id="cb42-93"><a href="#cb42-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-94"><a href="#cb42-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb42-95"><a href="#cb42-95" aria-hidden="true" tabindex="-1"></a>shelter_financial_ordered <span class="ot">&lt;-</span> shelter_financial_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb42-96"><a href="#cb42-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial, private_households_financial,</span>
<span id="cb42-97"><a href="#cb42-97" aria-hidden="true" tabindex="-1"></a>         roof_concrete_financial, roof_metal_financial, roof_wood_financial,</span>
<span id="cb42-98"><a href="#cb42-98" aria-hidden="true" tabindex="-1"></a>         wall_concrete_financial, wall_metal_financial, wall_wood_financial,</span>
<span id="cb42-99"><a href="#cb42-99" aria-hidden="true" tabindex="-1"></a>         freezer_financial, refrigerator_financial, tv_financial)</span>
<span id="cb42-100"><a href="#cb42-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-101"><a href="#cb42-101" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb42-102"><a href="#cb42-102" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb42-103"><a href="#cb42-103" aria-hidden="true" tabindex="-1"></a>  shelter_financial_ordered,</span>
<span id="cb42-104"><a href="#cb42-104" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Shelter_04_financial_damage.csv"</span>),</span>
<span id="cb42-105"><a href="#cb42-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb42-106"><a href="#cb42-106" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-107"><a href="#cb42-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-108"><a href="#cb42-108" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb42-109"><a href="#cb42-109" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(shelter_financial_ordered)</span>
<span id="cb42-110"><a href="#cb42-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-111"><a href="#cb42-111" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb42-112"><a href="#cb42-112" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb42-113"><a href="#cb42-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb42-114"><a href="#cb42-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-115"><a href="#cb42-115" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb42-116"><a href="#cb42-116" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb42-117"><a href="#cb42-117" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb42-118"><a href="#cb42-118" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb42-119"><a href="#cb42-119" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-120"><a href="#cb42-120" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-121"><a href="#cb42-121" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-122"><a href="#cb42-122" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb42-123"><a href="#cb42-123" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb42-124"><a href="#cb42-124" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-125"><a href="#cb42-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">private_households_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-126"><a href="#cb42-126" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Private Households"</span>,</span>
<span id="cb42-127"><a href="#cb42-127" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb42-128"><a href="#cb42-128" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-129"><a href="#cb42-129" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-130"><a href="#cb42-130" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_concrete_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-131"><a href="#cb42-131" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Concrete"</span>,</span>
<span id="cb42-132"><a href="#cb42-132" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb42-133"><a href="#cb42-133" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-134"><a href="#cb42-134" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_metal_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-135"><a href="#cb42-135" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Metal"</span>,</span>
<span id="cb42-136"><a href="#cb42-136" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb42-137"><a href="#cb42-137" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-138"><a href="#cb42-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_wood_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-139"><a href="#cb42-139" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Wood"</span>,</span>
<span id="cb42-140"><a href="#cb42-140" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb42-141"><a href="#cb42-141" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-142"><a href="#cb42-142" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-143"><a href="#cb42-143" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_concrete_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-144"><a href="#cb42-144" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Concrete"</span>,</span>
<span id="cb42-145"><a href="#cb42-145" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb42-146"><a href="#cb42-146" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-147"><a href="#cb42-147" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_metal_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-148"><a href="#cb42-148" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Metal"</span>,</span>
<span id="cb42-149"><a href="#cb42-149" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb42-150"><a href="#cb42-150" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-151"><a href="#cb42-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_wood_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-152"><a href="#cb42-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Wood"</span>,</span>
<span id="cb42-153"><a href="#cb42-153" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb42-154"><a href="#cb42-154" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-155"><a href="#cb42-155" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-156"><a href="#cb42-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">freezer_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-157"><a href="#cb42-157" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Freezer"</span>,</span>
<span id="cb42-158"><a href="#cb42-158" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb42-159"><a href="#cb42-159" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-160"><a href="#cb42-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">refrigerator_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-161"><a href="#cb42-161" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Refrigerator"</span>,</span>
<span id="cb42-162"><a href="#cb42-162" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb42-163"><a href="#cb42-163" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-164"><a href="#cb42-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">tv_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb42-165"><a href="#cb42-165" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"TV"</span>,</span>
<span id="cb42-166"><a href="#cb42-166" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb42-167"><a href="#cb42-167" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb42-168"><a href="#cb42-168" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb42-169"><a href="#cb42-169" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb42-170"><a href="#cb42-170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb42-171"><a href="#cb42-171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Value"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_financial"</span>)),</span>
<span id="cb42-172"><a href="#cb42-172" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Private Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"private_households_financial"</span>)),</span>
<span id="cb42-173"><a href="#cb42-173" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Roof Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"roof_concrete_financial"</span>, <span class="st">"roof_metal_financial"</span>, <span class="st">"roof_wood_financial"</span>)),</span>
<span id="cb42-174"><a href="#cb42-174" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Wall Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"wall_concrete_financial"</span>, <span class="st">"wall_metal_financial"</span>, <span class="st">"wall_wood_financial"</span>)),</span>
<span id="cb42-175"><a href="#cb42-175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Appliances"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"freezer_financial"</span>, <span class="st">"refrigerator_financial"</span>, <span class="st">"tv_financial"</span>))</span>
<span id="cb42-176"><a href="#cb42-176" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb42-177"><a href="#cb42-177" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-178"><a href="#cb42-178" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-179"><a href="#cb42-179" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-180"><a href="#cb42-180" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb42-181"><a href="#cb42-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb42-182"><a href="#cb42-182" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb42-183"><a href="#cb42-183" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb42-184"><a href="#cb42-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb42-185"><a href="#cb42-185" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb42-186"><a href="#cb42-186" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb42-187"><a href="#cb42-187" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb42-188"><a href="#cb42-188" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb42-189"><a href="#cb42-189" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb42-190"><a href="#cb42-190" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb42-191"><a href="#cb42-191" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-2deb24f66c6624693410" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2deb24f66c6624693410">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum"],"total_financial":[159336524416.962,4419701822.10911,298605854.273357,780944861.977932,841018164.753387,351813296.543829,319312061.167001,613401534.978352,432953979.677735,226717754.410709,235217132.956485,319717181.370321,136476812204.724,58075001912.7187,3012496095.01038,1770294711.81439,2045758984.75592,1240136317.48418,1359364883.85303,1131368409.83471,1049054677.6993,2999824568.58966,1299691427.5299,5483933587.01979,5276932081.634,6230534695.22473,10742620802.2659,1351983975.88418,3184586628.69905,17148916512.8306,9634574884.88154,3439737046.99374,18440010390.1293,527632875.570294,104480247.546033,309697954.697705,860686626.701195,9204896663.01365,2486415222.31356,2058124816.85301,1734813772.0968,800840341.28641,81093925.6507172,271327944.399918],"private_households_financial":[159336524416.962,4419701822.10911,298605854.273357,780944861.977932,841018164.753387,351813296.543829,319312061.167001,613401534.978352,432953979.677735,226717754.410709,235217132.956485,319717181.370321,136476812204.724,58075001912.7187,3012496095.01038,1770294711.81439,2045758984.75592,1240136317.48418,1359364883.85303,1131368409.83471,1049054677.6993,2999824568.58966,1299691427.5299,5483933587.01979,5276932081.634,6230534695.22473,10742620802.2659,1351983975.88418,3184586628.69905,17148916512.8306,9634574884.88154,3439737046.99374,18440010390.1293,527632875.570294,104480247.546033,309697954.697705,860686626.701195,9204896663.01365,2486415222.31356,2058124816.85301,1734813772.0968,800840341.28641,81093925.6507172,271327944.399918],"roof_concrete_financial":[362419914.352415,11544287.9879077,941363.885479165,3258461.17292122,2928577.24815516,784077.4164587,574330.440151905,545474.234623205,185482.282207689,524321.27824603,1320102.88956644,482097.140098196,253061772.268151,132960935.587055,2906764.60863184,2662230.75614977,8247106.79537174,0,0,408300.640160924,342208.771602818,6259960.38392056,1534084.14387212,7127496.19665548,5264717.93602244,7585506.05886059,18713272.0311824,14519739.669022,4856266.01738709,20685840.6494806,15657498.1482501,3329843.87452474,97813854.0963567,1255566.23215652,0,860925.762239028,3822059.44645375,49620595.7607068,9246195.17239353,21247186.5018283,8306314.47800238,2215483.57085462,415823.63681016,823703.534911715],"roof_metal_financial":[2483283737.18607,44568197.1725155,2745644.6659809,5459175.71894033,7475859.01165427,5174910.9486274,2553159.86576619,5491107.29520694,5378986.18402298,1397161.99438501,2268176.78298233,6624014.70494921,2151514664.12482,852360713.86418,36749809.6948454,29151426.77984,26115838.1853438,33544175.260676,27626378.5220111,21313293.4164002,20429863.6646882,42420437.4251558,18639122.3480463,93370200.1761869,81866363.9051487,83578484.9394459,185391513.005159,20720060.9330908,44851085.4320108,311174145.770045,156405711.232249,65806039.5702951,287200875.888732,15349297.1881134,3652925.37407386,5854295.18322538,29900265.0541806,113005513.301992,40802564.5026914,25689780.0431197,20673493.811917,14812090.159428,4116654.00442057,13343997.2655698],"roof_wood_financial":[10075534.0700583,94188.0728400721,0,36093.723761589,6389.62308688398,4480.44237976398,4176.94865565022,4848.65986331738,0,27141.336756265,7200.56121581694,3856.77712078556,4857718.03159474,2440556.16515232,1544737.76344434,88741.0252049923,0,19195.5223237058,0,0,0,0,15340.8414387211,57019.9695732439,0,262044.754760639,137814.332477807,62788.0634336085,0,78803.202474212,50781.0750754056,99895.3162357421,5123627.96562349,50222.6492862606,39491.0851251228,11479.010163187,329285.121540632,2260973.23292265,1228849.16484714,914272.873715035,246113.021570441,12659.9061191693,8316.47273620318,21965.4275976457],"wall_concrete_financial":[138930405611.519,4179187192.90354,287115985.071147,753456483.523169,808287320.490824,330992680.805066,299173947.460947,585475678.495575,415480312.145223,210962208.423698,225017537.994281,263225038.493615,119083685922.828,52129856469.8214,2728206211.24445,1464226915.88237,1869344206.95093,863798504.566763,1071441296.29093,918676440.36208,862366104.439102,2706512283.63624,1162068738.98313,4704147489.79263,4606628194.01963,5678785672.247,9278981473.64457,1177276189.38016,2840915620.17145,14273230048.1417,8124972012.06491,2622252051.18823,15667532495.7882,395503363.129303,69109398.9689648,215231440.559757,643870014.441057,8219759558.62147,2129607533.2545,1825326476.74798,1310551839.8626,664645071.256387,37424127.3129143,156503671.633226],"wall_metal_financial":[15360643009.3763,151102655.299996,4602223.44012038,14036448.1295068,11288334.1201617,10753061.7114336,13575083.1308632,20364371.425933,10387007.8036306,12460340.9653762,5040392.85107186,48595391.7218982,13095840218.67,4088284258.15688,220914110.25602,232501486.03708,102630662.342404,316726118.341146,253504411.279291,187818294.474026,151940694.591651,231250301.241301,115056310.790409,606312343.128827,526471793.602243,382033668.782616,1125521984.53699,97321498.3220932,249750823.751335,2281352711.62844,1225516611.81979,700932135.587457,2113700135.40635,81611805.0901735,13163695.0417076,86092576.2239027,174050707.100049,738699651.672437,294685188.074993,139072493.466512,363016706.8164,103811230.177188,34929185.4920533,84566896.250936],"wall_wood_financial":[676791747.609664,18775897.5771703,2196515.73278473,1253254.29727739,5111698.4695072,3304326.25507594,2819440.34256389,909123.724372005,618274.27402563,1110327.4127563,1260098.21276797,192838.856039278,458599603.670674,143188699.862983,14533823.0431592,38158640.8381468,36653807.9794299,23514514.8465396,5252163.21711238,1224901.92048277,10608471.9196874,5155261.49264046,383521.035968028,13304659.5670903,11845615.3560505,8275097.51875702,18024200.3687933,12557612.6867217,4856266.01738709,58609881.8401954,25813713.1633312,26638750.9961979,199416246.36182,32016938.9199912,18429173.0583906,860925.762239028,6762105.17449513,25889006.483847,9246195.17239353,44747862.4811232,28610638.7575637,14558892.0370446,3742412.73129142,14552095.7834403],"freezer_financial":[355400188.173937,6614885.15089951,476957.701976111,1311405.29667107,2900888.88144533,524211.758432386,175431.843537308,378195.469338757,504511.807604914,103630.558523922,100807.857021437,138843.97634828,323366946.974105,147110518.440511,2591173.02255181,1597338.45368987,879691.391506318,1151731.33942235,1008415.33768558,783937.229108975,1396211.7881395,3976916.00860835,1196585.63222025,22009708.2552722,14846504.5795833,18701720.3923909,20421235.6583432,7063657.13628097,8075276.63462654,45154235.0177235,20007743.5797098,5394347.07673008,25418356.0489325,1506679.47858782,0,0,705610.974729924,19986313.00553,214750.339487849,463574.978221708,1181342.50353812,303837.746860063,199595.345668876,856651.676308182],"refrigerator_financial":[617183297.682057,2899915.37261215,95182.3484206713,729895.302734354,1162911.40181288,189298.690545028,122175.748177769,63032.5782231261,321502.622493328,72171.2818291595,93607.2958056202,50138.1025702123,591019952.041867,329009542.680246,1619483.13909488,1038269.99489841,476499.50373259,374312.685312264,91037.4957632813,0,533845.683700397,1053146.27635369,99715.4693516873,17913773.7742608,13916404.410886,27611242.0542526,55573215.3790953,12243672.3695536,20111878.8348645,73887852.719883,31137262.5337362,4328797.03688216,23263430.2675782,163223.610180347,85564.0177710994,746135.660607155,382205.944645376,19969053.667874,465292.402223673,167402.07546895,719880.588093537,82289.3897746005,54057.0727853207,428325.838154092],"tv_financial":[540321376.99224,4914602.57162427,431981.427447662,1403644.81295068,1856185.50673979,86248.515810457,314315.386337679,169703.095216108,77902.5585272291,60451.1591389542,109208.511773223,404961.597682484,514865406.114872,249790218.140286,3429982.23818557,869662.047008927,1411171.60720805,1007764.92199456,441181.71023744,1143241.79245059,1437276.84073184,3196262.12543709,698008.285461814,19690896.1592936,16092487.8244419,23701258.4766399,39856093.3093004,10218757.3238198,11169411.8399903,84742993.8607059,35013551.2644922,10955186.3471864,20541368.3057435,175779.272501912,0,40176.5355711545,864373.444044159,15705997.2668672,918654.230031356,495767.685042661,1507442.25711895,398787.04275383,203753.582036978,230636.98977528]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_financial","name":"Total Value","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"private_households_financial","name":"Total Private Households","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"roof_concrete_financial","name":"Concrete","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"roof_metal_financial","name":"Metal","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"roof_wood_financial","name":"Wood","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"wall_concrete_financial","name":"Concrete","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"wall_metal_financial","name":"Metal","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"wall_wood_financial","name":"Wood","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"freezer_financial","name":"Freezer","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"refrigerator_financial","name":"Refrigerator","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"tv_financial","name":"TV","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Total Value","columns":["total_financial"]},{"name":"Total Private Households","columns":["private_households_financial"]},{"name":"Main Roof Materials","columns":["roof_concrete_financial","roof_metal_financial","roof_wood_financial"]},{"name":"Main Wall Materials","columns":["wall_concrete_financial","wall_metal_financial","wall_wood_financial"]},{"name":"Household Appliances","columns":["freezer_financial","refrigerator_financial","tv_financial"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"bd6df7e3a9ff8638c216606caf502733"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="wash" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> WASH</h1>
<section id="baseline-1" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="baseline-1"><span class="header-section-number">10.1</span> Baseline</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for WASH baseline at Area Council level</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>wash_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"WASH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get total households from Shelter baseline (since WASH doesn't have it)</span></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>total_households <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>, Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"number households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">total_households =</span> Value)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Get drinking water sources</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>drinking_water <span class="ot">&lt;-</span> wash_data <span class="sc">%&gt;%</span></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Drinking Water"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">water_type =</span> <span class="fu">paste0</span>(<span class="st">"water_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, water_type, Value) <span class="sc">%&gt;%</span></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> water_type,</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Get toilet types</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>toilet_type <span class="ot">&lt;-</span> wash_data <span class="sc">%&gt;%</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Toilet"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">toilet_type =</span> <span class="fu">paste0</span>(<span class="st">"toilet_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, toilet_type, Value) <span class="sc">%&gt;%</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> toilet_type,</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all data</span></span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>wash_wide <span class="ot">&lt;-</span> total_households <span class="sc">%&gt;%</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(drinking_water, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(toilet_type, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>wash_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(wash_wide)</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  wash_aggregated <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"WASH_01_baseline.csv"</span>),</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(wash_aggregated)</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_piped =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Piped"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_well =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Well"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_tank =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tank"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">toilet_pit latrine</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Pit Latrine"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_vip =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"VIP"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_flush =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Flush"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">toilet_water sealed</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water Sealed"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households"</span>)),</span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Drinking Water"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"water_piped"</span>, <span class="st">"water_well"</span>, <span class="st">"water_tank"</span>)),</span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Toilet Type"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"toilet_pit latrine"</span>, <span class="st">"toilet_vip"</span>, <span class="st">"toilet_flush"</span>, <span class="st">"toilet_water sealed"</span>))</span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb43-94"><a href="#cb43-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb43-95"><a href="#cb43-95" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb43-96"><a href="#cb43-96" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb43-97"><a href="#cb43-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb43-98"><a href="#cb43-98" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-99"><a href="#cb43-99" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb43-100"><a href="#cb43-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb43-101"><a href="#cb43-101" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-f24827c0d785e6ec7028" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f24827c0d785e6ec7028">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"total_households":[72482.0546920189,2794.95252753011,251.536722793333,95.5562924834146,403.506543031657,352.861855525167,399.483016622889,121.069311546954,736.395575324238,273.387859087372,161.15535111509,15197.264125121,4011.10961674314,313.385436919143,899.778336226117,555.824444268251,506.606466711524,1320.33984160773,1263.23800890242,1761.34327423859,2215.88663450749,776.294122501475,515.73360885726,9200.13931705135,606.924608004948,593.436796206294,476.457889720776,236.189949175808,767.461922591376,620.864206151392,1683.41539017212,1095.50324205733,1539.83327247302,1580.05204049829,10353.2774827892,1188.86767401795,1539.62290420528,1541.65738237234,935.199541294908,1153.86214879327,1202.44366657817,1007.7042284521,385.450635837244,605.948867341972,792.520433895933,24030.8306358174,8958.28660829032,620.505261352837,467.791975723459,610.02408994337,470.290296930793,327.891570980372,237.737908455605,232.625876024746,468.181911066327,197.239389926415,1023.64421567205,872.350722672883,887.60272195239,1904.00050406432,245.525974562536,486.365911492837,3298.47690356345,1825.63717105486,896.651622087837,10905.5906037098,374.158737182642,151.382492979637,140.043923990882,1021.95989506718,3601.9013798503,1581.98340313245,1424.05385466799,1782.97527561199,403.851005201499,87.3229637301334,335.957672295088,1057.72433363789],"water_tank":[26479.7678038288,1298.87194279908,247.908789291506,13.357331207359,88.9939242776587,54.2864393115642,142.972869107139,118.358755593743,91.6140166090663,381.367412038547,160.0124053625,6962.7261967335,1259.11884205223,7.7150863235129,326.153783371104,58.5684585643309,4.34441051671733,138.925567426828,597.685775127484,1287.02878621529,1658.87303266668,581.051474221736,323.682181291167,4654.92250097921,241.187595131663,302.78746561049,264.108260524604,132.960076284284,153.00664912423,94.6549834709586,1225.41279829471,1045.96481668676,1010.4788125066,184.361043344911,3169.88809444047,139.112663076366,525.364201418683,288.597976090927,320.351630153125,96.0698190799549,689.721865556898,395.695535376404,106.097952774491,115.208979453071,493.667471460551,8069.7413493108,677.148531371742,290.676460863184,162.269303231986,265.740107850867,275.59285621892,237.097653801073,180.818854928409,187.725954707832,370.337152124376,154.504188775692,481.954504726228,696.94837438773,668.903716099526,260.829666111169,22.424308369146,111.000366111705,1300.2528408245,1228.41838753838,497.098121268336,2323.61771956576,156.945779019564,77.6658007460748,133.156517892969,232.851621660875,1033.83432558829,578.632859175593,27.0418737295996,38.1475183434183,12.6599061191693,0.831647273620318,31.8498700165863,719.578798956423],"water_piped":[34504.2956400102,1002.53201843409,0,55.4842988613375,298.33190524897,195.222387524279,193.433881733188,0,116.335259186116,143.724285880199,0,5519.07815293681,2612.21792632506,98.3673506247895,279.197791212617,165.924257939664,302.370971963526,866.094528462749,533.744673056938,119.272064239779,250.115330923664,84.1764711146177,40.9997429635479,3018.65449389377,4.17640857370845,10.7788418178492,21.6946071145211,34.6852372915522,568.310411032855,471.670595601049,213.582172244161,26.2585309628474,457.466052653417,1210.03163660181,4714.81773611595,873.376493750116,458.189771084615,1004.23576182193,483.887777014511,900.13243529262,401.226603689513,128.601048997331,41.3288536970401,375.629276758451,48.2097140098196,13512.7379998816,7823.48392495566,177.965180120317,219.317105149481,234.322558154213,154.935287327054,50.020602067737,12.8323058336291,2.93321804230987,30.5107312829742,0,370.629802226086,100.280341638522,174.368126288094,1340.31144767398,220.879437436088,350.840442888782,1744.92805478612,286.550352211218,217.629081799296,6736.47523874807,202.146163377199,42.1238241334643,0,396.318164139975,2224.72862384526,435.465966183695,1214.30890128631,1596.04294488431,349.413408889071,84.8280219092724,191.099220099518,166.597044109855],"water_well":[5400.87949322022,239.773134116747,0,0,14.1581243169003,0,1.05127109637602,0.931958705462542,23.2670518372232,199.221782408196,1.14294575258929,938.140579500354,89.6169994343225,0,2.53816173829652,0,0.868882103343466,8.7610718197099,17.3693513443371,252.412973158601,236.595583306169,77.1617651883996,142.420159768114,875.567889179252,357.082933052073,274.370518999798,166.010906615466,56.1570508529894,6.07169242556469,1.60432175374506,7.15917895790481,2.91761455142749,2.89535476362922,1.29831720665431,1844.08482374296,30.3328363098843,488.267874219272,97.9742206655544,73.9272992661058,55.3445696873654,63.032578223126,473.598093903633,228.233968177684,111.608698845163,221.76468444517,1184.17593030656,38.291137190664,148.304316766931,84.9378384104926,6.54532285346963,32.9066096977814,35.0144214474159,38.4969175008871,41.0650525923382,61.0214625659483,42.7352011507233,38.0133130488293,57.6611964421503,15.7620905119181,253.109145702232,0,7.92859757940751,68.9528021649355,178.942835980001,34.4876687004348,319.137136374346,0,0,1.1479010163187,2.35203658243308,113.911628528927,46.5292402223673,96.5781204628558,45.5309089905316,7.59594367150156,0,5.49135689941143,110.395631639061],"toilet_flush":[15688.9665858318,109.360278790092,1.20931116727564,4.10994806380278,29.3275432278648,3.13190996028255,67.2813501680655,0,2.84602546297423,1.45419073982645,0,2863.34134756745,2164.25053633889,0,11.4217278223343,107.221379542057,36.4930483404256,41.3021957214895,64.2406701041739,0,328.529867105137,36.2426472854604,5.39470302151946,313.492754882766,4.17640857370845,82.3111556999391,66.027065131151,0,27.9297851575976,20.8561827986858,23.8639298596826,13.1292654814237,11.5814190545169,63.617543126061,737.171168381528,32.4247560553935,199.51808412656,235.35111703356,40.323981417876,33.4155892452017,67.8812380864434,7.41929128830756,20.9728511298412,96.0074828775593,3.85677712078556,11298.1497256116,7115.09788692837,26.1015597509798,10.1418314519991,1.30906457069393,2.74221747481512,4.00164816541896,0,1.95547869487325,8.41675345737218,20.8197133811216,279.66937457353,216.856238793304,424.591313164795,969.010840647946,191.727836556198,281.465214068967,1234.11443874793,431.639138140948,78.4891770423689,367.451310598327,12.5556623215652,1.31636950417076,0,3.52805487364963,281.327203791138,20.2819765071858,14.1647910012189,18.458476617783,11.3939155072523,3.32658909448127,1.09827137988229,68.2445722859648],"toilet_pit latrine":[29285.0644321181,1643.81007574333,141.48940657125,45.2094287018306,175.965259367189,134.67212829215,108.28092292673,69.8969029096907,673.085021993405,263.208523908587,32.0024810725,5934.23411160344,477.210521987767,299.923980826565,645.962162396465,426.453237257962,443.998754808512,847.3208031348,553.417035958559,0,1170.8101436751,489.8602971809,17.2630496688623,6050.91059964324,370.656260916625,356.681674699736,350.886688982688,222.976525445693,527.022902539015,447.605769294873,1089.38839809452,761.497397922577,1171.17100188802,753.023979859497,4546.7986819954,725.896151691713,432.122081701244,444.078804538437,714.630559572357,859.407185900031,546.686399589035,362.308724579019,42.5625508223248,18.0014030395423,401.104820561699,4699.82522810458,435.309770167548,379.659050923342,105.221501314491,503.989859717162,379.797120261894,148.060982120501,88.6595675778007,65.5085362782539,76.8028752985211,136.971798560011,168.344672073387,152.927520998747,27.5836583958567,248.374600971578,7.84850792920107,0.991074697425938,807.732825360673,530.783141859598,435.258163598591,6409.4857350281,91.6563349474257,7.89821702502455,25.2538223590114,733.835413719122,2100.46139272279,804.120715637835,919.423706806388,1314.24353518615,137.992976698945,3.32658909448127,271.273030830925,562.014124707945],"toilet_vip":[12131.2670661089,644.847811642779,73.7679812038139,4.10994806380278,123.377940475845,152.419618067084,136.665242528883,46.5979352731271,44.1133946761005,4.36257221947935,59.433179134643,2326.77553833001,407.757347426166,10.6082436948302,210.667424278611,4.94313273548723,8.68882103343466,234.045775755107,383.975213167822,0,323.121968058139,242.007354454526,217.946002069386,1423.02373351799,75.1753543267522,123.466733549909,29.240557415224,9.91006779758635,200.365850043635,94.6549834709586,374.663698797018,45.2230255471261,217.151607272191,253.17185529759,2593.42061274707,186.180857350324,135.351464105959,288.597976090926,114.251280683982,108.600665046906,77.5785578130782,610.854982737323,311.508524134406,396.030866869932,364.465437914236,2292.24657094649,203.54762401353,121.016322481815,264.955346683477,26.1812914138785,43.8754795970419,146.060158037792,118.990472275469,112.440024955212,188.324858608702,13.149292661761,77.3842444208311,33.8446153030013,10.8364372269437,117.573124107475,21.3030929506886,14.8661204613891,512.220816082378,174.106543115677,91.5707065494305,2850.9527989246,86.6340700187996,0,112.494299599233,95.25748158854,923.374564590546,538.068906161222,359.270608121824,425.775527316862,221.548357085463,69.8583709841067,18.6706134579988,283.014255656501],"toilet_water sealed":[7660.241799405,168.040747050664,19.3489786764102,38.0170195901757,53.5986134854081,1.04396998676085,43.102114951417,0.931958705462542,7.11506365743557,1.45419073982645,3.42883725776786,1259.08366367196,869.284894512927,1.92877158087823,17.7671321680756,0,5.2132926200608,43.8053590985494,159.384430416997,0,117.62180427221,9.35294123495753,8.63152483443113,178.388443224916,63.6902307490539,3.91957884285425,6.6027065131151,0.825838983132196,10.9290463660164,11.2302522762154,27.443519338635,2.91761455142749,14.4767738181461,36.3528817863205,1845.40825908774,102.504067529954,702.825009913161,492.000977690067,60.4859721268138,45.9464352121524,400.014438723685,16.0751311246663,6.78533418906628,7.20056121581694,11.5703313623567,4143.87734165465,1062.07522628842,26.1015597509798,11.409560383499,11.7815811362453,2.74221747481512,4.00164816541896,5.8328662880132,45.9537493295214,192.533235337388,26.298585323522,376.060275518775,442.48700747998,373.364519001061,318.720069364788,21.3030929506886,159.563026285577,575.544818070584,249.069082512704,239.035220992669,65.4433447150727,7.5333973929391,0,1.1479010163187,14.1122194945985,29.3408740150267,5.96528720799581,1.28770827283808,3.69169532355661,1.26599061191693,0,1.09827137988229,26.0935129328689]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"total_households","name":"","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"water_tank","name":"Tank","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"water_piped","name":"Piped","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"water_well","name":"Well","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"toilet_flush","name":"Flush","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"toilet_pit latrine","name":"Pit Latrine","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"toilet_vip","name":"VIP","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"toilet_water sealed","name":"Water Sealed","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Total Households","columns":["total_households"]},{"name":"Drinking Water","columns":["water_piped","water_well","water_tank"]},{"name":"Toilet Type","columns":["toilet_pit latrine","toilet_vip","toilet_flush","toilet_water sealed"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"88f86c1a14576dc389b748dee6f20b89"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimated-hazard-damage-4" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="estimated-hazard-damage-4"><span class="header-section-number">10.2</span> Estimated Hazard Damage</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for WASH damage functions</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>wash_damage_functions <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"WASH"</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get damage rate for WASH items</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>get_wash_damage_rate <span class="ot">&lt;-</span> <span class="cf">function</span>(indicator, attribute, area_council, intensity) {</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intensity <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, intensity)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  rate <span class="ot">&lt;-</span> wash_damage_functions <span class="sc">%&gt;%</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator,</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute)),</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="sc">!!</span>intensity_col)</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(rate) <span class="sc">&gt;</span> <span class="dv">0</span>, rate, <span class="dv">0</span>))</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Get baseline WASH data at council level</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>wash_baseline <span class="ot">&lt;-</span> wash_wide</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with hazard intensity from config</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>wash_with_intensity <span class="ot">&lt;-</span> wash_baseline <span class="sc">%&gt;%</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>    config <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>, Intensity),</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>)</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intensity =</span> <span class="fu">replace_na</span>(Intensity, <span class="dv">0</span>))</span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage for each WASH type</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>wash_damage_raw <span class="ot">&lt;-</span> wash_with_intensity <span class="sc">%&gt;%</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drinking water damaged</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_piped_damaged =</span> water_piped <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"piped"</span>, Region, Intensity),</span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_well_damaged =</span> water_well <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"well"</span>, Region, Intensity),</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_tank_damaged =</span> water_tank <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"tank"</span>, Region, Intensity),</span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Toilet types damaged</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_pit_latrine_damaged =</span> <span class="st">`</span><span class="at">toilet_pit latrine</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Toilet"</span>, <span class="st">"pit latrine"</span>, Region, Intensity),</span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_vip_damaged =</span> toilet_vip <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Toilet"</span>, <span class="st">"vip"</span>, Region, Intensity),</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_flush_damaged =</span> toilet_flush <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Toilet"</span>, <span class="st">"flush"</span>, Region, Intensity),</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_water_sealed_damaged =</span> <span class="st">`</span><span class="at">toilet_water sealed</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Toilet"</span>, <span class="st">"water sealed"</span>, Region, Intensity)</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Round for presentation</span></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a>wash_damage_rounded <span class="ot">&lt;-</span> wash_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">ends_with</span>(<span class="st">"_damaged"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a>wash_damage_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(wash_damage_rounded)</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>wash_damage_ordered <span class="ot">&lt;-</span> wash_damage_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, water_piped_damaged, water_well_damaged, water_tank_damaged,</span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a>         toilet_pit_latrine_damaged, toilet_vip_damaged, toilet_flush_damaged, toilet_water_sealed_damaged)</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>  wash_damage_ordered,</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"WASH_02_estimated_damage.csv"</span>),</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(wash_damage_ordered)</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_piped_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Piped"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_well_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Well"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_tank_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tank"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_pit_latrine_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Pit Latrine"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_vip_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"VIP"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_flush_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Flush"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_water_sealed_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water Sealed"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Drinking Water"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"water_piped_damaged"</span>, <span class="st">"water_well_damaged"</span>, <span class="st">"water_tank_damaged"</span>)),</span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Toilet Type"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"toilet_pit_latrine_damaged"</span>, <span class="st">"toilet_vip_damaged"</span>, <span class="st">"toilet_flush_damaged"</span>, <span class="st">"toilet_water_sealed_damaged"</span>))</span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb44-106"><a href="#cb44-106" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb44-107"><a href="#cb44-107" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-dca8dec883e686dab08b" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-dca8dec883e686dab08b">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"water_piped_damaged":[13297,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,471,87,46,100,48,90,40,13,4,38,5,9458,5476,125,154,164,108,35,9,2,21,0,259,70,122,938,155,246,1221,201,152,3368,101,21,0,198,1112,218,607,798,175,42,96,0],"water_well_damaged":[1174,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,184,3,49,10,7,6,6,47,23,11,22,830,27,104,59,5,23,25,27,29,43,30,27,40,11,177,0,6,48,125,24,160,0,0,1,1,57,23,48,23,4,0,3,0],"water_tank_damaged":[7129,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,319,14,53,29,32,10,69,40,11,12,49,5649,474,203,114,186,193,166,127,131,259,108,337,488,468,183,16,78,910,860,348,1161,78,39,67,116,517,289,14,19,6,0,16,0],"toilet_pit_latrine_damaged":[6952,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,454,73,43,44,71,86,55,36,4,2,40,3292,305,266,74,353,266,104,62,46,54,96,118,107,19,174,5,1,565,372,305,3206,46,4,13,367,1050,402,460,657,69,2,136,0],"toilet_vip_damaged":[3290,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,260,19,14,29,11,11,8,61,31,40,36,1604,142,85,185,18,31,102,83,79,132,9,54,24,8,82,15,10,359,122,64,1426,43,0,56,48,462,269,180,213,111,35,9,0],"toilet_flush_damaged":[8168,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,74,3,20,24,4,3,7,1,2,10,0,7909,4981,18,7,1,2,3,0,1,6,15,196,152,297,678,134,197,864,302,55,185,6,1,0,2,141,10,7,9,6,2,1,0],"toilet_water_sealed_damaged":[3119,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,185,10,70,49,6,5,40,2,1,1,1,2899,743,18,8,8,2,3,4,32,135,18,263,310,261,223,15,112,403,174,167,35,4,0,1,7,15,3,1,2,1,0,1,0]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"water_piped_damaged","name":"Piped","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"water_well_damaged","name":"Well","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"water_tank_damaged","name":"Tank","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"toilet_pit_latrine_damaged","name":"Pit Latrine","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"toilet_vip_damaged","name":"VIP","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"toilet_flush_damaged","name":"Flush","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"toilet_water_sealed_damaged","name":"Water Sealed","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Drinking Water","columns":["water_piped_damaged","water_well_damaged","water_tank_damaged"]},{"name":"Toilet Type","columns":["toilet_pit_latrine_damaged","toilet_vip_damaged","toilet_flush_damaged","toilet_water_sealed_damaged"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"d5cb46a46aabdda4b693cb468777a089"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="immediate-response-resources-6" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="immediate-response-resources-6"><span class="header-section-number">10.3</span> Immediate Response Resources</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for WASH resources</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>wash_resources <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"WASH"</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get resource quantity</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>get_wash_resource_quantity <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  quantity <span class="ot">&lt;-</span> wash_resources <span class="sc">%&gt;%</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Indicator)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(resource_type)),</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(quantity) <span class="sc">&gt;</span> <span class="dv">0</span>, quantity, <span class="dv">0</span>))</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate resource needs based on damaged facilities</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>wash_resources_calc <span class="ot">&lt;-</span> wash_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, water_piped_damaged, water_well_damaged, water_tank_damaged,</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>         toilet_pit_latrine_damaged) <span class="sc">%&gt;%</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep damaged facility counts (these become the columns)</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">piped =</span> water_piped_damaged,</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">well =</span> water_well_damaged,</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">tank =</span> water_tank_damaged,</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">pit_latrine =</span> toilet_pit_latrine_damaged</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, piped, well, tank, pit_latrine)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Round for presentation</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>wash_resources_rounded <span class="ot">&lt;-</span> wash_resources_calc <span class="sc">%&gt;%</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>wash_resources_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(wash_resources_rounded)</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>  wash_resources_aggregated,</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"WASH_03_immediate_response_resources.csv"</span>),</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(wash_resources_aggregated)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">piped =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Piped"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">well =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Well"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">tank =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tank"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">pit_latrine =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Pit Latrine"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Water Tank"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"piped"</span>)),</span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Water Purifier Tablets"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"well"</span>)),</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Hygiene Kit"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"tank"</span>)),</span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Pit Latrine"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"pit_latrine"</span>))</span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-b7babbd81dbc19378da9" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b7babbd81dbc19378da9">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"piped":[13297,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,471,87,46,100,48,90,40,13,4,38,5,9458,5476,125,154,164,108,35,9,2,21,0,259,70,122,938,155,246,1221,201,152,3368,101,21,0,198,1112,218,607,798,175,42,96,0],"well":[1174,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,184,3,49,10,7,6,6,47,23,11,22,830,27,104,59,5,23,25,27,29,43,30,27,40,11,177,0,6,48,125,24,160,0,0,1,1,57,23,48,23,4,0,3,0],"tank":[7129,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,319,14,53,29,32,10,69,40,11,12,49,5649,474,203,114,186,193,166,127,131,259,108,337,488,468,183,16,78,910,860,348,1161,78,39,67,116,517,289,14,19,6,0,16,0],"pit_latrine":[6952,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,454,73,43,44,71,86,55,36,4,2,40,3292,305,266,74,353,266,104,62,46,54,96,118,107,19,174,5,1,565,372,305,3206,46,4,13,367,1050,402,460,657,69,2,136,0]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"piped","name":"Piped","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"well","name":"Well","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"tank","name":"Tank","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"pit_latrine","name":"Pit Latrine","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Water Tank","columns":["piped"]},{"name":"Water Purifier Tablets","columns":["well"]},{"name":"Hygiene Kit","columns":["tank"]},{"name":"Pit Latrine","columns":["pit_latrine"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"9106efd60f6425a30f612a5b502a635f"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="estimated-financial-damage-5" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="estimated-financial-damage-5"><span class="header-section-number">10.4</span> Estimated Financial Damage</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for WASH financial costs</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>wash_financial <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"WASH"</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get unit cost for WASH items</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>get_wash_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(indicator, attribute, area_council) {</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> wash_financial <span class="sc">%&gt;%</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute)),</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the raw damage estimates (before rounding) for financial calculations</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>wash_financial_calc <span class="ot">&lt;-</span> wash_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for drinking water (in VT)</span></span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_piped_financial =</span> water_piped_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"piped"</span>, Region),</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_well_financial =</span> water_well_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"well"</span>, Region),</span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_tank_financial =</span> water_tank_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"tank"</span>, Region),</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for toilet types</span></span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_pit_latrine_financial =</span> toilet_pit_latrine_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Toilet"</span>, <span class="st">"pit latrine"</span>, Region),</span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_vip_financial =</span> toilet_vip_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Toilet"</span>, <span class="st">"vip"</span>, Region),</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_flush_financial =</span> toilet_flush_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Toilet"</span>, <span class="st">"flush"</span>, Region),</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_water_sealed_financial =</span> toilet_water_sealed_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Toilet"</span>, <span class="st">"water sealed"</span>, Region),</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total financial damage</span></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial =</span> water_piped_financial <span class="sc">+</span> water_well_financial <span class="sc">+</span> water_tank_financial <span class="sc">+</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>                     toilet_pit_latrine_financial <span class="sc">+</span> toilet_vip_financial <span class="sc">+</span> toilet_flush_financial <span class="sc">+</span> toilet_water_sealed_financial</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial, water_piped_financial, water_well_financial, water_tank_financial,</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>         toilet_pit_latrine_financial, toilet_vip_financial, toilet_flush_financial, toilet_water_sealed_financial)</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>wash_financial_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(wash_financial_calc)</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>wash_financial_ordered <span class="ot">&lt;-</span> wash_financial_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial, water_piped_financial, water_well_financial, water_tank_financial,</span>
<span id="cb46-49"><a href="#cb46-49" aria-hidden="true" tabindex="-1"></a>         toilet_pit_latrine_financial, toilet_vip_financial, toilet_flush_financial, toilet_water_sealed_financial)</span>
<span id="cb46-50"><a href="#cb46-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-51"><a href="#cb46-51" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb46-52"><a href="#cb46-52" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb46-53"><a href="#cb46-53" aria-hidden="true" tabindex="-1"></a>  wash_financial_ordered,</span>
<span id="cb46-54"><a href="#cb46-54" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"WASH_04_financial_damage.csv"</span>),</span>
<span id="cb46-55"><a href="#cb46-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb46-56"><a href="#cb46-56" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-57"><a href="#cb46-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-58"><a href="#cb46-58" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb46-59"><a href="#cb46-59" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(wash_financial_ordered)</span>
<span id="cb46-60"><a href="#cb46-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-61"><a href="#cb46-61" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb46-62"><a href="#cb46-62" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb46-63"><a href="#cb46-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb46-64"><a href="#cb46-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb46-65"><a href="#cb46-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb46-66"><a href="#cb46-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb46-67"><a href="#cb46-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb46-68"><a href="#cb46-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb46-69"><a href="#cb46-69" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-70"><a href="#cb46-70" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-71"><a href="#cb46-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb46-72"><a href="#cb46-72" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb46-73"><a href="#cb46-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb46-74"><a href="#cb46-74" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-75"><a href="#cb46-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-76"><a href="#cb46-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_piped_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb46-77"><a href="#cb46-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Piped"</span>,</span>
<span id="cb46-78"><a href="#cb46-78" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb46-79"><a href="#cb46-79" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-80"><a href="#cb46-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_well_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb46-81"><a href="#cb46-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Well"</span>,</span>
<span id="cb46-82"><a href="#cb46-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb46-83"><a href="#cb46-83" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-84"><a href="#cb46-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_tank_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb46-85"><a href="#cb46-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Tank"</span>,</span>
<span id="cb46-86"><a href="#cb46-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb46-87"><a href="#cb46-87" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-88"><a href="#cb46-88" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb46-89"><a href="#cb46-89" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_pit_latrine_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb46-90"><a href="#cb46-90" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Pit Latrine"</span>,</span>
<span id="cb46-91"><a href="#cb46-91" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb46-92"><a href="#cb46-92" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-93"><a href="#cb46-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_vip_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb46-94"><a href="#cb46-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"VIP"</span>,</span>
<span id="cb46-95"><a href="#cb46-95" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb46-96"><a href="#cb46-96" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-97"><a href="#cb46-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_flush_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb46-98"><a href="#cb46-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Flush"</span>,</span>
<span id="cb46-99"><a href="#cb46-99" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb46-100"><a href="#cb46-100" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-101"><a href="#cb46-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_water_sealed_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb46-102"><a href="#cb46-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Water Sealed"</span>,</span>
<span id="cb46-103"><a href="#cb46-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb46-104"><a href="#cb46-104" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-105"><a href="#cb46-105" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-106"><a href="#cb46-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb46-107"><a href="#cb46-107" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb46-108"><a href="#cb46-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Value"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_financial"</span>)),</span>
<span id="cb46-109"><a href="#cb46-109" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Drinking Water"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"water_piped_financial"</span>, <span class="st">"water_well_financial"</span>, <span class="st">"water_tank_financial"</span>)),</span>
<span id="cb46-110"><a href="#cb46-110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Toilet Type"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"toilet_pit_latrine_financial"</span>, <span class="st">"toilet_vip_financial"</span>, <span class="st">"toilet_flush_financial"</span>, <span class="st">"toilet_water_sealed_financial"</span>))</span>
<span id="cb46-111"><a href="#cb46-111" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-112"><a href="#cb46-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-113"><a href="#cb46-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-114"><a href="#cb46-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-115"><a href="#cb46-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb46-116"><a href="#cb46-116" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb46-117"><a href="#cb46-117" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb46-118"><a href="#cb46-118" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb46-119"><a href="#cb46-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb46-120"><a href="#cb46-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb46-121"><a href="#cb46-121" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb46-122"><a href="#cb46-122" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb46-123"><a href="#cb46-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb46-124"><a href="#cb46-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb46-125"><a href="#cb46-125" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb46-126"><a href="#cb46-126" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-be9bbc361f837ffe041d" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-be9bbc361f837ffe041d">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","West Vanualava","East Vanualava","Mota","East Gaua","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","North Ambae","East Ambae","South Ambae","North Maewo","South Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","North West Malekula","North East Malekula","Central Malekula","South West Malekula","South East Malekula","South Malekula","North Ambrym","West Ambrym","South East Ambrym","Paama","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"total_financial":[7578527967.32738,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,246322469.356583,27695448.4907335,43259330.5317021,46791742.3338419,19520167.3380368,27474924.0197032,24776045.8190689,19170212.1404387,8754314.80102078,17412157.1133814,11468126.7686559,6202328747.38293,3279867662.52652,78918659.1243545,68729924.0212665,61298912.1195992,48214353.1965681,31292388.4475556,20606933.3089218,24296822.7838001,60287100.8267925,22294077.8208216,204383329.271162,158871638.24937,206163710.807933,551564471.488083,89645657.5673348,153347005.783321,761091179.896249,262013420.364068,119441499.779203,1129876750.58787,31737575.4333363,5295096.33052688,7581886.21278503,70449375.735327,407152090.137049,107056026.878297,177385033.854128,228082166.327636,53228575.2780471,12747073.5864154,29161850.8143244,0],"water_piped_financial":[2659727198.58054,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,94296354.7223189,17467529.8750023,9163795.4216923,20084715.2364386,9677755.54029022,18002648.7058524,8024532.07379026,2572020.97994662,826577.073940802,7512585.53516902,964194.280196392,1891783319.98342,1095287749.49379,24915125.2168444,30704394.7209273,32805158.1415898,21690940.2257876,7002884.28948318,1796522.81670807,410650.525923382,4271502.37961639,0,51888172.311652,14039247.8293931,24411537.6803332,187643602.674357,30923121.2410523,49117662.0044295,244289927.670057,40117049.3095705,30468071.4519014,673647523.874807,20214616.3377199,4212382.41334643,0,39631816.4139975,222472862.384526,43546596.6183695,121430890.128631,159604294.488431,34941340.8889071,8482802.19092724,19109922.0099518,0],"water_well_financial":[175935030.266409,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27661272.3561444,454992.544648265,7324018.11328908,1469613.30998332,1108909.48899159,830168.545310481,945488.67334689,7103971.4085545,3423509.52266526,1674130.48267745,3326470.26667755,124338472.682189,4020569.40501972,15571953.2605278,8918473.03310172,687258.899614311,3455194.01826705,3676514.25197867,4042176.33759315,4311830.52219551,6407253.56942457,4487196.12082595,3991397.87012708,6054425.62642578,1655019.5037514,26576460.2987344,0,832502.745837789,7240044.22731823,18788997.7779001,3621205.21354565,23935285.228076,0,0,86092.5762239025,176402.743682481,8543372.13966952,3489693.01667755,7243359.03471418,3414818.17428987,569695.775362617,0,411851.767455857,0],"water_tank_financial":[106914249.206167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4754832.14166071,208668.994614549,788046.302128025,432896.96413639,480527.445229687,144104.728619932,1034582.79833535,593543.303064606,159146.929161737,172813.469179607,740501.207190827,84732284.1677634,7110059.57940329,3052102.83906343,1703827.68393585,2790271.1324341,2893724.99029866,2489525.36491127,1898597.97674829,1971122.52443224,3888540.09730595,1622293.98214477,5060522.29962539,7317957.93107117,7023489.01904502,2738711.49416727,235455.237876033,1165503.8441729,13652654.8286572,12898393.069153,5219530.27331753,17427132.8967432,1177093.34264673,582493.505595561,998673.884197267,1746387.16245656,7753757.44191218,4339746.44381695,202814.052971997,286106.387575637,94949.2958937697,6237.35455215238,238874.025124397,0],"toilet_pit_latrine_financial":[416958023.723208,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27280792.0919724,4355376.91015028,2592732.49020746,2664472.82723062,4287783.35743414,5156443.11540019,3280118.39753421,2173852.34747411,255375.304933949,108008.418237254,2406628.92337019,197392659.580392,18283010.347037,15945680.1387804,4419303.05520862,21167574.1081208,15951479.0509995,6218561.24906104,3723701.83826763,2751358.52368666,3225720.76253789,5752815.53952046,7070476.22708225,6422955.88194737,1158513.65262598,10431733.2408063,329637.333026445,41625.1372918894,33924778.6651483,22292891.9581031,18280842.8711408,192284572.050843,2749690.04842277,236946.510750737,757614.670770342,22015062.4115737,63013841.7816837,24123621.469135,27582711.2041916,39427306.0555845,4139789.30096835,99797.6728344381,8138190.92492775,0],"toilet_vip_financial":[328939106.039955,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25934206.1274707,1861808.57350324,1353514.64105959,2885979.76090926,1142512.80683982,1086006.65046906,775785.578130782,6108549.82737323,3115085.24134406,3960308.66869932,3644654.37914236,160457259.966254,14248333.6809471,8471142.57372705,18546874.2678434,1832690.39897149,3071283.57179293,10224211.0626454,8329333.05928283,7870801.74686484,13182740.1026091,920450.48632327,5416897.10945818,2369123.07121009,758550.605886059,8230118.68752325,1491216.5065482,1040628.43229724,35855457.1257664,12187458.0180974,6409949.45846013,142547639.94623,4331703.50093998,0,5624714.97996165,4762874.079427,46168728.2295273,26903445.3080611,17963530.4060912,21288776.3658431,11077417.8542731,3492918.54920533,933530.67289994,0],"toilet_flush_financial":[3266459032.02618,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,29486846.7352611,1296990.24221574,7980723.3650624,9414044.6813424,1612959.25671504,1336623.56980807,2715249.52345774,296771.651532302,838914.045193648,3840299.31510237,154271.084831422,3163481923.17126,1992227408.33994,7308436.73027434,2839712.80655975,366538.0797943,767820.892948234,1120461.48631731,0,547534.03456451,2356690.96806421,5829519.74671405,78307424.8805884,60719746.8621251,118885567.686143,271323035.381425,53683794.2357354,78810259.9393108,345552042.84942,120858958.679465,21976969.5718633,73490262.1196654,2511132.46431304,263273.900834152,0,705610.974729926,56265440.7582276,4056395.30143716,2832958.20024378,3691695.3235566,2278783.10145046,665317.818896254,219654.275976458,0],"toilet_water_sealed_financial":[623595327.484913,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36908165.1817548,2050081.35059908,14056500.1982632,9840019.55380134,1209719.44253628,918928.704243048,8000288.7744737,321502.622493326,135706.683781326,144011.224316339,231406.627247134,580142827.831651,148690531.680379,3654218.36513717,1597338.45368986,1649421.35907434,383910.446474117,560230.743158654,816601.280321848,6433524.906133,26954652.9472343,3681801.94529308,52648438.5726285,61948181.0471972,52271032.6601485,44620809.7110703,2982433.0130964,22338823.6799808,80576274.5298818,34869671.5517786,33464930.9389737,6544334.47150727,753339.73929391,0,114790.10163187,1411221.94945985,2934087.40150267,596528.720799581,128770.827283808,369169.532355661,126599.061191693,0,109827.137988229,0]},"columns":[{"id":"Region","name":"Region","type":"character","html":true,"minWidth":150,"sticky":"left"},{"id":"total_financial","name":"Total Value","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"water_piped_financial","name":"Piped","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"water_well_financial","name":"Well","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"water_tank_financial","name":"Tank","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"toilet_pit_latrine_financial","name":"Pit Latrine","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"toilet_vip_financial","name":"VIP","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"toilet_flush_financial","name":"Flush","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}},{"id":"toilet_water_sealed_financial","name":"Water Sealed","type":"numeric","format":{"cell":{"suffix":" VT","digits":0,"separators":true},"aggregated":{"suffix":" VT","digits":0,"separators":true}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Total Value","columns":["total_financial"]},{"name":"Drinking Water","columns":["water_piped_financial","water_well_financial","water_tank_financial"]},{"name":"Toilet Type","columns":["toilet_pit_latrine_financial","toilet_vip_financial","toilet_flush_financial","toilet_water_sealed_financial"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"1621db84e52051bd34f96105624f8688"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="business" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Business</h1>
<section id="baseline-2" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="baseline-2"><span class="header-section-number">11.1</span> Baseline</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Business baseline at Area Council level</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>business_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Business"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get businesses by industry type and sum them by Region and Attribute</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>industry_types <span class="ot">&lt;-</span> business_data <span class="sc">%&gt;%</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Industry Type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, Attribute) <span class="sc">%&gt;%</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">industry =</span> <span class="fu">paste0</span>(<span class="st">"industry_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, industry, Value) <span class="sc">%&gt;%</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> industry,</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total businesses</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>business_wide <span class="ot">&lt;-</span> industry_types <span class="sc">%&gt;%</span></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_businesses =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">"industry_"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_businesses, <span class="fu">everything</span>())</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>business_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(business_wide)</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  business_aggregated <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Business_01_baseline.csv"</span>),</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(business_aggregated)</span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all industry columns (excluding Region and total_businesses)</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>industry_cols <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(formatted), <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="st">"total_businesses"</span>))</span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Create column definitions dynamically</span></span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>column_defs <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_businesses =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Add definitions for all industry columns</span></span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> industry_cols) {</span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create readable name from column name</span></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>  readable_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"industry_"</span>, <span class="st">""</span>, col)</span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>  readable_name <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(readable_name)</span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>  column_defs[[col]] <span class="ot">&lt;-</span> <span class="fu">colDef</span>(</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> readable_name,</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Create column groups - single "Industry Type" group spanning all industry columns</span></span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a>all_groups <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb47-71"><a href="#cb47-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb47-72"><a href="#cb47-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Businesses"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_businesses"</span>)),</span>
<span id="cb47-73"><a href="#cb47-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Industry Type"</span>, <span class="at">columns =</span> industry_cols)</span>
<span id="cb47-74"><a href="#cb47-74" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-75"><a href="#cb47-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-76"><a href="#cb47-76" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb47-77"><a href="#cb47-77" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb47-78"><a href="#cb47-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> column_defs,</span>
<span id="cb47-79"><a href="#cb47-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> all_groups,</span>
<span id="cb47-80"><a href="#cb47-80" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-81"><a href="#cb47-81" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-82"><a href="#cb47-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-83"><a href="#cb47-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb47-84"><a href="#cb47-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb47-85"><a href="#cb47-85" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb47-86"><a href="#cb47-86" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb47-87"><a href="#cb47-87" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb47-88"><a href="#cb47-88" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb47-89"><a href="#cb47-89" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb47-90"><a href="#cb47-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb47-91"><a href="#cb47-91" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb47-92"><a href="#cb47-92" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb47-93"><a href="#cb47-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb47-94"><a href="#cb47-94" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-14523d8c5153d0273c3e" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-14523d8c5153d0273c3e">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"Region":["<b>National<\/b>","<b>Torba<\/b>","Torres","Ureparapara","Motalava","East Vanualava","Mota","West Gaua","Merelava","<b>Sanma<\/b>","Luganville","North West Santo","Big Bay Coast","Big Bay Inland","West Santo","South Santo 1","South Santo 2","East Santo","South East Santo","West Malo","East Malo","<b>Penama<\/b>","West Ambae","East Ambae","North Maewo","North Pentecost","Central Pentecost 1","Central Pentecost 2","South Pentecost","<b>Malampa<\/b>","Central Malekula","<b>Shefa<\/b>","Port Vila","Vermali","Vermaul","Varisu","South Epi","North Tongoa","Tongariki","Makimae","Nguna","Emau","Malorua","North Efate","Mele","Tanvasoko","Ifira","Pango","Erakor","Eratap","Eton","<b>Tafea<\/b>","North Erromango","South Erromango","Aniwa","North Tanna","West Tanna","Middle Bush Tanna","South West Tanna","Whitesands","South Tanna","Futuna","Aneityum","Canal Fanafo"],"total_businesses":[12962,254,53,16,8,116,17,10,34,2888,1131,10,35,51,68,89,287,340,460,207,80,660,4,3,200,4,1,137,311,107,107,8324,4335,144,25,84,56,51,30,40,249,26,245,187,499,754,75,267,521,581,155,729,2,5,20,24,464,93,31,46,41,2,1,130],"industry_transportation":[2604,25,6,0,1,15,1,2,0,815,307,1,3,14,12,28,50,90,226,16,8,65,0,1,15,1,0,0,48,22,22,1491,623,11,1,5,4,3,0,2,12,0,30,32,87,241,5,59,155,198,23,186,2,0,0,13,74,42,18,19,16,1,1,60],"industry_accommodation and food":[1356,35,8,0,0,21,2,3,1,273,114,0,0,0,1,5,31,21,65,24,8,68,0,0,33,0,0,14,21,14,14,899,417,20,1,4,3,5,0,2,41,4,40,31,57,78,10,57,55,54,20,67,0,0,3,0,47,9,0,5,3,0,0,4],"industry_administrative services":[514,0,0,0,0,0,0,0,0,72,58,0,0,0,1,0,3,4,4,0,0,4,1,1,0,0,0,1,1,2,2,416,291,3,4,0,0,2,0,0,5,0,5,0,16,30,3,10,23,23,1,20,0,1,1,1,9,4,0,4,0,0,0,2],"industry_wholesale and retail trade":[4954,176,37,16,4,69,14,5,31,1142,359,8,24,16,43,42,150,165,98,152,58,435,1,0,107,0,0,120,207,40,40,2837,1187,95,15,54,45,37,30,35,170,20,110,108,194,207,45,69,168,150,98,324,0,1,16,6,241,20,9,11,20,0,0,27],"industry_agriculture, forestry and fishing":[216,1,0,0,0,1,0,0,0,134,13,0,6,19,5,4,19,23,14,3,3,10,0,0,3,0,0,0,7,1,1,65,11,0,1,2,0,0,0,0,0,0,3,1,15,5,0,3,4,17,3,5,0,1,0,0,3,0,0,1,0,0,0,25],"industry_construction":[651,9,2,0,2,5,0,0,0,92,77,0,1,0,0,0,1,2,10,1,0,1,0,0,0,0,0,0,1,11,11,490,339,4,1,0,0,4,0,0,2,0,4,1,22,48,1,10,26,27,1,48,0,1,0,4,28,9,2,2,2,0,0,0],"industry_manufacturing":[850,5,0,0,1,2,0,0,2,204,91,1,1,2,6,10,32,22,19,11,3,72,2,1,42,3,1,1,22,13,13,500,254,7,1,19,3,0,0,1,18,2,20,4,37,45,1,11,36,35,6,56,0,1,0,0,45,6,2,1,0,1,0,6],"industry_arts and entertainment":[123,0,0,0,0,0,0,0,0,25,3,0,0,0,0,0,1,10,10,0,0,2,0,0,0,0,0,0,2,1,1,87,45,0,0,0,0,0,0,0,0,0,11,2,7,5,0,7,4,6,0,8,0,0,0,0,2,3,0,3,0,0,0,1],"industry_mining and quarrying":[25,0,0,0,0,0,0,0,0,8,5,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,17,11,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,4,0,0,0,0,0,0,0,0,0,0,0,0,0,1],"industry_real estate":[292,3,0,0,0,3,0,0,0,16,8,0,0,0,0,0,0,1,5,0,0,0,0,0,0,0,0,0,0,3,3,269,152,0,0,0,1,0,0,0,0,0,6,3,32,29,1,21,10,12,2,1,0,0,0,0,1,0,0,0,0,0,0,2],"industry_scientific and technical":[655,0,0,0,0,0,0,0,0,37,33,0,0,0,0,0,0,1,1,0,0,1,0,0,0,0,0,0,1,0,0,612,486,0,0,0,0,0,0,0,0,0,7,3,18,28,4,10,23,33,0,5,0,0,0,0,5,0,0,0,0,0,0,2],"industry_financial and insurance":[254,0,0,0,0,0,0,0,0,31,27,0,0,0,0,0,0,1,3,0,0,2,0,0,0,0,0,1,1,0,0,219,152,3,1,0,0,0,0,0,1,0,2,1,3,27,4,4,8,13,0,2,0,0,0,0,2,0,0,0,0,0,0,0],"industry_education":[59,0,0,0,0,0,0,0,0,9,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,49,40,1,0,0,0,0,0,0,0,0,1,0,1,1,0,1,2,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0],"industry_information and communication":[123,0,0,0,0,0,0,0,0,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,115,105,0,0,0,0,0,0,0,0,0,1,0,2,3,0,1,1,2,0,1,0,0,0,0,1,0,0,0,0,0,0,0],"industry_other services":[155,0,0,0,0,0,0,0,0,13,13,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,130,0,0,0,0,0,0,0,0,0,0,0,1,2,1,1,2,1,0,4,0,0,0,0,4,0,0,0,0,0,0,0],"industry_water supply and waste management":[31,0,0,0,0,0,0,0,0,3,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,28,12,0,0,0,0,0,0,0,0,0,1,1,4,4,0,0,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"industry_health and social work":[89,0,0,0,0,0,0,0,0,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,84,75,0,0,0,0,0,0,0,0,0,2,0,2,1,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"industry_electricity and gas":[11,0,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,5,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0]},"columns":[{"id":"Region","name":"Region","type":"character","sortable":true,"defaultSortDesc":false,"html":true,"minWidth":150,"sticky":"left"},{"id":"total_businesses","name":"","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_transportation","name":"Transportation","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_accommodation and food","name":"Accommodation and Food","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_administrative services","name":"Administrative Services","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_wholesale and retail trade","name":"Wholesale and Retail Trade","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_agriculture, forestry and fishing","name":"Agriculture, Forestry and Fishing","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_construction","name":"Construction","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_manufacturing","name":"Manufacturing","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_arts and entertainment","name":"Arts and Entertainment","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_mining and quarrying","name":"Mining and Quarrying","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_real estate","name":"Real Estate","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_scientific and technical","name":"Scientific and Technical","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_financial and insurance","name":"Financial and Insurance","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_education","name":"Education","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_information and communication","name":"Information and Communication","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_other services","name":"Other Services","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_water supply and waste management","name":"Water Supply and Waste Management","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_health and social work","name":"Health and Social Work","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}},{"id":"industry_electricity and gas","name":"Electricity and Gas","type":"numeric","format":{"cell":{"digits":0},"aggregated":{"digits":0}}}],"columnGroups":[{"name":"Region","columns":["Region"]},{"name":"Total Businesses","columns":["total_businesses"]},{"name":"Industry Type","columns":["industry_transportation","industry_accommodation and food","industry_administrative services","industry_wholesale and retail trade","industry_agriculture, forestry and fishing","industry_construction","industry_manufacturing","industry_arts and entertainment","industry_mining and quarrying","industry_real estate","industry_scientific and technical","industry_financial and insurance","industry_education","industry_information and communication","industry_other services","industry_water supply and waste management","industry_health and social work","industry_electricity and gas"]}],"defaultPageSize":15,"showPageSizeOptions":true,"pageSizeOptions":[10,15,25,50,75,100],"highlight":true,"bordered":true,"striped":true,"showSortable":true,"theme":{"borderColor":"#ddd","stripedColor":"#f6f8fa","headerStyle":{"&:hover":{"background":"#eee"}}},"dataKey":"880e3f79274c3f22d69e06c31fa80c4e"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<hr>

<p style="text-align: center">
  A work by <a href="https://github.com/holtzy/">Government of Vanuatu</a>
</p>

<p style="text-align: center">
  <span style="color: #808080"><em>Yan.holtz.data@gmail.com</em></span>
</p>

<p style="text-align: center">Contact: info@vanuato.com</p>

&nbsp;
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb48" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Disaster Damage and Response Estimation"</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Théophile L. Mouton"</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r Sys.Date()`"</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="an">include-after-body:</span><span class="co"> "asset/footer.html"</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="an">css:</span><span class="co"> "asset/style.css"</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co">    template-partials: </span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co">      - asset/title-block.html</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-location: left</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="co">    code-summary: "Show code"</span></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 8</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 6</span></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-dpi: 300</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a><span class="co">    self-contained: false</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="co">  echo: true</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="co">  error: false</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="fu"># Intro</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>This report runs based on a config file which provides the cyclone intensity applied to each council in Vanuatu. It has 5 columns:</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>National</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Province</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Area Council</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Hazard</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Intensity (number from 2 to 3)</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a>Let's load this file to use it later in our analysis:</span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>config <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"Ex_hazard_areas.csv"</span>), <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>Another file that will be useful: a 2 columns dataframe that provides the list of councils with their Province</span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>council_province_lookup <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/council_province_lookup.csv"</span>)</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>And load the required libs</span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, message=FALSE}</span></span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a><span class="in"># Load required packages</span></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)</span></span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a><span class="in">library(reactable)</span></span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a><span class="in">library(htmltools)</span></span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a><span class="in">library(readxl)</span></span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a><span class="in">library(here)</span></span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>Order of councils and provinces in the final tables:</span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the custom order for regions</span></span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a>region_order <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a>  <span class="st">"National"</span>, <span class="co"># Will be displayed as Vanuatu</span></span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Torba"</span>, <span class="st">"Torres"</span>, <span class="st">"Ureparapara"</span>, <span class="st">"Motalava"</span>, <span class="st">"West Vanualava"</span>, <span class="st">"East Vanualava"</span>, </span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mota"</span>, <span class="st">"East Gaua"</span>, <span class="st">"West Gaua"</span>, <span class="st">"Merelava"</span>,</span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Sanma"</span>, <span class="st">"Luganville"</span>, <span class="st">"North West Santo"</span>, <span class="st">"Big Bay Coast"</span>, <span class="st">"Big Bay Inland"</span>, </span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a>  <span class="st">"West Santo"</span>, <span class="st">"South Santo 1"</span>, <span class="st">"South Santo 2"</span>, <span class="st">"East Santo"</span>, <span class="st">"South East Santo"</span>, </span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Canal - Fanafo"</span>, <span class="st">"West Malo"</span>, <span class="st">"East Malo"</span>,</span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Penama"</span>, <span class="st">"West Ambae"</span>, <span class="st">"North Ambae"</span>, <span class="st">"East Ambae"</span>, <span class="st">"South Ambae"</span>, <span class="st">"North Maewo"</span>, </span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South Maewo"</span>, <span class="st">"North Pentecost"</span>, <span class="st">"Central Pentecost 1"</span>, <span class="st">"Central Pentecost 2"</span>, </span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South Pentecost"</span>,</span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Malampa"</span>, <span class="st">"North West Malekula"</span>, <span class="st">"North East Malekula"</span>, <span class="st">"Central Malekula"</span>, </span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a>  <span class="st">"South West Malekula"</span>, <span class="st">"South East Malekula"</span>, <span class="st">"South Malekula"</span>, <span class="st">"North Ambrym"</span>, </span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a>  <span class="st">"West Ambrym"</span>, <span class="st">"South East Ambrym"</span>, <span class="st">"Paama"</span>,</span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Shefa"</span>, <span class="st">"Port Vila"</span>, <span class="st">"Vermali"</span>, <span class="st">"Vermaul"</span>, <span class="st">"Varisu"</span>, <span class="st">"South Epi"</span>, <span class="st">"North Tongoa"</span>, </span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tongariki"</span>, <span class="st">"Makimae"</span>, <span class="st">"Nguna"</span>, <span class="st">"Emau"</span>, <span class="st">"Malorua"</span>, <span class="st">"North Efate"</span>, <span class="st">"Mele"</span>, </span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tanvasoko"</span>, <span class="st">"Ifira"</span>, <span class="st">"Pango"</span>, <span class="st">"Erakor"</span>, <span class="st">"Eratap"</span>, <span class="st">"Eton"</span>,</span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tafea"</span>, <span class="st">"North Erromango"</span>, <span class="st">"South Erromango"</span>, <span class="st">"Aniwa"</span>, <span class="st">"North Tanna"</span>, <span class="st">"West Tanna"</span>, </span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Middle Bush Tanna"</span>, <span class="st">"South West Tanna"</span>, <span class="st">"Whitesands"</span>, <span class="st">"South Tanna"</span>, <span class="st">"Futuna"</span>, <span class="st">"Aneityum"</span></span>
<span id="cb48-101"><a href="#cb48-101" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-102"><a href="#cb48-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-103"><a href="#cb48-103" aria-hidden="true" tabindex="-1"></a><span class="co"># Provincial levels (to be bolded)</span></span>
<span id="cb48-104"><a href="#cb48-104" aria-hidden="true" tabindex="-1"></a>provinces <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"National"</span>, <span class="st">"Torba"</span>, <span class="st">"Sanma"</span>, <span class="st">"Penama"</span>, <span class="st">"Malampa"</span>, <span class="st">"Shefa"</span>, <span class="st">"Tafea"</span>)</span>
<span id="cb48-105"><a href="#cb48-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-106"><a href="#cb48-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-107"><a href="#cb48-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-108"><a href="#cb48-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-109"><a href="#cb48-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-110"><a href="#cb48-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-111"><a href="#cb48-111" aria-hidden="true" tabindex="-1"></a>A function to aggregate a table with one row per council. It adds value per province and for the whole country</span>
<span id="cb48-114"><a href="#cb48-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-115"><a href="#cb48-115" aria-hidden="true" tabindex="-1"></a><span class="co"># council_data must be a data frame with a column called "Region"</span></span>
<span id="cb48-116"><a href="#cb48-116" aria-hidden="true" tabindex="-1"></a>compute_council_aggregates <span class="ot">&lt;-</span> <span class="cf">function</span>(council_data) {</span>
<span id="cb48-117"><a href="#cb48-117" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-118"><a href="#cb48-118" aria-hidden="true" tabindex="-1"></a>  province_data <span class="ot">&lt;-</span> council_data <span class="sc">%&gt;%</span></span>
<span id="cb48-119"><a href="#cb48-119" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(council_province_lookup, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Council"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-120"><a href="#cb48-120" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb48-121"><a href="#cb48-121" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-122"><a href="#cb48-122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Region =</span> Province)  </span>
<span id="cb48-123"><a href="#cb48-123" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-124"><a href="#cb48-124" aria-hidden="true" tabindex="-1"></a>  national_data <span class="ot">&lt;-</span> province_data <span class="sc">%&gt;%</span></span>
<span id="cb48-125"><a href="#cb48-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-126"><a href="#cb48-126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">"National"</span>)</span>
<span id="cb48-127"><a href="#cb48-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-128"><a href="#cb48-128" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb48-129"><a href="#cb48-129" aria-hidden="true" tabindex="-1"></a>    national_data,</span>
<span id="cb48-130"><a href="#cb48-130" aria-hidden="true" tabindex="-1"></a>    province_data,</span>
<span id="cb48-131"><a href="#cb48-131" aria-hidden="true" tabindex="-1"></a>    council_data</span>
<span id="cb48-132"><a href="#cb48-132" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-133"><a href="#cb48-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-134"><a href="#cb48-134" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add default order and formatting columns</span></span>
<span id="cb48-135"><a href="#cb48-135" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> result <span class="sc">%&gt;%</span></span>
<span id="cb48-136"><a href="#cb48-136" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">default_order =</span> <span class="fu">match</span>(Region, region_order)) <span class="sc">%&gt;%</span></span>
<span id="cb48-137"><a href="#cb48-137" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(default_order) <span class="sc">%&gt;%</span></span>
<span id="cb48-138"><a href="#cb48-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>default_order)</span>
<span id="cb48-139"><a href="#cb48-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-140"><a href="#cb48-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb48-141"><a href="#cb48-141" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-142"><a href="#cb48-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-143"><a href="#cb48-143" aria-hidden="true" tabindex="-1"></a>format_table <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb48-144"><a href="#cb48-144" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb48-145"><a href="#cb48-145" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Region, <span class="fu">everything</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb48-146"><a href="#cb48-146" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb48-147"><a href="#cb48-147" aria-hidden="true" tabindex="-1"></a>      <span class="at">Region =</span> <span class="fu">ifelse</span>(</span>
<span id="cb48-148"><a href="#cb48-148" aria-hidden="true" tabindex="-1"></a>        Region <span class="sc">%in%</span> provinces, </span>
<span id="cb48-149"><a href="#cb48-149" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="st">"&lt;b&gt;"</span>, Region, <span class="st">"&lt;/b&gt;"</span>), </span>
<span id="cb48-150"><a href="#cb48-150" aria-hidden="true" tabindex="-1"></a>        Region</span>
<span id="cb48-151"><a href="#cb48-151" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb48-152"><a href="#cb48-152" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-153"><a href="#cb48-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb48-154"><a href="#cb48-154" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-155"><a href="#cb48-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-156"><a href="#cb48-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-157"><a href="#cb48-157" aria-hidden="true" tabindex="-1"></a><span class="fu"># Education</span></span>
<span id="cb48-158"><a href="#cb48-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-159"><a href="#cb48-159" aria-hidden="true" tabindex="-1"></a><span class="fu">## Baseline: Number of Schools, Students, and Teachers</span></span>
<span id="cb48-160"><a href="#cb48-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-163"><a href="#cb48-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-164"><a href="#cb48-164" aria-hidden="true" tabindex="-1"></a>full_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"1c_input_baseline.csv"</span>), <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-165"><a href="#cb48-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-166"><a href="#cb48-166" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-167"><a href="#cb48-167" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Education in Baseline column and Area Council level data</span></span>
<span id="cb48-168"><a href="#cb48-168" aria-hidden="true" tabindex="-1"></a>education_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-169"><a href="#cb48-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Education"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Changed to filter Baseline column</span></span>
<span id="cb48-170"><a href="#cb48-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>  <span class="co"># Filter for the latest year</span></span>
<span id="cb48-171"><a href="#cb48-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-172"><a href="#cb48-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb48-173"><a href="#cb48-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-174"><a href="#cb48-174" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to get Schools, Students, Teachers as separate columns</span></span>
<span id="cb48-175"><a href="#cb48-175" aria-hidden="true" tabindex="-1"></a>education_wide <span class="ot">&lt;-</span> education_data <span class="sc">%&gt;%</span></span>
<span id="cb48-176"><a href="#cb48-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-177"><a href="#cb48-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">education_level =</span> <span class="fu">tolower</span>(Attribute),  <span class="co"># Keep lowercase for consistency</span></span>
<span id="cb48-178"><a href="#cb48-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">measure_type =</span> <span class="fu">case_when</span>(</span>
<span id="cb48-179"><a href="#cb48-179" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Number Schools"</span>, Indicator) <span class="sc">~</span> <span class="st">"schools"</span>,</span>
<span id="cb48-180"><a href="#cb48-180" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Students"</span>, Indicator) <span class="sc">~</span> <span class="st">"students"</span>,</span>
<span id="cb48-181"><a href="#cb48-181" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Teachers"</span>, Indicator) <span class="sc">~</span> <span class="st">"teachers"</span>,</span>
<span id="cb48-182"><a href="#cb48-182" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"other"</span></span>
<span id="cb48-183"><a href="#cb48-183" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-184"><a href="#cb48-184" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-185"><a href="#cb48-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(measure_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"schools"</span>, <span class="st">"students"</span>, <span class="st">"teachers"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-186"><a href="#cb48-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, education_level, measure_type, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-187"><a href="#cb48-187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-188"><a href="#cb48-188" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="fu">c</span>(education_level, measure_type),</span>
<span id="cb48-189"><a href="#cb48-189" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-190"><a href="#cb48-190" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span></span>
<span id="cb48-191"><a href="#cb48-191" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-192"><a href="#cb48-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-193"><a href="#cb48-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-194"><a href="#cb48-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-195"><a href="#cb48-195" aria-hidden="true" tabindex="-1"></a>education_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(education_wide)</span>
<span id="cb48-196"><a href="#cb48-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-197"><a href="#cb48-197" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-198"><a href="#cb48-198" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-199"><a href="#cb48-199" aria-hidden="true" tabindex="-1"></a>  education_aggregated <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb48-200"><a href="#cb48-200" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Education_01_baseline_education.csv"</span>),</span>
<span id="cb48-201"><a href="#cb48-201" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-202"><a href="#cb48-202" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-203"><a href="#cb48-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-204"><a href="#cb48-204" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-205"><a href="#cb48-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-206"><a href="#cb48-206" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(education_aggregated)</span>
<span id="cb48-207"><a href="#cb48-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-208"><a href="#cb48-208" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the reactable with proper case labels</span></span>
<span id="cb48-209"><a href="#cb48-209" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-210"><a href="#cb48-210" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-211"><a href="#cb48-211" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-212"><a href="#cb48-212" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-213"><a href="#cb48-213" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-214"><a href="#cb48-214" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-215"><a href="#cb48-215" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-216"><a href="#cb48-216" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-217"><a href="#cb48-217" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-218"><a href="#cb48-218" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-219"><a href="#cb48-219" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-220"><a href="#cb48-220" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-221"><a href="#cb48-221" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ECCE columns</span></span>
<span id="cb48-222"><a href="#cb48-222" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_schools =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-223"><a href="#cb48-223" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_students =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-224"><a href="#cb48-224" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_teachers =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Teachers"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-225"><a href="#cb48-225" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-226"><a href="#cb48-226" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Primary columns  </span></span>
<span id="cb48-227"><a href="#cb48-227" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_schools =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-228"><a href="#cb48-228" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_students =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-229"><a href="#cb48-229" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_teachers =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Teachers"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-230"><a href="#cb48-230" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-231"><a href="#cb48-231" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Secondary columns</span></span>
<span id="cb48-232"><a href="#cb48-232" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_schools =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-233"><a href="#cb48-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_students =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-234"><a href="#cb48-234" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_teachers =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Teachers"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-235"><a href="#cb48-235" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-236"><a href="#cb48-236" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-237"><a href="#cb48-237" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-238"><a href="#cb48-238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"ECCE"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ecce_schools"</span>, <span class="st">"ecce_students"</span>, <span class="st">"ecce_teachers"</span>)),</span>
<span id="cb48-239"><a href="#cb48-239" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Primary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"primary_schools"</span>, <span class="st">"primary_students"</span>, <span class="st">"primary_teachers"</span>)),</span>
<span id="cb48-240"><a href="#cb48-240" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Secondary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"secondary_schools"</span>, <span class="st">"secondary_students"</span>, <span class="st">"secondary_teachers"</span>))</span>
<span id="cb48-241"><a href="#cb48-241" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-242"><a href="#cb48-242" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-243"><a href="#cb48-243" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-244"><a href="#cb48-244" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-245"><a href="#cb48-245" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-246"><a href="#cb48-246" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-247"><a href="#cb48-247" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-248"><a href="#cb48-248" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-249"><a href="#cb48-249" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-250"><a href="#cb48-250" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-251"><a href="#cb48-251" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-252"><a href="#cb48-252" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-253"><a href="#cb48-253" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-254"><a href="#cb48-254" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-255"><a href="#cb48-255" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-256"><a href="#cb48-256" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-257"><a href="#cb48-257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-258"><a href="#cb48-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-259"><a href="#cb48-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-260"><a href="#cb48-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-261"><a href="#cb48-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-262"><a href="#cb48-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-263"><a href="#cb48-263" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimating damage: Number of damaged schools and students affected</span></span>
<span id="cb48-264"><a href="#cb48-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-267"><a href="#cb48-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-268"><a href="#cb48-268" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-269"><a href="#cb48-269" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to baseline values</span></span>
<span id="cb48-270"><a href="#cb48-270" aria-hidden="true" tabindex="-1"></a>education_with_config <span class="ot">&lt;-</span> education_wide <span class="sc">%&gt;%</span></span>
<span id="cb48-271"><a href="#cb48-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-272"><a href="#cb48-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-273"><a href="#cb48-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the baseline multiplying factors: 2a Input- Damage Multiplier (sheet 6)</span></span>
<span id="cb48-274"><a href="#cb48-274" aria-hidden="true" tabindex="-1"></a><span class="co"># Read CSV while preserving column names with spaces</span></span>
<span id="cb48-275"><a href="#cb48-275" aria-hidden="true" tabindex="-1"></a>baseline_factors <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb48-276"><a href="#cb48-276" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"2a Input- Damage Multiplier.csv"</span>),</span>
<span id="cb48-277"><a href="#cb48-277" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-278"><a href="#cb48-278" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-279"><a href="#cb48-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-280"><a href="#cb48-280" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for damage multipliers (now considers council-specific values)</span></span>
<span id="cb48-281"><a href="#cb48-281" aria-hidden="true" tabindex="-1"></a>get_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, education_level, measure_type, area_council) {</span>
<span id="cb48-282"><a href="#cb48-282" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb48-283"><a href="#cb48-283" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-284"><a href="#cb48-284" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb48-285"><a href="#cb48-285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-286"><a href="#cb48-286" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Education"</span>,</span>
<span id="cb48-287"><a href="#cb48-287" aria-hidden="true" tabindex="-1"></a>      Attribute <span class="sc">==</span> education_level,</span>
<span id="cb48-288"><a href="#cb48-288" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(measure_type, Indicator, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-289"><a href="#cb48-289" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council  <span class="co"># Add council-specific filter</span></span>
<span id="cb48-290"><a href="#cb48-290" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-291"><a href="#cb48-291" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-292"><a href="#cb48-292" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if we got any results</span></span>
<span id="cb48-293"><a href="#cb48-293" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb48-294"><a href="#cb48-294" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb48-295"><a href="#cb48-295" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-296"><a href="#cb48-296" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-297"><a href="#cb48-297" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the value from the intensity column</span></span>
<span id="cb48-298"><a href="#cb48-298" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb48-299"><a href="#cb48-299" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-300"><a href="#cb48-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb48-301"><a href="#cb48-301" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-302"><a href="#cb48-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-303"><a href="#cb48-303" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates</span></span>
<span id="cb48-304"><a href="#cb48-304" aria-hidden="true" tabindex="-1"></a>damage_estimates <span class="ot">&lt;-</span> education_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-305"><a href="#cb48-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-306"><a href="#cb48-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-307"><a href="#cb48-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-308"><a href="#cb48-308" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ECCE - now passing Region to get council-specific multipliers</span></span>
<span id="cb48-309"><a href="#cb48-309" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_schools_damaged =</span> <span class="fu">round</span>(ecce_schools <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"ecce"</span>, <span class="st">"schools"</span>, Region)),</span>
<span id="cb48-310"><a href="#cb48-310" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_students_affected =</span> <span class="fu">round</span>(ecce_students <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"ecce"</span>, <span class="st">"students"</span>, Region)),</span>
<span id="cb48-311"><a href="#cb48-311" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-312"><a href="#cb48-312" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Primary</span></span>
<span id="cb48-313"><a href="#cb48-313" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_schools_damaged =</span> <span class="fu">round</span>(primary_schools <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"primary"</span>, <span class="st">"schools"</span>, Region)),</span>
<span id="cb48-314"><a href="#cb48-314" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_students_affected =</span> <span class="fu">round</span>(primary_students <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"primary"</span>, <span class="st">"students"</span>, Region)),</span>
<span id="cb48-315"><a href="#cb48-315" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-316"><a href="#cb48-316" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Secondary</span></span>
<span id="cb48-317"><a href="#cb48-317" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_schools_damaged =</span> <span class="fu">round</span>(secondary_schools <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"secondary"</span>, <span class="st">"schools"</span>, Region)),</span>
<span id="cb48-318"><a href="#cb48-318" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_students_affected =</span> <span class="fu">round</span>(secondary_students <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"secondary"</span>, <span class="st">"students"</span>, Region))</span>
<span id="cb48-319"><a href="#cb48-319" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-320"><a href="#cb48-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-321"><a href="#cb48-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">contains</span>(<span class="st">"_damaged"</span>), <span class="fu">contains</span>(<span class="st">"_affected"</span>))</span>
<span id="cb48-322"><a href="#cb48-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-323"><a href="#cb48-323" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-324"><a href="#cb48-324" aria-hidden="true" tabindex="-1"></a>damage_estimates_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(damage_estimates)</span>
<span id="cb48-325"><a href="#cb48-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-326"><a href="#cb48-326" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-327"><a href="#cb48-327" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-328"><a href="#cb48-328" aria-hidden="true" tabindex="-1"></a>  damage_estimates_full <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb48-329"><a href="#cb48-329" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Education_02_damage_estimates.csv"</span>),</span>
<span id="cb48-330"><a href="#cb48-330" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-331"><a href="#cb48-331" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-332"><a href="#cb48-332" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-333"><a href="#cb48-333" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-334"><a href="#cb48-334" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(damage_estimates_full)</span>
<span id="cb48-335"><a href="#cb48-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-336"><a href="#cb48-336" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb48-337"><a href="#cb48-337" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-338"><a href="#cb48-338" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-339"><a href="#cb48-339" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-340"><a href="#cb48-340" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-341"><a href="#cb48-341" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-342"><a href="#cb48-342" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-343"><a href="#cb48-343" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-344"><a href="#cb48-344" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-345"><a href="#cb48-345" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-346"><a href="#cb48-346" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-347"><a href="#cb48-347" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ECCE columns</span></span>
<span id="cb48-348"><a href="#cb48-348" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_schools_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools Damaged"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-349"><a href="#cb48-349" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_students_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students Affected"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-350"><a href="#cb48-350" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-351"><a href="#cb48-351" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Primary columns  </span></span>
<span id="cb48-352"><a href="#cb48-352" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_schools_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools Damaged"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-353"><a href="#cb48-353" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_students_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students Affected"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-354"><a href="#cb48-354" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-355"><a href="#cb48-355" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Secondary columns</span></span>
<span id="cb48-356"><a href="#cb48-356" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_schools_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Schools Damaged"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-357"><a href="#cb48-357" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_students_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Students Affected"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-358"><a href="#cb48-358" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-359"><a href="#cb48-359" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-360"><a href="#cb48-360" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-361"><a href="#cb48-361" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"ECCE"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ecce_schools_damaged"</span>, <span class="st">"ecce_students_affected"</span>)),</span>
<span id="cb48-362"><a href="#cb48-362" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Primary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"primary_schools_damaged"</span>, <span class="st">"primary_students_affected"</span>)),</span>
<span id="cb48-363"><a href="#cb48-363" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Secondary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"secondary_schools_damaged"</span>, <span class="st">"secondary_students_affected"</span>))</span>
<span id="cb48-364"><a href="#cb48-364" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-365"><a href="#cb48-365" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-366"><a href="#cb48-366" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-367"><a href="#cb48-367" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-368"><a href="#cb48-368" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-369"><a href="#cb48-369" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-370"><a href="#cb48-370" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-371"><a href="#cb48-371" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-372"><a href="#cb48-372" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-373"><a href="#cb48-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-374"><a href="#cb48-374" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-375"><a href="#cb48-375" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-376"><a href="#cb48-376" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-377"><a href="#cb48-377" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-378"><a href="#cb48-378" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-379"><a href="#cb48-379" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-380"><a href="#cb48-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-381"><a href="#cb48-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-382"><a href="#cb48-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-383"><a href="#cb48-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-384"><a href="#cb48-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-385"><a href="#cb48-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-386"><a href="#cb48-386" aria-hidden="true" tabindex="-1"></a><span class="fu">## Resources needed to be sent to those affected</span></span>
<span id="cb48-387"><a href="#cb48-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-390"><a href="#cb48-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-391"><a href="#cb48-391" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-392"><a href="#cb48-392" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the resource response configuration "3aii Input- Resources Sent" (sheet 10)</span></span>
<span id="cb48-393"><a href="#cb48-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-394"><a href="#cb48-394" aria-hidden="true" tabindex="-1"></a>resource_config <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"3aii Input- Resources Sent.csv"</span>), <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-395"><a href="#cb48-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-396"><a href="#cb48-396" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get resource multipliers from config</span></span>
<span id="cb48-397"><a href="#cb48-397" aria-hidden="true" tabindex="-1"></a>get_resource_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type) {</span>
<span id="cb48-398"><a href="#cb48-398" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb48-399"><a href="#cb48-399" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"Education"</span>, Indicator <span class="sc">==</span> resource_type) <span class="sc">%&gt;%</span></span>
<span id="cb48-400"><a href="#cb48-400" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-401"><a href="#cb48-401" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-402"><a href="#cb48-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(multiplier) <span class="sc">&gt;</span> <span class="dv">0</span>, multiplier, <span class="dv">0</span>))</span>
<span id="cb48-403"><a href="#cb48-403" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-404"><a href="#cb48-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-405"><a href="#cb48-405" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration parameters</span></span>
<span id="cb48-406"><a href="#cb48-406" aria-hidden="true" tabindex="-1"></a>days_of_support <span class="ot">&lt;-</span> <span class="dv">14</span>  <span class="co"># Number of days to provide resources</span></span>
<span id="cb48-407"><a href="#cb48-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-408"><a href="#cb48-408" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories from config file to education baseline data</span></span>
<span id="cb48-409"><a href="#cb48-409" aria-hidden="true" tabindex="-1"></a>education_with_config_resources <span class="ot">&lt;-</span> education_wide <span class="sc">%&gt;%</span></span>
<span id="cb48-410"><a href="#cb48-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-411"><a href="#cb48-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-412"><a href="#cb48-412" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate resources needed using council-specific cyclone categories</span></span>
<span id="cb48-413"><a href="#cb48-413" aria-hidden="true" tabindex="-1"></a>resources_needed <span class="ot">&lt;-</span> education_with_config_resources <span class="sc">%&gt;%</span></span>
<span id="cb48-414"><a href="#cb48-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-415"><a href="#cb48-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-416"><a href="#cb48-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-417"><a href="#cb48-417" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get damage multiplier for this council's specific cyclone category</span></span>
<span id="cb48-418"><a href="#cb48-418" aria-hidden="true" tabindex="-1"></a>    <span class="at">damage_multiplier =</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"ecce"</span>, <span class="st">"schools"</span>, Region),</span>
<span id="cb48-419"><a href="#cb48-419" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-420"><a href="#cb48-420" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ECCE Resources</span></span>
<span id="cb48-421"><a href="#cb48-421" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_tents =</span> <span class="fu">round</span>(ecce_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tent"</span>), <span class="dv">0</span>),</span>
<span id="cb48-422"><a href="#cb48-422" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_solar_lamps =</span> <span class="fu">round</span>(ecce_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Solar Lamp"</span>), <span class="dv">0</span>),</span>
<span id="cb48-423"><a href="#cb48-423" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_water =</span> <span class="fu">ceiling</span>(ecce_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Water"</span>) <span class="sc">*</span> days_of_support),</span>
<span id="cb48-424"><a href="#cb48-424" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_tin_fish =</span> <span class="fu">round</span>(ecce_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tin Fish"</span>) <span class="sc">*</span> days_of_support, <span class="dv">0</span>),  <span class="co"># Changed to "Tin Fish"</span></span>
<span id="cb48-425"><a href="#cb48-425" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-426"><a href="#cb48-426" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Primary Resources</span></span>
<span id="cb48-427"><a href="#cb48-427" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_tents =</span> <span class="fu">round</span>(primary_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tent"</span>), <span class="dv">0</span>),</span>
<span id="cb48-428"><a href="#cb48-428" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_solar_lamps =</span> <span class="fu">round</span>(primary_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Solar Lamp"</span>), <span class="dv">0</span>),</span>
<span id="cb48-429"><a href="#cb48-429" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_water =</span> <span class="fu">ceiling</span>(primary_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Water"</span>) <span class="sc">*</span> days_of_support),</span>
<span id="cb48-430"><a href="#cb48-430" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_tin_fish =</span> <span class="fu">round</span>(primary_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tin Fish"</span>) <span class="sc">*</span> days_of_support, <span class="dv">0</span>),  <span class="co"># Changed to "Tin Fish"</span></span>
<span id="cb48-431"><a href="#cb48-431" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-432"><a href="#cb48-432" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Secondary Resources</span></span>
<span id="cb48-433"><a href="#cb48-433" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_tents =</span> <span class="fu">round</span>(secondary_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tent"</span>), <span class="dv">0</span>),</span>
<span id="cb48-434"><a href="#cb48-434" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_solar_lamps =</span> <span class="fu">round</span>(secondary_schools <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Solar Lamp"</span>), <span class="dv">0</span>),</span>
<span id="cb48-435"><a href="#cb48-435" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_water =</span> <span class="fu">ceiling</span>(secondary_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Water"</span>) <span class="sc">*</span> days_of_support),</span>
<span id="cb48-436"><a href="#cb48-436" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_tin_fish =</span> <span class="fu">round</span>(secondary_students <span class="sc">*</span> damage_multiplier <span class="sc">*</span> <span class="fu">get_resource_multiplier</span>(<span class="st">"Tin Fish"</span>) <span class="sc">*</span> days_of_support, <span class="dv">0</span>),  <span class="co"># Changed to "Tin Fish"</span></span>
<span id="cb48-437"><a href="#cb48-437" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-438"><a href="#cb48-438" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total Resources (sum across all education levels)</span></span>
<span id="cb48-439"><a href="#cb48-439" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_tents =</span> ecce_tents <span class="sc">+</span> primary_tents <span class="sc">+</span> secondary_tents,</span>
<span id="cb48-440"><a href="#cb48-440" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_solar_lamps =</span> ecce_solar_lamps <span class="sc">+</span> primary_solar_lamps <span class="sc">+</span> secondary_solar_lamps,</span>
<span id="cb48-441"><a href="#cb48-441" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_water =</span> ecce_water <span class="sc">+</span> primary_water <span class="sc">+</span> secondary_water,</span>
<span id="cb48-442"><a href="#cb48-442" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_tin_fish =</span> ecce_tin_fish <span class="sc">+</span> primary_tin_fish <span class="sc">+</span> secondary_tin_fish</span>
<span id="cb48-443"><a href="#cb48-443" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-444"><a href="#cb48-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-445"><a href="#cb48-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">contains</span>(<span class="st">"tents"</span>), <span class="fu">contains</span>(<span class="st">"solar_lamps"</span>), <span class="fu">contains</span>(<span class="st">"water"</span>), <span class="fu">contains</span>(<span class="st">"tin_fish"</span>))</span>
<span id="cb48-446"><a href="#cb48-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-447"><a href="#cb48-447" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-448"><a href="#cb48-448" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(resources_needed)</span>
<span id="cb48-449"><a href="#cb48-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-450"><a href="#cb48-450" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-451"><a href="#cb48-451" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-452"><a href="#cb48-452" aria-hidden="true" tabindex="-1"></a>  resources_needed_full <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb48-453"><a href="#cb48-453" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Education_03_resources_needed.csv"</span>),</span>
<span id="cb48-454"><a href="#cb48-454" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-455"><a href="#cb48-455" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-456"><a href="#cb48-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-457"><a href="#cb48-457" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-458"><a href="#cb48-458" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-459"><a href="#cb48-459" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb48-460"><a href="#cb48-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-461"><a href="#cb48-461" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the resources needed reactable</span></span>
<span id="cb48-462"><a href="#cb48-462" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-463"><a href="#cb48-463" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-464"><a href="#cb48-464" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-465"><a href="#cb48-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-466"><a href="#cb48-466" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-467"><a href="#cb48-467" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-468"><a href="#cb48-468" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-469"><a href="#cb48-469" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-470"><a href="#cb48-470" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-471"><a href="#cb48-471" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-472"><a href="#cb48-472" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ECCE columns</span></span>
<span id="cb48-473"><a href="#cb48-473" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_tents =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tents"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-474"><a href="#cb48-474" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_solar_lamps =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Lamps"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-475"><a href="#cb48-475" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_water =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water (1L bottles)"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-476"><a href="#cb48-476" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_tin_fish =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tinned Fish"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-477"><a href="#cb48-477" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-478"><a href="#cb48-478" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Primary columns  </span></span>
<span id="cb48-479"><a href="#cb48-479" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_tents =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tents"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-480"><a href="#cb48-480" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_solar_lamps =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Lamps"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-481"><a href="#cb48-481" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_water =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water (1L bottles)"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-482"><a href="#cb48-482" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_tin_fish =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tinned Fish"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-483"><a href="#cb48-483" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-484"><a href="#cb48-484" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Secondary columns</span></span>
<span id="cb48-485"><a href="#cb48-485" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_tents =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tents"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-486"><a href="#cb48-486" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_solar_lamps =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Lamps"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-487"><a href="#cb48-487" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_water =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water (1L bottles)"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-488"><a href="#cb48-488" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_tin_fish =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tinned Fish"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-489"><a href="#cb48-489" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-490"><a href="#cb48-490" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total columns</span></span>
<span id="cb48-491"><a href="#cb48-491" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_tents =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tents"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-492"><a href="#cb48-492" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_solar_lamps =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Lamps"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-493"><a href="#cb48-493" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_water =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water (1L bottles)"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-494"><a href="#cb48-494" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_tin_fish =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tinned Fish"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-495"><a href="#cb48-495" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-496"><a href="#cb48-496" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-497"><a href="#cb48-497" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-498"><a href="#cb48-498" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"ECCE"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ecce_tents"</span>, <span class="st">"ecce_solar_lamps"</span>, <span class="st">"ecce_water"</span>, <span class="st">"ecce_tin_fish"</span>)),</span>
<span id="cb48-499"><a href="#cb48-499" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Primary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"primary_tents"</span>, <span class="st">"primary_solar_lamps"</span>, <span class="st">"primary_water"</span>, <span class="st">"primary_tin_fish"</span>)),</span>
<span id="cb48-500"><a href="#cb48-500" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Secondary"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"secondary_tents"</span>, <span class="st">"secondary_solar_lamps"</span>, <span class="st">"secondary_water"</span>, <span class="st">"secondary_tin_fish"</span>)),</span>
<span id="cb48-501"><a href="#cb48-501" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Totals"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_tents"</span>, <span class="st">"total_solar_lamps"</span>, <span class="st">"total_water"</span>, <span class="st">"total_tin_fish"</span>))</span>
<span id="cb48-502"><a href="#cb48-502" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-503"><a href="#cb48-503" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-504"><a href="#cb48-504" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-505"><a href="#cb48-505" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-506"><a href="#cb48-506" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-507"><a href="#cb48-507" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-508"><a href="#cb48-508" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-509"><a href="#cb48-509" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-510"><a href="#cb48-510" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-511"><a href="#cb48-511" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-512"><a href="#cb48-512" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-513"><a href="#cb48-513" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-514"><a href="#cb48-514" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-515"><a href="#cb48-515" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-516"><a href="#cb48-516" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-517"><a href="#cb48-517" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-518"><a href="#cb48-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-519"><a href="#cb48-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-520"><a href="#cb48-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-521"><a href="#cb48-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-522"><a href="#cb48-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-523"><a href="#cb48-523" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimate financial damage from cyclone</span></span>
<span id="cb48-524"><a href="#cb48-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-527"><a href="#cb48-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-528"><a href="#cb48-528" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-529"><a href="#cb48-529" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the financial damage estimation config (4a Input- Finance Estimates, sheet 13)</span></span>
<span id="cb48-530"><a href="#cb48-530" aria-hidden="true" tabindex="-1"></a><span class="co"># Read CSV while preserving column names with spaces</span></span>
<span id="cb48-531"><a href="#cb48-531" aria-hidden="true" tabindex="-1"></a>financial_config <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb48-532"><a href="#cb48-532" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"4a Input- Finance Estimates.csv"</span>),</span>
<span id="cb48-533"><a href="#cb48-533" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-534"><a href="#cb48-534" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-535"><a href="#cb48-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-536"><a href="#cb48-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove empty column if exists</span></span>
<span id="cb48-537"><a href="#cb48-537" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="st">""</span> <span class="sc">%in%</span> <span class="fu">names</span>(financial_config)) {</span>
<span id="cb48-538"><a href="#cb48-538" aria-hidden="true" tabindex="-1"></a>  financial_config <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb48-539"><a href="#cb48-539" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-540"><a href="#cb48-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-541"><a href="#cb48-541" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean column names to remove any extra spaces</span></span>
<span id="cb48-542"><a href="#cb48-542" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(financial_config) <span class="ot">&lt;-</span> <span class="fu">trimws</span>(<span class="fu">names</span>(financial_config))</span>
<span id="cb48-543"><a href="#cb48-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-544"><a href="#cb48-544" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs from config (now council-specific)</span></span>
<span id="cb48-545"><a href="#cb48-545" aria-hidden="true" tabindex="-1"></a>get_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(school_type, area_council) {</span>
<span id="cb48-546"><a href="#cb48-546" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb48-547"><a href="#cb48-547" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-548"><a href="#cb48-548" aria-hidden="true" tabindex="-1"></a>      <span class="fu">trimws</span>(Cluster) <span class="sc">==</span> <span class="st">"Education"</span>, </span>
<span id="cb48-549"><a href="#cb48-549" aria-hidden="true" tabindex="-1"></a>      <span class="fu">trimws</span>(<span class="fu">tolower</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(school_type),</span>
<span id="cb48-550"><a href="#cb48-550" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Number Schools"</span>, <span class="fu">trimws</span>(Indicator), <span class="at">ignore.case =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-551"><a href="#cb48-551" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council  <span class="co"># Add council-specific filter</span></span>
<span id="cb48-552"><a href="#cb48-552" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-553"><a href="#cb48-553" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-554"><a href="#cb48-554" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-555"><a href="#cb48-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb48-556"><a href="#cb48-556" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-557"><a href="#cb48-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-558"><a href="#cb48-558" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories from config file to education baseline data</span></span>
<span id="cb48-559"><a href="#cb48-559" aria-hidden="true" tabindex="-1"></a>education_with_config_financial <span class="ot">&lt;-</span> education_wide <span class="sc">%&gt;%</span></span>
<span id="cb48-560"><a href="#cb48-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-561"><a href="#cb48-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-562"><a href="#cb48-562" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate financial damage using council-specific cyclone categories</span></span>
<span id="cb48-563"><a href="#cb48-563" aria-hidden="true" tabindex="-1"></a>financial_damage <span class="ot">&lt;-</span> education_with_config_financial <span class="sc">%&gt;%</span></span>
<span id="cb48-564"><a href="#cb48-564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-565"><a href="#cb48-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-566"><a href="#cb48-566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-567"><a href="#cb48-567" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get council-specific damage multipliers for each education level</span></span>
<span id="cb48-568"><a href="#cb48-568" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_damage_multiplier =</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"ecce"</span>, <span class="st">"schools"</span>, Region),</span>
<span id="cb48-569"><a href="#cb48-569" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_damage_multiplier =</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"primary"</span>, <span class="st">"schools"</span>, Region),</span>
<span id="cb48-570"><a href="#cb48-570" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_damage_multiplier =</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"secondary"</span>, <span class="st">"schools"</span>, Region),</span>
<span id="cb48-571"><a href="#cb48-571" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-572"><a href="#cb48-572" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate financial damage per education level (in VT) using council-specific values</span></span>
<span id="cb48-573"><a href="#cb48-573" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_financial_damage =</span> ecce_schools <span class="sc">*</span> <span class="fu">get_unit_cost</span>(<span class="st">"ecce"</span>, Region) <span class="sc">*</span> ecce_damage_multiplier,</span>
<span id="cb48-574"><a href="#cb48-574" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_financial_damage =</span> primary_schools <span class="sc">*</span> <span class="fu">get_unit_cost</span>(<span class="st">"primary"</span>, Region) <span class="sc">*</span> primary_damage_multiplier,</span>
<span id="cb48-575"><a href="#cb48-575" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_financial_damage =</span> secondary_schools <span class="sc">*</span> <span class="fu">get_unit_cost</span>(<span class="st">"secondary"</span>, Region) <span class="sc">*</span> secondary_damage_multiplier,</span>
<span id="cb48-576"><a href="#cb48-576" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-577"><a href="#cb48-577" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total financial damage</span></span>
<span id="cb48-578"><a href="#cb48-578" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial_damage =</span> ecce_financial_damage <span class="sc">+</span> primary_financial_damage <span class="sc">+</span> secondary_financial_damage</span>
<span id="cb48-579"><a href="#cb48-579" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-580"><a href="#cb48-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-581"><a href="#cb48-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">contains</span>(<span class="st">"financial_damage"</span>))</span>
<span id="cb48-582"><a href="#cb48-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-583"><a href="#cb48-583" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-584"><a href="#cb48-584" aria-hidden="true" tabindex="-1"></a>financial_damage_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(financial_damage)</span>
<span id="cb48-585"><a href="#cb48-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-586"><a href="#cb48-586" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-587"><a href="#cb48-587" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-588"><a href="#cb48-588" aria-hidden="true" tabindex="-1"></a>  financial_damage_full <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb48-589"><a href="#cb48-589" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Education_04_financial_damage.csv"</span>),</span>
<span id="cb48-590"><a href="#cb48-590" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-591"><a href="#cb48-591" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-592"><a href="#cb48-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-593"><a href="#cb48-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-594"><a href="#cb48-594" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-595"><a href="#cb48-595" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-596"><a href="#cb48-596" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(financial_damage_full)</span>
<span id="cb48-597"><a href="#cb48-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-598"><a href="#cb48-598" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the financial damage reactable</span></span>
<span id="cb48-599"><a href="#cb48-599" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-600"><a href="#cb48-600" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-601"><a href="#cb48-601" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-602"><a href="#cb48-602" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-603"><a href="#cb48-603" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-604"><a href="#cb48-604" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-605"><a href="#cb48-605" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-606"><a href="#cb48-606" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-607"><a href="#cb48-607" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-608"><a href="#cb48-608" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-609"><a href="#cb48-609" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage columns</span></span>
<span id="cb48-610"><a href="#cb48-610" aria-hidden="true" tabindex="-1"></a>    <span class="at">ecce_financial_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-611"><a href="#cb48-611" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"ECCE"</span>, </span>
<span id="cb48-612"><a href="#cb48-612" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-613"><a href="#cb48-613" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-614"><a href="#cb48-614" aria-hidden="true" tabindex="-1"></a>    <span class="at">primary_financial_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-615"><a href="#cb48-615" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Primary"</span>, </span>
<span id="cb48-616"><a href="#cb48-616" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-617"><a href="#cb48-617" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-618"><a href="#cb48-618" aria-hidden="true" tabindex="-1"></a>    <span class="at">secondary_financial_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-619"><a href="#cb48-619" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Secondary"</span>, </span>
<span id="cb48-620"><a href="#cb48-620" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-621"><a href="#cb48-621" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-622"><a href="#cb48-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-623"><a href="#cb48-623" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total"</span>, </span>
<span id="cb48-624"><a href="#cb48-624" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-625"><a href="#cb48-625" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-626"><a href="#cb48-626" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-627"><a href="#cb48-627" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-628"><a href="#cb48-628" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-629"><a href="#cb48-629" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Financial Damage (VT)"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"ecce_financial_damage"</span>, <span class="st">"primary_financial_damage"</span>, <span class="st">"secondary_financial_damage"</span>, <span class="st">"total_financial_damage"</span>))</span>
<span id="cb48-630"><a href="#cb48-630" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-631"><a href="#cb48-631" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-632"><a href="#cb48-632" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-633"><a href="#cb48-633" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-634"><a href="#cb48-634" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-635"><a href="#cb48-635" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-636"><a href="#cb48-636" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-637"><a href="#cb48-637" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-638"><a href="#cb48-638" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-639"><a href="#cb48-639" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-640"><a href="#cb48-640" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-641"><a href="#cb48-641" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-642"><a href="#cb48-642" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-643"><a href="#cb48-643" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-644"><a href="#cb48-644" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-645"><a href="#cb48-645" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-646"><a href="#cb48-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-647"><a href="#cb48-647" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-648"><a href="#cb48-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-649"><a href="#cb48-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-650"><a href="#cb48-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-651"><a href="#cb48-651" aria-hidden="true" tabindex="-1"></a><span class="fu"># Emergency Telecommunications</span></span>
<span id="cb48-652"><a href="#cb48-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-653"><a href="#cb48-653" aria-hidden="true" tabindex="-1"></a><span class="fu">## Baseline: Number of Telecommunication Towers</span></span>
<span id="cb48-654"><a href="#cb48-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-657"><a href="#cb48-657" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-658"><a href="#cb48-658" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-659"><a href="#cb48-659" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Emergency Telecommunications in Baseline column and Area Council level data</span></span>
<span id="cb48-660"><a href="#cb48-660" aria-hidden="true" tabindex="-1"></a>telecom_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-661"><a href="#cb48-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Emergency Telecommunications"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-662"><a href="#cb48-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-663"><a href="#cb48-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-664"><a href="#cb48-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb48-665"><a href="#cb48-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-666"><a href="#cb48-666" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape the data to get Digicel and Vodafone as separate columns</span></span>
<span id="cb48-667"><a href="#cb48-667" aria-hidden="true" tabindex="-1"></a>telecom_wide <span class="ot">&lt;-</span> telecom_data <span class="sc">%&gt;%</span></span>
<span id="cb48-668"><a href="#cb48-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-669"><a href="#cb48-669" aria-hidden="true" tabindex="-1"></a>    <span class="at">provider =</span> <span class="fu">tolower</span>(Attribute)  <span class="co"># digicel or vodafone</span></span>
<span id="cb48-670"><a href="#cb48-670" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-671"><a href="#cb48-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(provider <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"digicel"</span>, <span class="st">"vodafone"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-672"><a href="#cb48-672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, provider, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-673"><a href="#cb48-673" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group and sum to handle duplicates (4 councils have duplicate entries)</span></span>
<span id="cb48-674"><a href="#cb48-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, provider) <span class="sc">%&gt;%</span></span>
<span id="cb48-675"><a href="#cb48-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-676"><a href="#cb48-676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-677"><a href="#cb48-677" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> provider,</span>
<span id="cb48-678"><a href="#cb48-678" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-679"><a href="#cb48-679" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"towers_"</span></span>
<span id="cb48-680"><a href="#cb48-680" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-681"><a href="#cb48-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-682"><a href="#cb48-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-683"><a href="#cb48-683" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-684"><a href="#cb48-684" aria-hidden="true" tabindex="-1"></a>telecom_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(telecom_wide)</span>
<span id="cb48-685"><a href="#cb48-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-686"><a href="#cb48-686" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-687"><a href="#cb48-687" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-688"><a href="#cb48-688" aria-hidden="true" tabindex="-1"></a>  telecom_aggregated <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb48-689"><a href="#cb48-689" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Telecom_01_baseline_towers.csv"</span>),</span>
<span id="cb48-690"><a href="#cb48-690" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-691"><a href="#cb48-691" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-692"><a href="#cb48-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-693"><a href="#cb48-693" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-694"><a href="#cb48-694" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-695"><a href="#cb48-695" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(telecom_aggregated)</span>
<span id="cb48-696"><a href="#cb48-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-697"><a href="#cb48-697" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the reactable</span></span>
<span id="cb48-698"><a href="#cb48-698" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-699"><a href="#cb48-699" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-700"><a href="#cb48-700" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-701"><a href="#cb48-701" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-702"><a href="#cb48-702" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-703"><a href="#cb48-703" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-704"><a href="#cb48-704" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-705"><a href="#cb48-705" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-706"><a href="#cb48-706" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-707"><a href="#cb48-707" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-708"><a href="#cb48-708" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-709"><a href="#cb48-709" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_digicel =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-710"><a href="#cb48-710" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Digicel"</span>, </span>
<span id="cb48-711"><a href="#cb48-711" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-712"><a href="#cb48-712" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-713"><a href="#cb48-713" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_vodafone =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-714"><a href="#cb48-714" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Vodafone"</span>, </span>
<span id="cb48-715"><a href="#cb48-715" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-716"><a href="#cb48-716" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-717"><a href="#cb48-717" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-718"><a href="#cb48-718" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-719"><a href="#cb48-719" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-720"><a href="#cb48-720" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Number of Towers"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"towers_digicel"</span>, <span class="st">"towers_vodafone"</span>))</span>
<span id="cb48-721"><a href="#cb48-721" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-722"><a href="#cb48-722" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-723"><a href="#cb48-723" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-724"><a href="#cb48-724" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-725"><a href="#cb48-725" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-726"><a href="#cb48-726" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-727"><a href="#cb48-727" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-728"><a href="#cb48-728" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-729"><a href="#cb48-729" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-730"><a href="#cb48-730" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-731"><a href="#cb48-731" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-732"><a href="#cb48-732" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-733"><a href="#cb48-733" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-734"><a href="#cb48-734" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-735"><a href="#cb48-735" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-736"><a href="#cb48-736" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-737"><a href="#cb48-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-738"><a href="#cb48-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-739"><a href="#cb48-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-740"><a href="#cb48-740" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimating Damage: Number of Damaged Towers</span></span>
<span id="cb48-741"><a href="#cb48-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-742"><a href="#cb48-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-745"><a href="#cb48-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-746"><a href="#cb48-746" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-747"><a href="#cb48-747" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to baseline values</span></span>
<span id="cb48-748"><a href="#cb48-748" aria-hidden="true" tabindex="-1"></a>telecom_with_config <span class="ot">&lt;-</span> telecom_wide <span class="sc">%&gt;%</span></span>
<span id="cb48-749"><a href="#cb48-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-750"><a href="#cb48-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-751"><a href="#cb48-751" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for damage multipliers (council and provider-specific)</span></span>
<span id="cb48-752"><a href="#cb48-752" aria-hidden="true" tabindex="-1"></a>get_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, provider, area_council) {</span>
<span id="cb48-753"><a href="#cb48-753" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb48-754"><a href="#cb48-754" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-755"><a href="#cb48-755" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb48-756"><a href="#cb48-756" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-757"><a href="#cb48-757" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Emergency Telecommunications"</span>,</span>
<span id="cb48-758"><a href="#cb48-758" aria-hidden="true" tabindex="-1"></a>      Attribute <span class="sc">==</span> provider,</span>
<span id="cb48-759"><a href="#cb48-759" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Number Towers"</span>, Indicator, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-760"><a href="#cb48-760" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-761"><a href="#cb48-761" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-762"><a href="#cb48-762" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-763"><a href="#cb48-763" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if we got any results</span></span>
<span id="cb48-764"><a href="#cb48-764" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb48-765"><a href="#cb48-765" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb48-766"><a href="#cb48-766" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-767"><a href="#cb48-767" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-768"><a href="#cb48-768" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the value from the intensity column</span></span>
<span id="cb48-769"><a href="#cb48-769" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb48-770"><a href="#cb48-770" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-771"><a href="#cb48-771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb48-772"><a href="#cb48-772" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-773"><a href="#cb48-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-774"><a href="#cb48-774" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates</span></span>
<span id="cb48-775"><a href="#cb48-775" aria-hidden="true" tabindex="-1"></a>damage_estimates <span class="ot">&lt;-</span> telecom_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-776"><a href="#cb48-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-777"><a href="#cb48-777" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-778"><a href="#cb48-778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-779"><a href="#cb48-779" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Digicel towers damaged</span></span>
<span id="cb48-780"><a href="#cb48-780" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_digicel_damaged =</span> towers_digicel <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"digicel"</span>, Region),</span>
<span id="cb48-781"><a href="#cb48-781" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-782"><a href="#cb48-782" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vodafone towers damaged</span></span>
<span id="cb48-783"><a href="#cb48-783" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_vodafone_damaged =</span> towers_vodafone <span class="sc">*</span> <span class="fu">get_damage_multiplier</span>(Intensity, <span class="st">"vodafone"</span>, Region),</span>
<span id="cb48-784"><a href="#cb48-784" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-785"><a href="#cb48-785" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total towers damaged</span></span>
<span id="cb48-786"><a href="#cb48-786" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_towers_damaged =</span> towers_digicel_damaged <span class="sc">+</span> towers_vodafone_damaged</span>
<span id="cb48-787"><a href="#cb48-787" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-788"><a href="#cb48-788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-789"><a href="#cb48-789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, towers_digicel_damaged, towers_vodafone_damaged, total_towers_damaged)</span>
<span id="cb48-790"><a href="#cb48-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-791"><a href="#cb48-791" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-792"><a href="#cb48-792" aria-hidden="true" tabindex="-1"></a>damage_estimates_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(damage_estimates)</span>
<span id="cb48-793"><a href="#cb48-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-794"><a href="#cb48-794" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-795"><a href="#cb48-795" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-796"><a href="#cb48-796" aria-hidden="true" tabindex="-1"></a>  damage_estimates_full <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb48-797"><a href="#cb48-797" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Telecom_02_damage_estimates.csv"</span>),</span>
<span id="cb48-798"><a href="#cb48-798" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-799"><a href="#cb48-799" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-800"><a href="#cb48-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-801"><a href="#cb48-801" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-802"><a href="#cb48-802" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-803"><a href="#cb48-803" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(damage_estimates_full)</span>
<span id="cb48-804"><a href="#cb48-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-805"><a href="#cb48-805" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb48-806"><a href="#cb48-806" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-807"><a href="#cb48-807" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-808"><a href="#cb48-808" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-809"><a href="#cb48-809" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-810"><a href="#cb48-810" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-811"><a href="#cb48-811" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-812"><a href="#cb48-812" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-813"><a href="#cb48-813" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-814"><a href="#cb48-814" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-815"><a href="#cb48-815" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_digicel_damaged =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-816"><a href="#cb48-816" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Digicel"</span>, </span>
<span id="cb48-817"><a href="#cb48-817" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span>
<span id="cb48-818"><a href="#cb48-818" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-819"><a href="#cb48-819" aria-hidden="true" tabindex="-1"></a>    <span class="at">towers_vodafone_damaged =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-820"><a href="#cb48-820" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Vodafone"</span>, </span>
<span id="cb48-821"><a href="#cb48-821" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span>
<span id="cb48-822"><a href="#cb48-822" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-823"><a href="#cb48-823" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_towers_damaged =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-824"><a href="#cb48-824" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total"</span>, </span>
<span id="cb48-825"><a href="#cb48-825" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">1</span>)</span>
<span id="cb48-826"><a href="#cb48-826" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-827"><a href="#cb48-827" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-828"><a href="#cb48-828" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-829"><a href="#cb48-829" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-830"><a href="#cb48-830" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Damaged Towers"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"towers_digicel_damaged"</span>, <span class="st">"towers_vodafone_damaged"</span>, <span class="st">"total_towers_damaged"</span>))</span>
<span id="cb48-831"><a href="#cb48-831" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-832"><a href="#cb48-832" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-833"><a href="#cb48-833" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-834"><a href="#cb48-834" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-835"><a href="#cb48-835" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-836"><a href="#cb48-836" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-837"><a href="#cb48-837" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-838"><a href="#cb48-838" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-839"><a href="#cb48-839" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-840"><a href="#cb48-840" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-841"><a href="#cb48-841" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-842"><a href="#cb48-842" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-843"><a href="#cb48-843" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-844"><a href="#cb48-844" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-845"><a href="#cb48-845" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-846"><a href="#cb48-846" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-847"><a href="#cb48-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-848"><a href="#cb48-848" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-849"><a href="#cb48-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-850"><a href="#cb48-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-851"><a href="#cb48-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-852"><a href="#cb48-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-853"><a href="#cb48-853" aria-hidden="true" tabindex="-1"></a><span class="fu"># Energy </span></span>
<span id="cb48-854"><a href="#cb48-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-855"><a href="#cb48-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-856"><a href="#cb48-856" aria-hidden="true" tabindex="-1"></a><span class="fu">## Baseline: Household Energy Access and Usage</span></span>
<span id="cb48-857"><a href="#cb48-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-858"><a href="#cb48-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-859"><a href="#cb48-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-862"><a href="#cb48-862" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-863"><a href="#cb48-863" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-864"><a href="#cb48-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-865"><a href="#cb48-865" aria-hidden="true" tabindex="-1"></a><span class="co"># Get total households from Shelter baseline</span></span>
<span id="cb48-866"><a href="#cb48-866" aria-hidden="true" tabindex="-1"></a>total_households <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-867"><a href="#cb48-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-868"><a href="#cb48-868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-869"><a href="#cb48-869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-870"><a href="#cb48-870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"number households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-871"><a href="#cb48-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-872"><a href="#cb48-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-873"><a href="#cb48-873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">total_households =</span> Value)</span>
<span id="cb48-874"><a href="#cb48-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-875"><a href="#cb48-875" aria-hidden="true" tabindex="-1"></a><span class="co"># Get household electricity data</span></span>
<span id="cb48-876"><a href="#cb48-876" aria-hidden="true" tabindex="-1"></a>electricity_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-877"><a href="#cb48-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Energy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-878"><a href="#cb48-878" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-879"><a href="#cb48-879" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-880"><a href="#cb48-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Electricity"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-881"><a href="#cb48-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-882"><a href="#cb48-882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-883"><a href="#cb48-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-884"><a href="#cb48-884" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape electricity data</span></span>
<span id="cb48-885"><a href="#cb48-885" aria-hidden="true" tabindex="-1"></a>electricity_wide <span class="ot">&lt;-</span> electricity_data <span class="sc">%&gt;%</span></span>
<span id="cb48-886"><a href="#cb48-886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">attribute_clean =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-887"><a href="#cb48-887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, attribute_clean) <span class="sc">%&gt;%</span></span>
<span id="cb48-888"><a href="#cb48-888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-889"><a href="#cb48-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-890"><a href="#cb48-890" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> attribute_clean,</span>
<span id="cb48-891"><a href="#cb48-891" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-892"><a href="#cb48-892" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"elec_"</span></span>
<span id="cb48-893"><a href="#cb48-893" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-894"><a href="#cb48-894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-895"><a href="#cb48-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-896"><a href="#cb48-896" aria-hidden="true" tabindex="-1"></a><span class="co"># Get household cooking fuel data</span></span>
<span id="cb48-897"><a href="#cb48-897" aria-hidden="true" tabindex="-1"></a>cooking_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-898"><a href="#cb48-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Energy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-899"><a href="#cb48-899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-900"><a href="#cb48-900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-901"><a href="#cb48-901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Cooking Fuel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-902"><a href="#cb48-902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-903"><a href="#cb48-903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-904"><a href="#cb48-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-905"><a href="#cb48-905" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape cooking data</span></span>
<span id="cb48-906"><a href="#cb48-906" aria-hidden="true" tabindex="-1"></a>cooking_wide <span class="ot">&lt;-</span> cooking_data <span class="sc">%&gt;%</span></span>
<span id="cb48-907"><a href="#cb48-907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">attribute_clean =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-908"><a href="#cb48-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, attribute_clean) <span class="sc">%&gt;%</span></span>
<span id="cb48-909"><a href="#cb48-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-910"><a href="#cb48-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-911"><a href="#cb48-911" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> attribute_clean,</span>
<span id="cb48-912"><a href="#cb48-912" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-913"><a href="#cb48-913" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"cook_"</span></span>
<span id="cb48-914"><a href="#cb48-914" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-915"><a href="#cb48-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-916"><a href="#cb48-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-917"><a href="#cb48-917" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all energy data</span></span>
<span id="cb48-918"><a href="#cb48-918" aria-hidden="true" tabindex="-1"></a>energy_wide <span class="ot">&lt;-</span> total_households <span class="sc">%&gt;%</span></span>
<span id="cb48-919"><a href="#cb48-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(electricity_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-920"><a href="#cb48-920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cooking_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-921"><a href="#cb48-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-922"><a href="#cb48-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-923"><a href="#cb48-923" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-924"><a href="#cb48-924" aria-hidden="true" tabindex="-1"></a>energy_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(energy_wide)</span>
<span id="cb48-925"><a href="#cb48-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-926"><a href="#cb48-926" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-927"><a href="#cb48-927" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns to match client's specification before export</span></span>
<span id="cb48-928"><a href="#cb48-928" aria-hidden="true" tabindex="-1"></a>energy_aggregated_ordered <span class="ot">&lt;-</span> energy_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-929"><a href="#cb48-929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-930"><a href="#cb48-930" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-931"><a href="#cb48-931" aria-hidden="true" tabindex="-1"></a>    total_households,</span>
<span id="cb48-932"><a href="#cb48-932" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Electricity in client's order</span></span>
<span id="cb48-933"><a href="#cb48-933" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp</span><span class="st">`</span>,</span>
<span id="cb48-934"><a href="#cb48-934" aria-hidden="true" tabindex="-1"></a>    elec_generator,</span>
<span id="cb48-935"><a href="#cb48-935" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid</span><span class="st">`</span>,</span>
<span id="cb48-936"><a href="#cb48-936" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access</span><span class="st">`</span>,</span>
<span id="cb48-937"><a href="#cb48-937" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system</span><span class="st">`</span>,</span>
<span id="cb48-938"><a href="#cb48-938" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Cooking in client's order</span></span>
<span id="cb48-939"><a href="#cb48-939" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas</span><span class="st">`</span>,</span>
<span id="cb48-940"><a href="#cb48-940" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire</span><span class="st">`</span>,</span>
<span id="cb48-941"><a href="#cb48-941" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power</span><span class="st">`</span>,</span>
<span id="cb48-942"><a href="#cb48-942" aria-hidden="true" tabindex="-1"></a>    cook_electricity,</span>
<span id="cb48-943"><a href="#cb48-943" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove</span><span class="st">`</span></span>
<span id="cb48-944"><a href="#cb48-944" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-945"><a href="#cb48-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-946"><a href="#cb48-946" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-947"><a href="#cb48-947" aria-hidden="true" tabindex="-1"></a>  energy_aggregated_ordered,</span>
<span id="cb48-948"><a href="#cb48-948" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Energy_01_baseline.csv"</span>),</span>
<span id="cb48-949"><a href="#cb48-949" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-950"><a href="#cb48-950" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-951"><a href="#cb48-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-952"><a href="#cb48-952" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-953"><a href="#cb48-953" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-954"><a href="#cb48-954" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(energy_aggregated)</span>
<span id="cb48-955"><a href="#cb48-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-956"><a href="#cb48-956" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns to match client's specification</span></span>
<span id="cb48-957"><a href="#cb48-957" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> formatted <span class="sc">%&gt;%</span></span>
<span id="cb48-958"><a href="#cb48-958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-959"><a href="#cb48-959" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-960"><a href="#cb48-960" aria-hidden="true" tabindex="-1"></a>    total_households,</span>
<span id="cb48-961"><a href="#cb48-961" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Electricity in client's order</span></span>
<span id="cb48-962"><a href="#cb48-962" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp</span><span class="st">`</span>,</span>
<span id="cb48-963"><a href="#cb48-963" aria-hidden="true" tabindex="-1"></a>    elec_generator,</span>
<span id="cb48-964"><a href="#cb48-964" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid</span><span class="st">`</span>,</span>
<span id="cb48-965"><a href="#cb48-965" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access</span><span class="st">`</span>,</span>
<span id="cb48-966"><a href="#cb48-966" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system</span><span class="st">`</span>,</span>
<span id="cb48-967"><a href="#cb48-967" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Cooking in client's order</span></span>
<span id="cb48-968"><a href="#cb48-968" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas</span><span class="st">`</span>,</span>
<span id="cb48-969"><a href="#cb48-969" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire</span><span class="st">`</span>,</span>
<span id="cb48-970"><a href="#cb48-970" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power</span><span class="st">`</span>,</span>
<span id="cb48-971"><a href="#cb48-971" aria-hidden="true" tabindex="-1"></a>    cook_electricity,</span>
<span id="cb48-972"><a href="#cb48-972" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove</span><span class="st">`</span></span>
<span id="cb48-973"><a href="#cb48-973" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-974"><a href="#cb48-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-975"><a href="#cb48-975" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the reactable with client's specified column order</span></span>
<span id="cb48-976"><a href="#cb48-976" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-977"><a href="#cb48-977" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-978"><a href="#cb48-978" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-979"><a href="#cb48-979" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-980"><a href="#cb48-980" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-981"><a href="#cb48-981" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-982"><a href="#cb48-982" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-983"><a href="#cb48-983" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-984"><a href="#cb48-984" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-985"><a href="#cb48-985" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-986"><a href="#cb48-986" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-987"><a href="#cb48-987" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total Households</span></span>
<span id="cb48-988"><a href="#cb48-988" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-989"><a href="#cb48-989" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-990"><a href="#cb48-990" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Electricity columns (in client's order)</span></span>
<span id="cb48-991"><a href="#cb48-991" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Battery Lamp"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-992"><a href="#cb48-992" aria-hidden="true" tabindex="-1"></a>    <span class="at">elec_generator =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Generator"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-993"><a href="#cb48-993" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Main Grid"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-994"><a href="#cb48-994" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"No Access"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-995"><a href="#cb48-995" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar System"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-996"><a href="#cb48-996" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-997"><a href="#cb48-997" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Cooking columns (in client's order)</span></span>
<span id="cb48-998"><a href="#cb48-998" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Bottle Gas"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-999"><a href="#cb48-999" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Open Fire"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1000"><a href="#cb48-1000" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Power"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1001"><a href="#cb48-1001" aria-hidden="true" tabindex="-1"></a>    <span class="at">cook_electricity =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Electricity"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1002"><a href="#cb48-1002" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood Stove"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-1003"><a href="#cb48-1003" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1004"><a href="#cb48-1004" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-1005"><a href="#cb48-1005" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households"</span>)),</span>
<span id="cb48-1006"><a href="#cb48-1006" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Electricity"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"elec_battery lamp"</span>, <span class="st">"elec_generator"</span>, <span class="st">"elec_main grid"</span>, <span class="st">"elec_no access"</span>, <span class="st">"elec_solar system"</span>)),</span>
<span id="cb48-1007"><a href="#cb48-1007" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Cooking"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"cook_bottle gas"</span>, <span class="st">"cook_open fire"</span>, <span class="st">"cook_solar power"</span>, <span class="st">"cook_electricity"</span>, <span class="st">"cook_wood stove"</span>))</span>
<span id="cb48-1008"><a href="#cb48-1008" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1009"><a href="#cb48-1009" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1010"><a href="#cb48-1010" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1011"><a href="#cb48-1011" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1012"><a href="#cb48-1012" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-1013"><a href="#cb48-1013" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-1014"><a href="#cb48-1014" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-1015"><a href="#cb48-1015" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1016"><a href="#cb48-1016" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-1017"><a href="#cb48-1017" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-1018"><a href="#cb48-1018" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1019"><a href="#cb48-1019" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-1020"><a href="#cb48-1020" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1021"><a href="#cb48-1021" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-1022"><a href="#cb48-1022" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1023"><a href="#cb48-1023" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1024"><a href="#cb48-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1025"><a href="#cb48-1025" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-1026"><a href="#cb48-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1027"><a href="#cb48-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1028"><a href="#cb48-1028" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimating damage: Households affected by electricity disruption</span></span>
<span id="cb48-1029"><a href="#cb48-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1030"><a href="#cb48-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1033"><a href="#cb48-1033" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-1034"><a href="#cb48-1034" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-1035"><a href="#cb48-1035" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to baseline values</span></span>
<span id="cb48-1036"><a href="#cb48-1036" aria-hidden="true" tabindex="-1"></a>energy_with_config <span class="ot">&lt;-</span> energy_wide <span class="sc">%&gt;%</span></span>
<span id="cb48-1037"><a href="#cb48-1037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-1038"><a href="#cb48-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1039"><a href="#cb48-1039" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for damage multipliers (council-specific, for both electricity and cooking)</span></span>
<span id="cb48-1040"><a href="#cb48-1040" aria-hidden="true" tabindex="-1"></a>get_energy_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, indicator_type, attribute_type, area_council) {</span>
<span id="cb48-1041"><a href="#cb48-1041" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb48-1042"><a href="#cb48-1042" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1043"><a href="#cb48-1043" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb48-1044"><a href="#cb48-1044" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-1045"><a href="#cb48-1045" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Energy"</span>,</span>
<span id="cb48-1046"><a href="#cb48-1046" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator_type,</span>
<span id="cb48-1047"><a href="#cb48-1047" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute_type)),</span>
<span id="cb48-1048"><a href="#cb48-1048" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-1049"><a href="#cb48-1049" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-1050"><a href="#cb48-1050" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1051"><a href="#cb48-1051" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if we got any results</span></span>
<span id="cb48-1052"><a href="#cb48-1052" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb48-1053"><a href="#cb48-1053" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb48-1054"><a href="#cb48-1054" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-1055"><a href="#cb48-1055" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1056"><a href="#cb48-1056" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the value from the intensity column</span></span>
<span id="cb48-1057"><a href="#cb48-1057" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb48-1058"><a href="#cb48-1058" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1059"><a href="#cb48-1059" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb48-1060"><a href="#cb48-1060" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-1061"><a href="#cb48-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1062"><a href="#cb48-1062" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates</span></span>
<span id="cb48-1063"><a href="#cb48-1063" aria-hidden="true" tabindex="-1"></a>damage_estimates <span class="ot">&lt;-</span> energy_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-1064"><a href="#cb48-1064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1065"><a href="#cb48-1065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-1066"><a href="#cb48-1066" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-1067"><a href="#cb48-1067" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total households affected (same as baseline - no damage applied)</span></span>
<span id="cb48-1068"><a href="#cb48-1068" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> total_households,</span>
<span id="cb48-1069"><a href="#cb48-1069" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1070"><a href="#cb48-1070" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Damaged households for each electricity type</span></span>
<span id="cb48-1071"><a href="#cb48-1071" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">elec_battery lamp</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Electricity"</span>, <span class="st">"battery lamp"</span>, Region),</span>
<span id="cb48-1072"><a href="#cb48-1072" aria-hidden="true" tabindex="-1"></a>    <span class="at">elec_generator_damaged =</span> elec_generator <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Electricity"</span>, <span class="st">"generator"</span>, Region),</span>
<span id="cb48-1073"><a href="#cb48-1073" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">elec_main grid</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Electricity"</span>, <span class="st">"main grid"</span>, Region),</span>
<span id="cb48-1074"><a href="#cb48-1074" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">elec_no access</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Electricity"</span>, <span class="st">"no access"</span>, Region),</span>
<span id="cb48-1075"><a href="#cb48-1075" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">elec_solar system</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Electricity"</span>, <span class="st">"solar system"</span>, Region),</span>
<span id="cb48-1076"><a href="#cb48-1076" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1077"><a href="#cb48-1077" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Damaged households for each cooking fuel type</span></span>
<span id="cb48-1078"><a href="#cb48-1078" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">cook_bottle gas</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Cooking Fuel"</span>, <span class="st">"bottle gas"</span>, Region),</span>
<span id="cb48-1079"><a href="#cb48-1079" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">cook_open fire</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Cooking Fuel"</span>, <span class="st">"open fire"</span>, Region),</span>
<span id="cb48-1080"><a href="#cb48-1080" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">cook_solar power</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Cooking Fuel"</span>, <span class="st">"solar power"</span>, Region),</span>
<span id="cb48-1081"><a href="#cb48-1081" aria-hidden="true" tabindex="-1"></a>    <span class="at">cook_electricity_damaged =</span> cook_electricity <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Cooking Fuel"</span>, <span class="st">"electricity"</span>, Region),</span>
<span id="cb48-1082"><a href="#cb48-1082" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">cook_wood stove</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_energy_damage_multiplier</span>(Intensity, <span class="st">"Household Cooking Fuel"</span>, <span class="st">"wood stove"</span>, Region)</span>
<span id="cb48-1083"><a href="#cb48-1083" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1084"><a href="#cb48-1084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-1085"><a href="#cb48-1085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_households_affected, <span class="fu">contains</span>(<span class="st">"_damaged"</span>))</span>
<span id="cb48-1086"><a href="#cb48-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1087"><a href="#cb48-1087" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-1088"><a href="#cb48-1088" aria-hidden="true" tabindex="-1"></a>damage_estimates_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(damage_estimates)</span>
<span id="cb48-1089"><a href="#cb48-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1090"><a href="#cb48-1090" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-1091"><a href="#cb48-1091" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns to match client's specification before export</span></span>
<span id="cb48-1092"><a href="#cb48-1092" aria-hidden="true" tabindex="-1"></a>damage_estimates_ordered <span class="ot">&lt;-</span> damage_estimates_full <span class="sc">%&gt;%</span></span>
<span id="cb48-1093"><a href="#cb48-1093" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-1094"><a href="#cb48-1094" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-1095"><a href="#cb48-1095" aria-hidden="true" tabindex="-1"></a>    total_households_affected,</span>
<span id="cb48-1096"><a href="#cb48-1096" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Electricity in client's order</span></span>
<span id="cb48-1097"><a href="#cb48-1097" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp_damaged</span><span class="st">`</span>,</span>
<span id="cb48-1098"><a href="#cb48-1098" aria-hidden="true" tabindex="-1"></a>    elec_generator_damaged,</span>
<span id="cb48-1099"><a href="#cb48-1099" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid_damaged</span><span class="st">`</span>,</span>
<span id="cb48-1100"><a href="#cb48-1100" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access_damaged</span><span class="st">`</span>,</span>
<span id="cb48-1101"><a href="#cb48-1101" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system_damaged</span><span class="st">`</span>,</span>
<span id="cb48-1102"><a href="#cb48-1102" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Cooking in client's order</span></span>
<span id="cb48-1103"><a href="#cb48-1103" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas_damaged</span><span class="st">`</span>,</span>
<span id="cb48-1104"><a href="#cb48-1104" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire_damaged</span><span class="st">`</span>,</span>
<span id="cb48-1105"><a href="#cb48-1105" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power_damaged</span><span class="st">`</span>,</span>
<span id="cb48-1106"><a href="#cb48-1106" aria-hidden="true" tabindex="-1"></a>    cook_electricity_damaged,</span>
<span id="cb48-1107"><a href="#cb48-1107" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove_damaged</span><span class="st">`</span></span>
<span id="cb48-1108"><a href="#cb48-1108" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-1109"><a href="#cb48-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1110"><a href="#cb48-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-1111"><a href="#cb48-1111" aria-hidden="true" tabindex="-1"></a>  damage_estimates_ordered,</span>
<span id="cb48-1112"><a href="#cb48-1112" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Energy_02_damage_estimates.csv"</span>),</span>
<span id="cb48-1113"><a href="#cb48-1113" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-1114"><a href="#cb48-1114" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1115"><a href="#cb48-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1116"><a href="#cb48-1116" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-1117"><a href="#cb48-1117" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-1118"><a href="#cb48-1118" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(damage_estimates_ordered)</span>
<span id="cb48-1119"><a href="#cb48-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1120"><a href="#cb48-1120" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb48-1121"><a href="#cb48-1121" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-1122"><a href="#cb48-1122" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-1123"><a href="#cb48-1123" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-1124"><a href="#cb48-1124" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1125"><a href="#cb48-1125" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-1126"><a href="#cb48-1126" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-1127"><a href="#cb48-1127" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-1128"><a href="#cb48-1128" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1129"><a href="#cb48-1129" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1130"><a href="#cb48-1130" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total Households</span></span>
<span id="cb48-1131"><a href="#cb48-1131" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1132"><a href="#cb48-1132" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1133"><a href="#cb48-1133" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Electricity columns (in client's order)</span></span>
<span id="cb48-1134"><a href="#cb48-1134" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_battery lamp_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Battery Lamp"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1135"><a href="#cb48-1135" aria-hidden="true" tabindex="-1"></a>    <span class="at">elec_generator_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Generator"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1136"><a href="#cb48-1136" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_main grid_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Main Grid"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1137"><a href="#cb48-1137" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_no access_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"No Access"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1138"><a href="#cb48-1138" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">elec_solar system_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar System"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1139"><a href="#cb48-1139" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1140"><a href="#cb48-1140" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Household Cooking columns (in client's order)</span></span>
<span id="cb48-1141"><a href="#cb48-1141" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_bottle gas_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Bottle Gas"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1142"><a href="#cb48-1142" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_open fire_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Open Fire"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1143"><a href="#cb48-1143" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_solar power_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Power"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1144"><a href="#cb48-1144" aria-hidden="true" tabindex="-1"></a>    <span class="at">cook_electricity_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Electricity"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1145"><a href="#cb48-1145" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">cook_wood stove_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood Stove"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-1146"><a href="#cb48-1146" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1147"><a href="#cb48-1147" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-1148"><a href="#cb48-1148" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households_affected"</span>)),</span>
<span id="cb48-1149"><a href="#cb48-1149" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Electricity Affected"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"elec_battery lamp_damaged"</span>, <span class="st">"elec_generator_damaged"</span>, <span class="st">"elec_main grid_damaged"</span>, <span class="st">"elec_no access_damaged"</span>, <span class="st">"elec_solar system_damaged"</span>)),</span>
<span id="cb48-1150"><a href="#cb48-1150" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Cooking Affected"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"cook_bottle gas_damaged"</span>, <span class="st">"cook_open fire_damaged"</span>, <span class="st">"cook_solar power_damaged"</span>, <span class="st">"cook_electricity_damaged"</span>, <span class="st">"cook_wood stove_damaged"</span>))</span>
<span id="cb48-1151"><a href="#cb48-1151" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1152"><a href="#cb48-1152" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1153"><a href="#cb48-1153" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1154"><a href="#cb48-1154" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1155"><a href="#cb48-1155" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-1156"><a href="#cb48-1156" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-1157"><a href="#cb48-1157" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-1158"><a href="#cb48-1158" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1159"><a href="#cb48-1159" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-1160"><a href="#cb48-1160" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-1161"><a href="#cb48-1161" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1162"><a href="#cb48-1162" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-1163"><a href="#cb48-1163" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1164"><a href="#cb48-1164" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-1165"><a href="#cb48-1165" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1166"><a href="#cb48-1166" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1167"><a href="#cb48-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-1168"><a href="#cb48-1168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1169"><a href="#cb48-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1170"><a href="#cb48-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1171"><a href="#cb48-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Immediate Response Resources </span></span>
<span id="cb48-1172"><a href="#cb48-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1173"><a href="#cb48-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1176"><a href="#cb48-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-1177"><a href="#cb48-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-1178"><a href="#cb48-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1179"><a href="#cb48-1179" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we need to get infrastructure baseline data and calculate damage</span></span>
<span id="cb48-1180"><a href="#cb48-1180" aria-hidden="true" tabindex="-1"></a>energy_infra_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-1181"><a href="#cb48-1181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Energy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1182"><a href="#cb48-1182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1183"><a href="#cb48-1183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1184"><a href="#cb48-1184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Energy Infrastructure"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1185"><a href="#cb48-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1186"><a href="#cb48-1186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-1187"><a href="#cb48-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1188"><a href="#cb48-1188" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape infrastructure data</span></span>
<span id="cb48-1189"><a href="#cb48-1189" aria-hidden="true" tabindex="-1"></a>energy_infra_wide <span class="ot">&lt;-</span> energy_infra_data <span class="sc">%&gt;%</span></span>
<span id="cb48-1190"><a href="#cb48-1190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">attribute_clean =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-1191"><a href="#cb48-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, attribute_clean) <span class="sc">%&gt;%</span></span>
<span id="cb48-1192"><a href="#cb48-1192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1193"><a href="#cb48-1193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-1194"><a href="#cb48-1194" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> attribute_clean,</span>
<span id="cb48-1195"><a href="#cb48-1195" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-1196"><a href="#cb48-1196" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"infra_"</span></span>
<span id="cb48-1197"><a href="#cb48-1197" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1198"><a href="#cb48-1198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-1199"><a href="#cb48-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1200"><a href="#cb48-1200" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone config to infrastructure data</span></span>
<span id="cb48-1201"><a href="#cb48-1201" aria-hidden="true" tabindex="-1"></a>energy_infra_with_config <span class="ot">&lt;-</span> energy_infra_wide <span class="sc">%&gt;%</span></span>
<span id="cb48-1202"><a href="#cb48-1202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-1203"><a href="#cb48-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1204"><a href="#cb48-1204" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for infrastructure damage multipliers</span></span>
<span id="cb48-1205"><a href="#cb48-1205" aria-hidden="true" tabindex="-1"></a>get_infra_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, attribute_type, area_council) {</span>
<span id="cb48-1206"><a href="#cb48-1206" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb48-1207"><a href="#cb48-1207" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1208"><a href="#cb48-1208" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb48-1209"><a href="#cb48-1209" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-1210"><a href="#cb48-1210" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Energy"</span>,</span>
<span id="cb48-1211"><a href="#cb48-1211" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Energy Infrastructure"</span>,</span>
<span id="cb48-1212"><a href="#cb48-1212" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute_type)),</span>
<span id="cb48-1213"><a href="#cb48-1213" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-1214"><a href="#cb48-1214" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-1215"><a href="#cb48-1215" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1216"><a href="#cb48-1216" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb48-1217"><a href="#cb48-1217" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb48-1218"><a href="#cb48-1218" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-1219"><a href="#cb48-1219" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1220"><a href="#cb48-1220" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb48-1221"><a href="#cb48-1221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb48-1222"><a href="#cb48-1222" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-1223"><a href="#cb48-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1224"><a href="#cb48-1224" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damaged infrastructure</span></span>
<span id="cb48-1225"><a href="#cb48-1225" aria-hidden="true" tabindex="-1"></a>infra_damage <span class="ot">&lt;-</span> energy_infra_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-1226"><a href="#cb48-1226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1227"><a href="#cb48-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-1228"><a href="#cb48-1228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-1229"><a href="#cb48-1229" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate damaged poles</span></span>
<span id="cb48-1230"><a href="#cb48-1230" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_low voltage poles_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_low voltage poles</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"low voltage poles"</span>, Region),</span>
<span id="cb48-1231"><a href="#cb48-1231" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_high voltage poles_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_high voltage poles</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"high voltage poles"</span>, Region),</span>
<span id="cb48-1232"><a href="#cb48-1232" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1233"><a href="#cb48-1233" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total damaged poles for power line cable calculation</span></span>
<span id="cb48-1234"><a href="#cb48-1234" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_poles_damaged =</span> <span class="st">`</span><span class="at">infra_low voltage poles_damaged</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">infra_high voltage poles_damaged</span><span class="st">`</span></span>
<span id="cb48-1235"><a href="#cb48-1235" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1236"><a href="#cb48-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-1237"><a href="#cb48-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">contains</span>(<span class="st">"_damaged"</span>), total_poles_damaged)</span>
<span id="cb48-1238"><a href="#cb48-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1239"><a href="#cb48-1239" aria-hidden="true" tabindex="-1"></a><span class="co"># Now calculate resources needed</span></span>
<span id="cb48-1240"><a href="#cb48-1240" aria-hidden="true" tabindex="-1"></a><span class="co"># Join household damage data with infrastructure damage data</span></span>
<span id="cb48-1241"><a href="#cb48-1241" aria-hidden="true" tabindex="-1"></a>resources_base <span class="ot">&lt;-</span> damage_estimates <span class="sc">%&gt;%</span></span>
<span id="cb48-1242"><a href="#cb48-1242" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(infra_damage, <span class="at">by =</span> <span class="st">"Region"</span>)</span>
<span id="cb48-1243"><a href="#cb48-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1244"><a href="#cb48-1244" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total electricity households affected</span></span>
<span id="cb48-1245"><a href="#cb48-1245" aria-hidden="true" tabindex="-1"></a>resources_needed <span class="ot">&lt;-</span> resources_base <span class="sc">%&gt;%</span></span>
<span id="cb48-1246"><a href="#cb48-1246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-1247"><a href="#cb48-1247" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total households with electricity affected (for solar lamps)</span></span>
<span id="cb48-1248"><a href="#cb48-1248" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_elec_affected =</span> <span class="st">`</span><span class="at">elec_battery lamp_damaged</span><span class="st">`</span> <span class="sc">+</span> elec_generator_damaged <span class="sc">+</span> </span>
<span id="cb48-1249"><a href="#cb48-1249" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">elec_main grid_damaged</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">elec_no access_damaged</span><span class="st">`</span> <span class="sc">+</span> </span>
<span id="cb48-1250"><a href="#cb48-1250" aria-hidden="true" tabindex="-1"></a>                          <span class="st">`</span><span class="at">elec_solar system_damaged</span><span class="st">`</span>,</span>
<span id="cb48-1251"><a href="#cb48-1251" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1252"><a href="#cb48-1252" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Resource calculations based on specifications</span></span>
<span id="cb48-1253"><a href="#cb48-1253" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_lamp =</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">*</span> total_elec_affected, <span class="dv">0</span>),</span>
<span id="cb48-1254"><a href="#cb48-1254" aria-hidden="true" tabindex="-1"></a>    <span class="at">low_voltage_poles_support =</span> <span class="fu">round</span>(<span class="fl">0.2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">infra_low voltage poles_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb48-1255"><a href="#cb48-1255" aria-hidden="true" tabindex="-1"></a>    <span class="at">high_voltage_pole_support =</span> <span class="fu">round</span>(<span class="fl">0.2</span> <span class="sc">*</span> <span class="st">`</span><span class="at">infra_high voltage poles_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb48-1256"><a href="#cb48-1256" aria-hidden="true" tabindex="-1"></a>    <span class="at">power_line_cable =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> total_poles_damaged, <span class="dv">0</span>)</span>
<span id="cb48-1257"><a href="#cb48-1257" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1258"><a href="#cb48-1258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, solar_lamp, low_voltage_poles_support, high_voltage_pole_support, power_line_cable)</span>
<span id="cb48-1259"><a href="#cb48-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1260"><a href="#cb48-1260" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-1261"><a href="#cb48-1261" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(resources_needed)</span>
<span id="cb48-1262"><a href="#cb48-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1263"><a href="#cb48-1263" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-1264"><a href="#cb48-1264" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-1265"><a href="#cb48-1265" aria-hidden="true" tabindex="-1"></a>  resources_needed_full,</span>
<span id="cb48-1266"><a href="#cb48-1266" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Energy_03_resources_needed.csv"</span>),</span>
<span id="cb48-1267"><a href="#cb48-1267" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-1268"><a href="#cb48-1268" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1269"><a href="#cb48-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1270"><a href="#cb48-1270" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-1271"><a href="#cb48-1271" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-1272"><a href="#cb48-1272" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb48-1273"><a href="#cb48-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1274"><a href="#cb48-1274" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the resources needed reactable</span></span>
<span id="cb48-1275"><a href="#cb48-1275" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-1276"><a href="#cb48-1276" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-1277"><a href="#cb48-1277" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-1278"><a href="#cb48-1278" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1279"><a href="#cb48-1279" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-1280"><a href="#cb48-1280" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-1281"><a href="#cb48-1281" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-1282"><a href="#cb48-1282" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1283"><a href="#cb48-1283" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1284"><a href="#cb48-1284" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_lamp =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1285"><a href="#cb48-1285" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Solar Lamp"</span>, </span>
<span id="cb48-1286"><a href="#cb48-1286" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-1287"><a href="#cb48-1287" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1288"><a href="#cb48-1288" aria-hidden="true" tabindex="-1"></a>    <span class="at">low_voltage_poles_support =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1289"><a href="#cb48-1289" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Low Voltage Poles Support"</span>, </span>
<span id="cb48-1290"><a href="#cb48-1290" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-1291"><a href="#cb48-1291" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1292"><a href="#cb48-1292" aria-hidden="true" tabindex="-1"></a>    <span class="at">high_voltage_pole_support =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1293"><a href="#cb48-1293" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"High Voltage Pole Support"</span>, </span>
<span id="cb48-1294"><a href="#cb48-1294" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-1295"><a href="#cb48-1295" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1296"><a href="#cb48-1296" aria-hidden="true" tabindex="-1"></a>    <span class="at">power_line_cable =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1297"><a href="#cb48-1297" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Power Line Cable (metres)"</span>, </span>
<span id="cb48-1298"><a href="#cb48-1298" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-1299"><a href="#cb48-1299" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-1300"><a href="#cb48-1300" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1301"><a href="#cb48-1301" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-1302"><a href="#cb48-1302" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-1303"><a href="#cb48-1303" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Electricity"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"solar_lamp"</span>)),</span>
<span id="cb48-1304"><a href="#cb48-1304" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Non-renewable"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"low_voltage_poles_support"</span>, <span class="st">"high_voltage_pole_support"</span>, <span class="st">"power_line_cable"</span>))</span>
<span id="cb48-1305"><a href="#cb48-1305" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1306"><a href="#cb48-1306" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1307"><a href="#cb48-1307" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1308"><a href="#cb48-1308" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1309"><a href="#cb48-1309" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-1310"><a href="#cb48-1310" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-1311"><a href="#cb48-1311" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-1312"><a href="#cb48-1312" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1313"><a href="#cb48-1313" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-1314"><a href="#cb48-1314" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-1315"><a href="#cb48-1315" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1316"><a href="#cb48-1316" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-1317"><a href="#cb48-1317" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1318"><a href="#cb48-1318" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-1319"><a href="#cb48-1319" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1320"><a href="#cb48-1320" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1321"><a href="#cb48-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1322"><a href="#cb48-1322" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-1323"><a href="#cb48-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1324"><a href="#cb48-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1325"><a href="#cb48-1325" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimated Financial Damage</span></span>
<span id="cb48-1326"><a href="#cb48-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1327"><a href="#cb48-1327" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 1: Household Electricity Financial Damage</span></span>
<span id="cb48-1328"><a href="#cb48-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1331"><a href="#cb48-1331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-1332"><a href="#cb48-1332" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for household electricity</span></span>
<span id="cb48-1333"><a href="#cb48-1333" aria-hidden="true" tabindex="-1"></a>get_household_elec_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(electricity_type, area_council) {</span>
<span id="cb48-1334"><a href="#cb48-1334" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb48-1335"><a href="#cb48-1335" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-1336"><a href="#cb48-1336" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Energy"</span>,</span>
<span id="cb48-1337"><a href="#cb48-1337" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Household Electricity"</span>,</span>
<span id="cb48-1338"><a href="#cb48-1338" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(electricity_type)),</span>
<span id="cb48-1339"><a href="#cb48-1339" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-1340"><a href="#cb48-1340" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1341"><a href="#cb48-1341" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-1342"><a href="#cb48-1342" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1343"><a href="#cb48-1343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb48-1344"><a href="#cb48-1344" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-1345"><a href="#cb48-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1346"><a href="#cb48-1346" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories from config file</span></span>
<span id="cb48-1347"><a href="#cb48-1347" aria-hidden="true" tabindex="-1"></a>energy_damage_with_config <span class="ot">&lt;-</span> damage_estimates <span class="sc">%&gt;%</span></span>
<span id="cb48-1348"><a href="#cb48-1348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-1349"><a href="#cb48-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1350"><a href="#cb48-1350" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate household electricity financial damage</span></span>
<span id="cb48-1351"><a href="#cb48-1351" aria-hidden="true" tabindex="-1"></a>household_elec_financial <span class="ot">&lt;-</span> energy_damage_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-1352"><a href="#cb48-1352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1353"><a href="#cb48-1353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-1354"><a href="#cb48-1354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-1355"><a href="#cb48-1355" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each electricity type (in VT)</span></span>
<span id="cb48-1356"><a href="#cb48-1356" aria-hidden="true" tabindex="-1"></a>    <span class="at">battery_lamp_damage =</span> <span class="st">`</span><span class="at">elec_battery lamp_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_household_elec_unit_cost</span>(<span class="st">"battery lamp"</span>, Region),</span>
<span id="cb48-1357"><a href="#cb48-1357" aria-hidden="true" tabindex="-1"></a>    <span class="at">generator_damage =</span> elec_generator_damaged <span class="sc">*</span> <span class="fu">get_household_elec_unit_cost</span>(<span class="st">"generator"</span>, Region),</span>
<span id="cb48-1358"><a href="#cb48-1358" aria-hidden="true" tabindex="-1"></a>    <span class="at">main_grid_damage =</span> <span class="st">`</span><span class="at">elec_main grid_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_household_elec_unit_cost</span>(<span class="st">"electricity poles"</span>, Region),  <span class="co"># Using "electricity poles" as proxy for main grid</span></span>
<span id="cb48-1359"><a href="#cb48-1359" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1360"><a href="#cb48-1360" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total household electricity financial damage</span></span>
<span id="cb48-1361"><a href="#cb48-1361" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_household_elec_damage =</span> battery_lamp_damage <span class="sc">+</span> generator_damage <span class="sc">+</span> main_grid_damage</span>
<span id="cb48-1362"><a href="#cb48-1362" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1363"><a href="#cb48-1363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-1364"><a href="#cb48-1364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, battery_lamp_damage, generator_damage, main_grid_damage, total_household_elec_damage)</span>
<span id="cb48-1365"><a href="#cb48-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1366"><a href="#cb48-1366" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-1367"><a href="#cb48-1367" aria-hidden="true" tabindex="-1"></a>household_elec_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(household_elec_financial)</span>
<span id="cb48-1368"><a href="#cb48-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1369"><a href="#cb48-1369" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb48-1370"><a href="#cb48-1370" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-1371"><a href="#cb48-1371" aria-hidden="true" tabindex="-1"></a>  household_elec_financial_full,</span>
<span id="cb48-1372"><a href="#cb48-1372" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Energy_04a_financial_damage_household_electricity.csv"</span>),</span>
<span id="cb48-1373"><a href="#cb48-1373" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-1374"><a href="#cb48-1374" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1375"><a href="#cb48-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1376"><a href="#cb48-1376" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb48-1377"><a href="#cb48-1377" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(household_elec_financial_full)</span>
<span id="cb48-1378"><a href="#cb48-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1379"><a href="#cb48-1379" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-1380"><a href="#cb48-1380" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb48-1381"><a href="#cb48-1381" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-1382"><a href="#cb48-1382" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1383"><a href="#cb48-1383" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-1384"><a href="#cb48-1384" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-1385"><a href="#cb48-1385" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-1386"><a href="#cb48-1386" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1387"><a href="#cb48-1387" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1388"><a href="#cb48-1388" aria-hidden="true" tabindex="-1"></a>    <span class="at">battery_lamp_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1389"><a href="#cb48-1389" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Battery Lamp"</span>,</span>
<span id="cb48-1390"><a href="#cb48-1390" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-1391"><a href="#cb48-1391" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1392"><a href="#cb48-1392" aria-hidden="true" tabindex="-1"></a>    <span class="at">generator_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1393"><a href="#cb48-1393" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Generator"</span>,</span>
<span id="cb48-1394"><a href="#cb48-1394" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-1395"><a href="#cb48-1395" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1396"><a href="#cb48-1396" aria-hidden="true" tabindex="-1"></a>    <span class="at">main_grid_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1397"><a href="#cb48-1397" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Main Grid"</span>,</span>
<span id="cb48-1398"><a href="#cb48-1398" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-1399"><a href="#cb48-1399" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1400"><a href="#cb48-1400" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_household_elec_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1401"><a href="#cb48-1401" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb48-1402"><a href="#cb48-1402" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-1403"><a href="#cb48-1403" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-1404"><a href="#cb48-1404" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1405"><a href="#cb48-1405" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-1406"><a href="#cb48-1406" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-1407"><a href="#cb48-1407" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Electricity"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"battery_lamp_damage"</span>, <span class="st">"generator_damage"</span>, <span class="st">"main_grid_damage"</span>, <span class="st">"total_household_elec_damage"</span>))</span>
<span id="cb48-1408"><a href="#cb48-1408" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1409"><a href="#cb48-1409" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1410"><a href="#cb48-1410" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1411"><a href="#cb48-1411" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1412"><a href="#cb48-1412" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-1413"><a href="#cb48-1413" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-1414"><a href="#cb48-1414" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-1415"><a href="#cb48-1415" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1416"><a href="#cb48-1416" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-1417"><a href="#cb48-1417" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-1418"><a href="#cb48-1418" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1419"><a href="#cb48-1419" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-1420"><a href="#cb48-1420" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1421"><a href="#cb48-1421" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-1422"><a href="#cb48-1422" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1423"><a href="#cb48-1423" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1424"><a href="#cb48-1424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-1425"><a href="#cb48-1425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1426"><a href="#cb48-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1427"><a href="#cb48-1427" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 2: Energy Infrastructure Financial Damage</span></span>
<span id="cb48-1428"><a href="#cb48-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1429"><a href="#cb48-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1432"><a href="#cb48-1432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-1433"><a href="#cb48-1433" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for infrastructure</span></span>
<span id="cb48-1434"><a href="#cb48-1434" aria-hidden="true" tabindex="-1"></a>get_infrastructure_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(infrastructure_type, area_council) {</span>
<span id="cb48-1435"><a href="#cb48-1435" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb48-1436"><a href="#cb48-1436" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-1437"><a href="#cb48-1437" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Energy"</span>,</span>
<span id="cb48-1438"><a href="#cb48-1438" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Energy Infrastructure"</span>,</span>
<span id="cb48-1439"><a href="#cb48-1439" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(infrastructure_type)),</span>
<span id="cb48-1440"><a href="#cb48-1440" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-1441"><a href="#cb48-1441" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1442"><a href="#cb48-1442" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-1443"><a href="#cb48-1443" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1444"><a href="#cb48-1444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb48-1445"><a href="#cb48-1445" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-1446"><a href="#cb48-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1447"><a href="#cb48-1447" aria-hidden="true" tabindex="-1"></a><span class="co"># Join infrastructure baseline with config</span></span>
<span id="cb48-1448"><a href="#cb48-1448" aria-hidden="true" tabindex="-1"></a>energy_infra_with_config <span class="ot">&lt;-</span> energy_infra_wide <span class="sc">%&gt;%</span></span>
<span id="cb48-1449"><a href="#cb48-1449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-1450"><a href="#cb48-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1451"><a href="#cb48-1451" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate infrastructure financial damage</span></span>
<span id="cb48-1452"><a href="#cb48-1452" aria-hidden="true" tabindex="-1"></a>infrastructure_financial <span class="ot">&lt;-</span> energy_infra_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-1453"><a href="#cb48-1453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1454"><a href="#cb48-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-1455"><a href="#cb48-1455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-1456"><a href="#cb48-1456" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate damaged infrastructure units and their financial cost</span></span>
<span id="cb48-1457"><a href="#cb48-1457" aria-hidden="true" tabindex="-1"></a>    <span class="at">hydro_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_hydro"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) infra_hydro <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"hydro"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb48-1458"><a href="#cb48-1458" aria-hidden="true" tabindex="-1"></a>    <span class="at">hydro_financial =</span> hydro_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"hydro"</span>, Region),</span>
<span id="cb48-1459"><a href="#cb48-1459" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1460"><a href="#cb48-1460" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_solar"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) infra_solar <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"solar"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb48-1461"><a href="#cb48-1461" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_financial =</span> solar_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"solar"</span>, Region),</span>
<span id="cb48-1462"><a href="#cb48-1462" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1463"><a href="#cb48-1463" aria-hidden="true" tabindex="-1"></a>    <span class="at">pole_support_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_electrcity pole support"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_electrcity pole support</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"electrcity pole support"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb48-1464"><a href="#cb48-1464" aria-hidden="true" tabindex="-1"></a>    <span class="at">pole_support_financial =</span> pole_support_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"electrcity pole support"</span>, Region),</span>
<span id="cb48-1465"><a href="#cb48-1465" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1466"><a href="#cb48-1466" aria-hidden="true" tabindex="-1"></a>    <span class="at">terminals_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_electrical terminals"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_electrical terminals</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"electrical terminals"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb48-1467"><a href="#cb48-1467" aria-hidden="true" tabindex="-1"></a>    <span class="at">terminals_financial =</span> terminals_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"electrical terminals"</span>, Region),</span>
<span id="cb48-1468"><a href="#cb48-1468" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1469"><a href="#cb48-1469" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_poles_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_high voltage poles"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_high voltage poles</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"high voltage poles"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb48-1470"><a href="#cb48-1470" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_poles_financial =</span> hv_poles_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"high voltage poles"</span>, Region),</span>
<span id="cb48-1471"><a href="#cb48-1471" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1472"><a href="#cb48-1472" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_support_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_high voltage support poles"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_high voltage support poles</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"high voltage support poles"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb48-1473"><a href="#cb48-1473" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_support_financial =</span> hv_support_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"high voltage support poles"</span>, Region),</span>
<span id="cb48-1474"><a href="#cb48-1474" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1475"><a href="#cb48-1475" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_transformer_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_high voltage transformer substation"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_high voltage transformer substation</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"high voltage transformer substation"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb48-1476"><a href="#cb48-1476" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_transformer_financial =</span> hv_transformer_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"high voltage transformer substation"</span>, Region),</span>
<span id="cb48-1477"><a href="#cb48-1477" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1478"><a href="#cb48-1478" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_poles_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_low voltage poles"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_low voltage poles</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"low voltage poles"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb48-1479"><a href="#cb48-1479" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_poles_financial =</span> lv_poles_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"low voltage poles"</span>, Region),</span>
<span id="cb48-1480"><a href="#cb48-1480" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1481"><a href="#cb48-1481" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_distribution_damaged =</span> <span class="cf">if</span>(<span class="st">"infra_low voltage street distrbution boxes"</span> <span class="sc">%in%</span> <span class="fu">names</span>(.)) <span class="st">`</span><span class="at">infra_low voltage street distrbution boxes</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infra_damage_multiplier</span>(Intensity, <span class="st">"low voltage street distrbution boxes"</span>, Region) <span class="cf">else</span> <span class="dv">0</span>,</span>
<span id="cb48-1482"><a href="#cb48-1482" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_distribution_financial =</span> lv_distribution_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"low voltage street distrbution boxes"</span>, Region),</span>
<span id="cb48-1483"><a href="#cb48-1483" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1484"><a href="#cb48-1484" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total infrastructure financial damage</span></span>
<span id="cb48-1485"><a href="#cb48-1485" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_infrastructure_damage =</span> hydro_financial <span class="sc">+</span> solar_financial <span class="sc">+</span> pole_support_financial <span class="sc">+</span> </span>
<span id="cb48-1486"><a href="#cb48-1486" aria-hidden="true" tabindex="-1"></a>                                  terminals_financial <span class="sc">+</span> hv_poles_financial <span class="sc">+</span> hv_support_financial <span class="sc">+</span></span>
<span id="cb48-1487"><a href="#cb48-1487" aria-hidden="true" tabindex="-1"></a>                                  hv_transformer_financial <span class="sc">+</span> lv_poles_financial <span class="sc">+</span> lv_distribution_financial</span>
<span id="cb48-1488"><a href="#cb48-1488" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1489"><a href="#cb48-1489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-1490"><a href="#cb48-1490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, hydro_financial, solar_financial, pole_support_financial, terminals_financial,</span>
<span id="cb48-1491"><a href="#cb48-1491" aria-hidden="true" tabindex="-1"></a>         hv_poles_financial, hv_support_financial, hv_transformer_financial, </span>
<span id="cb48-1492"><a href="#cb48-1492" aria-hidden="true" tabindex="-1"></a>         lv_poles_financial, lv_distribution_financial, total_infrastructure_damage)</span>
<span id="cb48-1493"><a href="#cb48-1493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1494"><a href="#cb48-1494" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-1495"><a href="#cb48-1495" aria-hidden="true" tabindex="-1"></a>infrastructure_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(infrastructure_financial)</span>
<span id="cb48-1496"><a href="#cb48-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1497"><a href="#cb48-1497" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb48-1498"><a href="#cb48-1498" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-1499"><a href="#cb48-1499" aria-hidden="true" tabindex="-1"></a>  infrastructure_financial_full,</span>
<span id="cb48-1500"><a href="#cb48-1500" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Energy_04b_financial_damage_infrastructure.csv"</span>),</span>
<span id="cb48-1501"><a href="#cb48-1501" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-1502"><a href="#cb48-1502" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1503"><a href="#cb48-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1504"><a href="#cb48-1504" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb48-1505"><a href="#cb48-1505" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(infrastructure_financial_full)</span>
<span id="cb48-1506"><a href="#cb48-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1507"><a href="#cb48-1507" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-1508"><a href="#cb48-1508" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb48-1509"><a href="#cb48-1509" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-1510"><a href="#cb48-1510" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1511"><a href="#cb48-1511" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-1512"><a href="#cb48-1512" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-1513"><a href="#cb48-1513" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-1514"><a href="#cb48-1514" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1515"><a href="#cb48-1515" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1516"><a href="#cb48-1516" aria-hidden="true" tabindex="-1"></a>    <span class="at">hydro_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Hydro"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1517"><a href="#cb48-1517" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1518"><a href="#cb48-1518" aria-hidden="true" tabindex="-1"></a>    <span class="at">pole_support_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Electricity Pole Support"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1519"><a href="#cb48-1519" aria-hidden="true" tabindex="-1"></a>    <span class="at">terminals_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Electrical Terminals"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1520"><a href="#cb48-1520" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_poles_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"High Voltage Poles"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1521"><a href="#cb48-1521" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_support_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"High Voltage Support Poles"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1522"><a href="#cb48-1522" aria-hidden="true" tabindex="-1"></a>    <span class="at">hv_transformer_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"HV Transformer Substation"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1523"><a href="#cb48-1523" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_poles_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Low Voltage Poles"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1524"><a href="#cb48-1524" aria-hidden="true" tabindex="-1"></a>    <span class="at">lv_distribution_financial =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"LV Street Distribution Boxes"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1525"><a href="#cb48-1525" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_infrastructure_damage =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total Value"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-1526"><a href="#cb48-1526" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1527"><a href="#cb48-1527" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-1528"><a href="#cb48-1528" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-1529"><a href="#cb48-1529" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Renewable"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"hydro_financial"</span>, <span class="st">"solar_financial"</span>)),</span>
<span id="cb48-1530"><a href="#cb48-1530" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Non-renewable"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"pole_support_financial"</span>, <span class="st">"terminals_financial"</span>, </span>
<span id="cb48-1531"><a href="#cb48-1531" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"hv_poles_financial"</span>, <span class="st">"hv_support_financial"</span>,</span>
<span id="cb48-1532"><a href="#cb48-1532" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"hv_transformer_financial"</span>, <span class="st">"lv_poles_financial"</span>,</span>
<span id="cb48-1533"><a href="#cb48-1533" aria-hidden="true" tabindex="-1"></a>                                                   <span class="st">"lv_distribution_financial"</span>)),</span>
<span id="cb48-1534"><a href="#cb48-1534" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_infrastructure_damage"</span>))</span>
<span id="cb48-1535"><a href="#cb48-1535" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1536"><a href="#cb48-1536" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1537"><a href="#cb48-1537" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1538"><a href="#cb48-1538" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1539"><a href="#cb48-1539" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-1540"><a href="#cb48-1540" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-1541"><a href="#cb48-1541" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-1542"><a href="#cb48-1542" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1543"><a href="#cb48-1543" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-1544"><a href="#cb48-1544" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-1545"><a href="#cb48-1545" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1546"><a href="#cb48-1546" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-1547"><a href="#cb48-1547" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1548"><a href="#cb48-1548" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-1549"><a href="#cb48-1549" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1550"><a href="#cb48-1550" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1551"><a href="#cb48-1551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-1552"><a href="#cb48-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1553"><a href="#cb48-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1554"><a href="#cb48-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1555"><a href="#cb48-1555" aria-hidden="true" tabindex="-1"></a><span class="fu"># Food security </span></span>
<span id="cb48-1556"><a href="#cb48-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1557"><a href="#cb48-1557" aria-hidden="true" tabindex="-1"></a><span class="fu">## Baseline: Food Security</span></span>
<span id="cb48-1558"><a href="#cb48-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1559"><a href="#cb48-1559" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 1: Staple crops</span></span>
<span id="cb48-1560"><a href="#cb48-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1563"><a href="#cb48-1563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-1564"><a href="#cb48-1564" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-1565"><a href="#cb48-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1566"><a href="#cb48-1566" aria-hidden="true" tabindex="-1"></a><span class="co"># Get total households from Shelter baseline (for both tables)</span></span>
<span id="cb48-1567"><a href="#cb48-1567" aria-hidden="true" tabindex="-1"></a>total_households <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-1568"><a href="#cb48-1568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1569"><a href="#cb48-1569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1570"><a href="#cb48-1570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1571"><a href="#cb48-1571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"number households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1572"><a href="#cb48-1572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1573"><a href="#cb48-1573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-1574"><a href="#cb48-1574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">total_households =</span> Value)</span>
<span id="cb48-1575"><a href="#cb48-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1576"><a href="#cb48-1576" aria-hidden="true" tabindex="-1"></a><span class="co"># === TABLE 1: STAPLE CROPS ===</span></span>
<span id="cb48-1577"><a href="#cb48-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1578"><a href="#cb48-1578" aria-hidden="true" tabindex="-1"></a><span class="co"># Get staple crop data</span></span>
<span id="cb48-1579"><a href="#cb48-1579" aria-hidden="true" tabindex="-1"></a>staple_crop_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-1580"><a href="#cb48-1580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Food Security"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1581"><a href="#cb48-1581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1582"><a href="#cb48-1582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1583"><a href="#cb48-1583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Stable Crop Households"</span>, <span class="st">"Staple Crop Production"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1584"><a href="#cb48-1584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1585"><a href="#cb48-1585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Indicator, Attribute, Value)</span>
<span id="cb48-1586"><a href="#cb48-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1587"><a href="#cb48-1587" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape staple crop data</span></span>
<span id="cb48-1588"><a href="#cb48-1588" aria-hidden="true" tabindex="-1"></a>staple_crop_wide <span class="ot">&lt;-</span> staple_crop_data <span class="sc">%&gt;%</span></span>
<span id="cb48-1589"><a href="#cb48-1589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-1590"><a href="#cb48-1590" aria-hidden="true" tabindex="-1"></a>    <span class="at">crop =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)),</span>
<span id="cb48-1591"><a href="#cb48-1591" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="fu">case_when</span>(</span>
<span id="cb48-1592"><a href="#cb48-1592" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Households"</span>, Indicator) <span class="sc">~</span> <span class="st">"households"</span>,</span>
<span id="cb48-1593"><a href="#cb48-1593" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Production"</span>, Indicator) <span class="sc">~</span> <span class="st">"production"</span>,</span>
<span id="cb48-1594"><a href="#cb48-1594" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"other"</span></span>
<span id="cb48-1595"><a href="#cb48-1595" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-1596"><a href="#cb48-1596" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1597"><a href="#cb48-1597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, crop, metric) <span class="sc">%&gt;%</span></span>
<span id="cb48-1598"><a href="#cb48-1598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1599"><a href="#cb48-1599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-1600"><a href="#cb48-1600" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="fu">c</span>(crop, metric),</span>
<span id="cb48-1601"><a href="#cb48-1601" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-1602"><a href="#cb48-1602" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span></span>
<span id="cb48-1603"><a href="#cb48-1603" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1604"><a href="#cb48-1604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-1605"><a href="#cb48-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1606"><a href="#cb48-1606" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with total households</span></span>
<span id="cb48-1607"><a href="#cb48-1607" aria-hidden="true" tabindex="-1"></a>staple_crop_full <span class="ot">&lt;-</span> total_households <span class="sc">%&gt;%</span></span>
<span id="cb48-1608"><a href="#cb48-1608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(staple_crop_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1609"><a href="#cb48-1609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-1610"><a href="#cb48-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1611"><a href="#cb48-1611" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-1612"><a href="#cb48-1612" aria-hidden="true" tabindex="-1"></a>staple_crop_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(staple_crop_full)</span>
<span id="cb48-1613"><a href="#cb48-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1614"><a href="#cb48-1614" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to client's specification</span></span>
<span id="cb48-1615"><a href="#cb48-1615" aria-hidden="true" tabindex="-1"></a>staple_crop_ordered <span class="ot">&lt;-</span> staple_crop_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-1616"><a href="#cb48-1616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-1617"><a href="#cb48-1617" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-1618"><a href="#cb48-1618" aria-hidden="true" tabindex="-1"></a>    total_households,</span>
<span id="cb48-1619"><a href="#cb48-1619" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Island Cabbage</span></span>
<span id="cb48-1620"><a href="#cb48-1620" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_households</span><span class="st">`</span>,</span>
<span id="cb48-1621"><a href="#cb48-1621" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_production</span><span class="st">`</span>,</span>
<span id="cb48-1622"><a href="#cb48-1622" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banana</span></span>
<span id="cb48-1623"><a href="#cb48-1623" aria-hidden="true" tabindex="-1"></a>    banana_households,</span>
<span id="cb48-1624"><a href="#cb48-1624" aria-hidden="true" tabindex="-1"></a>    banana_production,</span>
<span id="cb48-1625"><a href="#cb48-1625" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Taro</span></span>
<span id="cb48-1626"><a href="#cb48-1626" aria-hidden="true" tabindex="-1"></a>    taro_households,</span>
<span id="cb48-1627"><a href="#cb48-1627" aria-hidden="true" tabindex="-1"></a>    taro_production,</span>
<span id="cb48-1628"><a href="#cb48-1628" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kumala</span></span>
<span id="cb48-1629"><a href="#cb48-1629" aria-hidden="true" tabindex="-1"></a>    kumala_households,</span>
<span id="cb48-1630"><a href="#cb48-1630" aria-hidden="true" tabindex="-1"></a>    kumala_production,</span>
<span id="cb48-1631"><a href="#cb48-1631" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manioc</span></span>
<span id="cb48-1632"><a href="#cb48-1632" aria-hidden="true" tabindex="-1"></a>    manioc_households,</span>
<span id="cb48-1633"><a href="#cb48-1633" aria-hidden="true" tabindex="-1"></a>    manioc_production,</span>
<span id="cb48-1634"><a href="#cb48-1634" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Yam</span></span>
<span id="cb48-1635"><a href="#cb48-1635" aria-hidden="true" tabindex="-1"></a>    yam_households,</span>
<span id="cb48-1636"><a href="#cb48-1636" aria-hidden="true" tabindex="-1"></a>    yam_production</span>
<span id="cb48-1637"><a href="#cb48-1637" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-1638"><a href="#cb48-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1639"><a href="#cb48-1639" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb48-1640"><a href="#cb48-1640" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-1641"><a href="#cb48-1641" aria-hidden="true" tabindex="-1"></a>  staple_crop_ordered,</span>
<span id="cb48-1642"><a href="#cb48-1642" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_01a_baseline_staple_crops.csv"</span>),</span>
<span id="cb48-1643"><a href="#cb48-1643" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-1644"><a href="#cb48-1644" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1645"><a href="#cb48-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1646"><a href="#cb48-1646" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb48-1647"><a href="#cb48-1647" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(staple_crop_ordered)</span>
<span id="cb48-1648"><a href="#cb48-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1649"><a href="#cb48-1649" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-1650"><a href="#cb48-1650" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb48-1651"><a href="#cb48-1651" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-1652"><a href="#cb48-1652" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1653"><a href="#cb48-1653" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-1654"><a href="#cb48-1654" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-1655"><a href="#cb48-1655" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-1656"><a href="#cb48-1656" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1657"><a href="#cb48-1657" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1658"><a href="#cb48-1658" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1659"><a href="#cb48-1659" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1660"><a href="#cb48-1660" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Island Cabbage</span></span>
<span id="cb48-1661"><a href="#cb48-1661" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_households</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1662"><a href="#cb48-1662" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_production</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1663"><a href="#cb48-1663" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1664"><a href="#cb48-1664" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banana</span></span>
<span id="cb48-1665"><a href="#cb48-1665" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1666"><a href="#cb48-1666" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1667"><a href="#cb48-1667" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1668"><a href="#cb48-1668" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Taro</span></span>
<span id="cb48-1669"><a href="#cb48-1669" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1670"><a href="#cb48-1670" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1671"><a href="#cb48-1671" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1672"><a href="#cb48-1672" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kumala</span></span>
<span id="cb48-1673"><a href="#cb48-1673" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1674"><a href="#cb48-1674" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1675"><a href="#cb48-1675" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1676"><a href="#cb48-1676" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manioc</span></span>
<span id="cb48-1677"><a href="#cb48-1677" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1678"><a href="#cb48-1678" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1679"><a href="#cb48-1679" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1680"><a href="#cb48-1680" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Yam</span></span>
<span id="cb48-1681"><a href="#cb48-1681" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1682"><a href="#cb48-1682" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-1683"><a href="#cb48-1683" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1684"><a href="#cb48-1684" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-1685"><a href="#cb48-1685" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households"</span>)),</span>
<span id="cb48-1686"><a href="#cb48-1686" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Island Cabbage"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"island cabbage_households"</span>, <span class="st">"island cabbage_production"</span>)),</span>
<span id="cb48-1687"><a href="#cb48-1687" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Banana"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"banana_households"</span>, <span class="st">"banana_production"</span>)),</span>
<span id="cb48-1688"><a href="#cb48-1688" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Taro"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"taro_households"</span>, <span class="st">"taro_production"</span>)),</span>
<span id="cb48-1689"><a href="#cb48-1689" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Kumala"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"kumala_households"</span>, <span class="st">"kumala_production"</span>)),</span>
<span id="cb48-1690"><a href="#cb48-1690" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Manioc"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"manioc_households"</span>, <span class="st">"manioc_production"</span>)),</span>
<span id="cb48-1691"><a href="#cb48-1691" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Yam"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"yam_households"</span>, <span class="st">"yam_production"</span>))</span>
<span id="cb48-1692"><a href="#cb48-1692" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1693"><a href="#cb48-1693" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1694"><a href="#cb48-1694" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1695"><a href="#cb48-1695" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1696"><a href="#cb48-1696" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-1697"><a href="#cb48-1697" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-1698"><a href="#cb48-1698" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-1699"><a href="#cb48-1699" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1700"><a href="#cb48-1700" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-1701"><a href="#cb48-1701" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-1702"><a href="#cb48-1702" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1703"><a href="#cb48-1703" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-1704"><a href="#cb48-1704" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1705"><a href="#cb48-1705" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-1706"><a href="#cb48-1706" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1707"><a href="#cb48-1707" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1708"><a href="#cb48-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1709"><a href="#cb48-1709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-1710"><a href="#cb48-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1711"><a href="#cb48-1711" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 2: Cash Crops</span></span>
<span id="cb48-1712"><a href="#cb48-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1715"><a href="#cb48-1715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-1716"><a href="#cb48-1716" aria-hidden="true" tabindex="-1"></a><span class="co"># Get cash crop data</span></span>
<span id="cb48-1717"><a href="#cb48-1717" aria-hidden="true" tabindex="-1"></a>cash_crop_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-1718"><a href="#cb48-1718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Food Security"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1719"><a href="#cb48-1719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1720"><a href="#cb48-1720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1721"><a href="#cb48-1721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Cash Crop Households"</span>, <span class="st">"Cash Crop Production"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1722"><a href="#cb48-1722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1723"><a href="#cb48-1723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Indicator, Attribute, Value)</span>
<span id="cb48-1724"><a href="#cb48-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1725"><a href="#cb48-1725" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape cash crop data</span></span>
<span id="cb48-1726"><a href="#cb48-1726" aria-hidden="true" tabindex="-1"></a>cash_crop_wide <span class="ot">&lt;-</span> cash_crop_data <span class="sc">%&gt;%</span></span>
<span id="cb48-1727"><a href="#cb48-1727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-1728"><a href="#cb48-1728" aria-hidden="true" tabindex="-1"></a>    <span class="at">crop =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)),</span>
<span id="cb48-1729"><a href="#cb48-1729" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="fu">case_when</span>(</span>
<span id="cb48-1730"><a href="#cb48-1730" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Households"</span>, Indicator) <span class="sc">~</span> <span class="st">"households"</span>,</span>
<span id="cb48-1731"><a href="#cb48-1731" aria-hidden="true" tabindex="-1"></a>      <span class="fu">grepl</span>(<span class="st">"Production"</span>, Indicator) <span class="sc">~</span> <span class="st">"production"</span>,</span>
<span id="cb48-1732"><a href="#cb48-1732" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"other"</span></span>
<span id="cb48-1733"><a href="#cb48-1733" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-1734"><a href="#cb48-1734" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1735"><a href="#cb48-1735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, crop, metric) <span class="sc">%&gt;%</span></span>
<span id="cb48-1736"><a href="#cb48-1736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1737"><a href="#cb48-1737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-1738"><a href="#cb48-1738" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="fu">c</span>(crop, metric),</span>
<span id="cb48-1739"><a href="#cb48-1739" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-1740"><a href="#cb48-1740" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span></span>
<span id="cb48-1741"><a href="#cb48-1741" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1742"><a href="#cb48-1742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-1743"><a href="#cb48-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1744"><a href="#cb48-1744" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with total households</span></span>
<span id="cb48-1745"><a href="#cb48-1745" aria-hidden="true" tabindex="-1"></a>cash_crop_full <span class="ot">&lt;-</span> total_households <span class="sc">%&gt;%</span></span>
<span id="cb48-1746"><a href="#cb48-1746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cash_crop_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-1747"><a href="#cb48-1747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-1748"><a href="#cb48-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1749"><a href="#cb48-1749" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-1750"><a href="#cb48-1750" aria-hidden="true" tabindex="-1"></a>cash_crop_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(cash_crop_full)</span>
<span id="cb48-1751"><a href="#cb48-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1752"><a href="#cb48-1752" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to client's specification</span></span>
<span id="cb48-1753"><a href="#cb48-1753" aria-hidden="true" tabindex="-1"></a>cash_crop_ordered <span class="ot">&lt;-</span> cash_crop_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-1754"><a href="#cb48-1754" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-1755"><a href="#cb48-1755" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-1756"><a href="#cb48-1756" aria-hidden="true" tabindex="-1"></a>    total_households,</span>
<span id="cb48-1757"><a href="#cb48-1757" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kava</span></span>
<span id="cb48-1758"><a href="#cb48-1758" aria-hidden="true" tabindex="-1"></a>    kava_households,</span>
<span id="cb48-1759"><a href="#cb48-1759" aria-hidden="true" tabindex="-1"></a>    kava_production,</span>
<span id="cb48-1760"><a href="#cb48-1760" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coconut</span></span>
<span id="cb48-1761"><a href="#cb48-1761" aria-hidden="true" tabindex="-1"></a>    coconut_households,</span>
<span id="cb48-1762"><a href="#cb48-1762" aria-hidden="true" tabindex="-1"></a>    coconut_production,</span>
<span id="cb48-1763"><a href="#cb48-1763" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cocoa</span></span>
<span id="cb48-1764"><a href="#cb48-1764" aria-hidden="true" tabindex="-1"></a>    cocoa_households,</span>
<span id="cb48-1765"><a href="#cb48-1765" aria-hidden="true" tabindex="-1"></a>    cocoa_production,</span>
<span id="cb48-1766"><a href="#cb48-1766" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coffee</span></span>
<span id="cb48-1767"><a href="#cb48-1767" aria-hidden="true" tabindex="-1"></a>    coffee_households,</span>
<span id="cb48-1768"><a href="#cb48-1768" aria-hidden="true" tabindex="-1"></a>    coffee_production,</span>
<span id="cb48-1769"><a href="#cb48-1769" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vanilla</span></span>
<span id="cb48-1770"><a href="#cb48-1770" aria-hidden="true" tabindex="-1"></a>    vanilla_households,</span>
<span id="cb48-1771"><a href="#cb48-1771" aria-hidden="true" tabindex="-1"></a>    vanilla_production,</span>
<span id="cb48-1772"><a href="#cb48-1772" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tahitian Lime</span></span>
<span id="cb48-1773"><a href="#cb48-1773" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_households</span><span class="st">`</span>,</span>
<span id="cb48-1774"><a href="#cb48-1774" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_production</span><span class="st">`</span>,</span>
<span id="cb48-1775"><a href="#cb48-1775" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pepper</span></span>
<span id="cb48-1776"><a href="#cb48-1776" aria-hidden="true" tabindex="-1"></a>    pepper_households,</span>
<span id="cb48-1777"><a href="#cb48-1777" aria-hidden="true" tabindex="-1"></a>    pepper_production,</span>
<span id="cb48-1778"><a href="#cb48-1778" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Noni</span></span>
<span id="cb48-1779"><a href="#cb48-1779" aria-hidden="true" tabindex="-1"></a>    noni_households,</span>
<span id="cb48-1780"><a href="#cb48-1780" aria-hidden="true" tabindex="-1"></a>    noni_production</span>
<span id="cb48-1781"><a href="#cb48-1781" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-1782"><a href="#cb48-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1783"><a href="#cb48-1783" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb48-1784"><a href="#cb48-1784" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-1785"><a href="#cb48-1785" aria-hidden="true" tabindex="-1"></a>  cash_crop_ordered,</span>
<span id="cb48-1786"><a href="#cb48-1786" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_01b_baseline_cash_crops.csv"</span>),</span>
<span id="cb48-1787"><a href="#cb48-1787" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-1788"><a href="#cb48-1788" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1789"><a href="#cb48-1789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1790"><a href="#cb48-1790" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb48-1791"><a href="#cb48-1791" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(cash_crop_ordered)</span>
<span id="cb48-1792"><a href="#cb48-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1793"><a href="#cb48-1793" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-1794"><a href="#cb48-1794" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb48-1795"><a href="#cb48-1795" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-1796"><a href="#cb48-1796" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1797"><a href="#cb48-1797" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-1798"><a href="#cb48-1798" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-1799"><a href="#cb48-1799" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-1800"><a href="#cb48-1800" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1801"><a href="#cb48-1801" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1802"><a href="#cb48-1802" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1803"><a href="#cb48-1803" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1804"><a href="#cb48-1804" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kava</span></span>
<span id="cb48-1805"><a href="#cb48-1805" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1806"><a href="#cb48-1806" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1807"><a href="#cb48-1807" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1808"><a href="#cb48-1808" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coconut</span></span>
<span id="cb48-1809"><a href="#cb48-1809" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1810"><a href="#cb48-1810" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1811"><a href="#cb48-1811" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1812"><a href="#cb48-1812" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cocoa</span></span>
<span id="cb48-1813"><a href="#cb48-1813" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1814"><a href="#cb48-1814" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1815"><a href="#cb48-1815" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1816"><a href="#cb48-1816" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coffee</span></span>
<span id="cb48-1817"><a href="#cb48-1817" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1818"><a href="#cb48-1818" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1819"><a href="#cb48-1819" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1820"><a href="#cb48-1820" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vanilla</span></span>
<span id="cb48-1821"><a href="#cb48-1821" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1822"><a href="#cb48-1822" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1823"><a href="#cb48-1823" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1824"><a href="#cb48-1824" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tahitian Lime</span></span>
<span id="cb48-1825"><a href="#cb48-1825" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_households</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1826"><a href="#cb48-1826" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_production</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1827"><a href="#cb48-1827" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1828"><a href="#cb48-1828" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pepper</span></span>
<span id="cb48-1829"><a href="#cb48-1829" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1830"><a href="#cb48-1830" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1831"><a href="#cb48-1831" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1832"><a href="#cb48-1832" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Noni</span></span>
<span id="cb48-1833"><a href="#cb48-1833" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1834"><a href="#cb48-1834" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_production =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-1835"><a href="#cb48-1835" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1836"><a href="#cb48-1836" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-1837"><a href="#cb48-1837" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households"</span>)),</span>
<span id="cb48-1838"><a href="#cb48-1838" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Kava"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"kava_households"</span>, <span class="st">"kava_production"</span>)),</span>
<span id="cb48-1839"><a href="#cb48-1839" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Coconut"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"coconut_households"</span>, <span class="st">"coconut_production"</span>)),</span>
<span id="cb48-1840"><a href="#cb48-1840" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Cocoa"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"cocoa_households"</span>, <span class="st">"cocoa_production"</span>)),</span>
<span id="cb48-1841"><a href="#cb48-1841" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Coffee"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"coffee_households"</span>, <span class="st">"coffee_production"</span>)),</span>
<span id="cb48-1842"><a href="#cb48-1842" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Vanilla"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"vanilla_households"</span>, <span class="st">"vanilla_production"</span>)),</span>
<span id="cb48-1843"><a href="#cb48-1843" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Tahitian Lime"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"tahitian lime_households"</span>, <span class="st">"tahitian lime_production"</span>)),</span>
<span id="cb48-1844"><a href="#cb48-1844" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Pepper"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"pepper_households"</span>, <span class="st">"pepper_production"</span>)),</span>
<span id="cb48-1845"><a href="#cb48-1845" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Noni"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"noni_households"</span>, <span class="st">"noni_production"</span>))</span>
<span id="cb48-1846"><a href="#cb48-1846" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1847"><a href="#cb48-1847" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1848"><a href="#cb48-1848" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1849"><a href="#cb48-1849" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1850"><a href="#cb48-1850" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-1851"><a href="#cb48-1851" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-1852"><a href="#cb48-1852" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-1853"><a href="#cb48-1853" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1854"><a href="#cb48-1854" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-1855"><a href="#cb48-1855" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-1856"><a href="#cb48-1856" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-1857"><a href="#cb48-1857" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-1858"><a href="#cb48-1858" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-1859"><a href="#cb48-1859" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-1860"><a href="#cb48-1860" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1861"><a href="#cb48-1861" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1862"><a href="#cb48-1862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-1863"><a href="#cb48-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1864"><a href="#cb48-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1865"><a href="#cb48-1865" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimated Hazard Damage </span></span>
<span id="cb48-1866"><a href="#cb48-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1867"><a href="#cb48-1867" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 1: Staple Crops Damage</span></span>
<span id="cb48-1868"><a href="#cb48-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1871"><a href="#cb48-1871" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-1872"><a href="#cb48-1872" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for food security damage multipliers</span></span>
<span id="cb48-1873"><a href="#cb48-1873" aria-hidden="true" tabindex="-1"></a>get_food_security_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, indicator_type, crop_type, area_council) {</span>
<span id="cb48-1874"><a href="#cb48-1874" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb48-1875"><a href="#cb48-1875" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1876"><a href="#cb48-1876" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb48-1877"><a href="#cb48-1877" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-1878"><a href="#cb48-1878" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Food Security"</span>,</span>
<span id="cb48-1879"><a href="#cb48-1879" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator_type,</span>
<span id="cb48-1880"><a href="#cb48-1880" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(crop_type)),</span>
<span id="cb48-1881"><a href="#cb48-1881" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-1882"><a href="#cb48-1882" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-1883"><a href="#cb48-1883" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1884"><a href="#cb48-1884" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb48-1885"><a href="#cb48-1885" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb48-1886"><a href="#cb48-1886" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-1887"><a href="#cb48-1887" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-1888"><a href="#cb48-1888" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb48-1889"><a href="#cb48-1889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb48-1890"><a href="#cb48-1890" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-1891"><a href="#cb48-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1892"><a href="#cb48-1892" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories from config file</span></span>
<span id="cb48-1893"><a href="#cb48-1893" aria-hidden="true" tabindex="-1"></a>staple_crop_with_config <span class="ot">&lt;-</span> staple_crop_full <span class="sc">%&gt;%</span></span>
<span id="cb48-1894"><a href="#cb48-1894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-1895"><a href="#cb48-1895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1896"><a href="#cb48-1896" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate staple crop damage estimates</span></span>
<span id="cb48-1897"><a href="#cb48-1897" aria-hidden="true" tabindex="-1"></a>staple_damage <span class="ot">&lt;-</span> staple_crop_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-1898"><a href="#cb48-1898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-1899"><a href="#cb48-1899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-1900"><a href="#cb48-1900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-1901"><a href="#cb48-1901" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total households affected (same as baseline)</span></span>
<span id="cb48-1902"><a href="#cb48-1902" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> total_households,</span>
<span id="cb48-1903"><a href="#cb48-1903" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1904"><a href="#cb48-1904" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Island Cabbage</span></span>
<span id="cb48-1905"><a href="#cb48-1905" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_households_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">island cabbage_households</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"island cabbage"</span>, Region),</span>
<span id="cb48-1906"><a href="#cb48-1906" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_production_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">island cabbage_production</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"island cabbage"</span>, Region),</span>
<span id="cb48-1907"><a href="#cb48-1907" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1908"><a href="#cb48-1908" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banana</span></span>
<span id="cb48-1909"><a href="#cb48-1909" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_households_damaged =</span> banana_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"banana"</span>, Region),</span>
<span id="cb48-1910"><a href="#cb48-1910" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_production_damaged =</span> banana_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"banana"</span>, Region),</span>
<span id="cb48-1911"><a href="#cb48-1911" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1912"><a href="#cb48-1912" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Taro</span></span>
<span id="cb48-1913"><a href="#cb48-1913" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_households_damaged =</span> taro_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"taro"</span>, Region),</span>
<span id="cb48-1914"><a href="#cb48-1914" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_production_damaged =</span> taro_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"taro"</span>, Region),</span>
<span id="cb48-1915"><a href="#cb48-1915" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1916"><a href="#cb48-1916" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kumala</span></span>
<span id="cb48-1917"><a href="#cb48-1917" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_households_damaged =</span> kumala_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"kumala"</span>, Region),</span>
<span id="cb48-1918"><a href="#cb48-1918" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_production_damaged =</span> kumala_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"kumala"</span>, Region),</span>
<span id="cb48-1919"><a href="#cb48-1919" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1920"><a href="#cb48-1920" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manioc</span></span>
<span id="cb48-1921"><a href="#cb48-1921" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_households_damaged =</span> manioc_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"manioc"</span>, Region),</span>
<span id="cb48-1922"><a href="#cb48-1922" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_production_damaged =</span> manioc_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"manioc"</span>, Region),</span>
<span id="cb48-1923"><a href="#cb48-1923" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1924"><a href="#cb48-1924" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Yam</span></span>
<span id="cb48-1925"><a href="#cb48-1925" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_households_damaged =</span> yam_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Households"</span>, <span class="st">"yam"</span>, Region),</span>
<span id="cb48-1926"><a href="#cb48-1926" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_production_damaged =</span> yam_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Stable Crop Production"</span>, <span class="st">"yam"</span>, Region)</span>
<span id="cb48-1927"><a href="#cb48-1927" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-1928"><a href="#cb48-1928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-1929"><a href="#cb48-1929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_households_affected, <span class="fu">contains</span>(<span class="st">"_damaged"</span>))</span>
<span id="cb48-1930"><a href="#cb48-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1931"><a href="#cb48-1931" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-1932"><a href="#cb48-1932" aria-hidden="true" tabindex="-1"></a>staple_damage_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(staple_damage)</span>
<span id="cb48-1933"><a href="#cb48-1933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1934"><a href="#cb48-1934" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to client's specification</span></span>
<span id="cb48-1935"><a href="#cb48-1935" aria-hidden="true" tabindex="-1"></a>staple_damage_ordered <span class="ot">&lt;-</span> staple_damage_full <span class="sc">%&gt;%</span></span>
<span id="cb48-1936"><a href="#cb48-1936" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-1937"><a href="#cb48-1937" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-1938"><a href="#cb48-1938" aria-hidden="true" tabindex="-1"></a>    total_households_affected,</span>
<span id="cb48-1939"><a href="#cb48-1939" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Island Cabbage</span></span>
<span id="cb48-1940"><a href="#cb48-1940" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_households_damaged</span><span class="st">`</span>,</span>
<span id="cb48-1941"><a href="#cb48-1941" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_production_damaged</span><span class="st">`</span>,</span>
<span id="cb48-1942"><a href="#cb48-1942" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banana</span></span>
<span id="cb48-1943"><a href="#cb48-1943" aria-hidden="true" tabindex="-1"></a>    banana_households_damaged,</span>
<span id="cb48-1944"><a href="#cb48-1944" aria-hidden="true" tabindex="-1"></a>    banana_production_damaged,</span>
<span id="cb48-1945"><a href="#cb48-1945" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Taro</span></span>
<span id="cb48-1946"><a href="#cb48-1946" aria-hidden="true" tabindex="-1"></a>    taro_households_damaged,</span>
<span id="cb48-1947"><a href="#cb48-1947" aria-hidden="true" tabindex="-1"></a>    taro_production_damaged,</span>
<span id="cb48-1948"><a href="#cb48-1948" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kumala</span></span>
<span id="cb48-1949"><a href="#cb48-1949" aria-hidden="true" tabindex="-1"></a>    kumala_households_damaged,</span>
<span id="cb48-1950"><a href="#cb48-1950" aria-hidden="true" tabindex="-1"></a>    kumala_production_damaged,</span>
<span id="cb48-1951"><a href="#cb48-1951" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manioc</span></span>
<span id="cb48-1952"><a href="#cb48-1952" aria-hidden="true" tabindex="-1"></a>    manioc_households_damaged,</span>
<span id="cb48-1953"><a href="#cb48-1953" aria-hidden="true" tabindex="-1"></a>    manioc_production_damaged,</span>
<span id="cb48-1954"><a href="#cb48-1954" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Yam</span></span>
<span id="cb48-1955"><a href="#cb48-1955" aria-hidden="true" tabindex="-1"></a>    yam_households_damaged,</span>
<span id="cb48-1956"><a href="#cb48-1956" aria-hidden="true" tabindex="-1"></a>    yam_production_damaged</span>
<span id="cb48-1957"><a href="#cb48-1957" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-1958"><a href="#cb48-1958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1959"><a href="#cb48-1959" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb48-1960"><a href="#cb48-1960" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-1961"><a href="#cb48-1961" aria-hidden="true" tabindex="-1"></a>  staple_damage_ordered,</span>
<span id="cb48-1962"><a href="#cb48-1962" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_02a_damage_staple_crops.csv"</span>),</span>
<span id="cb48-1963"><a href="#cb48-1963" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-1964"><a href="#cb48-1964" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-1965"><a href="#cb48-1965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1966"><a href="#cb48-1966" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb48-1967"><a href="#cb48-1967" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(staple_damage_ordered)</span>
<span id="cb48-1968"><a href="#cb48-1968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-1969"><a href="#cb48-1969" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-1970"><a href="#cb48-1970" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb48-1971"><a href="#cb48-1971" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-1972"><a href="#cb48-1972" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-1973"><a href="#cb48-1973" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-1974"><a href="#cb48-1974" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-1975"><a href="#cb48-1975" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-1976"><a href="#cb48-1976" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-1977"><a href="#cb48-1977" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-1978"><a href="#cb48-1978" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1979"><a href="#cb48-1979" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1980"><a href="#cb48-1980" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Island Cabbage</span></span>
<span id="cb48-1981"><a href="#cb48-1981" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_households_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1982"><a href="#cb48-1982" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">island cabbage_production_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1983"><a href="#cb48-1983" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1984"><a href="#cb48-1984" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Banana</span></span>
<span id="cb48-1985"><a href="#cb48-1985" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1986"><a href="#cb48-1986" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1987"><a href="#cb48-1987" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1988"><a href="#cb48-1988" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Taro</span></span>
<span id="cb48-1989"><a href="#cb48-1989" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1990"><a href="#cb48-1990" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1991"><a href="#cb48-1991" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1992"><a href="#cb48-1992" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kumala</span></span>
<span id="cb48-1993"><a href="#cb48-1993" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1994"><a href="#cb48-1994" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1995"><a href="#cb48-1995" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-1996"><a href="#cb48-1996" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Manioc</span></span>
<span id="cb48-1997"><a href="#cb48-1997" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1998"><a href="#cb48-1998" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-1999"><a href="#cb48-1999" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2000"><a href="#cb48-2000" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Yam</span></span>
<span id="cb48-2001"><a href="#cb48-2001" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2002"><a href="#cb48-2002" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-2003"><a href="#cb48-2003" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2004"><a href="#cb48-2004" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-2005"><a href="#cb48-2005" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households_affected"</span>)),</span>
<span id="cb48-2006"><a href="#cb48-2006" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Island Cabbage"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"island cabbage_households_damaged"</span>, <span class="st">"island cabbage_production_damaged"</span>)),</span>
<span id="cb48-2007"><a href="#cb48-2007" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Banana"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"banana_households_damaged"</span>, <span class="st">"banana_production_damaged"</span>)),</span>
<span id="cb48-2008"><a href="#cb48-2008" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Taro"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"taro_households_damaged"</span>, <span class="st">"taro_production_damaged"</span>)),</span>
<span id="cb48-2009"><a href="#cb48-2009" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Kumala"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"kumala_households_damaged"</span>, <span class="st">"kumala_production_damaged"</span>)),</span>
<span id="cb48-2010"><a href="#cb48-2010" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Manioc"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"manioc_households_damaged"</span>, <span class="st">"manioc_production_damaged"</span>)),</span>
<span id="cb48-2011"><a href="#cb48-2011" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Yam"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"yam_households_damaged"</span>, <span class="st">"yam_production_damaged"</span>))</span>
<span id="cb48-2012"><a href="#cb48-2012" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2013"><a href="#cb48-2013" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2014"><a href="#cb48-2014" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2015"><a href="#cb48-2015" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2016"><a href="#cb48-2016" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-2017"><a href="#cb48-2017" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-2018"><a href="#cb48-2018" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-2019"><a href="#cb48-2019" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2020"><a href="#cb48-2020" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-2021"><a href="#cb48-2021" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-2022"><a href="#cb48-2022" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2023"><a href="#cb48-2023" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-2024"><a href="#cb48-2024" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2025"><a href="#cb48-2025" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-2026"><a href="#cb48-2026" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2027"><a href="#cb48-2027" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2028"><a href="#cb48-2028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-2029"><a href="#cb48-2029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2030"><a href="#cb48-2030" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 2: Cash Crops Damage</span></span>
<span id="cb48-2031"><a href="#cb48-2031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2034"><a href="#cb48-2034" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-2035"><a href="#cb48-2035" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories from config file</span></span>
<span id="cb48-2036"><a href="#cb48-2036" aria-hidden="true" tabindex="-1"></a>cash_crop_with_config <span class="ot">&lt;-</span> cash_crop_full <span class="sc">%&gt;%</span></span>
<span id="cb48-2037"><a href="#cb48-2037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-2038"><a href="#cb48-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2039"><a href="#cb48-2039" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cash crop damage estimates</span></span>
<span id="cb48-2040"><a href="#cb48-2040" aria-hidden="true" tabindex="-1"></a>cash_damage <span class="ot">&lt;-</span> cash_crop_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-2041"><a href="#cb48-2041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2042"><a href="#cb48-2042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-2043"><a href="#cb48-2043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-2044"><a href="#cb48-2044" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total households affected (same as baseline)</span></span>
<span id="cb48-2045"><a href="#cb48-2045" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> total_households,</span>
<span id="cb48-2046"><a href="#cb48-2046" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2047"><a href="#cb48-2047" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kava</span></span>
<span id="cb48-2048"><a href="#cb48-2048" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_households_damaged =</span> kava_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"kava"</span>, Region),</span>
<span id="cb48-2049"><a href="#cb48-2049" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_production_damaged =</span> kava_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"kava"</span>, Region),</span>
<span id="cb48-2050"><a href="#cb48-2050" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2051"><a href="#cb48-2051" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coconut</span></span>
<span id="cb48-2052"><a href="#cb48-2052" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_households_damaged =</span> coconut_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"coconut"</span>, Region),</span>
<span id="cb48-2053"><a href="#cb48-2053" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_production_damaged =</span> coconut_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"coconut"</span>, Region),</span>
<span id="cb48-2054"><a href="#cb48-2054" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2055"><a href="#cb48-2055" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cocoa</span></span>
<span id="cb48-2056"><a href="#cb48-2056" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_households_damaged =</span> cocoa_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"cocoa"</span>, Region),</span>
<span id="cb48-2057"><a href="#cb48-2057" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_production_damaged =</span> cocoa_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"cocoa"</span>, Region),</span>
<span id="cb48-2058"><a href="#cb48-2058" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2059"><a href="#cb48-2059" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coffee</span></span>
<span id="cb48-2060"><a href="#cb48-2060" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_households_damaged =</span> coffee_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"coffee"</span>, Region),</span>
<span id="cb48-2061"><a href="#cb48-2061" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_production_damaged =</span> coffee_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"coffee"</span>, Region),</span>
<span id="cb48-2062"><a href="#cb48-2062" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2063"><a href="#cb48-2063" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vanilla</span></span>
<span id="cb48-2064"><a href="#cb48-2064" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_households_damaged =</span> vanilla_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"vanilla"</span>, Region),</span>
<span id="cb48-2065"><a href="#cb48-2065" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_production_damaged =</span> vanilla_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"vanilla"</span>, Region),</span>
<span id="cb48-2066"><a href="#cb48-2066" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2067"><a href="#cb48-2067" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tahitian Lime</span></span>
<span id="cb48-2068"><a href="#cb48-2068" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_households_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">tahitian lime_households</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"tahitian lime"</span>, Region),</span>
<span id="cb48-2069"><a href="#cb48-2069" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_production_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">tahitian lime_production</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"tahitian lime"</span>, Region),</span>
<span id="cb48-2070"><a href="#cb48-2070" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2071"><a href="#cb48-2071" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pepper</span></span>
<span id="cb48-2072"><a href="#cb48-2072" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_households_damaged =</span> pepper_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"pepper"</span>, Region),</span>
<span id="cb48-2073"><a href="#cb48-2073" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_production_damaged =</span> pepper_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"pepper"</span>, Region),</span>
<span id="cb48-2074"><a href="#cb48-2074" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2075"><a href="#cb48-2075" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Noni</span></span>
<span id="cb48-2076"><a href="#cb48-2076" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_households_damaged =</span> noni_households <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Households"</span>, <span class="st">"noni"</span>, Region),</span>
<span id="cb48-2077"><a href="#cb48-2077" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_production_damaged =</span> noni_production <span class="sc">*</span> <span class="fu">get_food_security_damage_multiplier</span>(Intensity, <span class="st">"Cash Crop Production"</span>, <span class="st">"noni"</span>, Region)</span>
<span id="cb48-2078"><a href="#cb48-2078" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2079"><a href="#cb48-2079" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-2080"><a href="#cb48-2080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_households_affected, <span class="fu">contains</span>(<span class="st">"_damaged"</span>))</span>
<span id="cb48-2081"><a href="#cb48-2081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2082"><a href="#cb48-2082" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-2083"><a href="#cb48-2083" aria-hidden="true" tabindex="-1"></a>cash_damage_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(cash_damage)</span>
<span id="cb48-2084"><a href="#cb48-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2085"><a href="#cb48-2085" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to client's specification</span></span>
<span id="cb48-2086"><a href="#cb48-2086" aria-hidden="true" tabindex="-1"></a>cash_damage_ordered <span class="ot">&lt;-</span> cash_damage_full <span class="sc">%&gt;%</span></span>
<span id="cb48-2087"><a href="#cb48-2087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-2088"><a href="#cb48-2088" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-2089"><a href="#cb48-2089" aria-hidden="true" tabindex="-1"></a>    total_households_affected,</span>
<span id="cb48-2090"><a href="#cb48-2090" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kava</span></span>
<span id="cb48-2091"><a href="#cb48-2091" aria-hidden="true" tabindex="-1"></a>    kava_households_damaged,</span>
<span id="cb48-2092"><a href="#cb48-2092" aria-hidden="true" tabindex="-1"></a>    kava_production_damaged,</span>
<span id="cb48-2093"><a href="#cb48-2093" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coconut</span></span>
<span id="cb48-2094"><a href="#cb48-2094" aria-hidden="true" tabindex="-1"></a>    coconut_households_damaged,</span>
<span id="cb48-2095"><a href="#cb48-2095" aria-hidden="true" tabindex="-1"></a>    coconut_production_damaged,</span>
<span id="cb48-2096"><a href="#cb48-2096" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cocoa</span></span>
<span id="cb48-2097"><a href="#cb48-2097" aria-hidden="true" tabindex="-1"></a>    cocoa_households_damaged,</span>
<span id="cb48-2098"><a href="#cb48-2098" aria-hidden="true" tabindex="-1"></a>    cocoa_production_damaged,</span>
<span id="cb48-2099"><a href="#cb48-2099" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coffee</span></span>
<span id="cb48-2100"><a href="#cb48-2100" aria-hidden="true" tabindex="-1"></a>    coffee_households_damaged,</span>
<span id="cb48-2101"><a href="#cb48-2101" aria-hidden="true" tabindex="-1"></a>    coffee_production_damaged,</span>
<span id="cb48-2102"><a href="#cb48-2102" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vanilla</span></span>
<span id="cb48-2103"><a href="#cb48-2103" aria-hidden="true" tabindex="-1"></a>    vanilla_households_damaged,</span>
<span id="cb48-2104"><a href="#cb48-2104" aria-hidden="true" tabindex="-1"></a>    vanilla_production_damaged,</span>
<span id="cb48-2105"><a href="#cb48-2105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tahitian Lime</span></span>
<span id="cb48-2106"><a href="#cb48-2106" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_households_damaged</span><span class="st">`</span>,</span>
<span id="cb48-2107"><a href="#cb48-2107" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_production_damaged</span><span class="st">`</span>,</span>
<span id="cb48-2108"><a href="#cb48-2108" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pepper</span></span>
<span id="cb48-2109"><a href="#cb48-2109" aria-hidden="true" tabindex="-1"></a>    pepper_households_damaged,</span>
<span id="cb48-2110"><a href="#cb48-2110" aria-hidden="true" tabindex="-1"></a>    pepper_production_damaged,</span>
<span id="cb48-2111"><a href="#cb48-2111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Noni</span></span>
<span id="cb48-2112"><a href="#cb48-2112" aria-hidden="true" tabindex="-1"></a>    noni_households_damaged,</span>
<span id="cb48-2113"><a href="#cb48-2113" aria-hidden="true" tabindex="-1"></a>    noni_production_damaged</span>
<span id="cb48-2114"><a href="#cb48-2114" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-2115"><a href="#cb48-2115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2116"><a href="#cb48-2116" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb48-2117"><a href="#cb48-2117" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-2118"><a href="#cb48-2118" aria-hidden="true" tabindex="-1"></a>  cash_damage_ordered,</span>
<span id="cb48-2119"><a href="#cb48-2119" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_02b_damage_cash_crops.csv"</span>),</span>
<span id="cb48-2120"><a href="#cb48-2120" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-2121"><a href="#cb48-2121" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2122"><a href="#cb48-2122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2123"><a href="#cb48-2123" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb48-2124"><a href="#cb48-2124" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(cash_damage_ordered)</span>
<span id="cb48-2125"><a href="#cb48-2125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2126"><a href="#cb48-2126" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-2127"><a href="#cb48-2127" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb48-2128"><a href="#cb48-2128" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-2129"><a href="#cb48-2129" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2130"><a href="#cb48-2130" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-2131"><a href="#cb48-2131" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-2132"><a href="#cb48-2132" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-2133"><a href="#cb48-2133" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2134"><a href="#cb48-2134" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2135"><a href="#cb48-2135" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households_affected =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2136"><a href="#cb48-2136" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2137"><a href="#cb48-2137" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Kava</span></span>
<span id="cb48-2138"><a href="#cb48-2138" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2139"><a href="#cb48-2139" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2140"><a href="#cb48-2140" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2141"><a href="#cb48-2141" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coconut</span></span>
<span id="cb48-2142"><a href="#cb48-2142" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2143"><a href="#cb48-2143" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2144"><a href="#cb48-2144" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2145"><a href="#cb48-2145" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cocoa</span></span>
<span id="cb48-2146"><a href="#cb48-2146" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2147"><a href="#cb48-2147" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2148"><a href="#cb48-2148" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2149"><a href="#cb48-2149" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Coffee</span></span>
<span id="cb48-2150"><a href="#cb48-2150" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2151"><a href="#cb48-2151" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2152"><a href="#cb48-2152" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2153"><a href="#cb48-2153" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Vanilla</span></span>
<span id="cb48-2154"><a href="#cb48-2154" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2155"><a href="#cb48-2155" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2156"><a href="#cb48-2156" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2157"><a href="#cb48-2157" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tahitian Lime</span></span>
<span id="cb48-2158"><a href="#cb48-2158" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_households_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2159"><a href="#cb48-2159" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">tahitian lime_production_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2160"><a href="#cb48-2160" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2161"><a href="#cb48-2161" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pepper</span></span>
<span id="cb48-2162"><a href="#cb48-2162" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2163"><a href="#cb48-2163" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2164"><a href="#cb48-2164" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2165"><a href="#cb48-2165" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Noni</span></span>
<span id="cb48-2166"><a href="#cb48-2166" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2167"><a href="#cb48-2167" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_production_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Production"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-2168"><a href="#cb48-2168" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2169"><a href="#cb48-2169" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-2170"><a href="#cb48-2170" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households_affected"</span>)),</span>
<span id="cb48-2171"><a href="#cb48-2171" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Kava"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"kava_households_damaged"</span>, <span class="st">"kava_production_damaged"</span>)),</span>
<span id="cb48-2172"><a href="#cb48-2172" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Coconut"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"coconut_households_damaged"</span>, <span class="st">"coconut_production_damaged"</span>)),</span>
<span id="cb48-2173"><a href="#cb48-2173" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Cocoa"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"cocoa_households_damaged"</span>, <span class="st">"cocoa_production_damaged"</span>)),</span>
<span id="cb48-2174"><a href="#cb48-2174" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Coffee"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"coffee_households_damaged"</span>, <span class="st">"coffee_production_damaged"</span>)),</span>
<span id="cb48-2175"><a href="#cb48-2175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Vanilla"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"vanilla_households_damaged"</span>, <span class="st">"vanilla_production_damaged"</span>)),</span>
<span id="cb48-2176"><a href="#cb48-2176" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Tahitian Lime"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"tahitian lime_households_damaged"</span>, <span class="st">"tahitian lime_production_damaged"</span>)),</span>
<span id="cb48-2177"><a href="#cb48-2177" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Pepper"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"pepper_households_damaged"</span>, <span class="st">"pepper_production_damaged"</span>)),</span>
<span id="cb48-2178"><a href="#cb48-2178" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Noni"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"noni_households_damaged"</span>, <span class="st">"noni_production_damaged"</span>))</span>
<span id="cb48-2179"><a href="#cb48-2179" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2180"><a href="#cb48-2180" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2181"><a href="#cb48-2181" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2182"><a href="#cb48-2182" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2183"><a href="#cb48-2183" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-2184"><a href="#cb48-2184" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-2185"><a href="#cb48-2185" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-2186"><a href="#cb48-2186" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2187"><a href="#cb48-2187" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-2188"><a href="#cb48-2188" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-2189"><a href="#cb48-2189" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2190"><a href="#cb48-2190" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-2191"><a href="#cb48-2191" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2192"><a href="#cb48-2192" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-2193"><a href="#cb48-2193" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2194"><a href="#cb48-2194" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2195"><a href="#cb48-2195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-2196"><a href="#cb48-2196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2197"><a href="#cb48-2197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2198"><a href="#cb48-2198" aria-hidden="true" tabindex="-1"></a><span class="fu">## Immediate Response Resources</span></span>
<span id="cb48-2199"><a href="#cb48-2199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2202"><a href="#cb48-2202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-2203"><a href="#cb48-2203" aria-hidden="true" tabindex="-1"></a><span class="do">## Resources needed for Food Security restoration</span></span>
<span id="cb48-2204"><a href="#cb48-2204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2205"><a href="#cb48-2205" aria-hidden="true" tabindex="-1"></a><span class="co"># === Staple Crops Resources ===</span></span>
<span id="cb48-2206"><a href="#cb48-2206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2207"><a href="#cb48-2207" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get resource multipliers</span></span>
<span id="cb48-2208"><a href="#cb48-2208" aria-hidden="true" tabindex="-1"></a>get_food_security_resource_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb48-2209"><a href="#cb48-2209" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb48-2210"><a href="#cb48-2210" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-2211"><a href="#cb48-2211" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Food Security"</span>,</span>
<span id="cb48-2212"><a href="#cb48-2212" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> resource_type,</span>
<span id="cb48-2213"><a href="#cb48-2213" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-2214"><a href="#cb48-2214" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2215"><a href="#cb48-2215" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-2216"><a href="#cb48-2216" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-2217"><a href="#cb48-2217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(multiplier) <span class="sc">&gt;</span> <span class="dv">0</span>, multiplier, <span class="dv">0</span>))</span>
<span id="cb48-2218"><a href="#cb48-2218" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-2219"><a href="#cb48-2219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2220"><a href="#cb48-2220" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate resources needed based on total affected households</span></span>
<span id="cb48-2221"><a href="#cb48-2221" aria-hidden="true" tabindex="-1"></a>resources_needed <span class="ot">&lt;-</span> staple_damage <span class="sc">%&gt;%</span></span>
<span id="cb48-2222"><a href="#cb48-2222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-2223"><a href="#cb48-2223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-2224"><a href="#cb48-2224" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Number of affected households (for the first column)</span></span>
<span id="cb48-2225"><a href="#cb48-2225" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_households_affected =</span> total_households_affected,</span>
<span id="cb48-2226"><a href="#cb48-2226" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2227"><a href="#cb48-2227" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Resources = total affected households * resource multiplier</span></span>
<span id="cb48-2228"><a href="#cb48-2228" aria-hidden="true" tabindex="-1"></a>    <span class="at">island_cabbage_cuttings =</span> <span class="fu">round</span>(total_households_affected <span class="sc">*</span> <span class="fu">get_food_security_resource_multiplier</span>(<span class="st">"Island Cabbage Cuttings"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb48-2229"><a href="#cb48-2229" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_seedlings =</span> <span class="fu">round</span>(total_households_affected <span class="sc">*</span> <span class="fu">get_food_security_resource_multiplier</span>(<span class="st">"Taro Seedlings"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb48-2230"><a href="#cb48-2230" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_cuttings =</span> <span class="fu">round</span>(total_households_affected <span class="sc">*</span> <span class="fu">get_food_security_resource_multiplier</span>(<span class="st">"Kumala Cuttings"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb48-2231"><a href="#cb48-2231" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_cuttings =</span> <span class="fu">round</span>(total_households_affected <span class="sc">*</span> <span class="fu">get_food_security_resource_multiplier</span>(<span class="st">"Manioc Cuttings"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb48-2232"><a href="#cb48-2232" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_cuttings =</span> <span class="fu">round</span>(total_households_affected <span class="sc">*</span> <span class="fu">get_food_security_resource_multiplier</span>(<span class="st">"Yam Cuttings"</span>, Region), <span class="dv">0</span>)</span>
<span id="cb48-2233"><a href="#cb48-2233" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2234"><a href="#cb48-2234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-2235"><a href="#cb48-2235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, num_households_affected, island_cabbage_cuttings, taro_seedlings, kumala_cuttings, manioc_cuttings, yam_cuttings)</span>
<span id="cb48-2236"><a href="#cb48-2236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2237"><a href="#cb48-2237" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-2238"><a href="#cb48-2238" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(resources_needed)</span>
<span id="cb48-2239"><a href="#cb48-2239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2240"><a href="#cb48-2240" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-2241"><a href="#cb48-2241" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-2242"><a href="#cb48-2242" aria-hidden="true" tabindex="-1"></a>  resources_needed_full,</span>
<span id="cb48-2243"><a href="#cb48-2243" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_03_resources_needed.csv"</span>),</span>
<span id="cb48-2244"><a href="#cb48-2244" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-2245"><a href="#cb48-2245" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2246"><a href="#cb48-2246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2247"><a href="#cb48-2247" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-2248"><a href="#cb48-2248" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb48-2249"><a href="#cb48-2249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2250"><a href="#cb48-2250" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-2251"><a href="#cb48-2251" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-2252"><a href="#cb48-2252" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-2253"><a href="#cb48-2253" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2254"><a href="#cb48-2254" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-2255"><a href="#cb48-2255" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-2256"><a href="#cb48-2256" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-2257"><a href="#cb48-2257" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2258"><a href="#cb48-2258" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2259"><a href="#cb48-2259" aria-hidden="true" tabindex="-1"></a>    <span class="at">num_households_affected =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2260"><a href="#cb48-2260" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Number of Households"</span>, </span>
<span id="cb48-2261"><a href="#cb48-2261" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2262"><a href="#cb48-2262" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2263"><a href="#cb48-2263" aria-hidden="true" tabindex="-1"></a>    <span class="at">island_cabbage_cuttings =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2264"><a href="#cb48-2264" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Island Cabbage Cuttings"</span>, </span>
<span id="cb48-2265"><a href="#cb48-2265" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2266"><a href="#cb48-2266" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2267"><a href="#cb48-2267" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_seedlings =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2268"><a href="#cb48-2268" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Taro Seedlings"</span>, </span>
<span id="cb48-2269"><a href="#cb48-2269" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2270"><a href="#cb48-2270" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2271"><a href="#cb48-2271" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_cuttings =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2272"><a href="#cb48-2272" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Kumala Cuttings"</span>, </span>
<span id="cb48-2273"><a href="#cb48-2273" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2274"><a href="#cb48-2274" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2275"><a href="#cb48-2275" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_cuttings =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2276"><a href="#cb48-2276" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Manioc Cuttings"</span>, </span>
<span id="cb48-2277"><a href="#cb48-2277" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2278"><a href="#cb48-2278" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2279"><a href="#cb48-2279" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_cuttings =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2280"><a href="#cb48-2280" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Yam Cuttings"</span>, </span>
<span id="cb48-2281"><a href="#cb48-2281" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2282"><a href="#cb48-2282" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-2283"><a href="#cb48-2283" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2284"><a href="#cb48-2284" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-2285"><a href="#cb48-2285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-2286"><a href="#cb48-2286" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Staple Crops Resources"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"num_households_affected"</span>, <span class="st">"island_cabbage_cuttings"</span>, <span class="st">"taro_seedlings"</span>, <span class="st">"kumala_cuttings"</span>, <span class="st">"manioc_cuttings"</span>, <span class="st">"yam_cuttings"</span>))</span>
<span id="cb48-2287"><a href="#cb48-2287" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2288"><a href="#cb48-2288" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2289"><a href="#cb48-2289" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2290"><a href="#cb48-2290" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2291"><a href="#cb48-2291" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-2292"><a href="#cb48-2292" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-2293"><a href="#cb48-2293" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-2294"><a href="#cb48-2294" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2295"><a href="#cb48-2295" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-2296"><a href="#cb48-2296" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-2297"><a href="#cb48-2297" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2298"><a href="#cb48-2298" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-2299"><a href="#cb48-2299" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2300"><a href="#cb48-2300" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-2301"><a href="#cb48-2301" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2302"><a href="#cb48-2302" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2303"><a href="#cb48-2303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-2304"><a href="#cb48-2304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2305"><a href="#cb48-2305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2306"><a href="#cb48-2306" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimated Financial Damage </span></span>
<span id="cb48-2307"><a href="#cb48-2307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2308"><a href="#cb48-2308" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 1: Staple Crops Financial Damage</span></span>
<span id="cb48-2309"><a href="#cb48-2309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2312"><a href="#cb48-2312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-2313"><a href="#cb48-2313" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for food security</span></span>
<span id="cb48-2314"><a href="#cb48-2314" aria-hidden="true" tabindex="-1"></a>get_food_security_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(indicator_type, crop_type, area_council) {</span>
<span id="cb48-2315"><a href="#cb48-2315" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb48-2316"><a href="#cb48-2316" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-2317"><a href="#cb48-2317" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Food Security"</span>,</span>
<span id="cb48-2318"><a href="#cb48-2318" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator_type,</span>
<span id="cb48-2319"><a href="#cb48-2319" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(crop_type)),</span>
<span id="cb48-2320"><a href="#cb48-2320" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-2321"><a href="#cb48-2321" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2322"><a href="#cb48-2322" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-2323"><a href="#cb48-2323" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-2324"><a href="#cb48-2324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb48-2325"><a href="#cb48-2325" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-2326"><a href="#cb48-2326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2327"><a href="#cb48-2327" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate staple crops financial damage</span></span>
<span id="cb48-2328"><a href="#cb48-2328" aria-hidden="true" tabindex="-1"></a>staple_financial <span class="ot">&lt;-</span> staple_damage <span class="sc">%&gt;%</span></span>
<span id="cb48-2329"><a href="#cb48-2329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-2330"><a href="#cb48-2330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-2331"><a href="#cb48-2331" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each crop (damaged production * unit cost)</span></span>
<span id="cb48-2332"><a href="#cb48-2332" aria-hidden="true" tabindex="-1"></a>    <span class="at">island_cabbage_financial =</span> <span class="st">`</span><span class="at">island cabbage_production_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"island cabbage"</span>, Region),</span>
<span id="cb48-2333"><a href="#cb48-2333" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_financial =</span> banana_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"banana"</span>, Region),</span>
<span id="cb48-2334"><a href="#cb48-2334" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_financial =</span> taro_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"taro"</span>, Region),</span>
<span id="cb48-2335"><a href="#cb48-2335" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_financial =</span> kumala_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"kumala"</span>, Region),</span>
<span id="cb48-2336"><a href="#cb48-2336" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_financial =</span> manioc_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"manioc"</span>, Region),</span>
<span id="cb48-2337"><a href="#cb48-2337" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_financial =</span> yam_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Staple Crop Production"</span>, <span class="st">"yam"</span>, Region),</span>
<span id="cb48-2338"><a href="#cb48-2338" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2339"><a href="#cb48-2339" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total staple crops financial damage</span></span>
<span id="cb48-2340"><a href="#cb48-2340" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_staple_financial =</span> island_cabbage_financial <span class="sc">+</span> banana_financial <span class="sc">+</span> taro_financial <span class="sc">+</span> </span>
<span id="cb48-2341"><a href="#cb48-2341" aria-hidden="true" tabindex="-1"></a>                             kumala_financial <span class="sc">+</span> manioc_financial <span class="sc">+</span> yam_financial</span>
<span id="cb48-2342"><a href="#cb48-2342" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2343"><a href="#cb48-2343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-2344"><a href="#cb48-2344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_staple_financial, island_cabbage_financial, banana_financial, </span>
<span id="cb48-2345"><a href="#cb48-2345" aria-hidden="true" tabindex="-1"></a>         taro_financial, kumala_financial, manioc_financial, yam_financial)</span>
<span id="cb48-2346"><a href="#cb48-2346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2347"><a href="#cb48-2347" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-2348"><a href="#cb48-2348" aria-hidden="true" tabindex="-1"></a>staple_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(staple_financial)</span>
<span id="cb48-2349"><a href="#cb48-2349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2350"><a href="#cb48-2350" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-2351"><a href="#cb48-2351" aria-hidden="true" tabindex="-1"></a>staple_financial_ordered <span class="ot">&lt;-</span> staple_financial_full <span class="sc">%&gt;%</span></span>
<span id="cb48-2352"><a href="#cb48-2352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_staple_financial, island_cabbage_financial, banana_financial, </span>
<span id="cb48-2353"><a href="#cb48-2353" aria-hidden="true" tabindex="-1"></a>         taro_financial, kumala_financial, manioc_financial, yam_financial)</span>
<span id="cb48-2354"><a href="#cb48-2354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2355"><a href="#cb48-2355" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb48-2356"><a href="#cb48-2356" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-2357"><a href="#cb48-2357" aria-hidden="true" tabindex="-1"></a>  staple_financial_ordered,</span>
<span id="cb48-2358"><a href="#cb48-2358" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_04a_financial_damage_staple_crops.csv"</span>),</span>
<span id="cb48-2359"><a href="#cb48-2359" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-2360"><a href="#cb48-2360" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2361"><a href="#cb48-2361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2362"><a href="#cb48-2362" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb48-2363"><a href="#cb48-2363" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(staple_financial_ordered)</span>
<span id="cb48-2364"><a href="#cb48-2364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2365"><a href="#cb48-2365" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-2366"><a href="#cb48-2366" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb48-2367"><a href="#cb48-2367" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-2368"><a href="#cb48-2368" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2369"><a href="#cb48-2369" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-2370"><a href="#cb48-2370" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-2371"><a href="#cb48-2371" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-2372"><a href="#cb48-2372" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2373"><a href="#cb48-2373" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2374"><a href="#cb48-2374" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_staple_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2375"><a href="#cb48-2375" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb48-2376"><a href="#cb48-2376" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2377"><a href="#cb48-2377" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2378"><a href="#cb48-2378" aria-hidden="true" tabindex="-1"></a>    <span class="at">island_cabbage_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2379"><a href="#cb48-2379" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Island Cabbage"</span>,</span>
<span id="cb48-2380"><a href="#cb48-2380" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2381"><a href="#cb48-2381" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2382"><a href="#cb48-2382" aria-hidden="true" tabindex="-1"></a>    <span class="at">banana_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2383"><a href="#cb48-2383" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Banana"</span>,</span>
<span id="cb48-2384"><a href="#cb48-2384" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2385"><a href="#cb48-2385" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2386"><a href="#cb48-2386" aria-hidden="true" tabindex="-1"></a>    <span class="at">taro_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2387"><a href="#cb48-2387" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Taro"</span>,</span>
<span id="cb48-2388"><a href="#cb48-2388" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2389"><a href="#cb48-2389" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2390"><a href="#cb48-2390" aria-hidden="true" tabindex="-1"></a>    <span class="at">kumala_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2391"><a href="#cb48-2391" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Kumala"</span>,</span>
<span id="cb48-2392"><a href="#cb48-2392" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2393"><a href="#cb48-2393" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2394"><a href="#cb48-2394" aria-hidden="true" tabindex="-1"></a>    <span class="at">manioc_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2395"><a href="#cb48-2395" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Manioc"</span>,</span>
<span id="cb48-2396"><a href="#cb48-2396" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2397"><a href="#cb48-2397" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2398"><a href="#cb48-2398" aria-hidden="true" tabindex="-1"></a>    <span class="at">yam_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2399"><a href="#cb48-2399" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Yam"</span>,</span>
<span id="cb48-2400"><a href="#cb48-2400" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2401"><a href="#cb48-2401" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-2402"><a href="#cb48-2402" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2403"><a href="#cb48-2403" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-2404"><a href="#cb48-2404" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-2405"><a href="#cb48-2405" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Staple Crops Financial Damage (VT)"</span>, </span>
<span id="cb48-2406"><a href="#cb48-2406" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_staple_financial"</span>, <span class="st">"island_cabbage_financial"</span>, <span class="st">"banana_financial"</span>, </span>
<span id="cb48-2407"><a href="#cb48-2407" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"taro_financial"</span>, <span class="st">"kumala_financial"</span>, <span class="st">"manioc_financial"</span>, <span class="st">"yam_financial"</span>))</span>
<span id="cb48-2408"><a href="#cb48-2408" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2409"><a href="#cb48-2409" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2410"><a href="#cb48-2410" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2411"><a href="#cb48-2411" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2412"><a href="#cb48-2412" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-2413"><a href="#cb48-2413" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-2414"><a href="#cb48-2414" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-2415"><a href="#cb48-2415" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2416"><a href="#cb48-2416" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-2417"><a href="#cb48-2417" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-2418"><a href="#cb48-2418" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2419"><a href="#cb48-2419" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-2420"><a href="#cb48-2420" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2421"><a href="#cb48-2421" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-2422"><a href="#cb48-2422" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2423"><a href="#cb48-2423" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2424"><a href="#cb48-2424" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-2425"><a href="#cb48-2425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2426"><a href="#cb48-2426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2427"><a href="#cb48-2427" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 2: Cash Crops Financial Damage</span></span>
<span id="cb48-2428"><a href="#cb48-2428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2429"><a href="#cb48-2429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2432"><a href="#cb48-2432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-2433"><a href="#cb48-2433" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate cash crops financial damage</span></span>
<span id="cb48-2434"><a href="#cb48-2434" aria-hidden="true" tabindex="-1"></a>cash_financial <span class="ot">&lt;-</span> cash_damage <span class="sc">%&gt;%</span></span>
<span id="cb48-2435"><a href="#cb48-2435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-2436"><a href="#cb48-2436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-2437"><a href="#cb48-2437" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each crop (damaged production * unit cost)</span></span>
<span id="cb48-2438"><a href="#cb48-2438" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_financial =</span> kava_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"kava"</span>, Region),</span>
<span id="cb48-2439"><a href="#cb48-2439" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_financial =</span> coconut_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"coconut"</span>, Region),</span>
<span id="cb48-2440"><a href="#cb48-2440" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_financial =</span> cocoa_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"cocoa"</span>, Region),</span>
<span id="cb48-2441"><a href="#cb48-2441" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_financial =</span> coffee_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"coffee"</span>, Region),</span>
<span id="cb48-2442"><a href="#cb48-2442" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_financial =</span> vanilla_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"vanilla"</span>, Region),</span>
<span id="cb48-2443"><a href="#cb48-2443" aria-hidden="true" tabindex="-1"></a>    <span class="at">tahitian_lime_financial =</span> <span class="st">`</span><span class="at">tahitian lime_production_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"tahitian lime"</span>, Region),</span>
<span id="cb48-2444"><a href="#cb48-2444" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_financial =</span> pepper_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"pepper"</span>, Region),</span>
<span id="cb48-2445"><a href="#cb48-2445" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_financial =</span> noni_production_damaged <span class="sc">*</span> <span class="fu">get_food_security_unit_cost</span>(<span class="st">"Cash Crop Production"</span>, <span class="st">"noni"</span>, Region),</span>
<span id="cb48-2446"><a href="#cb48-2446" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2447"><a href="#cb48-2447" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total cash crops financial damage</span></span>
<span id="cb48-2448"><a href="#cb48-2448" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_cash_financial =</span> kava_financial <span class="sc">+</span> coconut_financial <span class="sc">+</span> cocoa_financial <span class="sc">+</span> </span>
<span id="cb48-2449"><a href="#cb48-2449" aria-hidden="true" tabindex="-1"></a>                           coffee_financial <span class="sc">+</span> vanilla_financial <span class="sc">+</span> tahitian_lime_financial <span class="sc">+</span> </span>
<span id="cb48-2450"><a href="#cb48-2450" aria-hidden="true" tabindex="-1"></a>                           pepper_financial <span class="sc">+</span> noni_financial</span>
<span id="cb48-2451"><a href="#cb48-2451" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2452"><a href="#cb48-2452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-2453"><a href="#cb48-2453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_cash_financial, kava_financial, coconut_financial, cocoa_financial,</span>
<span id="cb48-2454"><a href="#cb48-2454" aria-hidden="true" tabindex="-1"></a>         coffee_financial, vanilla_financial, tahitian_lime_financial, pepper_financial, noni_financial)</span>
<span id="cb48-2455"><a href="#cb48-2455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2456"><a href="#cb48-2456" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-2457"><a href="#cb48-2457" aria-hidden="true" tabindex="-1"></a>cash_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(cash_financial)</span>
<span id="cb48-2458"><a href="#cb48-2458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2459"><a href="#cb48-2459" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-2460"><a href="#cb48-2460" aria-hidden="true" tabindex="-1"></a>cash_financial_ordered <span class="ot">&lt;-</span> cash_financial_full <span class="sc">%&gt;%</span></span>
<span id="cb48-2461"><a href="#cb48-2461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_cash_financial, kava_financial, coconut_financial, cocoa_financial,</span>
<span id="cb48-2462"><a href="#cb48-2462" aria-hidden="true" tabindex="-1"></a>         coffee_financial, vanilla_financial, tahitian_lime_financial, pepper_financial, noni_financial)</span>
<span id="cb48-2463"><a href="#cb48-2463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2464"><a href="#cb48-2464" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb48-2465"><a href="#cb48-2465" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-2466"><a href="#cb48-2466" aria-hidden="true" tabindex="-1"></a>  cash_financial_ordered,</span>
<span id="cb48-2467"><a href="#cb48-2467" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"FoodSecurity_04b_financial_damage_cash_crops.csv"</span>),</span>
<span id="cb48-2468"><a href="#cb48-2468" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-2469"><a href="#cb48-2469" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2470"><a href="#cb48-2470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2471"><a href="#cb48-2471" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb48-2472"><a href="#cb48-2472" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(cash_financial_ordered)</span>
<span id="cb48-2473"><a href="#cb48-2473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2474"><a href="#cb48-2474" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-2475"><a href="#cb48-2475" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb48-2476"><a href="#cb48-2476" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-2477"><a href="#cb48-2477" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2478"><a href="#cb48-2478" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-2479"><a href="#cb48-2479" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-2480"><a href="#cb48-2480" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-2481"><a href="#cb48-2481" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2482"><a href="#cb48-2482" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2483"><a href="#cb48-2483" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_cash_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2484"><a href="#cb48-2484" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb48-2485"><a href="#cb48-2485" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2486"><a href="#cb48-2486" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2487"><a href="#cb48-2487" aria-hidden="true" tabindex="-1"></a>    <span class="at">kava_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2488"><a href="#cb48-2488" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Kava"</span>,</span>
<span id="cb48-2489"><a href="#cb48-2489" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2490"><a href="#cb48-2490" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2491"><a href="#cb48-2491" aria-hidden="true" tabindex="-1"></a>    <span class="at">coconut_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2492"><a href="#cb48-2492" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Coconut"</span>,</span>
<span id="cb48-2493"><a href="#cb48-2493" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2494"><a href="#cb48-2494" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2495"><a href="#cb48-2495" aria-hidden="true" tabindex="-1"></a>    <span class="at">cocoa_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2496"><a href="#cb48-2496" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Cocoa"</span>,</span>
<span id="cb48-2497"><a href="#cb48-2497" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2498"><a href="#cb48-2498" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2499"><a href="#cb48-2499" aria-hidden="true" tabindex="-1"></a>    <span class="at">coffee_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2500"><a href="#cb48-2500" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Coffee"</span>,</span>
<span id="cb48-2501"><a href="#cb48-2501" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2502"><a href="#cb48-2502" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2503"><a href="#cb48-2503" aria-hidden="true" tabindex="-1"></a>    <span class="at">vanilla_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2504"><a href="#cb48-2504" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Vanilla"</span>,</span>
<span id="cb48-2505"><a href="#cb48-2505" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2506"><a href="#cb48-2506" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2507"><a href="#cb48-2507" aria-hidden="true" tabindex="-1"></a>    <span class="at">tahitian_lime_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2508"><a href="#cb48-2508" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Tahitian Lime"</span>,</span>
<span id="cb48-2509"><a href="#cb48-2509" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2510"><a href="#cb48-2510" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2511"><a href="#cb48-2511" aria-hidden="true" tabindex="-1"></a>    <span class="at">pepper_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2512"><a href="#cb48-2512" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Pepper"</span>,</span>
<span id="cb48-2513"><a href="#cb48-2513" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2514"><a href="#cb48-2514" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2515"><a href="#cb48-2515" aria-hidden="true" tabindex="-1"></a>    <span class="at">noni_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2516"><a href="#cb48-2516" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Noni"</span>,</span>
<span id="cb48-2517"><a href="#cb48-2517" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2518"><a href="#cb48-2518" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-2519"><a href="#cb48-2519" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2520"><a href="#cb48-2520" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-2521"><a href="#cb48-2521" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-2522"><a href="#cb48-2522" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Cash Crops Financial Damage (VT)"</span>, </span>
<span id="cb48-2523"><a href="#cb48-2523" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_cash_financial"</span>, <span class="st">"kava_financial"</span>, <span class="st">"coconut_financial"</span>, <span class="st">"cocoa_financial"</span>,</span>
<span id="cb48-2524"><a href="#cb48-2524" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"coffee_financial"</span>, <span class="st">"vanilla_financial"</span>, <span class="st">"tahitian_lime_financial"</span>, </span>
<span id="cb48-2525"><a href="#cb48-2525" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"pepper_financial"</span>, <span class="st">"noni_financial"</span>))</span>
<span id="cb48-2526"><a href="#cb48-2526" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2527"><a href="#cb48-2527" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2528"><a href="#cb48-2528" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2529"><a href="#cb48-2529" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2530"><a href="#cb48-2530" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-2531"><a href="#cb48-2531" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-2532"><a href="#cb48-2532" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-2533"><a href="#cb48-2533" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2534"><a href="#cb48-2534" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-2535"><a href="#cb48-2535" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-2536"><a href="#cb48-2536" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2537"><a href="#cb48-2537" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-2538"><a href="#cb48-2538" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2539"><a href="#cb48-2539" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-2540"><a href="#cb48-2540" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2541"><a href="#cb48-2541" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2542"><a href="#cb48-2542" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-2543"><a href="#cb48-2543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2544"><a href="#cb48-2544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2545"><a href="#cb48-2545" aria-hidden="true" tabindex="-1"></a><span class="fu"># Gender &amp; Protection </span></span>
<span id="cb48-2546"><a href="#cb48-2546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2547"><a href="#cb48-2547" aria-hidden="true" tabindex="-1"></a><span class="fu">## Baseline : Gender &amp; Protection </span></span>
<span id="cb48-2548"><a href="#cb48-2548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2549"><a href="#cb48-2549" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 1: Population by Sex and Age</span></span>
<span id="cb48-2550"><a href="#cb48-2550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2553"><a href="#cb48-2553" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-2554"><a href="#cb48-2554" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-2555"><a href="#cb48-2555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2556"><a href="#cb48-2556" aria-hidden="true" tabindex="-1"></a><span class="co"># Get total population from the data</span></span>
<span id="cb48-2557"><a href="#cb48-2557" aria-hidden="true" tabindex="-1"></a>total_population <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-2558"><a href="#cb48-2558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2559"><a href="#cb48-2559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2560"><a href="#cb48-2560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2561"><a href="#cb48-2561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Population Sex"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2562"><a href="#cb48-2562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2563"><a href="#cb48-2563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region) <span class="sc">%&gt;%</span></span>
<span id="cb48-2564"><a href="#cb48-2564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_population =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb48-2565"><a href="#cb48-2565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2566"><a href="#cb48-2566" aria-hidden="true" tabindex="-1"></a><span class="co"># Get population by sex</span></span>
<span id="cb48-2567"><a href="#cb48-2567" aria-hidden="true" tabindex="-1"></a>population_sex <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-2568"><a href="#cb48-2568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2569"><a href="#cb48-2569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2570"><a href="#cb48-2570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2571"><a href="#cb48-2571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Population Sex"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2572"><a href="#cb48-2572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2573"><a href="#cb48-2573" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-2574"><a href="#cb48-2574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2575"><a href="#cb48-2575" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape sex data</span></span>
<span id="cb48-2576"><a href="#cb48-2576" aria-hidden="true" tabindex="-1"></a>sex_wide <span class="ot">&lt;-</span> population_sex <span class="sc">%&gt;%</span></span>
<span id="cb48-2577"><a href="#cb48-2577" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-2578"><a href="#cb48-2578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, sex) <span class="sc">%&gt;%</span></span>
<span id="cb48-2579"><a href="#cb48-2579" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2580"><a href="#cb48-2580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-2581"><a href="#cb48-2581" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> sex,</span>
<span id="cb48-2582"><a href="#cb48-2582" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-2583"><a href="#cb48-2583" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"sex_"</span></span>
<span id="cb48-2584"><a href="#cb48-2584" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2585"><a href="#cb48-2585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-2586"><a href="#cb48-2586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2587"><a href="#cb48-2587" aria-hidden="true" tabindex="-1"></a><span class="co"># Get population by age</span></span>
<span id="cb48-2588"><a href="#cb48-2588" aria-hidden="true" tabindex="-1"></a>population_age <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-2589"><a href="#cb48-2589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2590"><a href="#cb48-2590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2591"><a href="#cb48-2591" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2592"><a href="#cb48-2592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Population Age"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2593"><a href="#cb48-2593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2594"><a href="#cb48-2594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-2595"><a href="#cb48-2595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2596"><a href="#cb48-2596" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape age data</span></span>
<span id="cb48-2597"><a href="#cb48-2597" aria-hidden="true" tabindex="-1"></a>age_wide <span class="ot">&lt;-</span> population_age <span class="sc">%&gt;%</span></span>
<span id="cb48-2598"><a href="#cb48-2598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_group =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-2599"><a href="#cb48-2599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, age_group) <span class="sc">%&gt;%</span></span>
<span id="cb48-2600"><a href="#cb48-2600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2601"><a href="#cb48-2601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-2602"><a href="#cb48-2602" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> age_group,</span>
<span id="cb48-2603"><a href="#cb48-2603" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-2604"><a href="#cb48-2604" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"age_"</span></span>
<span id="cb48-2605"><a href="#cb48-2605" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2606"><a href="#cb48-2606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-2607"><a href="#cb48-2607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2608"><a href="#cb48-2608" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all population data</span></span>
<span id="cb48-2609"><a href="#cb48-2609" aria-hidden="true" tabindex="-1"></a>population_full <span class="ot">&lt;-</span> total_population <span class="sc">%&gt;%</span></span>
<span id="cb48-2610"><a href="#cb48-2610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sex_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2611"><a href="#cb48-2611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(age_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2612"><a href="#cb48-2612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-2613"><a href="#cb48-2613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2614"><a href="#cb48-2614" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-2615"><a href="#cb48-2615" aria-hidden="true" tabindex="-1"></a>population_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(population_full)</span>
<span id="cb48-2616"><a href="#cb48-2616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2617"><a href="#cb48-2617" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-2618"><a href="#cb48-2618" aria-hidden="true" tabindex="-1"></a>population_ordered <span class="ot">&lt;-</span> population_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-2619"><a href="#cb48-2619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-2620"><a href="#cb48-2620" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-2621"><a href="#cb48-2621" aria-hidden="true" tabindex="-1"></a>    total_population,</span>
<span id="cb48-2622"><a href="#cb48-2622" aria-hidden="true" tabindex="-1"></a>    sex_male,</span>
<span id="cb48-2623"><a href="#cb48-2623" aria-hidden="true" tabindex="-1"></a>    sex_female,</span>
<span id="cb48-2624"><a href="#cb48-2624" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_0-4</span><span class="st">`</span>,</span>
<span id="cb48-2625"><a href="#cb48-2625" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_5-11</span><span class="st">`</span>,</span>
<span id="cb48-2626"><a href="#cb48-2626" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_12-18</span><span class="st">`</span>,</span>
<span id="cb48-2627"><a href="#cb48-2627" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_19-35</span><span class="st">`</span>,</span>
<span id="cb48-2628"><a href="#cb48-2628" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_36-54</span><span class="st">`</span>,</span>
<span id="cb48-2629"><a href="#cb48-2629" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_55+</span><span class="st">`</span></span>
<span id="cb48-2630"><a href="#cb48-2630" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-2631"><a href="#cb48-2631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2632"><a href="#cb48-2632" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb48-2633"><a href="#cb48-2633" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-2634"><a href="#cb48-2634" aria-hidden="true" tabindex="-1"></a>  population_ordered,</span>
<span id="cb48-2635"><a href="#cb48-2635" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"GenderProtection_01a_baseline_population.csv"</span>),</span>
<span id="cb48-2636"><a href="#cb48-2636" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-2637"><a href="#cb48-2637" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2638"><a href="#cb48-2638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2639"><a href="#cb48-2639" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb48-2640"><a href="#cb48-2640" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(population_ordered)</span>
<span id="cb48-2641"><a href="#cb48-2641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2642"><a href="#cb48-2642" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-2643"><a href="#cb48-2643" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb48-2644"><a href="#cb48-2644" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-2645"><a href="#cb48-2645" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2646"><a href="#cb48-2646" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-2647"><a href="#cb48-2647" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-2648"><a href="#cb48-2648" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-2649"><a href="#cb48-2649" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2650"><a href="#cb48-2650" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2651"><a href="#cb48-2651" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_population =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2652"><a href="#cb48-2652" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex_male =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Male"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2653"><a href="#cb48-2653" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex_female =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Female"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2654"><a href="#cb48-2654" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_0-4</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"0-4"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2655"><a href="#cb48-2655" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_5-11</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"5-11"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2656"><a href="#cb48-2656" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_12-18</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"12-18"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2657"><a href="#cb48-2657" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_19-35</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"19-35"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2658"><a href="#cb48-2658" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_36-54</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"36-54"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2659"><a href="#cb48-2659" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">age_55+</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"55+"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-2660"><a href="#cb48-2660" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2661"><a href="#cb48-2661" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-2662"><a href="#cb48-2662" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Population"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_population"</span>)),</span>
<span id="cb48-2663"><a href="#cb48-2663" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Sex"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"sex_male"</span>, <span class="st">"sex_female"</span>)),</span>
<span id="cb48-2664"><a href="#cb48-2664" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Age Group"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"age_0-4"</span>, <span class="st">"age_5-11"</span>, <span class="st">"age_12-18"</span>, <span class="st">"age_19-35"</span>, <span class="st">"age_36-54"</span>, <span class="st">"age_55+"</span>))</span>
<span id="cb48-2665"><a href="#cb48-2665" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2666"><a href="#cb48-2666" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2667"><a href="#cb48-2667" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2668"><a href="#cb48-2668" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2669"><a href="#cb48-2669" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-2670"><a href="#cb48-2670" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-2671"><a href="#cb48-2671" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-2672"><a href="#cb48-2672" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2673"><a href="#cb48-2673" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-2674"><a href="#cb48-2674" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-2675"><a href="#cb48-2675" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2676"><a href="#cb48-2676" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-2677"><a href="#cb48-2677" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2678"><a href="#cb48-2678" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-2679"><a href="#cb48-2679" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2680"><a href="#cb48-2680" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2681"><a href="#cb48-2681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-2682"><a href="#cb48-2682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2683"><a href="#cb48-2683" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 2: Marital Status</span></span>
<span id="cb48-2684"><a href="#cb48-2684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2687"><a href="#cb48-2687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-2688"><a href="#cb48-2688" aria-hidden="true" tabindex="-1"></a><span class="co"># Get marital status data</span></span>
<span id="cb48-2689"><a href="#cb48-2689" aria-hidden="true" tabindex="-1"></a>marital_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-2690"><a href="#cb48-2690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2691"><a href="#cb48-2691" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2692"><a href="#cb48-2692" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2693"><a href="#cb48-2693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Marital Status"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2694"><a href="#cb48-2694" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2695"><a href="#cb48-2695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-2696"><a href="#cb48-2696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2697"><a href="#cb48-2697" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape marital status data</span></span>
<span id="cb48-2698"><a href="#cb48-2698" aria-hidden="true" tabindex="-1"></a>marital_wide <span class="ot">&lt;-</span> marital_data <span class="sc">%&gt;%</span></span>
<span id="cb48-2699"><a href="#cb48-2699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-2700"><a href="#cb48-2700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, status) <span class="sc">%&gt;%</span></span>
<span id="cb48-2701"><a href="#cb48-2701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2702"><a href="#cb48-2702" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-2703"><a href="#cb48-2703" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> status,</span>
<span id="cb48-2704"><a href="#cb48-2704" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-2705"><a href="#cb48-2705" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"marital_"</span></span>
<span id="cb48-2706"><a href="#cb48-2706" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2707"><a href="#cb48-2707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-2708"><a href="#cb48-2708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2709"><a href="#cb48-2709" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with total population</span></span>
<span id="cb48-2710"><a href="#cb48-2710" aria-hidden="true" tabindex="-1"></a>marital_full <span class="ot">&lt;-</span> total_population <span class="sc">%&gt;%</span></span>
<span id="cb48-2711"><a href="#cb48-2711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(marital_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2712"><a href="#cb48-2712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-2713"><a href="#cb48-2713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2714"><a href="#cb48-2714" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-2715"><a href="#cb48-2715" aria-hidden="true" tabindex="-1"></a>marital_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(marital_full)</span>
<span id="cb48-2716"><a href="#cb48-2716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2717"><a href="#cb48-2717" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-2718"><a href="#cb48-2718" aria-hidden="true" tabindex="-1"></a>marital_ordered <span class="ot">&lt;-</span> marital_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-2719"><a href="#cb48-2719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-2720"><a href="#cb48-2720" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-2721"><a href="#cb48-2721" aria-hidden="true" tabindex="-1"></a>    total_population,</span>
<span id="cb48-2722"><a href="#cb48-2722" aria-hidden="true" tabindex="-1"></a>    marital_defacto,</span>
<span id="cb48-2723"><a href="#cb48-2723" aria-hidden="true" tabindex="-1"></a>    marital_married,</span>
<span id="cb48-2724"><a href="#cb48-2724" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">marital_never married</span><span class="st">`</span>,</span>
<span id="cb48-2725"><a href="#cb48-2725" aria-hidden="true" tabindex="-1"></a>    marital_separated,</span>
<span id="cb48-2726"><a href="#cb48-2726" aria-hidden="true" tabindex="-1"></a>    marital_widowed</span>
<span id="cb48-2727"><a href="#cb48-2727" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-2728"><a href="#cb48-2728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2729"><a href="#cb48-2729" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb48-2730"><a href="#cb48-2730" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-2731"><a href="#cb48-2731" aria-hidden="true" tabindex="-1"></a>  marital_ordered,</span>
<span id="cb48-2732"><a href="#cb48-2732" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"GenderProtection_01b_baseline_marital_status.csv"</span>),</span>
<span id="cb48-2733"><a href="#cb48-2733" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-2734"><a href="#cb48-2734" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2735"><a href="#cb48-2735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2736"><a href="#cb48-2736" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb48-2737"><a href="#cb48-2737" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(marital_ordered)</span>
<span id="cb48-2738"><a href="#cb48-2738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2739"><a href="#cb48-2739" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-2740"><a href="#cb48-2740" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb48-2741"><a href="#cb48-2741" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-2742"><a href="#cb48-2742" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2743"><a href="#cb48-2743" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-2744"><a href="#cb48-2744" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-2745"><a href="#cb48-2745" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-2746"><a href="#cb48-2746" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2747"><a href="#cb48-2747" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2748"><a href="#cb48-2748" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_population =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2749"><a href="#cb48-2749" aria-hidden="true" tabindex="-1"></a>    <span class="at">marital_defacto =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Defacto"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2750"><a href="#cb48-2750" aria-hidden="true" tabindex="-1"></a>    <span class="at">marital_married =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Married"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2751"><a href="#cb48-2751" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">marital_never married</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Never Married"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2752"><a href="#cb48-2752" aria-hidden="true" tabindex="-1"></a>    <span class="at">marital_separated =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Separated"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2753"><a href="#cb48-2753" aria-hidden="true" tabindex="-1"></a>    <span class="at">marital_widowed =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Widow"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-2754"><a href="#cb48-2754" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2755"><a href="#cb48-2755" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-2756"><a href="#cb48-2756" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-2757"><a href="#cb48-2757" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Marital Status"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_population"</span>, <span class="st">"marital_defacto"</span>, <span class="st">"marital_married"</span>, <span class="st">"marital_never married"</span>, <span class="st">"marital_separated"</span>, <span class="st">"marital_widowed"</span>))</span>
<span id="cb48-2758"><a href="#cb48-2758" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2759"><a href="#cb48-2759" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2760"><a href="#cb48-2760" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2761"><a href="#cb48-2761" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2762"><a href="#cb48-2762" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-2763"><a href="#cb48-2763" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-2764"><a href="#cb48-2764" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-2765"><a href="#cb48-2765" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2766"><a href="#cb48-2766" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-2767"><a href="#cb48-2767" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-2768"><a href="#cb48-2768" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2769"><a href="#cb48-2769" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-2770"><a href="#cb48-2770" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2771"><a href="#cb48-2771" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-2772"><a href="#cb48-2772" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2773"><a href="#cb48-2773" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2774"><a href="#cb48-2774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-2775"><a href="#cb48-2775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2776"><a href="#cb48-2776" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 3: Employment Status</span></span>
<span id="cb48-2777"><a href="#cb48-2777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2780"><a href="#cb48-2780" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-2781"><a href="#cb48-2781" aria-hidden="true" tabindex="-1"></a><span class="co"># Get employment status data</span></span>
<span id="cb48-2782"><a href="#cb48-2782" aria-hidden="true" tabindex="-1"></a>employment_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-2783"><a href="#cb48-2783" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2784"><a href="#cb48-2784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2785"><a href="#cb48-2785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2786"><a href="#cb48-2786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Employment Status"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2787"><a href="#cb48-2787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2788"><a href="#cb48-2788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-2789"><a href="#cb48-2789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2790"><a href="#cb48-2790" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape employment status data</span></span>
<span id="cb48-2791"><a href="#cb48-2791" aria-hidden="true" tabindex="-1"></a>employment_wide <span class="ot">&lt;-</span> employment_data <span class="sc">%&gt;%</span></span>
<span id="cb48-2792"><a href="#cb48-2792" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">status =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-2793"><a href="#cb48-2793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, status) <span class="sc">%&gt;%</span></span>
<span id="cb48-2794"><a href="#cb48-2794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2795"><a href="#cb48-2795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-2796"><a href="#cb48-2796" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> status,</span>
<span id="cb48-2797"><a href="#cb48-2797" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-2798"><a href="#cb48-2798" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"employ_"</span></span>
<span id="cb48-2799"><a href="#cb48-2799" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2800"><a href="#cb48-2800" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-2801"><a href="#cb48-2801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2802"><a href="#cb48-2802" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine with total population</span></span>
<span id="cb48-2803"><a href="#cb48-2803" aria-hidden="true" tabindex="-1"></a>employment_full <span class="ot">&lt;-</span> total_population <span class="sc">%&gt;%</span></span>
<span id="cb48-2804"><a href="#cb48-2804" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(employment_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2805"><a href="#cb48-2805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-2806"><a href="#cb48-2806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2807"><a href="#cb48-2807" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-2808"><a href="#cb48-2808" aria-hidden="true" tabindex="-1"></a>employment_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(employment_full)</span>
<span id="cb48-2809"><a href="#cb48-2809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2810"><a href="#cb48-2810" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-2811"><a href="#cb48-2811" aria-hidden="true" tabindex="-1"></a>employment_ordered <span class="ot">&lt;-</span> employment_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-2812"><a href="#cb48-2812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-2813"><a href="#cb48-2813" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-2814"><a href="#cb48-2814" aria-hidden="true" tabindex="-1"></a>    total_population,</span>
<span id="cb48-2815"><a href="#cb48-2815" aria-hidden="true" tabindex="-1"></a>    employ_government,</span>
<span id="cb48-2816"><a href="#cb48-2816" aria-hidden="true" tabindex="-1"></a>    employ_private,</span>
<span id="cb48-2817"><a href="#cb48-2817" aria-hidden="true" tabindex="-1"></a>    employ_employer,</span>
<span id="cb48-2818"><a href="#cb48-2818" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">employ_self-employed</span><span class="st">`</span>,</span>
<span id="cb48-2819"><a href="#cb48-2819" aria-hidden="true" tabindex="-1"></a>    employ_voluntary,</span>
<span id="cb48-2820"><a href="#cb48-2820" aria-hidden="true" tabindex="-1"></a>    employ_unpaid,</span>
<span id="cb48-2821"><a href="#cb48-2821" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">employ_own consumption</span><span class="st">`</span></span>
<span id="cb48-2822"><a href="#cb48-2822" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-2823"><a href="#cb48-2823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2824"><a href="#cb48-2824" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 3 TO CSV ===</span></span>
<span id="cb48-2825"><a href="#cb48-2825" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-2826"><a href="#cb48-2826" aria-hidden="true" tabindex="-1"></a>  employment_ordered,</span>
<span id="cb48-2827"><a href="#cb48-2827" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"GenderProtection_01c_baseline_employment_status.csv"</span>),</span>
<span id="cb48-2828"><a href="#cb48-2828" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-2829"><a href="#cb48-2829" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2830"><a href="#cb48-2830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2831"><a href="#cb48-2831" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 3 ===</span></span>
<span id="cb48-2832"><a href="#cb48-2832" aria-hidden="true" tabindex="-1"></a>formatted3 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(employment_ordered)</span>
<span id="cb48-2833"><a href="#cb48-2833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2834"><a href="#cb48-2834" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-2835"><a href="#cb48-2835" aria-hidden="true" tabindex="-1"></a>  formatted3,</span>
<span id="cb48-2836"><a href="#cb48-2836" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-2837"><a href="#cb48-2837" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2838"><a href="#cb48-2838" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-2839"><a href="#cb48-2839" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-2840"><a href="#cb48-2840" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-2841"><a href="#cb48-2841" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2842"><a href="#cb48-2842" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2843"><a href="#cb48-2843" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_population =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2844"><a href="#cb48-2844" aria-hidden="true" tabindex="-1"></a>    <span class="at">employ_government =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Government"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2845"><a href="#cb48-2845" aria-hidden="true" tabindex="-1"></a>    <span class="at">employ_private =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Private"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2846"><a href="#cb48-2846" aria-hidden="true" tabindex="-1"></a>    <span class="at">employ_employer =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Employer"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2847"><a href="#cb48-2847" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">employ_self-employed</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Self Employed"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2848"><a href="#cb48-2848" aria-hidden="true" tabindex="-1"></a>    <span class="at">employ_voluntary =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Voluntary"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2849"><a href="#cb48-2849" aria-hidden="true" tabindex="-1"></a>    <span class="at">employ_unpaid =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Unpaid"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-2850"><a href="#cb48-2850" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">employ_own consumption</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Own Consumption"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-2851"><a href="#cb48-2851" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2852"><a href="#cb48-2852" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-2853"><a href="#cb48-2853" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-2854"><a href="#cb48-2854" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Employment Status"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_population"</span>, <span class="st">"employ_government"</span>, <span class="st">"employ_private"</span>, <span class="st">"employ_employer"</span>, <span class="st">"employ_self-employed"</span>, <span class="st">"employ_voluntary"</span>, <span class="st">"employ_unpaid"</span>, <span class="st">"employ_own consumption"</span>))</span>
<span id="cb48-2855"><a href="#cb48-2855" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2856"><a href="#cb48-2856" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2857"><a href="#cb48-2857" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2858"><a href="#cb48-2858" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2859"><a href="#cb48-2859" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-2860"><a href="#cb48-2860" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-2861"><a href="#cb48-2861" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-2862"><a href="#cb48-2862" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2863"><a href="#cb48-2863" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-2864"><a href="#cb48-2864" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-2865"><a href="#cb48-2865" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2866"><a href="#cb48-2866" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-2867"><a href="#cb48-2867" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2868"><a href="#cb48-2868" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-2869"><a href="#cb48-2869" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2870"><a href="#cb48-2870" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2871"><a href="#cb48-2871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-2872"><a href="#cb48-2872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2873"><a href="#cb48-2873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2874"><a href="#cb48-2874" aria-hidden="true" tabindex="-1"></a><span class="fu">## Immediate Response Resources</span></span>
<span id="cb48-2875"><a href="#cb48-2875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2876"><a href="#cb48-2876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2879"><a href="#cb48-2879" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-2880"><a href="#cb48-2880" aria-hidden="true" tabindex="-1"></a><span class="do">## Resources needed for Gender &amp; Protection</span></span>
<span id="cb48-2881"><a href="#cb48-2881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2882"><a href="#cb48-2882" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-2883"><a href="#cb48-2883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2884"><a href="#cb48-2884" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration parameters</span></span>
<span id="cb48-2885"><a href="#cb48-2885" aria-hidden="true" tabindex="-1"></a>days_of_support <span class="ot">&lt;-</span> <span class="dv">14</span>  <span class="co"># Number of days to provide resources (adjust as needed)</span></span>
<span id="cb48-2886"><a href="#cb48-2886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2887"><a href="#cb48-2887" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get resource multipliers</span></span>
<span id="cb48-2888"><a href="#cb48-2888" aria-hidden="true" tabindex="-1"></a>get_gender_protection_resource_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb48-2889"><a href="#cb48-2889" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb48-2890"><a href="#cb48-2890" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-2891"><a href="#cb48-2891" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Gender &amp; Protection"</span>,</span>
<span id="cb48-2892"><a href="#cb48-2892" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> resource_type,</span>
<span id="cb48-2893"><a href="#cb48-2893" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-2894"><a href="#cb48-2894" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2895"><a href="#cb48-2895" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-2896"><a href="#cb48-2896" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-2897"><a href="#cb48-2897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(multiplier) <span class="sc">&gt;</span> <span class="dv">0</span>, multiplier, <span class="dv">0</span>))</span>
<span id="cb48-2898"><a href="#cb48-2898" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-2899"><a href="#cb48-2899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2900"><a href="#cb48-2900" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone categories to population data</span></span>
<span id="cb48-2901"><a href="#cb48-2901" aria-hidden="true" tabindex="-1"></a>population_with_config <span class="ot">&lt;-</span> population_full <span class="sc">%&gt;%</span></span>
<span id="cb48-2902"><a href="#cb48-2902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-2903"><a href="#cb48-2903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2904"><a href="#cb48-2904" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate resources needed based on total population in affected areas</span></span>
<span id="cb48-2905"><a href="#cb48-2905" aria-hidden="true" tabindex="-1"></a>resources_needed <span class="ot">&lt;-</span> population_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-2906"><a href="#cb48-2906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2907"><a href="#cb48-2907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-2908"><a href="#cb48-2908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-2909"><a href="#cb48-2909" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total population affected</span></span>
<span id="cb48-2910"><a href="#cb48-2910" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_affected =</span> total_population,</span>
<span id="cb48-2911"><a href="#cb48-2911" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-2912"><a href="#cb48-2912" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Resources = population * resource multiplier * days of support</span></span>
<span id="cb48-2913"><a href="#cb48-2913" aria-hidden="true" tabindex="-1"></a>    <span class="at">water =</span> <span class="fu">ceiling</span>(total_population <span class="sc">*</span> <span class="fu">get_gender_protection_resource_multiplier</span>(<span class="st">"Water"</span>, Region) <span class="sc">*</span> days_of_support),</span>
<span id="cb48-2914"><a href="#cb48-2914" aria-hidden="true" tabindex="-1"></a>    <span class="at">tin_fish =</span> <span class="fu">round</span>(total_population <span class="sc">*</span> <span class="fu">get_gender_protection_resource_multiplier</span>(<span class="st">"Tin Fish"</span>, Region) <span class="sc">*</span> days_of_support, <span class="dv">0</span>),</span>
<span id="cb48-2915"><a href="#cb48-2915" aria-hidden="true" tabindex="-1"></a>    <span class="at">rice =</span> <span class="fu">round</span>(total_population <span class="sc">*</span> <span class="fu">get_gender_protection_resource_multiplier</span>(<span class="st">"Rice"</span>, Region) <span class="sc">*</span> days_of_support, <span class="dv">0</span>)</span>
<span id="cb48-2916"><a href="#cb48-2916" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-2917"><a href="#cb48-2917" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-2918"><a href="#cb48-2918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, population_affected, water, tin_fish, rice)</span>
<span id="cb48-2919"><a href="#cb48-2919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2920"><a href="#cb48-2920" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-2921"><a href="#cb48-2921" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(resources_needed)</span>
<span id="cb48-2922"><a href="#cb48-2922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2923"><a href="#cb48-2923" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-2924"><a href="#cb48-2924" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-2925"><a href="#cb48-2925" aria-hidden="true" tabindex="-1"></a>  resources_needed_full,</span>
<span id="cb48-2926"><a href="#cb48-2926" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"GenderProtection_02_resources_needed.csv"</span>),</span>
<span id="cb48-2927"><a href="#cb48-2927" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-2928"><a href="#cb48-2928" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2929"><a href="#cb48-2929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2930"><a href="#cb48-2930" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-2931"><a href="#cb48-2931" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb48-2932"><a href="#cb48-2932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2933"><a href="#cb48-2933" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-2934"><a href="#cb48-2934" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-2935"><a href="#cb48-2935" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-2936"><a href="#cb48-2936" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2937"><a href="#cb48-2937" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-2938"><a href="#cb48-2938" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-2939"><a href="#cb48-2939" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-2940"><a href="#cb48-2940" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2941"><a href="#cb48-2941" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2942"><a href="#cb48-2942" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_affected =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2943"><a href="#cb48-2943" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Population"</span>, </span>
<span id="cb48-2944"><a href="#cb48-2944" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2945"><a href="#cb48-2945" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2946"><a href="#cb48-2946" aria-hidden="true" tabindex="-1"></a>    <span class="at">water =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2947"><a href="#cb48-2947" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Water (litres)"</span>, </span>
<span id="cb48-2948"><a href="#cb48-2948" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2949"><a href="#cb48-2949" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2950"><a href="#cb48-2950" aria-hidden="true" tabindex="-1"></a>    <span class="at">tin_fish =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2951"><a href="#cb48-2951" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Tin Fish (kg)"</span>, </span>
<span id="cb48-2952"><a href="#cb48-2952" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2953"><a href="#cb48-2953" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2954"><a href="#cb48-2954" aria-hidden="true" tabindex="-1"></a>    <span class="at">rice =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-2955"><a href="#cb48-2955" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Rice (kg)"</span>, </span>
<span id="cb48-2956"><a href="#cb48-2956" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-2957"><a href="#cb48-2957" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-2958"><a href="#cb48-2958" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2959"><a href="#cb48-2959" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-2960"><a href="#cb48-2960" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-2961"><a href="#cb48-2961" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Resources Needed"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"population_affected"</span>, <span class="st">"water"</span>, <span class="st">"tin_fish"</span>, <span class="st">"rice"</span>))</span>
<span id="cb48-2962"><a href="#cb48-2962" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2963"><a href="#cb48-2963" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2964"><a href="#cb48-2964" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2965"><a href="#cb48-2965" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2966"><a href="#cb48-2966" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-2967"><a href="#cb48-2967" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-2968"><a href="#cb48-2968" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-2969"><a href="#cb48-2969" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-2970"><a href="#cb48-2970" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-2971"><a href="#cb48-2971" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-2972"><a href="#cb48-2972" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-2973"><a href="#cb48-2973" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-2974"><a href="#cb48-2974" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-2975"><a href="#cb48-2975" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-2976"><a href="#cb48-2976" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-2977"><a href="#cb48-2977" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-2978"><a href="#cb48-2978" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-2979"><a href="#cb48-2979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2980"><a href="#cb48-2980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2981"><a href="#cb48-2981" aria-hidden="true" tabindex="-1"></a><span class="fu"># Health</span></span>
<span id="cb48-2982"><a href="#cb48-2982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2983"><a href="#cb48-2983" aria-hidden="true" tabindex="-1"></a><span class="fu">## Baseline: Health </span></span>
<span id="cb48-2984"><a href="#cb48-2984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2987"><a href="#cb48-2987" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-2988"><a href="#cb48-2988" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-2989"><a href="#cb48-2989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2990"><a href="#cb48-2990" aria-hidden="true" tabindex="-1"></a><span class="co"># Get health facility data</span></span>
<span id="cb48-2991"><a href="#cb48-2991" aria-hidden="true" tabindex="-1"></a>health_facility_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-2992"><a href="#cb48-2992" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Health"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2993"><a href="#cb48-2993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2994"><a href="#cb48-2994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-2995"><a href="#cb48-2995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Health Facility"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2996"><a href="#cb48-2996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-2997"><a href="#cb48-2997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-2998"><a href="#cb48-2998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2999"><a href="#cb48-2999" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape health facility data</span></span>
<span id="cb48-3000"><a href="#cb48-3000" aria-hidden="true" tabindex="-1"></a>facility_wide <span class="ot">&lt;-</span> health_facility_data <span class="sc">%&gt;%</span></span>
<span id="cb48-3001"><a href="#cb48-3001" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">facility_type =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-3002"><a href="#cb48-3002" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, facility_type) <span class="sc">%&gt;%</span></span>
<span id="cb48-3003"><a href="#cb48-3003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3004"><a href="#cb48-3004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-3005"><a href="#cb48-3005" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> facility_type,</span>
<span id="cb48-3006"><a href="#cb48-3006" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-3007"><a href="#cb48-3007" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"facility_"</span></span>
<span id="cb48-3008"><a href="#cb48-3008" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3009"><a href="#cb48-3009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-3010"><a href="#cb48-3010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3011"><a href="#cb48-3011" aria-hidden="true" tabindex="-1"></a><span class="co"># Get health professionals data</span></span>
<span id="cb48-3012"><a href="#cb48-3012" aria-hidden="true" tabindex="-1"></a>health_professionals_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-3013"><a href="#cb48-3013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Health"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3014"><a href="#cb48-3014" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3015"><a href="#cb48-3015" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3016"><a href="#cb48-3016" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Health Professionals"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3017"><a href="#cb48-3017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3018"><a href="#cb48-3018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-3019"><a href="#cb48-3019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3020"><a href="#cb48-3020" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape health professionals data</span></span>
<span id="cb48-3021"><a href="#cb48-3021" aria-hidden="true" tabindex="-1"></a>professionals_wide <span class="ot">&lt;-</span> health_professionals_data <span class="sc">%&gt;%</span></span>
<span id="cb48-3022"><a href="#cb48-3022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">professional_type =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-3023"><a href="#cb48-3023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, professional_type) <span class="sc">%&gt;%</span></span>
<span id="cb48-3024"><a href="#cb48-3024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3025"><a href="#cb48-3025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-3026"><a href="#cb48-3026" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> professional_type,</span>
<span id="cb48-3027"><a href="#cb48-3027" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-3028"><a href="#cb48-3028" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"prof_"</span></span>
<span id="cb48-3029"><a href="#cb48-3029" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3030"><a href="#cb48-3030" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-3031"><a href="#cb48-3031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3032"><a href="#cb48-3032" aria-hidden="true" tabindex="-1"></a><span class="co"># Get hospital staff data</span></span>
<span id="cb48-3033"><a href="#cb48-3033" aria-hidden="true" tabindex="-1"></a>hospital_staff_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-3034"><a href="#cb48-3034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Health"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3035"><a href="#cb48-3035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3036"><a href="#cb48-3036" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3037"><a href="#cb48-3037" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Hospital Staff"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3038"><a href="#cb48-3038" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3039"><a href="#cb48-3039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-3040"><a href="#cb48-3040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3041"><a href="#cb48-3041" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape hospital staff data</span></span>
<span id="cb48-3042"><a href="#cb48-3042" aria-hidden="true" tabindex="-1"></a>hospital_staff_wide <span class="ot">&lt;-</span> hospital_staff_data <span class="sc">%&gt;%</span></span>
<span id="cb48-3043"><a href="#cb48-3043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">staff_type =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-3044"><a href="#cb48-3044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, staff_type) <span class="sc">%&gt;%</span></span>
<span id="cb48-3045"><a href="#cb48-3045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3046"><a href="#cb48-3046" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-3047"><a href="#cb48-3047" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> staff_type,</span>
<span id="cb48-3048"><a href="#cb48-3048" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-3049"><a href="#cb48-3049" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"staff_"</span></span>
<span id="cb48-3050"><a href="#cb48-3050" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3051"><a href="#cb48-3051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-3052"><a href="#cb48-3052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3053"><a href="#cb48-3053" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all health data</span></span>
<span id="cb48-3054"><a href="#cb48-3054" aria-hidden="true" tabindex="-1"></a>health_full <span class="ot">&lt;-</span> facility_wide <span class="sc">%&gt;%</span></span>
<span id="cb48-3055"><a href="#cb48-3055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(professionals_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3056"><a href="#cb48-3056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(hospital_staff_wide, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3057"><a href="#cb48-3057" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-3058"><a href="#cb48-3058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3059"><a href="#cb48-3059" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-3060"><a href="#cb48-3060" aria-hidden="true" tabindex="-1"></a>health_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(health_full)</span>
<span id="cb48-3061"><a href="#cb48-3061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3062"><a href="#cb48-3062" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to client's specification</span></span>
<span id="cb48-3063"><a href="#cb48-3063" aria-hidden="true" tabindex="-1"></a>health_ordered <span class="ot">&lt;-</span> health_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-3064"><a href="#cb48-3064" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-3065"><a href="#cb48-3065" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-3066"><a href="#cb48-3066" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Facility</span></span>
<span id="cb48-3067"><a href="#cb48-3067" aria-hidden="true" tabindex="-1"></a>    facility_hospital,</span>
<span id="cb48-3068"><a href="#cb48-3068" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">facility_health centre</span><span class="st">`</span>,</span>
<span id="cb48-3069"><a href="#cb48-3069" aria-hidden="true" tabindex="-1"></a>    facility_dispensary,</span>
<span id="cb48-3070"><a href="#cb48-3070" aria-hidden="true" tabindex="-1"></a>    facility_aidpost,</span>
<span id="cb48-3071"><a href="#cb48-3071" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Professional</span></span>
<span id="cb48-3072"><a href="#cb48-3072" aria-hidden="true" tabindex="-1"></a>    prof_doctor,</span>
<span id="cb48-3073"><a href="#cb48-3073" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_nurse practitioner</span><span class="st">`</span>,</span>
<span id="cb48-3074"><a href="#cb48-3074" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_registered nurse</span><span class="st">`</span>,</span>
<span id="cb48-3075"><a href="#cb48-3075" aria-hidden="true" tabindex="-1"></a>    prof_midwife,</span>
<span id="cb48-3076"><a href="#cb48-3076" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_nurse aid</span><span class="st">`</span>,</span>
<span id="cb48-3077"><a href="#cb48-3077" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Hospital Staff</span></span>
<span id="cb48-3078"><a href="#cb48-3078" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_clinical medical services</span><span class="st">`</span>,</span>
<span id="cb48-3079"><a href="#cb48-3079" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_nonclinical medical services</span><span class="st">`</span>,</span>
<span id="cb48-3080"><a href="#cb48-3080" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_clinical nursing services</span><span class="st">`</span>,</span>
<span id="cb48-3081"><a href="#cb48-3081" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_nonclinical nursing services</span><span class="st">`</span>,</span>
<span id="cb48-3082"><a href="#cb48-3082" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_pharmacy services</span><span class="st">`</span></span>
<span id="cb48-3083"><a href="#cb48-3083" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-3084"><a href="#cb48-3084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3085"><a href="#cb48-3085" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-3086"><a href="#cb48-3086" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-3087"><a href="#cb48-3087" aria-hidden="true" tabindex="-1"></a>  health_ordered,</span>
<span id="cb48-3088"><a href="#cb48-3088" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Health_01_baseline.csv"</span>),</span>
<span id="cb48-3089"><a href="#cb48-3089" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-3090"><a href="#cb48-3090" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3091"><a href="#cb48-3091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3092"><a href="#cb48-3092" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-3093"><a href="#cb48-3093" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(health_ordered)</span>
<span id="cb48-3094"><a href="#cb48-3094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3095"><a href="#cb48-3095" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-3096"><a href="#cb48-3096" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-3097"><a href="#cb48-3097" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-3098"><a href="#cb48-3098" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3099"><a href="#cb48-3099" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-3100"><a href="#cb48-3100" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-3101"><a href="#cb48-3101" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-3102"><a href="#cb48-3102" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3103"><a href="#cb48-3103" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3104"><a href="#cb48-3104" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Facility</span></span>
<span id="cb48-3105"><a href="#cb48-3105" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_hospital =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Hospital"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3106"><a href="#cb48-3106" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">facility_health centre</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Health Centre"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3107"><a href="#cb48-3107" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_dispensary =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Dispensary"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3108"><a href="#cb48-3108" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_aidpost =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Aidpost"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3109"><a href="#cb48-3109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3110"><a href="#cb48-3110" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Professional</span></span>
<span id="cb48-3111"><a href="#cb48-3111" aria-hidden="true" tabindex="-1"></a>    <span class="at">prof_doctor =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Doctor"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3112"><a href="#cb48-3112" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_nurse practitioner</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Nurse Practitioner"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3113"><a href="#cb48-3113" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_registered nurse</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Registered Nurse"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3114"><a href="#cb48-3114" aria-hidden="true" tabindex="-1"></a>    <span class="at">prof_midwife =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Midwife"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3115"><a href="#cb48-3115" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">prof_nurse aid</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Nurse Aid"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3116"><a href="#cb48-3116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3117"><a href="#cb48-3117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Hospital Staff</span></span>
<span id="cb48-3118"><a href="#cb48-3118" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_clinical medical services</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Clinical Medical"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3119"><a href="#cb48-3119" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_nonclinical medical services</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Nonclinical Medical"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3120"><a href="#cb48-3120" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_clinical nursing services</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Clinical Nursing"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3121"><a href="#cb48-3121" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_nonclinical nursing services</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Nonclinical Nursing"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3122"><a href="#cb48-3122" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">staff_pharmacy services</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Pharmacy"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-3123"><a href="#cb48-3123" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3124"><a href="#cb48-3124" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-3125"><a href="#cb48-3125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-3126"><a href="#cb48-3126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Health Facility"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"facility_hospital"</span>, <span class="st">"facility_health centre"</span>, <span class="st">"facility_dispensary"</span>, <span class="st">"facility_aidpost"</span>)),</span>
<span id="cb48-3127"><a href="#cb48-3127" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Health Professional"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"prof_doctor"</span>, <span class="st">"prof_nurse practitioner"</span>, <span class="st">"prof_registered nurse"</span>, <span class="st">"prof_midwife"</span>, <span class="st">"prof_nurse aid"</span>)),</span>
<span id="cb48-3128"><a href="#cb48-3128" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Hospital Staff"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"staff_clinical medical services"</span>, <span class="st">"staff_nonclinical medical services"</span>, <span class="st">"staff_clinical nursing services"</span>, <span class="st">"staff_nonclinical nursing services"</span>, <span class="st">"staff_pharmacy services"</span>))</span>
<span id="cb48-3129"><a href="#cb48-3129" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3130"><a href="#cb48-3130" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3131"><a href="#cb48-3131" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3132"><a href="#cb48-3132" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3133"><a href="#cb48-3133" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-3134"><a href="#cb48-3134" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-3135"><a href="#cb48-3135" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-3136"><a href="#cb48-3136" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3137"><a href="#cb48-3137" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-3138"><a href="#cb48-3138" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-3139"><a href="#cb48-3139" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3140"><a href="#cb48-3140" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-3141"><a href="#cb48-3141" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3142"><a href="#cb48-3142" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-3143"><a href="#cb48-3143" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3144"><a href="#cb48-3144" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3145"><a href="#cb48-3145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-3146"><a href="#cb48-3146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3147"><a href="#cb48-3147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3148"><a href="#cb48-3148" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimated Hazard Damage</span></span>
<span id="cb48-3149"><a href="#cb48-3149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3152"><a href="#cb48-3152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-3153"><a href="#cb48-3153" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-3154"><a href="#cb48-3154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3155"><a href="#cb48-3155" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to baseline values</span></span>
<span id="cb48-3156"><a href="#cb48-3156" aria-hidden="true" tabindex="-1"></a>health_with_config <span class="ot">&lt;-</span> health_full <span class="sc">%&gt;%</span></span>
<span id="cb48-3157"><a href="#cb48-3157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-3158"><a href="#cb48-3158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3159"><a href="#cb48-3159" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for health damage multipliers (council-specific)</span></span>
<span id="cb48-3160"><a href="#cb48-3160" aria-hidden="true" tabindex="-1"></a>get_health_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, indicator_type, attribute_type, area_council) {</span>
<span id="cb48-3161"><a href="#cb48-3161" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb48-3162"><a href="#cb48-3162" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-3163"><a href="#cb48-3163" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb48-3164"><a href="#cb48-3164" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-3165"><a href="#cb48-3165" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Health"</span>,</span>
<span id="cb48-3166"><a href="#cb48-3166" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator_type,</span>
<span id="cb48-3167"><a href="#cb48-3167" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute_type)),</span>
<span id="cb48-3168"><a href="#cb48-3168" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-3169"><a href="#cb48-3169" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-3170"><a href="#cb48-3170" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-3171"><a href="#cb48-3171" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if we got any results</span></span>
<span id="cb48-3172"><a href="#cb48-3172" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb48-3173"><a href="#cb48-3173" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb48-3174"><a href="#cb48-3174" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-3175"><a href="#cb48-3175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-3176"><a href="#cb48-3176" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the value from the intensity column</span></span>
<span id="cb48-3177"><a href="#cb48-3177" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb48-3178"><a href="#cb48-3178" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-3179"><a href="#cb48-3179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb48-3180"><a href="#cb48-3180" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-3181"><a href="#cb48-3181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3182"><a href="#cb48-3182" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates for Health Facilities only</span></span>
<span id="cb48-3183"><a href="#cb48-3183" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep UNROUNDED values for aggregation first</span></span>
<span id="cb48-3184"><a href="#cb48-3184" aria-hidden="true" tabindex="-1"></a>damage_estimates_raw <span class="ot">&lt;-</span> health_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-3185"><a href="#cb48-3185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3186"><a href="#cb48-3186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3187"><a href="#cb48-3187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3188"><a href="#cb48-3188" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Facility Damage - keep as decimals for now</span></span>
<span id="cb48-3189"><a href="#cb48-3189" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_hospital_damaged =</span> facility_hospital <span class="sc">*</span> <span class="fu">get_health_damage_multiplier</span>(Intensity, <span class="st">"Health Facility"</span>, <span class="st">"hospital"</span>, Region),</span>
<span id="cb48-3190"><a href="#cb48-3190" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">facility_health centre</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_health_damage_multiplier</span>(Intensity, <span class="st">"Health Facility"</span>, <span class="st">"health centre"</span>, Region),</span>
<span id="cb48-3191"><a href="#cb48-3191" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_dispensary_damaged =</span> facility_dispensary <span class="sc">*</span> <span class="fu">get_health_damage_multiplier</span>(Intensity, <span class="st">"Health Facility"</span>, <span class="st">"dispensary"</span>, Region),</span>
<span id="cb48-3192"><a href="#cb48-3192" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_aidpost_damaged =</span> facility_aidpost <span class="sc">*</span> <span class="fu">get_health_damage_multiplier</span>(Intensity, <span class="st">"Health Facility"</span>, <span class="st">"aidpost"</span>, Region)</span>
<span id="cb48-3193"><a href="#cb48-3193" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3194"><a href="#cb48-3194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3195"><a href="#cb48-3195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, facility_hospital_damaged, <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span>, </span>
<span id="cb48-3196"><a href="#cb48-3196" aria-hidden="true" tabindex="-1"></a>         facility_dispensary_damaged, facility_aidpost_damaged)</span>
<span id="cb48-3197"><a href="#cb48-3197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3198"><a href="#cb48-3198" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels FIRST</span></span>
<span id="cb48-3199"><a href="#cb48-3199" aria-hidden="true" tabindex="-1"></a>damage_estimates_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(damage_estimates_raw)</span>
<span id="cb48-3200"><a href="#cb48-3200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3201"><a href="#cb48-3201" aria-hidden="true" tabindex="-1"></a><span class="co"># NOW round all values (council, province, and national)</span></span>
<span id="cb48-3202"><a href="#cb48-3202" aria-hidden="true" tabindex="-1"></a>damage_estimates_full <span class="ot">&lt;-</span> damage_estimates_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-3203"><a href="#cb48-3203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3204"><a href="#cb48-3204" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_hospital_damaged =</span> <span class="fu">round</span>(facility_hospital_damaged, <span class="dv">0</span>),</span>
<span id="cb48-3205"><a href="#cb48-3205" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb48-3206"><a href="#cb48-3206" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_dispensary_damaged =</span> <span class="fu">round</span>(facility_dispensary_damaged, <span class="dv">0</span>),</span>
<span id="cb48-3207"><a href="#cb48-3207" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_aidpost_damaged =</span> <span class="fu">round</span>(facility_aidpost_damaged, <span class="dv">0</span>)</span>
<span id="cb48-3208"><a href="#cb48-3208" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-3209"><a href="#cb48-3209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3210"><a href="#cb48-3210" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-3211"><a href="#cb48-3211" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-3212"><a href="#cb48-3212" aria-hidden="true" tabindex="-1"></a>  damage_estimates_full,</span>
<span id="cb48-3213"><a href="#cb48-3213" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Health_02_damage_estimates.csv"</span>),</span>
<span id="cb48-3214"><a href="#cb48-3214" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-3215"><a href="#cb48-3215" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3216"><a href="#cb48-3216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3217"><a href="#cb48-3217" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-3218"><a href="#cb48-3218" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-3219"><a href="#cb48-3219" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(damage_estimates_full)</span>
<span id="cb48-3220"><a href="#cb48-3220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3221"><a href="#cb48-3221" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb48-3222"><a href="#cb48-3222" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-3223"><a href="#cb48-3223" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-3224"><a href="#cb48-3224" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-3225"><a href="#cb48-3225" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3226"><a href="#cb48-3226" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-3227"><a href="#cb48-3227" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-3228"><a href="#cb48-3228" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-3229"><a href="#cb48-3229" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3230"><a href="#cb48-3230" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3231"><a href="#cb48-3231" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3232"><a href="#cb48-3232" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Health Facility - showing as whole numbers</span></span>
<span id="cb48-3233"><a href="#cb48-3233" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_hospital_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Hospital"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3234"><a href="#cb48-3234" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Health Centre"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3235"><a href="#cb48-3235" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_dispensary_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Dispensary"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3236"><a href="#cb48-3236" aria-hidden="true" tabindex="-1"></a>    <span class="at">facility_aidpost_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Aidpost"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-3237"><a href="#cb48-3237" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3238"><a href="#cb48-3238" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-3239"><a href="#cb48-3239" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-3240"><a href="#cb48-3240" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Health Facility"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"facility_hospital_damaged"</span>, <span class="st">"facility_health centre_damaged"</span>, <span class="st">"facility_dispensary_damaged"</span>, <span class="st">"facility_aidpost_damaged"</span>))</span>
<span id="cb48-3241"><a href="#cb48-3241" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3242"><a href="#cb48-3242" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3243"><a href="#cb48-3243" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3244"><a href="#cb48-3244" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3245"><a href="#cb48-3245" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-3246"><a href="#cb48-3246" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-3247"><a href="#cb48-3247" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-3248"><a href="#cb48-3248" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3249"><a href="#cb48-3249" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-3250"><a href="#cb48-3250" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-3251"><a href="#cb48-3251" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3252"><a href="#cb48-3252" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-3253"><a href="#cb48-3253" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3254"><a href="#cb48-3254" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-3255"><a href="#cb48-3255" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3256"><a href="#cb48-3256" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3257"><a href="#cb48-3257" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-3258"><a href="#cb48-3258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3259"><a href="#cb48-3259" aria-hidden="true" tabindex="-1"></a><span class="fu">## Immediate Response Resources</span></span>
<span id="cb48-3260"><a href="#cb48-3260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3263"><a href="#cb48-3263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-3264"><a href="#cb48-3264" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-3265"><a href="#cb48-3265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3266"><a href="#cb48-3266" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get resource multipliers from config</span></span>
<span id="cb48-3267"><a href="#cb48-3267" aria-hidden="true" tabindex="-1"></a>get_health_resource_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb48-3268"><a href="#cb48-3268" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb48-3269"><a href="#cb48-3269" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-3270"><a href="#cb48-3270" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Health"</span>,</span>
<span id="cb48-3271"><a href="#cb48-3271" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> resource_type,</span>
<span id="cb48-3272"><a href="#cb48-3272" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-3273"><a href="#cb48-3273" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3274"><a href="#cb48-3274" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-3275"><a href="#cb48-3275" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3276"><a href="#cb48-3276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(multiplier) <span class="sc">&gt;</span> <span class="dv">0</span>, multiplier, <span class="dv">0</span>))</span>
<span id="cb48-3277"><a href="#cb48-3277" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-3278"><a href="#cb48-3278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3279"><a href="#cb48-3279" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total damaged facilities (this is what we need for resources)</span></span>
<span id="cb48-3280"><a href="#cb48-3280" aria-hidden="true" tabindex="-1"></a>health_facilities_damaged <span class="ot">&lt;-</span> damage_estimates_raw <span class="sc">%&gt;%</span></span>
<span id="cb48-3281"><a href="#cb48-3281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3282"><a href="#cb48-3282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3283"><a href="#cb48-3283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3284"><a href="#cb48-3284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3285"><a href="#cb48-3285" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total damaged facilities</span></span>
<span id="cb48-3286"><a href="#cb48-3286" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_facilities_damaged =</span> facility_hospital_damaged <span class="sc">+</span> <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span> <span class="sc">+</span></span>
<span id="cb48-3287"><a href="#cb48-3287" aria-hidden="true" tabindex="-1"></a>                                 facility_dispensary_damaged <span class="sc">+</span> facility_aidpost_damaged</span>
<span id="cb48-3288"><a href="#cb48-3288" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3289"><a href="#cb48-3289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3290"><a href="#cb48-3290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_facilities_damaged)</span>
<span id="cb48-3291"><a href="#cb48-3291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3292"><a href="#cb48-3292" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate resources needed based on FACILITIES with multipliers from config</span></span>
<span id="cb48-3293"><a href="#cb48-3293" aria-hidden="true" tabindex="-1"></a>resources_needed <span class="ot">&lt;-</span> health_facilities_damaged <span class="sc">%&gt;%</span></span>
<span id="cb48-3294"><a href="#cb48-3294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3295"><a href="#cb48-3295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3296"><a href="#cb48-3296" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ALL resources based on damaged facilities with multipliers from config file</span></span>
<span id="cb48-3297"><a href="#cb48-3297" aria-hidden="true" tabindex="-1"></a>    <span class="at">medical_tent =</span> <span class="fu">round</span>(<span class="fu">get_health_resource_multiplier</span>(<span class="st">"Medical Tent"</span>, Region) <span class="sc">*</span> total_facilities_damaged, <span class="dv">0</span>),</span>
<span id="cb48-3298"><a href="#cb48-3298" aria-hidden="true" tabindex="-1"></a>    <span class="at">emergency_health_kits =</span> <span class="fu">round</span>(<span class="fu">get_health_resource_multiplier</span>(<span class="st">"Emergency Health Kits"</span>, Region) <span class="sc">*</span> total_facilities_damaged, <span class="dv">0</span>),</span>
<span id="cb48-3299"><a href="#cb48-3299" aria-hidden="true" tabindex="-1"></a>    <span class="at">trauma_surgical_kits =</span> <span class="fu">round</span>(<span class="fu">get_health_resource_multiplier</span>(<span class="st">"Trauma and Surgical Kits"</span>, Region) <span class="sc">*</span> total_facilities_damaged, <span class="dv">0</span>),</span>
<span id="cb48-3300"><a href="#cb48-3300" aria-hidden="true" tabindex="-1"></a>    <span class="at">essential_ncd_medicines =</span> <span class="fu">round</span>(<span class="fu">get_health_resource_multiplier</span>(<span class="st">"Essential NCD Medicines"</span>, Region) <span class="sc">*</span> total_facilities_damaged, <span class="dv">0</span>),</span>
<span id="cb48-3301"><a href="#cb48-3301" aria-hidden="true" tabindex="-1"></a>    <span class="at">mosquito_nets =</span> <span class="fu">round</span>(<span class="fu">get_health_resource_multiplier</span>(<span class="st">"Mosquito Nets"</span>, Region) <span class="sc">*</span> total_facilities_damaged, <span class="dv">0</span>)</span>
<span id="cb48-3302"><a href="#cb48-3302" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3303"><a href="#cb48-3303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3304"><a href="#cb48-3304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, medical_tent, emergency_health_kits, trauma_surgical_kits,</span>
<span id="cb48-3305"><a href="#cb48-3305" aria-hidden="true" tabindex="-1"></a>         essential_ncd_medicines, mosquito_nets)</span>
<span id="cb48-3306"><a href="#cb48-3306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3307"><a href="#cb48-3307" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-3308"><a href="#cb48-3308" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(resources_needed)</span>
<span id="cb48-3309"><a href="#cb48-3309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3310"><a href="#cb48-3310" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-3311"><a href="#cb48-3311" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-3312"><a href="#cb48-3312" aria-hidden="true" tabindex="-1"></a>  resources_needed_full,</span>
<span id="cb48-3313"><a href="#cb48-3313" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Health_03_resources_needed.csv"</span>),</span>
<span id="cb48-3314"><a href="#cb48-3314" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-3315"><a href="#cb48-3315" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3316"><a href="#cb48-3316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3317"><a href="#cb48-3317" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-3318"><a href="#cb48-3318" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-3319"><a href="#cb48-3319" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb48-3320"><a href="#cb48-3320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3321"><a href="#cb48-3321" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the resources needed reactable</span></span>
<span id="cb48-3322"><a href="#cb48-3322" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-3323"><a href="#cb48-3323" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-3324"><a href="#cb48-3324" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-3325"><a href="#cb48-3325" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3326"><a href="#cb48-3326" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-3327"><a href="#cb48-3327" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-3328"><a href="#cb48-3328" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-3329"><a href="#cb48-3329" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3330"><a href="#cb48-3330" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3331"><a href="#cb48-3331" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3332"><a href="#cb48-3332" aria-hidden="true" tabindex="-1"></a>    <span class="at">medical_tent =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3333"><a href="#cb48-3333" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Medical Tent"</span>,</span>
<span id="cb48-3334"><a href="#cb48-3334" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-3335"><a href="#cb48-3335" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3336"><a href="#cb48-3336" aria-hidden="true" tabindex="-1"></a>    <span class="at">emergency_health_kits =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3337"><a href="#cb48-3337" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Emergency Health Kits"</span>,</span>
<span id="cb48-3338"><a href="#cb48-3338" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-3339"><a href="#cb48-3339" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3340"><a href="#cb48-3340" aria-hidden="true" tabindex="-1"></a>    <span class="at">trauma_surgical_kits =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3341"><a href="#cb48-3341" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Trauma and Surgical Kits"</span>,</span>
<span id="cb48-3342"><a href="#cb48-3342" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-3343"><a href="#cb48-3343" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3344"><a href="#cb48-3344" aria-hidden="true" tabindex="-1"></a>    <span class="at">essential_ncd_medicines =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3345"><a href="#cb48-3345" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Essential NCD Medicines"</span>,</span>
<span id="cb48-3346"><a href="#cb48-3346" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-3347"><a href="#cb48-3347" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3348"><a href="#cb48-3348" aria-hidden="true" tabindex="-1"></a>    <span class="at">mosquito_nets =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3349"><a href="#cb48-3349" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Mosquito Nets"</span>,</span>
<span id="cb48-3350"><a href="#cb48-3350" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-3351"><a href="#cb48-3351" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-3352"><a href="#cb48-3352" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3353"><a href="#cb48-3353" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-3354"><a href="#cb48-3354" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-3355"><a href="#cb48-3355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Resources Needed"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"medical_tent"</span>, <span class="st">"emergency_health_kits"</span>, <span class="st">"trauma_surgical_kits"</span>, <span class="st">"essential_ncd_medicines"</span>, <span class="st">"mosquito_nets"</span>))</span>
<span id="cb48-3356"><a href="#cb48-3356" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3357"><a href="#cb48-3357" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3358"><a href="#cb48-3358" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3359"><a href="#cb48-3359" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3360"><a href="#cb48-3360" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-3361"><a href="#cb48-3361" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-3362"><a href="#cb48-3362" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-3363"><a href="#cb48-3363" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3364"><a href="#cb48-3364" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-3365"><a href="#cb48-3365" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-3366"><a href="#cb48-3366" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3367"><a href="#cb48-3367" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-3368"><a href="#cb48-3368" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3369"><a href="#cb48-3369" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-3370"><a href="#cb48-3370" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3371"><a href="#cb48-3371" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3372"><a href="#cb48-3372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-3373"><a href="#cb48-3373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3374"><a href="#cb48-3374" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimated Financial Damage</span></span>
<span id="cb48-3377"><a href="#cb48-3377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-3378"><a href="#cb48-3378" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-3379"><a href="#cb48-3379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3380"><a href="#cb48-3380" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for health facilities</span></span>
<span id="cb48-3381"><a href="#cb48-3381" aria-hidden="true" tabindex="-1"></a>get_health_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(facility_type, area_council) {</span>
<span id="cb48-3382"><a href="#cb48-3382" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb48-3383"><a href="#cb48-3383" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-3384"><a href="#cb48-3384" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Health"</span>,</span>
<span id="cb48-3385"><a href="#cb48-3385" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Health Facility"</span>,</span>
<span id="cb48-3386"><a href="#cb48-3386" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(facility_type)),</span>
<span id="cb48-3387"><a href="#cb48-3387" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-3388"><a href="#cb48-3388" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3389"><a href="#cb48-3389" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-3390"><a href="#cb48-3390" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3391"><a href="#cb48-3391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb48-3392"><a href="#cb48-3392" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-3393"><a href="#cb48-3393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3394"><a href="#cb48-3394" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the raw damage estimates (before rounding) for financial calculations</span></span>
<span id="cb48-3395"><a href="#cb48-3395" aria-hidden="true" tabindex="-1"></a>health_financial <span class="ot">&lt;-</span> damage_estimates_raw <span class="sc">%&gt;%</span></span>
<span id="cb48-3396"><a href="#cb48-3396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3397"><a href="#cb48-3397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3398"><a href="#cb48-3398" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each facility type (in VT)</span></span>
<span id="cb48-3399"><a href="#cb48-3399" aria-hidden="true" tabindex="-1"></a>    <span class="at">hospital_financial =</span> facility_hospital_damaged <span class="sc">*</span> <span class="fu">get_health_unit_cost</span>(<span class="st">"hospital"</span>, Region),</span>
<span id="cb48-3400"><a href="#cb48-3400" aria-hidden="true" tabindex="-1"></a>    <span class="at">health_centre_financial =</span> <span class="st">`</span><span class="at">facility_health centre_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_health_unit_cost</span>(<span class="st">"health centre"</span>, Region),</span>
<span id="cb48-3401"><a href="#cb48-3401" aria-hidden="true" tabindex="-1"></a>    <span class="at">dispensary_financial =</span> facility_dispensary_damaged <span class="sc">*</span> <span class="fu">get_health_unit_cost</span>(<span class="st">"dispensary"</span>, Region),</span>
<span id="cb48-3402"><a href="#cb48-3402" aria-hidden="true" tabindex="-1"></a>    <span class="at">aidpost_financial =</span> facility_aidpost_damaged <span class="sc">*</span> <span class="fu">get_health_unit_cost</span>(<span class="st">"aidpost"</span>, Region),</span>
<span id="cb48-3403"><a href="#cb48-3403" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3404"><a href="#cb48-3404" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total financial damage</span></span>
<span id="cb48-3405"><a href="#cb48-3405" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial_damage =</span> hospital_financial <span class="sc">+</span> health_centre_financial <span class="sc">+</span></span>
<span id="cb48-3406"><a href="#cb48-3406" aria-hidden="true" tabindex="-1"></a>                              dispensary_financial <span class="sc">+</span> aidpost_financial</span>
<span id="cb48-3407"><a href="#cb48-3407" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3408"><a href="#cb48-3408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3409"><a href="#cb48-3409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial_damage, hospital_financial, health_centre_financial,</span>
<span id="cb48-3410"><a href="#cb48-3410" aria-hidden="true" tabindex="-1"></a>         dispensary_financial, aidpost_financial)</span>
<span id="cb48-3411"><a href="#cb48-3411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3412"><a href="#cb48-3412" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-3413"><a href="#cb48-3413" aria-hidden="true" tabindex="-1"></a>health_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(health_financial)</span>
<span id="cb48-3414"><a href="#cb48-3414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3415"><a href="#cb48-3415" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns to match specification</span></span>
<span id="cb48-3416"><a href="#cb48-3416" aria-hidden="true" tabindex="-1"></a>health_financial_ordered <span class="ot">&lt;-</span> health_financial_full <span class="sc">%&gt;%</span></span>
<span id="cb48-3417"><a href="#cb48-3417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial_damage, hospital_financial, health_centre_financial,</span>
<span id="cb48-3418"><a href="#cb48-3418" aria-hidden="true" tabindex="-1"></a>         dispensary_financial, aidpost_financial)</span>
<span id="cb48-3419"><a href="#cb48-3419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3420"><a href="#cb48-3420" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-3421"><a href="#cb48-3421" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-3422"><a href="#cb48-3422" aria-hidden="true" tabindex="-1"></a>  health_financial_ordered,</span>
<span id="cb48-3423"><a href="#cb48-3423" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Health_04_financial_damage.csv"</span>),</span>
<span id="cb48-3424"><a href="#cb48-3424" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-3425"><a href="#cb48-3425" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3426"><a href="#cb48-3426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3427"><a href="#cb48-3427" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-3428"><a href="#cb48-3428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3429"><a href="#cb48-3429" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-3430"><a href="#cb48-3430" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(health_financial_ordered)</span>
<span id="cb48-3431"><a href="#cb48-3431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3432"><a href="#cb48-3432" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the financial damage reactable</span></span>
<span id="cb48-3433"><a href="#cb48-3433" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-3434"><a href="#cb48-3434" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-3435"><a href="#cb48-3435" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-3436"><a href="#cb48-3436" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3437"><a href="#cb48-3437" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-3438"><a href="#cb48-3438" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-3439"><a href="#cb48-3439" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-3440"><a href="#cb48-3440" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3441"><a href="#cb48-3441" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3442"><a href="#cb48-3442" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3443"><a href="#cb48-3443" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial_damage =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3444"><a href="#cb48-3444" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb48-3445"><a href="#cb48-3445" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-3446"><a href="#cb48-3446" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3447"><a href="#cb48-3447" aria-hidden="true" tabindex="-1"></a>    <span class="at">hospital_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3448"><a href="#cb48-3448" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Hospital"</span>,</span>
<span id="cb48-3449"><a href="#cb48-3449" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-3450"><a href="#cb48-3450" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3451"><a href="#cb48-3451" aria-hidden="true" tabindex="-1"></a>    <span class="at">health_centre_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3452"><a href="#cb48-3452" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Health Centre"</span>,</span>
<span id="cb48-3453"><a href="#cb48-3453" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-3454"><a href="#cb48-3454" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3455"><a href="#cb48-3455" aria-hidden="true" tabindex="-1"></a>    <span class="at">dispensary_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3456"><a href="#cb48-3456" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Dispensary"</span>,</span>
<span id="cb48-3457"><a href="#cb48-3457" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-3458"><a href="#cb48-3458" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3459"><a href="#cb48-3459" aria-hidden="true" tabindex="-1"></a>    <span class="at">aidpost_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3460"><a href="#cb48-3460" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Aidpost"</span>,</span>
<span id="cb48-3461"><a href="#cb48-3461" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-3462"><a href="#cb48-3462" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-3463"><a href="#cb48-3463" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3464"><a href="#cb48-3464" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-3465"><a href="#cb48-3465" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-3466"><a href="#cb48-3466" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Health Facility Financial Damage (VT)"</span>, </span>
<span id="cb48-3467"><a href="#cb48-3467" aria-hidden="true" tabindex="-1"></a>             <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_financial_damage"</span>, <span class="st">"hospital_financial"</span>,</span>
<span id="cb48-3468"><a href="#cb48-3468" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"health_centre_financial"</span>, <span class="st">"dispensary_financial"</span>,</span>
<span id="cb48-3469"><a href="#cb48-3469" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"aidpost_financial"</span>))</span>
<span id="cb48-3470"><a href="#cb48-3470" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3471"><a href="#cb48-3471" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3472"><a href="#cb48-3472" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3473"><a href="#cb48-3473" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3474"><a href="#cb48-3474" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-3475"><a href="#cb48-3475" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-3476"><a href="#cb48-3476" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-3477"><a href="#cb48-3477" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3478"><a href="#cb48-3478" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-3479"><a href="#cb48-3479" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-3480"><a href="#cb48-3480" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3481"><a href="#cb48-3481" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-3482"><a href="#cb48-3482" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3483"><a href="#cb48-3483" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-3484"><a href="#cb48-3484" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3485"><a href="#cb48-3485" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3486"><a href="#cb48-3486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-3487"><a href="#cb48-3487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3488"><a href="#cb48-3488" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistics</span></span>
<span id="cb48-3489"><a href="#cb48-3489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3490"><a href="#cb48-3490" aria-hidden="true" tabindex="-1"></a><span class="fu">## Baseline: Logistics Infrastructure </span></span>
<span id="cb48-3491"><a href="#cb48-3491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3492"><a href="#cb48-3492" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 1: Infrastructure</span></span>
<span id="cb48-3493"><a href="#cb48-3493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3496"><a href="#cb48-3496" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-3497"><a href="#cb48-3497" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-3498"><a href="#cb48-3498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3499"><a href="#cb48-3499" aria-hidden="true" tabindex="-1"></a><span class="co"># Get logistics infrastructure data</span></span>
<span id="cb48-3500"><a href="#cb48-3500" aria-hidden="true" tabindex="-1"></a>logistics_infrastructure_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-3501"><a href="#cb48-3501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Logistics"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3502"><a href="#cb48-3502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3503"><a href="#cb48-3503" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3504"><a href="#cb48-3504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Infrastructure"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3505"><a href="#cb48-3505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3506"><a href="#cb48-3506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-3507"><a href="#cb48-3507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3508"><a href="#cb48-3508" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape infrastructure data</span></span>
<span id="cb48-3509"><a href="#cb48-3509" aria-hidden="true" tabindex="-1"></a>infrastructure_wide <span class="ot">&lt;-</span> logistics_infrastructure_data <span class="sc">%&gt;%</span></span>
<span id="cb48-3510"><a href="#cb48-3510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">infrastructure_type =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-3511"><a href="#cb48-3511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, infrastructure_type) <span class="sc">%&gt;%</span></span>
<span id="cb48-3512"><a href="#cb48-3512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3513"><a href="#cb48-3513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-3514"><a href="#cb48-3514" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> infrastructure_type,</span>
<span id="cb48-3515"><a href="#cb48-3515" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-3516"><a href="#cb48-3516" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"infra_"</span></span>
<span id="cb48-3517"><a href="#cb48-3517" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3518"><a href="#cb48-3518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-3519"><a href="#cb48-3519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3520"><a href="#cb48-3520" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-3521"><a href="#cb48-3521" aria-hidden="true" tabindex="-1"></a>infrastructure_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(infrastructure_wide)</span>
<span id="cb48-3522"><a href="#cb48-3522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3523"><a href="#cb48-3523" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to specification</span></span>
<span id="cb48-3524"><a href="#cb48-3524" aria-hidden="true" tabindex="-1"></a>infrastructure_ordered <span class="ot">&lt;-</span> infrastructure_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-3525"><a href="#cb48-3525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-3526"><a href="#cb48-3526" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-3527"><a href="#cb48-3527" aria-hidden="true" tabindex="-1"></a>    infra_airport,</span>
<span id="cb48-3528"><a href="#cb48-3528" aria-hidden="true" tabindex="-1"></a>    infra_wharf,</span>
<span id="cb48-3529"><a href="#cb48-3529" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_permanent bridge</span><span class="st">`</span>,</span>
<span id="cb48-3530"><a href="#cb48-3530" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_temporary bridge</span><span class="st">`</span>,</span>
<span id="cb48-3531"><a href="#cb48-3531" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_police stations</span><span class="st">`</span>,</span>
<span id="cb48-3532"><a href="#cb48-3532" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_fire hydrants</span><span class="st">`</span>,</span>
<span id="cb48-3533"><a href="#cb48-3533" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_main water valves</span><span class="st">`</span></span>
<span id="cb48-3534"><a href="#cb48-3534" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-3535"><a href="#cb48-3535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3536"><a href="#cb48-3536" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb48-3537"><a href="#cb48-3537" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-3538"><a href="#cb48-3538" aria-hidden="true" tabindex="-1"></a>  infrastructure_ordered,</span>
<span id="cb48-3539"><a href="#cb48-3539" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_01a_baseline_infrastructure.csv"</span>),</span>
<span id="cb48-3540"><a href="#cb48-3540" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-3541"><a href="#cb48-3541" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3542"><a href="#cb48-3542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3543"><a href="#cb48-3543" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb48-3544"><a href="#cb48-3544" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(infrastructure_ordered)</span>
<span id="cb48-3545"><a href="#cb48-3545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3546"><a href="#cb48-3546" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-3547"><a href="#cb48-3547" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb48-3548"><a href="#cb48-3548" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-3549"><a href="#cb48-3549" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3550"><a href="#cb48-3550" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-3551"><a href="#cb48-3551" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-3552"><a href="#cb48-3552" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3553"><a href="#cb48-3553" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-3554"><a href="#cb48-3554" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3555"><a href="#cb48-3555" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-3556"><a href="#cb48-3556" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3557"><a href="#cb48-3557" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3558"><a href="#cb48-3558" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_airport =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Airport"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3559"><a href="#cb48-3559" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_wharf =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wharf"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3560"><a href="#cb48-3560" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_permanent bridge</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Permanent Bridge"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3561"><a href="#cb48-3561" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_temporary bridge</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Temporary Bridge"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3562"><a href="#cb48-3562" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_police stations</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Police Stations"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3563"><a href="#cb48-3563" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_fire hydrants</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Fire Hydrants"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3564"><a href="#cb48-3564" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_main water valves</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Main Water Valves"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-3565"><a href="#cb48-3565" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3566"><a href="#cb48-3566" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-3567"><a href="#cb48-3567" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-3568"><a href="#cb48-3568" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Infrastructure"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"infra_airport"</span>, <span class="st">"infra_wharf"</span>, <span class="st">"infra_permanent bridge"</span>, </span>
<span id="cb48-3569"><a href="#cb48-3569" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"infra_temporary bridge"</span>, <span class="st">"infra_police stations"</span>, </span>
<span id="cb48-3570"><a href="#cb48-3570" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"infra_fire hydrants"</span>, <span class="st">"infra_main water valves"</span>))</span>
<span id="cb48-3571"><a href="#cb48-3571" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3572"><a href="#cb48-3572" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3573"><a href="#cb48-3573" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3574"><a href="#cb48-3574" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3575"><a href="#cb48-3575" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-3576"><a href="#cb48-3576" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-3577"><a href="#cb48-3577" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-3578"><a href="#cb48-3578" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3579"><a href="#cb48-3579" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-3580"><a href="#cb48-3580" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-3581"><a href="#cb48-3581" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3582"><a href="#cb48-3582" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-3583"><a href="#cb48-3583" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3584"><a href="#cb48-3584" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-3585"><a href="#cb48-3585" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3586"><a href="#cb48-3586" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3587"><a href="#cb48-3587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-3588"><a href="#cb48-3588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3589"><a href="#cb48-3589" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 2: Road Surface</span></span>
<span id="cb48-3590"><a href="#cb48-3590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3593"><a href="#cb48-3593" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-3594"><a href="#cb48-3594" aria-hidden="true" tabindex="-1"></a><span class="co"># Get logistics road surface data</span></span>
<span id="cb48-3595"><a href="#cb48-3595" aria-hidden="true" tabindex="-1"></a>logistics_road_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-3596"><a href="#cb48-3596" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Logistics"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3597"><a href="#cb48-3597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3598"><a href="#cb48-3598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3599"><a href="#cb48-3599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Road Surface"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3600"><a href="#cb48-3600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3601"><a href="#cb48-3601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value)</span>
<span id="cb48-3602"><a href="#cb48-3602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3603"><a href="#cb48-3603" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape road surface data</span></span>
<span id="cb48-3604"><a href="#cb48-3604" aria-hidden="true" tabindex="-1"></a>road_wide <span class="ot">&lt;-</span> logistics_road_data <span class="sc">%&gt;%</span></span>
<span id="cb48-3605"><a href="#cb48-3605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">road_type =</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute))) <span class="sc">%&gt;%</span></span>
<span id="cb48-3606"><a href="#cb48-3606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, road_type) <span class="sc">%&gt;%</span></span>
<span id="cb48-3607"><a href="#cb48-3607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3608"><a href="#cb48-3608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-3609"><a href="#cb48-3609" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> road_type,</span>
<span id="cb48-3610"><a href="#cb48-3610" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-3611"><a href="#cb48-3611" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"road_"</span></span>
<span id="cb48-3612"><a href="#cb48-3612" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3613"><a href="#cb48-3613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-3614"><a href="#cb48-3614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3615"><a href="#cb48-3615" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-3616"><a href="#cb48-3616" aria-hidden="true" tabindex="-1"></a>road_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(road_wide)</span>
<span id="cb48-3617"><a href="#cb48-3617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3618"><a href="#cb48-3618" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns according to specification</span></span>
<span id="cb48-3619"><a href="#cb48-3619" aria-hidden="true" tabindex="-1"></a>road_ordered <span class="ot">&lt;-</span> road_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-3620"><a href="#cb48-3620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb48-3621"><a href="#cb48-3621" aria-hidden="true" tabindex="-1"></a>    Region,</span>
<span id="cb48-3622"><a href="#cb48-3622" aria-hidden="true" tabindex="-1"></a>    road_asphalt,</span>
<span id="cb48-3623"><a href="#cb48-3623" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">road_chips seal</span><span class="st">`</span>,</span>
<span id="cb48-3624"><a href="#cb48-3624" aria-hidden="true" tabindex="-1"></a>    road_concrete,</span>
<span id="cb48-3625"><a href="#cb48-3625" aria-hidden="true" tabindex="-1"></a>    road_earth,</span>
<span id="cb48-3626"><a href="#cb48-3626" aria-hidden="true" tabindex="-1"></a>    road_gravel</span>
<span id="cb48-3627"><a href="#cb48-3627" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-3628"><a href="#cb48-3628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3629"><a href="#cb48-3629" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb48-3630"><a href="#cb48-3630" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-3631"><a href="#cb48-3631" aria-hidden="true" tabindex="-1"></a>  road_ordered,</span>
<span id="cb48-3632"><a href="#cb48-3632" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_01b_baseline_road_surface.csv"</span>),</span>
<span id="cb48-3633"><a href="#cb48-3633" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-3634"><a href="#cb48-3634" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3635"><a href="#cb48-3635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3636"><a href="#cb48-3636" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb48-3637"><a href="#cb48-3637" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(road_ordered)</span>
<span id="cb48-3638"><a href="#cb48-3638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3639"><a href="#cb48-3639" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-3640"><a href="#cb48-3640" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb48-3641"><a href="#cb48-3641" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-3642"><a href="#cb48-3642" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3643"><a href="#cb48-3643" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-3644"><a href="#cb48-3644" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-3645"><a href="#cb48-3645" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3646"><a href="#cb48-3646" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-3647"><a href="#cb48-3647" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3648"><a href="#cb48-3648" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-3649"><a href="#cb48-3649" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3650"><a href="#cb48-3650" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3651"><a href="#cb48-3651" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_asphalt =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Asphalt"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3652"><a href="#cb48-3652" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">road_chips seal</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Chips Seal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3653"><a href="#cb48-3653" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_concrete =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3654"><a href="#cb48-3654" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_earth =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Earth"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3655"><a href="#cb48-3655" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_gravel =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Gravel"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-3656"><a href="#cb48-3656" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3657"><a href="#cb48-3657" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-3658"><a href="#cb48-3658" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-3659"><a href="#cb48-3659" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Road Surface"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"road_asphalt"</span>, <span class="st">"road_chips seal"</span>, <span class="st">"road_concrete"</span>, </span>
<span id="cb48-3660"><a href="#cb48-3660" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"road_earth"</span>, <span class="st">"road_gravel"</span>))</span>
<span id="cb48-3661"><a href="#cb48-3661" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3662"><a href="#cb48-3662" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3663"><a href="#cb48-3663" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3664"><a href="#cb48-3664" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3665"><a href="#cb48-3665" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-3666"><a href="#cb48-3666" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-3667"><a href="#cb48-3667" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-3668"><a href="#cb48-3668" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3669"><a href="#cb48-3669" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-3670"><a href="#cb48-3670" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-3671"><a href="#cb48-3671" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3672"><a href="#cb48-3672" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-3673"><a href="#cb48-3673" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3674"><a href="#cb48-3674" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-3675"><a href="#cb48-3675" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3676"><a href="#cb48-3676" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3677"><a href="#cb48-3677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-3678"><a href="#cb48-3678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3679"><a href="#cb48-3679" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimated Hazard Damage</span></span>
<span id="cb48-3680"><a href="#cb48-3680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3681"><a href="#cb48-3681" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 1: Infrastructure Damage</span></span>
<span id="cb48-3682"><a href="#cb48-3682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3685"><a href="#cb48-3685" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-3686"><a href="#cb48-3686" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-3687"><a href="#cb48-3687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3688"><a href="#cb48-3688" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to baseline values</span></span>
<span id="cb48-3689"><a href="#cb48-3689" aria-hidden="true" tabindex="-1"></a>infrastructure_with_config <span class="ot">&lt;-</span> infrastructure_wide <span class="sc">%&gt;%</span></span>
<span id="cb48-3690"><a href="#cb48-3690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-3691"><a href="#cb48-3691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3692"><a href="#cb48-3692" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function for infrastructure damage multipliers (council-specific)</span></span>
<span id="cb48-3693"><a href="#cb48-3693" aria-hidden="true" tabindex="-1"></a>get_logistics_damage_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(cyclone_category, indicator_type, attribute_type, area_council) {</span>
<span id="cb48-3694"><a href="#cb48-3694" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, cyclone_category)</span>
<span id="cb48-3695"><a href="#cb48-3695" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-3696"><a href="#cb48-3696" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb48-3697"><a href="#cb48-3697" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-3698"><a href="#cb48-3698" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Logistics"</span>,</span>
<span id="cb48-3699"><a href="#cb48-3699" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator_type,</span>
<span id="cb48-3700"><a href="#cb48-3700" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute_type)),</span>
<span id="cb48-3701"><a href="#cb48-3701" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-3702"><a href="#cb48-3702" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-3703"><a href="#cb48-3703" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-3704"><a href="#cb48-3704" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Check if we got any results</span></span>
<span id="cb48-3705"><a href="#cb48-3705" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(multiplier) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb48-3706"><a href="#cb48-3706" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb48-3707"><a href="#cb48-3707" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-3708"><a href="#cb48-3708" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-3709"><a href="#cb48-3709" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the value from the intensity column</span></span>
<span id="cb48-3710"><a href="#cb48-3710" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;-</span> multiplier[[intensity_col]][<span class="dv">1</span>]</span>
<span id="cb48-3711"><a href="#cb48-3711" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-3712"><a href="#cb48-3712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">is.na</span>(result) <span class="sc">||</span> <span class="fu">length</span>(result) <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, result))</span>
<span id="cb48-3713"><a href="#cb48-3713" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-3714"><a href="#cb48-3714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3715"><a href="#cb48-3715" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates for Infrastructure</span></span>
<span id="cb48-3716"><a href="#cb48-3716" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep UNROUNDED values for aggregation first</span></span>
<span id="cb48-3717"><a href="#cb48-3717" aria-hidden="true" tabindex="-1"></a>infrastructure_damage_raw <span class="ot">&lt;-</span> infrastructure_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-3718"><a href="#cb48-3718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3719"><a href="#cb48-3719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3720"><a href="#cb48-3720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3721"><a href="#cb48-3721" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Infrastructure Damage - keep as decimals for now</span></span>
<span id="cb48-3722"><a href="#cb48-3722" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_airport_damaged =</span> infra_airport <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"airport"</span>, Region),</span>
<span id="cb48-3723"><a href="#cb48-3723" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_wharf_damaged =</span> infra_wharf <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"wharf"</span>, Region),</span>
<span id="cb48-3724"><a href="#cb48-3724" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_permanent bridge</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"permanent bridge"</span>, Region),</span>
<span id="cb48-3725"><a href="#cb48-3725" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_temporary bridge</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"temporary bridge"</span>, Region),</span>
<span id="cb48-3726"><a href="#cb48-3726" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_police stations</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"police stations"</span>, Region),</span>
<span id="cb48-3727"><a href="#cb48-3727" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_fire hydrants</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"fire hydrants"</span>, Region),</span>
<span id="cb48-3728"><a href="#cb48-3728" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">infra_main water valves</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Infrastructure"</span>, <span class="st">"main water valves"</span>, Region)</span>
<span id="cb48-3729"><a href="#cb48-3729" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3730"><a href="#cb48-3730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3731"><a href="#cb48-3731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, infra_airport_damaged, infra_wharf_damaged, <span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span>,</span>
<span id="cb48-3732"><a href="#cb48-3732" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span>, <span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span>, </span>
<span id="cb48-3733"><a href="#cb48-3733" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span>, <span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span>)</span>
<span id="cb48-3734"><a href="#cb48-3734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3735"><a href="#cb48-3735" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels FIRST</span></span>
<span id="cb48-3736"><a href="#cb48-3736" aria-hidden="true" tabindex="-1"></a>infrastructure_damage_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(infrastructure_damage_raw)</span>
<span id="cb48-3737"><a href="#cb48-3737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3738"><a href="#cb48-3738" aria-hidden="true" tabindex="-1"></a><span class="co"># NOW round all values (council, province, and national)</span></span>
<span id="cb48-3739"><a href="#cb48-3739" aria-hidden="true" tabindex="-1"></a>infrastructure_damage_full <span class="ot">&lt;-</span> infrastructure_damage_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-3740"><a href="#cb48-3740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3741"><a href="#cb48-3741" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_airport_damaged =</span> <span class="fu">round</span>(infra_airport_damaged, <span class="dv">0</span>),</span>
<span id="cb48-3742"><a href="#cb48-3742" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_wharf_damaged =</span> <span class="fu">round</span>(infra_wharf_damaged, <span class="dv">0</span>),</span>
<span id="cb48-3743"><a href="#cb48-3743" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb48-3744"><a href="#cb48-3744" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb48-3745"><a href="#cb48-3745" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb48-3746"><a href="#cb48-3746" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb48-3747"><a href="#cb48-3747" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span>, <span class="dv">0</span>)</span>
<span id="cb48-3748"><a href="#cb48-3748" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-3749"><a href="#cb48-3749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3750"><a href="#cb48-3750" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb48-3751"><a href="#cb48-3751" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-3752"><a href="#cb48-3752" aria-hidden="true" tabindex="-1"></a>  infrastructure_damage_full,</span>
<span id="cb48-3753"><a href="#cb48-3753" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_02a_damage_infrastructure.csv"</span>),</span>
<span id="cb48-3754"><a href="#cb48-3754" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-3755"><a href="#cb48-3755" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3756"><a href="#cb48-3756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3757"><a href="#cb48-3757" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb48-3758"><a href="#cb48-3758" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-3759"><a href="#cb48-3759" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(infrastructure_damage_full)</span>
<span id="cb48-3760"><a href="#cb48-3760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3761"><a href="#cb48-3761" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb48-3762"><a href="#cb48-3762" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-3763"><a href="#cb48-3763" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb48-3764"><a href="#cb48-3764" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-3765"><a href="#cb48-3765" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3766"><a href="#cb48-3766" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-3767"><a href="#cb48-3767" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-3768"><a href="#cb48-3768" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-3769"><a href="#cb48-3769" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3770"><a href="#cb48-3770" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3771"><a href="#cb48-3771" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3772"><a href="#cb48-3772" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Infrastructure</span></span>
<span id="cb48-3773"><a href="#cb48-3773" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_airport_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Airport"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3774"><a href="#cb48-3774" aria-hidden="true" tabindex="-1"></a>    <span class="at">infra_wharf_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wharf"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3775"><a href="#cb48-3775" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Permanent Bridge"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3776"><a href="#cb48-3776" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Temporary Bridge"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3777"><a href="#cb48-3777" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Police Stations"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3778"><a href="#cb48-3778" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Fire Hydrants"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3779"><a href="#cb48-3779" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Main Water Valves"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-3780"><a href="#cb48-3780" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3781"><a href="#cb48-3781" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-3782"><a href="#cb48-3782" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-3783"><a href="#cb48-3783" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Infrastructure"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"infra_airport_damaged"</span>, <span class="st">"infra_wharf_damaged"</span>, </span>
<span id="cb48-3784"><a href="#cb48-3784" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"infra_permanent bridge_damaged"</span>, <span class="st">"infra_temporary bridge_damaged"</span>,</span>
<span id="cb48-3785"><a href="#cb48-3785" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"infra_police stations_damaged"</span>, <span class="st">"infra_fire hydrants_damaged"</span>,</span>
<span id="cb48-3786"><a href="#cb48-3786" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"infra_main water valves_damaged"</span>))</span>
<span id="cb48-3787"><a href="#cb48-3787" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3788"><a href="#cb48-3788" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3789"><a href="#cb48-3789" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3790"><a href="#cb48-3790" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3791"><a href="#cb48-3791" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-3792"><a href="#cb48-3792" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-3793"><a href="#cb48-3793" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-3794"><a href="#cb48-3794" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3795"><a href="#cb48-3795" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-3796"><a href="#cb48-3796" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-3797"><a href="#cb48-3797" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3798"><a href="#cb48-3798" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-3799"><a href="#cb48-3799" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3800"><a href="#cb48-3800" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-3801"><a href="#cb48-3801" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3802"><a href="#cb48-3802" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3803"><a href="#cb48-3803" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-3804"><a href="#cb48-3804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3805"><a href="#cb48-3805" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 2: Road Surface Damage</span></span>
<span id="cb48-3806"><a href="#cb48-3806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3809"><a href="#cb48-3809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-3810"><a href="#cb48-3810" aria-hidden="true" tabindex="-1"></a><span class="co"># Add cyclone strength to road baseline values</span></span>
<span id="cb48-3811"><a href="#cb48-3811" aria-hidden="true" tabindex="-1"></a>road_with_config <span class="ot">&lt;-</span> road_wide <span class="sc">%&gt;%</span></span>
<span id="cb48-3812"><a href="#cb48-3812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(config, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>))</span>
<span id="cb48-3813"><a href="#cb48-3813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3814"><a href="#cb48-3814" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage estimates for Road Surface</span></span>
<span id="cb48-3815"><a href="#cb48-3815" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep UNROUNDED values for aggregation first</span></span>
<span id="cb48-3816"><a href="#cb48-3816" aria-hidden="true" tabindex="-1"></a>road_damage_raw <span class="ot">&lt;-</span> road_with_config <span class="sc">%&gt;%</span></span>
<span id="cb48-3817"><a href="#cb48-3817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3818"><a href="#cb48-3818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3819"><a href="#cb48-3819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3820"><a href="#cb48-3820" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Road Surface Damage - keep as decimals for now</span></span>
<span id="cb48-3821"><a href="#cb48-3821" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_asphalt_damaged =</span> road_asphalt <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Road Surface"</span>, <span class="st">"asphalt"</span>, Region),</span>
<span id="cb48-3822"><a href="#cb48-3822" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">road_chips seal</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Road Surface"</span>, <span class="st">"chips seal"</span>, Region),</span>
<span id="cb48-3823"><a href="#cb48-3823" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_concrete_damaged =</span> road_concrete <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Road Surface"</span>, <span class="st">"concrete"</span>, Region),</span>
<span id="cb48-3824"><a href="#cb48-3824" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_earth_damaged =</span> road_earth <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Road Surface"</span>, <span class="st">"earth"</span>, Region),</span>
<span id="cb48-3825"><a href="#cb48-3825" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_gravel_damaged =</span> road_gravel <span class="sc">*</span> <span class="fu">get_logistics_damage_multiplier</span>(Intensity, <span class="st">"Road Surface"</span>, <span class="st">"gravel"</span>, Region)</span>
<span id="cb48-3826"><a href="#cb48-3826" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3827"><a href="#cb48-3827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3828"><a href="#cb48-3828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, road_asphalt_damaged, <span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span>, road_concrete_damaged,</span>
<span id="cb48-3829"><a href="#cb48-3829" aria-hidden="true" tabindex="-1"></a>         road_earth_damaged, road_gravel_damaged)</span>
<span id="cb48-3830"><a href="#cb48-3830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3831"><a href="#cb48-3831" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels FIRST</span></span>
<span id="cb48-3832"><a href="#cb48-3832" aria-hidden="true" tabindex="-1"></a>road_damage_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(road_damage_raw)</span>
<span id="cb48-3833"><a href="#cb48-3833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3834"><a href="#cb48-3834" aria-hidden="true" tabindex="-1"></a><span class="co"># NOW round all values (council, province, and national)</span></span>
<span id="cb48-3835"><a href="#cb48-3835" aria-hidden="true" tabindex="-1"></a>road_damage_full <span class="ot">&lt;-</span> road_damage_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-3836"><a href="#cb48-3836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3837"><a href="#cb48-3837" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_asphalt_damaged =</span> <span class="fu">round</span>(road_asphalt_damaged, <span class="dv">0</span>),</span>
<span id="cb48-3838"><a href="#cb48-3838" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span>, <span class="dv">0</span>),</span>
<span id="cb48-3839"><a href="#cb48-3839" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_concrete_damaged =</span> <span class="fu">round</span>(road_concrete_damaged, <span class="dv">0</span>),</span>
<span id="cb48-3840"><a href="#cb48-3840" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_earth_damaged =</span> <span class="fu">round</span>(road_earth_damaged, <span class="dv">0</span>),</span>
<span id="cb48-3841"><a href="#cb48-3841" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_gravel_damaged =</span> <span class="fu">round</span>(road_gravel_damaged, <span class="dv">0</span>)</span>
<span id="cb48-3842"><a href="#cb48-3842" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-3843"><a href="#cb48-3843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3844"><a href="#cb48-3844" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb48-3845"><a href="#cb48-3845" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-3846"><a href="#cb48-3846" aria-hidden="true" tabindex="-1"></a>  road_damage_full,</span>
<span id="cb48-3847"><a href="#cb48-3847" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_02b_damage_road_surface.csv"</span>),</span>
<span id="cb48-3848"><a href="#cb48-3848" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-3849"><a href="#cb48-3849" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3850"><a href="#cb48-3850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3851"><a href="#cb48-3851" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb48-3852"><a href="#cb48-3852" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-3853"><a href="#cb48-3853" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(road_damage_full)</span>
<span id="cb48-3854"><a href="#cb48-3854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3855"><a href="#cb48-3855" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the damage estimation reactable</span></span>
<span id="cb48-3856"><a href="#cb48-3856" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-3857"><a href="#cb48-3857" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb48-3858"><a href="#cb48-3858" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-3859"><a href="#cb48-3859" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3860"><a href="#cb48-3860" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-3861"><a href="#cb48-3861" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-3862"><a href="#cb48-3862" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-3863"><a href="#cb48-3863" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3864"><a href="#cb48-3864" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3865"><a href="#cb48-3865" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-3866"><a href="#cb48-3866" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Road Surface</span></span>
<span id="cb48-3867"><a href="#cb48-3867" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_asphalt_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Asphalt"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3868"><a href="#cb48-3868" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Chips Seal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3869"><a href="#cb48-3869" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_concrete_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3870"><a href="#cb48-3870" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_earth_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Earth"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-3871"><a href="#cb48-3871" aria-hidden="true" tabindex="-1"></a>    <span class="at">road_gravel_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Gravel"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-3872"><a href="#cb48-3872" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3873"><a href="#cb48-3873" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-3874"><a href="#cb48-3874" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-3875"><a href="#cb48-3875" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Road Surface"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"road_asphalt_damaged"</span>, <span class="st">"road_chips seal_damaged"</span>, </span>
<span id="cb48-3876"><a href="#cb48-3876" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"road_concrete_damaged"</span>, <span class="st">"road_earth_damaged"</span>, </span>
<span id="cb48-3877"><a href="#cb48-3877" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"road_gravel_damaged"</span>))</span>
<span id="cb48-3878"><a href="#cb48-3878" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3879"><a href="#cb48-3879" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3880"><a href="#cb48-3880" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3881"><a href="#cb48-3881" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3882"><a href="#cb48-3882" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-3883"><a href="#cb48-3883" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-3884"><a href="#cb48-3884" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-3885"><a href="#cb48-3885" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-3886"><a href="#cb48-3886" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-3887"><a href="#cb48-3887" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-3888"><a href="#cb48-3888" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-3889"><a href="#cb48-3889" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-3890"><a href="#cb48-3890" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-3891"><a href="#cb48-3891" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-3892"><a href="#cb48-3892" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-3893"><a href="#cb48-3893" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3894"><a href="#cb48-3894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-3895"><a href="#cb48-3895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3896"><a href="#cb48-3896" aria-hidden="true" tabindex="-1"></a><span class="fu">## Immediate Response Resources</span></span>
<span id="cb48-3897"><a href="#cb48-3897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3900"><a href="#cb48-3900" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-3901"><a href="#cb48-3901" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-3902"><a href="#cb48-3902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3903"><a href="#cb48-3903" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get resource multipliers</span></span>
<span id="cb48-3904"><a href="#cb48-3904" aria-hidden="true" tabindex="-1"></a>get_logistics_resource_multiplier <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb48-3905"><a href="#cb48-3905" aria-hidden="true" tabindex="-1"></a>  multiplier <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb48-3906"><a href="#cb48-3906" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-3907"><a href="#cb48-3907" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Logistics"</span>,</span>
<span id="cb48-3908"><a href="#cb48-3908" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> resource_type,</span>
<span id="cb48-3909"><a href="#cb48-3909" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-3910"><a href="#cb48-3910" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3911"><a href="#cb48-3911" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-3912"><a href="#cb48-3912" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-3913"><a href="#cb48-3913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(multiplier) <span class="sc">&gt;</span> <span class="dv">0</span>, multiplier, <span class="dv">0</span>))</span>
<span id="cb48-3914"><a href="#cb48-3914" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-3915"><a href="#cb48-3915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3916"><a href="#cb48-3916" aria-hidden="true" tabindex="-1"></a><span class="co"># Determine which councils are affected (have cyclone intensity assigned)</span></span>
<span id="cb48-3917"><a href="#cb48-3917" aria-hidden="true" tabindex="-1"></a>affected_councils <span class="ot">&lt;-</span> config <span class="sc">%&gt;%</span></span>
<span id="cb48-3918"><a href="#cb48-3918" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Intensity)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3919"><a href="#cb48-3919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>, Province) <span class="sc">%&gt;%</span></span>
<span id="cb48-3920"><a href="#cb48-3920" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb48-3921"><a href="#cb48-3921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3922"><a href="#cb48-3922" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of affected councils</span></span>
<span id="cb48-3923"><a href="#cb48-3923" aria-hidden="true" tabindex="-1"></a>num_affected_councils <span class="ot">&lt;-</span> <span class="fu">nrow</span>(affected_councils)</span>
<span id="cb48-3924"><a href="#cb48-3924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3925"><a href="#cb48-3925" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of affected provinces</span></span>
<span id="cb48-3926"><a href="#cb48-3926" aria-hidden="true" tabindex="-1"></a>num_affected_provinces <span class="ot">&lt;-</span> affected_councils <span class="sc">%&gt;%</span></span>
<span id="cb48-3927"><a href="#cb48-3927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb48-3928"><a href="#cb48-3928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3929"><a href="#cb48-3929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nrow</span>()</span>
<span id="cb48-3930"><a href="#cb48-3930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3931"><a href="#cb48-3931" aria-hidden="true" tabindex="-1"></a><span class="co"># Create council-level resources (for councils that are affected)</span></span>
<span id="cb48-3932"><a href="#cb48-3932" aria-hidden="true" tabindex="-1"></a>resources_needed_councils <span class="ot">&lt;-</span> affected_councils <span class="sc">%&gt;%</span></span>
<span id="cb48-3933"><a href="#cb48-3933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3934"><a href="#cb48-3934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3935"><a href="#cb48-3935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-3936"><a href="#cb48-3936" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Resources = multiplier * 1 (per affected council)</span></span>
<span id="cb48-3937"><a href="#cb48-3937" aria-hidden="true" tabindex="-1"></a>    <span class="at">truck =</span> <span class="fu">round</span>(<span class="dv">1</span> <span class="sc">*</span> <span class="fu">get_logistics_resource_multiplier</span>(<span class="st">"Truck"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb48-3938"><a href="#cb48-3938" aria-hidden="true" tabindex="-1"></a>    <span class="at">fibreglass_boat =</span> <span class="fu">round</span>(<span class="dv">10</span> <span class="sc">*</span> <span class="fu">get_logistics_resource_multiplier</span>(<span class="st">"Fibreglass Boat"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb48-3939"><a href="#cb48-3939" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuel =</span> <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> <span class="fu">get_logistics_resource_multiplier</span>(<span class="st">"Fuel"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb48-3940"><a href="#cb48-3940" aria-hidden="true" tabindex="-1"></a>    <span class="at">chainsaw =</span> <span class="fu">round</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">get_logistics_resource_multiplier</span>(<span class="st">"Chainsaw"</span>, Region), <span class="dv">0</span>),</span>
<span id="cb48-3941"><a href="#cb48-3941" aria-hidden="true" tabindex="-1"></a>    <span class="at">ship =</span> <span class="dv">0</span>  <span class="co"># Ships only at province/national level</span></span>
<span id="cb48-3942"><a href="#cb48-3942" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3943"><a href="#cb48-3943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-3944"><a href="#cb48-3944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, truck, fibreglass_boat, ship, fuel, chainsaw)</span>
<span id="cb48-3945"><a href="#cb48-3945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3946"><a href="#cb48-3946" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province level</span></span>
<span id="cb48-3947"><a href="#cb48-3947" aria-hidden="true" tabindex="-1"></a>province_resources <span class="ot">&lt;-</span> resources_needed_councils <span class="sc">%&gt;%</span></span>
<span id="cb48-3948"><a href="#cb48-3948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(council_province_lookup, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Council"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3949"><a href="#cb48-3949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Province) <span class="sc">%&gt;%</span></span>
<span id="cb48-3950"><a href="#cb48-3950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb48-3951"><a href="#cb48-3951" aria-hidden="true" tabindex="-1"></a>    <span class="at">truck =</span> <span class="fu">sum</span>(truck, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-3952"><a href="#cb48-3952" aria-hidden="true" tabindex="-1"></a>    <span class="at">fibreglass_boat =</span> <span class="fu">sum</span>(fibreglass_boat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-3953"><a href="#cb48-3953" aria-hidden="true" tabindex="-1"></a>    <span class="at">ship =</span> <span class="dv">1</span>,  <span class="co"># 1 ship per affected province</span></span>
<span id="cb48-3954"><a href="#cb48-3954" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuel =</span> <span class="fu">sum</span>(fuel, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-3955"><a href="#cb48-3955" aria-hidden="true" tabindex="-1"></a>    <span class="at">chainsaw =</span> <span class="fu">sum</span>(chainsaw, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-3956"><a href="#cb48-3956" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb48-3957"><a href="#cb48-3957" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3958"><a href="#cb48-3958" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Region =</span> Province)</span>
<span id="cb48-3959"><a href="#cb48-3959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3960"><a href="#cb48-3960" aria-hidden="true" tabindex="-1"></a><span class="co"># National level - sum of provinces</span></span>
<span id="cb48-3961"><a href="#cb48-3961" aria-hidden="true" tabindex="-1"></a>national_resources <span class="ot">&lt;-</span> province_resources <span class="sc">%&gt;%</span></span>
<span id="cb48-3962"><a href="#cb48-3962" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb48-3963"><a href="#cb48-3963" aria-hidden="true" tabindex="-1"></a>    <span class="at">truck =</span> <span class="fu">sum</span>(truck, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-3964"><a href="#cb48-3964" aria-hidden="true" tabindex="-1"></a>    <span class="at">fibreglass_boat =</span> <span class="fu">sum</span>(fibreglass_boat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-3965"><a href="#cb48-3965" aria-hidden="true" tabindex="-1"></a>    <span class="at">ship =</span> <span class="fu">sum</span>(ship, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-3966"><a href="#cb48-3966" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuel =</span> <span class="fu">sum</span>(fuel, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb48-3967"><a href="#cb48-3967" aria-hidden="true" tabindex="-1"></a>    <span class="at">chainsaw =</span> <span class="fu">sum</span>(chainsaw, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb48-3968"><a href="#cb48-3968" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-3969"><a href="#cb48-3969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">"National"</span>)</span>
<span id="cb48-3970"><a href="#cb48-3970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3971"><a href="#cb48-3971" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all levels</span></span>
<span id="cb48-3972"><a href="#cb48-3972" aria-hidden="true" tabindex="-1"></a>resources_needed_full <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb48-3973"><a href="#cb48-3973" aria-hidden="true" tabindex="-1"></a>  national_resources,</span>
<span id="cb48-3974"><a href="#cb48-3974" aria-hidden="true" tabindex="-1"></a>  province_resources,</span>
<span id="cb48-3975"><a href="#cb48-3975" aria-hidden="true" tabindex="-1"></a>  resources_needed_councils</span>
<span id="cb48-3976"><a href="#cb48-3976" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb48-3977"><a href="#cb48-3977" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">default_order =</span> <span class="fu">match</span>(Region, region_order)) <span class="sc">%&gt;%</span></span>
<span id="cb48-3978"><a href="#cb48-3978" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(default_order) <span class="sc">%&gt;%</span></span>
<span id="cb48-3979"><a href="#cb48-3979" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>default_order)</span>
<span id="cb48-3980"><a href="#cb48-3980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3981"><a href="#cb48-3981" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-3982"><a href="#cb48-3982" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-3983"><a href="#cb48-3983" aria-hidden="true" tabindex="-1"></a>  resources_needed_full,</span>
<span id="cb48-3984"><a href="#cb48-3984" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_03_resources_needed.csv"</span>),</span>
<span id="cb48-3985"><a href="#cb48-3985" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-3986"><a href="#cb48-3986" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-3987"><a href="#cb48-3987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3988"><a href="#cb48-3988" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-3989"><a href="#cb48-3989" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-3990"><a href="#cb48-3990" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(resources_needed_full)</span>
<span id="cb48-3991"><a href="#cb48-3991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3992"><a href="#cb48-3992" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the resources needed reactable</span></span>
<span id="cb48-3993"><a href="#cb48-3993" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-3994"><a href="#cb48-3994" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-3995"><a href="#cb48-3995" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-3996"><a href="#cb48-3996" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-3997"><a href="#cb48-3997" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-3998"><a href="#cb48-3998" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-3999"><a href="#cb48-3999" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-4000"><a href="#cb48-4000" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4001"><a href="#cb48-4001" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4002"><a href="#cb48-4002" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4003"><a href="#cb48-4003" aria-hidden="true" tabindex="-1"></a>    <span class="at">truck =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4004"><a href="#cb48-4004" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Truck"</span>,</span>
<span id="cb48-4005"><a href="#cb48-4005" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4006"><a href="#cb48-4006" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4007"><a href="#cb48-4007" aria-hidden="true" tabindex="-1"></a>    <span class="at">fibreglass_boat =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4008"><a href="#cb48-4008" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Fibreglass Boat"</span>,</span>
<span id="cb48-4009"><a href="#cb48-4009" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4010"><a href="#cb48-4010" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4011"><a href="#cb48-4011" aria-hidden="true" tabindex="-1"></a>    <span class="at">ship =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4012"><a href="#cb48-4012" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Ship"</span>,</span>
<span id="cb48-4013"><a href="#cb48-4013" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4014"><a href="#cb48-4014" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4015"><a href="#cb48-4015" aria-hidden="true" tabindex="-1"></a>    <span class="at">fuel =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4016"><a href="#cb48-4016" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Fuel (litres)"</span>,</span>
<span id="cb48-4017"><a href="#cb48-4017" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4018"><a href="#cb48-4018" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4019"><a href="#cb48-4019" aria-hidden="true" tabindex="-1"></a>    <span class="at">chainsaw =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4020"><a href="#cb48-4020" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Chainsaw"</span>,</span>
<span id="cb48-4021"><a href="#cb48-4021" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4022"><a href="#cb48-4022" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-4023"><a href="#cb48-4023" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4024"><a href="#cb48-4024" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-4025"><a href="#cb48-4025" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-4026"><a href="#cb48-4026" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Resources Needed"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"truck"</span>, <span class="st">"fibreglass_boat"</span>, <span class="st">"ship"</span>, <span class="st">"fuel"</span>, <span class="st">"chainsaw"</span>))</span>
<span id="cb48-4027"><a href="#cb48-4027" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4028"><a href="#cb48-4028" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4029"><a href="#cb48-4029" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4030"><a href="#cb48-4030" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4031"><a href="#cb48-4031" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-4032"><a href="#cb48-4032" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-4033"><a href="#cb48-4033" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-4034"><a href="#cb48-4034" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4035"><a href="#cb48-4035" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-4036"><a href="#cb48-4036" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-4037"><a href="#cb48-4037" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4038"><a href="#cb48-4038" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-4039"><a href="#cb48-4039" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4040"><a href="#cb48-4040" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-4041"><a href="#cb48-4041" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4042"><a href="#cb48-4042" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4043"><a href="#cb48-4043" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-4044"><a href="#cb48-4044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4045"><a href="#cb48-4045" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimated Financial Damage</span></span>
<span id="cb48-4046"><a href="#cb48-4046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4047"><a href="#cb48-4047" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 1: Infrastructure Financial Damage</span></span>
<span id="cb48-4048"><a href="#cb48-4048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4051"><a href="#cb48-4051" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-4052"><a href="#cb48-4052" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-4053"><a href="#cb48-4053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4054"><a href="#cb48-4054" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for infrastructure</span></span>
<span id="cb48-4055"><a href="#cb48-4055" aria-hidden="true" tabindex="-1"></a>get_infrastructure_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(infrastructure_type, area_council) {</span>
<span id="cb48-4056"><a href="#cb48-4056" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb48-4057"><a href="#cb48-4057" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-4058"><a href="#cb48-4058" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Logistics"</span>,</span>
<span id="cb48-4059"><a href="#cb48-4059" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Infrastructure"</span>,</span>
<span id="cb48-4060"><a href="#cb48-4060" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(infrastructure_type)),</span>
<span id="cb48-4061"><a href="#cb48-4061" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-4062"><a href="#cb48-4062" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4063"><a href="#cb48-4063" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-4064"><a href="#cb48-4064" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-4065"><a href="#cb48-4065" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb48-4066"><a href="#cb48-4066" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-4067"><a href="#cb48-4067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4068"><a href="#cb48-4068" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the raw damage estimates (before rounding) for financial calculations</span></span>
<span id="cb48-4069"><a href="#cb48-4069" aria-hidden="true" tabindex="-1"></a>infrastructure_financial <span class="ot">&lt;-</span> infrastructure_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb48-4070"><a href="#cb48-4070" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-4071"><a href="#cb48-4071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-4072"><a href="#cb48-4072" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each infrastructure type (in VT)</span></span>
<span id="cb48-4073"><a href="#cb48-4073" aria-hidden="true" tabindex="-1"></a>    <span class="at">airport_financial =</span> infra_airport_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"airport"</span>, Region),</span>
<span id="cb48-4074"><a href="#cb48-4074" aria-hidden="true" tabindex="-1"></a>    <span class="at">wharf_financial =</span> infra_wharf_damaged <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"wharf"</span>, Region),</span>
<span id="cb48-4075"><a href="#cb48-4075" aria-hidden="true" tabindex="-1"></a>    <span class="at">permanent_bridge_financial =</span> <span class="st">`</span><span class="at">infra_permanent bridge_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"permanent bridge"</span>, Region),</span>
<span id="cb48-4076"><a href="#cb48-4076" aria-hidden="true" tabindex="-1"></a>    <span class="at">temporary_bridge_financial =</span> <span class="st">`</span><span class="at">infra_temporary bridge_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"temporary bridge"</span>, Region),</span>
<span id="cb48-4077"><a href="#cb48-4077" aria-hidden="true" tabindex="-1"></a>    <span class="at">police_stations_financial =</span> <span class="st">`</span><span class="at">infra_police stations_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"police stations"</span>, Region),</span>
<span id="cb48-4078"><a href="#cb48-4078" aria-hidden="true" tabindex="-1"></a>    <span class="at">fire_hydrants_financial =</span> <span class="st">`</span><span class="at">infra_fire hydrants_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"fire hydrants"</span>, Region),</span>
<span id="cb48-4079"><a href="#cb48-4079" aria-hidden="true" tabindex="-1"></a>    <span class="at">main_water_valves_financial =</span> <span class="st">`</span><span class="at">infra_main water valves_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_infrastructure_unit_cost</span>(<span class="st">"main water valves"</span>, Region),</span>
<span id="cb48-4080"><a href="#cb48-4080" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4081"><a href="#cb48-4081" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total infrastructure financial damage</span></span>
<span id="cb48-4082"><a href="#cb48-4082" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_infrastructure_financial =</span> airport_financial <span class="sc">+</span> wharf_financial <span class="sc">+</span> permanent_bridge_financial <span class="sc">+</span></span>
<span id="cb48-4083"><a href="#cb48-4083" aria-hidden="true" tabindex="-1"></a>                                      temporary_bridge_financial <span class="sc">+</span> police_stations_financial <span class="sc">+</span> </span>
<span id="cb48-4084"><a href="#cb48-4084" aria-hidden="true" tabindex="-1"></a>                                      fire_hydrants_financial <span class="sc">+</span> main_water_valves_financial</span>
<span id="cb48-4085"><a href="#cb48-4085" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4086"><a href="#cb48-4086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-4087"><a href="#cb48-4087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_infrastructure_financial, airport_financial, wharf_financial, </span>
<span id="cb48-4088"><a href="#cb48-4088" aria-hidden="true" tabindex="-1"></a>         permanent_bridge_financial, temporary_bridge_financial, police_stations_financial,</span>
<span id="cb48-4089"><a href="#cb48-4089" aria-hidden="true" tabindex="-1"></a>         fire_hydrants_financial, main_water_valves_financial)</span>
<span id="cb48-4090"><a href="#cb48-4090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4091"><a href="#cb48-4091" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-4092"><a href="#cb48-4092" aria-hidden="true" tabindex="-1"></a>infrastructure_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(infrastructure_financial)</span>
<span id="cb48-4093"><a href="#cb48-4093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4094"><a href="#cb48-4094" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-4095"><a href="#cb48-4095" aria-hidden="true" tabindex="-1"></a>infrastructure_financial_ordered <span class="ot">&lt;-</span> infrastructure_financial_full <span class="sc">%&gt;%</span></span>
<span id="cb48-4096"><a href="#cb48-4096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_infrastructure_financial, airport_financial, wharf_financial,</span>
<span id="cb48-4097"><a href="#cb48-4097" aria-hidden="true" tabindex="-1"></a>         permanent_bridge_financial, temporary_bridge_financial, police_stations_financial,</span>
<span id="cb48-4098"><a href="#cb48-4098" aria-hidden="true" tabindex="-1"></a>         fire_hydrants_financial, main_water_valves_financial)</span>
<span id="cb48-4099"><a href="#cb48-4099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4100"><a href="#cb48-4100" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 1 TO CSV ===</span></span>
<span id="cb48-4101"><a href="#cb48-4101" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-4102"><a href="#cb48-4102" aria-hidden="true" tabindex="-1"></a>  infrastructure_financial_ordered,</span>
<span id="cb48-4103"><a href="#cb48-4103" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_04a_financial_damage_infrastructure.csv"</span>),</span>
<span id="cb48-4104"><a href="#cb48-4104" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-4105"><a href="#cb48-4105" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4106"><a href="#cb48-4106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4107"><a href="#cb48-4107" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 1 ===</span></span>
<span id="cb48-4108"><a href="#cb48-4108" aria-hidden="true" tabindex="-1"></a>formatted1 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(infrastructure_financial_ordered)</span>
<span id="cb48-4109"><a href="#cb48-4109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4110"><a href="#cb48-4110" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-4111"><a href="#cb48-4111" aria-hidden="true" tabindex="-1"></a>  formatted1,</span>
<span id="cb48-4112"><a href="#cb48-4112" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-4113"><a href="#cb48-4113" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4114"><a href="#cb48-4114" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-4115"><a href="#cb48-4115" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-4116"><a href="#cb48-4116" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-4117"><a href="#cb48-4117" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4118"><a href="#cb48-4118" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4119"><a href="#cb48-4119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4120"><a href="#cb48-4120" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_infrastructure_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4121"><a href="#cb48-4121" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb48-4122"><a href="#cb48-4122" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4123"><a href="#cb48-4123" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4124"><a href="#cb48-4124" aria-hidden="true" tabindex="-1"></a>    <span class="at">airport_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4125"><a href="#cb48-4125" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Airport"</span>,</span>
<span id="cb48-4126"><a href="#cb48-4126" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4127"><a href="#cb48-4127" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4128"><a href="#cb48-4128" aria-hidden="true" tabindex="-1"></a>    <span class="at">wharf_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4129"><a href="#cb48-4129" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Wharf"</span>,</span>
<span id="cb48-4130"><a href="#cb48-4130" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4131"><a href="#cb48-4131" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4132"><a href="#cb48-4132" aria-hidden="true" tabindex="-1"></a>    <span class="at">permanent_bridge_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4133"><a href="#cb48-4133" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Permanent Bridge"</span>,</span>
<span id="cb48-4134"><a href="#cb48-4134" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4135"><a href="#cb48-4135" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4136"><a href="#cb48-4136" aria-hidden="true" tabindex="-1"></a>    <span class="at">temporary_bridge_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4137"><a href="#cb48-4137" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Temporary Bridge"</span>,</span>
<span id="cb48-4138"><a href="#cb48-4138" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4139"><a href="#cb48-4139" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4140"><a href="#cb48-4140" aria-hidden="true" tabindex="-1"></a>    <span class="at">police_stations_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4141"><a href="#cb48-4141" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Police Stations"</span>,</span>
<span id="cb48-4142"><a href="#cb48-4142" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4143"><a href="#cb48-4143" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4144"><a href="#cb48-4144" aria-hidden="true" tabindex="-1"></a>    <span class="at">fire_hydrants_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4145"><a href="#cb48-4145" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Fire Hydrants"</span>,</span>
<span id="cb48-4146"><a href="#cb48-4146" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4147"><a href="#cb48-4147" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4148"><a href="#cb48-4148" aria-hidden="true" tabindex="-1"></a>    <span class="at">main_water_valves_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4149"><a href="#cb48-4149" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Main Water Valves"</span>,</span>
<span id="cb48-4150"><a href="#cb48-4150" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4151"><a href="#cb48-4151" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-4152"><a href="#cb48-4152" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4153"><a href="#cb48-4153" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-4154"><a href="#cb48-4154" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-4155"><a href="#cb48-4155" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Infrastructure"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_infrastructure_financial"</span>, <span class="st">"airport_financial"</span>, </span>
<span id="cb48-4156"><a href="#cb48-4156" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"wharf_financial"</span>, <span class="st">"permanent_bridge_financial"</span>,</span>
<span id="cb48-4157"><a href="#cb48-4157" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"temporary_bridge_financial"</span>, <span class="st">"police_stations_financial"</span>,</span>
<span id="cb48-4158"><a href="#cb48-4158" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"fire_hydrants_financial"</span>, <span class="st">"main_water_valves_financial"</span>))</span>
<span id="cb48-4159"><a href="#cb48-4159" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4160"><a href="#cb48-4160" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4161"><a href="#cb48-4161" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4162"><a href="#cb48-4162" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4163"><a href="#cb48-4163" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-4164"><a href="#cb48-4164" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-4165"><a href="#cb48-4165" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-4166"><a href="#cb48-4166" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4167"><a href="#cb48-4167" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-4168"><a href="#cb48-4168" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-4169"><a href="#cb48-4169" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4170"><a href="#cb48-4170" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-4171"><a href="#cb48-4171" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4172"><a href="#cb48-4172" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-4173"><a href="#cb48-4173" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4174"><a href="#cb48-4174" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4175"><a href="#cb48-4175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-4176"><a href="#cb48-4176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4177"><a href="#cb48-4177" aria-hidden="true" tabindex="-1"></a><span class="fu">### Table 2: Road Surface Financial Damage</span></span>
<span id="cb48-4178"><a href="#cb48-4178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4181"><a href="#cb48-4181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-4182"><a href="#cb48-4182" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper function to get unit costs for road surface</span></span>
<span id="cb48-4183"><a href="#cb48-4183" aria-hidden="true" tabindex="-1"></a>get_road_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(road_type, area_council) {</span>
<span id="cb48-4184"><a href="#cb48-4184" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb48-4185"><a href="#cb48-4185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-4186"><a href="#cb48-4186" aria-hidden="true" tabindex="-1"></a>      Cluster <span class="sc">==</span> <span class="st">"Logistics"</span>,</span>
<span id="cb48-4187"><a href="#cb48-4187" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> <span class="st">"Road Surface"</span>,</span>
<span id="cb48-4188"><a href="#cb48-4188" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(road_type)),</span>
<span id="cb48-4189"><a href="#cb48-4189" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-4190"><a href="#cb48-4190" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4191"><a href="#cb48-4191" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-4192"><a href="#cb48-4192" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-4193"><a href="#cb48-4193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb48-4194"><a href="#cb48-4194" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-4195"><a href="#cb48-4195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4196"><a href="#cb48-4196" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the raw damage estimates (before rounding) for financial calculations</span></span>
<span id="cb48-4197"><a href="#cb48-4197" aria-hidden="true" tabindex="-1"></a>road_financial <span class="ot">&lt;-</span> road_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb48-4198"><a href="#cb48-4198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-4199"><a href="#cb48-4199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-4200"><a href="#cb48-4200" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for each road surface type (in VT)</span></span>
<span id="cb48-4201"><a href="#cb48-4201" aria-hidden="true" tabindex="-1"></a>    <span class="at">asphalt_financial =</span> road_asphalt_damaged <span class="sc">*</span> <span class="fu">get_road_unit_cost</span>(<span class="st">"asphalt"</span>, Region),</span>
<span id="cb48-4202"><a href="#cb48-4202" aria-hidden="true" tabindex="-1"></a>    <span class="at">chips_seal_financial =</span> <span class="st">`</span><span class="at">road_chips seal_damaged</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_road_unit_cost</span>(<span class="st">"chips seal"</span>, Region),</span>
<span id="cb48-4203"><a href="#cb48-4203" aria-hidden="true" tabindex="-1"></a>    <span class="at">concrete_financial =</span> road_concrete_damaged <span class="sc">*</span> <span class="fu">get_road_unit_cost</span>(<span class="st">"concrete"</span>, Region),</span>
<span id="cb48-4204"><a href="#cb48-4204" aria-hidden="true" tabindex="-1"></a>    <span class="at">earth_financial =</span> road_earth_damaged <span class="sc">*</span> <span class="fu">get_road_unit_cost</span>(<span class="st">"earth"</span>, Region),</span>
<span id="cb48-4205"><a href="#cb48-4205" aria-hidden="true" tabindex="-1"></a>    <span class="at">gravel_financial =</span> road_gravel_damaged <span class="sc">*</span> <span class="fu">get_road_unit_cost</span>(<span class="st">"gravel"</span>, Region),</span>
<span id="cb48-4206"><a href="#cb48-4206" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4207"><a href="#cb48-4207" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total road surface financial damage</span></span>
<span id="cb48-4208"><a href="#cb48-4208" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_road_financial =</span> asphalt_financial <span class="sc">+</span> chips_seal_financial <span class="sc">+</span> concrete_financial <span class="sc">+</span></span>
<span id="cb48-4209"><a href="#cb48-4209" aria-hidden="true" tabindex="-1"></a>                            earth_financial <span class="sc">+</span> gravel_financial</span>
<span id="cb48-4210"><a href="#cb48-4210" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4211"><a href="#cb48-4211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-4212"><a href="#cb48-4212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_road_financial, asphalt_financial, chips_seal_financial,</span>
<span id="cb48-4213"><a href="#cb48-4213" aria-hidden="true" tabindex="-1"></a>         concrete_financial, earth_financial, gravel_financial)</span>
<span id="cb48-4214"><a href="#cb48-4214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4215"><a href="#cb48-4215" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-4216"><a href="#cb48-4216" aria-hidden="true" tabindex="-1"></a>road_financial_full <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(road_financial)</span>
<span id="cb48-4217"><a href="#cb48-4217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4218"><a href="#cb48-4218" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-4219"><a href="#cb48-4219" aria-hidden="true" tabindex="-1"></a>road_financial_ordered <span class="ot">&lt;-</span> road_financial_full <span class="sc">%&gt;%</span></span>
<span id="cb48-4220"><a href="#cb48-4220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_road_financial, asphalt_financial, chips_seal_financial,</span>
<span id="cb48-4221"><a href="#cb48-4221" aria-hidden="true" tabindex="-1"></a>         concrete_financial, earth_financial, gravel_financial)</span>
<span id="cb48-4222"><a href="#cb48-4222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4223"><a href="#cb48-4223" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TABLE 2 TO CSV ===</span></span>
<span id="cb48-4224"><a href="#cb48-4224" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-4225"><a href="#cb48-4225" aria-hidden="true" tabindex="-1"></a>  road_financial_ordered,</span>
<span id="cb48-4226"><a href="#cb48-4226" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Logistics_04b_financial_damage_road_surface.csv"</span>),</span>
<span id="cb48-4227"><a href="#cb48-4227" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-4228"><a href="#cb48-4228" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4229"><a href="#cb48-4229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4230"><a href="#cb48-4230" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION TABLE 2 ===</span></span>
<span id="cb48-4231"><a href="#cb48-4231" aria-hidden="true" tabindex="-1"></a>formatted2 <span class="ot">&lt;-</span> <span class="fu">format_table</span>(road_financial_ordered)</span>
<span id="cb48-4232"><a href="#cb48-4232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4233"><a href="#cb48-4233" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-4234"><a href="#cb48-4234" aria-hidden="true" tabindex="-1"></a>  formatted2,</span>
<span id="cb48-4235"><a href="#cb48-4235" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-4236"><a href="#cb48-4236" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4237"><a href="#cb48-4237" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>, </span>
<span id="cb48-4238"><a href="#cb48-4238" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-4239"><a href="#cb48-4239" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-4240"><a href="#cb48-4240" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4241"><a href="#cb48-4241" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4242"><a href="#cb48-4242" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4243"><a href="#cb48-4243" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_road_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4244"><a href="#cb48-4244" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb48-4245"><a href="#cb48-4245" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4246"><a href="#cb48-4246" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4247"><a href="#cb48-4247" aria-hidden="true" tabindex="-1"></a>    <span class="at">asphalt_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4248"><a href="#cb48-4248" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Asphalt"</span>,</span>
<span id="cb48-4249"><a href="#cb48-4249" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4250"><a href="#cb48-4250" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4251"><a href="#cb48-4251" aria-hidden="true" tabindex="-1"></a>    <span class="at">chips_seal_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4252"><a href="#cb48-4252" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Chips Seal"</span>,</span>
<span id="cb48-4253"><a href="#cb48-4253" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4254"><a href="#cb48-4254" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4255"><a href="#cb48-4255" aria-hidden="true" tabindex="-1"></a>    <span class="at">concrete_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4256"><a href="#cb48-4256" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Concrete"</span>,</span>
<span id="cb48-4257"><a href="#cb48-4257" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4258"><a href="#cb48-4258" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4259"><a href="#cb48-4259" aria-hidden="true" tabindex="-1"></a>    <span class="at">earth_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4260"><a href="#cb48-4260" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Earth"</span>,</span>
<span id="cb48-4261"><a href="#cb48-4261" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4262"><a href="#cb48-4262" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4263"><a href="#cb48-4263" aria-hidden="true" tabindex="-1"></a>    <span class="at">gravel_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4264"><a href="#cb48-4264" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Gravel"</span>,</span>
<span id="cb48-4265"><a href="#cb48-4265" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4266"><a href="#cb48-4266" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-4267"><a href="#cb48-4267" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4268"><a href="#cb48-4268" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-4269"><a href="#cb48-4269" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-4270"><a href="#cb48-4270" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Road Surface"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_road_financial"</span>, <span class="st">"asphalt_financial"</span>, </span>
<span id="cb48-4271"><a href="#cb48-4271" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"chips_seal_financial"</span>, <span class="st">"concrete_financial"</span>,</span>
<span id="cb48-4272"><a href="#cb48-4272" aria-hidden="true" tabindex="-1"></a>                                                  <span class="st">"earth_financial"</span>, <span class="st">"gravel_financial"</span>))</span>
<span id="cb48-4273"><a href="#cb48-4273" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4274"><a href="#cb48-4274" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4275"><a href="#cb48-4275" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4276"><a href="#cb48-4276" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4277"><a href="#cb48-4277" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-4278"><a href="#cb48-4278" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-4279"><a href="#cb48-4279" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-4280"><a href="#cb48-4280" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4281"><a href="#cb48-4281" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-4282"><a href="#cb48-4282" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-4283"><a href="#cb48-4283" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4284"><a href="#cb48-4284" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-4285"><a href="#cb48-4285" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4286"><a href="#cb48-4286" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-4287"><a href="#cb48-4287" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4288"><a href="#cb48-4288" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4289"><a href="#cb48-4289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-4290"><a href="#cb48-4290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4291"><a href="#cb48-4291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4292"><a href="#cb48-4292" aria-hidden="true" tabindex="-1"></a><span class="fu"># Shelter </span></span>
<span id="cb48-4293"><a href="#cb48-4293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4294"><a href="#cb48-4294" aria-hidden="true" tabindex="-1"></a><span class="fu">## Baseline</span></span>
<span id="cb48-4295"><a href="#cb48-4295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4298"><a href="#cb48-4298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-4299"><a href="#cb48-4299" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Shelter baseline at Area Council level</span></span>
<span id="cb48-4300"><a href="#cb48-4300" aria-hidden="true" tabindex="-1"></a>shelter_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-4301"><a href="#cb48-4301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4302"><a href="#cb48-4302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4303"><a href="#cb48-4303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4304"><a href="#cb48-4304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb48-4305"><a href="#cb48-4305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4306"><a href="#cb48-4306" aria-hidden="true" tabindex="-1"></a><span class="co"># Get total households</span></span>
<span id="cb48-4307"><a href="#cb48-4307" aria-hidden="true" tabindex="-1"></a>total_households <span class="ot">&lt;-</span> shelter_data <span class="sc">%&gt;%</span></span>
<span id="cb48-4308"><a href="#cb48-4308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"number households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4309"><a href="#cb48-4309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-4310"><a href="#cb48-4310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">total_households =</span> Value)</span>
<span id="cb48-4311"><a href="#cb48-4311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4312"><a href="#cb48-4312" aria-hidden="true" tabindex="-1"></a><span class="co"># Get roof materials</span></span>
<span id="cb48-4313"><a href="#cb48-4313" aria-hidden="true" tabindex="-1"></a>roof_materials <span class="ot">&lt;-</span> shelter_data <span class="sc">%&gt;%</span></span>
<span id="cb48-4314"><a href="#cb48-4314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Roof Material"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4315"><a href="#cb48-4315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">material =</span> <span class="fu">paste0</span>(<span class="st">"roof_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb48-4316"><a href="#cb48-4316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, material, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-4317"><a href="#cb48-4317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-4318"><a href="#cb48-4318" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> material,</span>
<span id="cb48-4319"><a href="#cb48-4319" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb48-4320"><a href="#cb48-4320" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-4321"><a href="#cb48-4321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4322"><a href="#cb48-4322" aria-hidden="true" tabindex="-1"></a><span class="co"># Get wall materials</span></span>
<span id="cb48-4323"><a href="#cb48-4323" aria-hidden="true" tabindex="-1"></a>wall_materials <span class="ot">&lt;-</span> shelter_data <span class="sc">%&gt;%</span></span>
<span id="cb48-4324"><a href="#cb48-4324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Wall Material"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4325"><a href="#cb48-4325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">material =</span> <span class="fu">paste0</span>(<span class="st">"wall_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb48-4326"><a href="#cb48-4326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, material, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-4327"><a href="#cb48-4327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-4328"><a href="#cb48-4328" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> material,</span>
<span id="cb48-4329"><a href="#cb48-4329" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb48-4330"><a href="#cb48-4330" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-4331"><a href="#cb48-4331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4332"><a href="#cb48-4332" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all data</span></span>
<span id="cb48-4333"><a href="#cb48-4333" aria-hidden="true" tabindex="-1"></a>shelter_wide <span class="ot">&lt;-</span> total_households <span class="sc">%&gt;%</span></span>
<span id="cb48-4334"><a href="#cb48-4334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(roof_materials, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4335"><a href="#cb48-4335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(wall_materials, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4336"><a href="#cb48-4336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-4337"><a href="#cb48-4337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4338"><a href="#cb48-4338" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-4339"><a href="#cb48-4339" aria-hidden="true" tabindex="-1"></a>shelter_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(shelter_wide)</span>
<span id="cb48-4340"><a href="#cb48-4340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4341"><a href="#cb48-4341" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-4342"><a href="#cb48-4342" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-4343"><a href="#cb48-4343" aria-hidden="true" tabindex="-1"></a>  shelter_aggregated <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb48-4344"><a href="#cb48-4344" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Shelter_01_baseline.csv"</span>),</span>
<span id="cb48-4345"><a href="#cb48-4345" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-4346"><a href="#cb48-4346" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4347"><a href="#cb48-4347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4348"><a href="#cb48-4348" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-4349"><a href="#cb48-4349" aria-hidden="true" tabindex="-1"></a><span class="co"># Format for display</span></span>
<span id="cb48-4350"><a href="#cb48-4350" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(shelter_aggregated)</span>
<span id="cb48-4351"><a href="#cb48-4351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4352"><a href="#cb48-4352" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the reactable</span></span>
<span id="cb48-4353"><a href="#cb48-4353" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-4354"><a href="#cb48-4354" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-4355"><a href="#cb48-4355" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-4356"><a href="#cb48-4356" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4357"><a href="#cb48-4357" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb48-4358"><a href="#cb48-4358" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-4359"><a href="#cb48-4359" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4360"><a href="#cb48-4360" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-4361"><a href="#cb48-4361" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4362"><a href="#cb48-4362" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-4363"><a href="#cb48-4363" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4364"><a href="#cb48-4364" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4365"><a href="#cb48-4365" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4366"><a href="#cb48-4366" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4367"><a href="#cb48-4367" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_concrete =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4368"><a href="#cb48-4368" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_metal =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4369"><a href="#cb48-4369" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_wood =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4370"><a href="#cb48-4370" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4371"><a href="#cb48-4371" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_concrete =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4372"><a href="#cb48-4372" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_metal =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4373"><a href="#cb48-4373" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_wood =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-4374"><a href="#cb48-4374" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4375"><a href="#cb48-4375" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-4376"><a href="#cb48-4376" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-4377"><a href="#cb48-4377" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households"</span>)),</span>
<span id="cb48-4378"><a href="#cb48-4378" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Roof Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"roof_concrete"</span>, <span class="st">"roof_metal"</span>, <span class="st">"roof_wood"</span>)),</span>
<span id="cb48-4379"><a href="#cb48-4379" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Wall Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"wall_concrete"</span>, <span class="st">"wall_metal"</span>, <span class="st">"wall_wood"</span>))</span>
<span id="cb48-4380"><a href="#cb48-4380" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4381"><a href="#cb48-4381" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4382"><a href="#cb48-4382" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4383"><a href="#cb48-4383" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4384"><a href="#cb48-4384" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-4385"><a href="#cb48-4385" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-4386"><a href="#cb48-4386" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-4387"><a href="#cb48-4387" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4388"><a href="#cb48-4388" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-4389"><a href="#cb48-4389" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-4390"><a href="#cb48-4390" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4391"><a href="#cb48-4391" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-4392"><a href="#cb48-4392" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4393"><a href="#cb48-4393" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-4394"><a href="#cb48-4394" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4395"><a href="#cb48-4395" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4396"><a href="#cb48-4396" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-4397"><a href="#cb48-4397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4398"><a href="#cb48-4398" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimated Hazard Damage </span></span>
<span id="cb48-4399"><a href="#cb48-4399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4402"><a href="#cb48-4402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-4403"><a href="#cb48-4403" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-4404"><a href="#cb48-4404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4405"><a href="#cb48-4405" aria-hidden="true" tabindex="-1"></a><span class="co"># Load damage multiplier configuration</span></span>
<span id="cb48-4406"><a href="#cb48-4406" aria-hidden="true" tabindex="-1"></a>baseline_factors <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb48-4407"><a href="#cb48-4407" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"2a Input- Damage Multiplier.csv"</span>),</span>
<span id="cb48-4408"><a href="#cb48-4408" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-4409"><a href="#cb48-4409" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4410"><a href="#cb48-4410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4411"><a href="#cb48-4411" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Shelter damage functions</span></span>
<span id="cb48-4412"><a href="#cb48-4412" aria-hidden="true" tabindex="-1"></a>shelter_damage_functions <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb48-4413"><a href="#cb48-4413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"Shelter"</span>)</span>
<span id="cb48-4414"><a href="#cb48-4414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4415"><a href="#cb48-4415" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get damage rate for a given indicator, attribute, area council, and intensity</span></span>
<span id="cb48-4416"><a href="#cb48-4416" aria-hidden="true" tabindex="-1"></a>get_shelter_damage_rate <span class="ot">&lt;-</span> <span class="cf">function</span>(indicator, attribute, area_council, intensity) {</span>
<span id="cb48-4417"><a href="#cb48-4417" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intensity <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb48-4418"><a href="#cb48-4418" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-4419"><a href="#cb48-4419" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, intensity)</span>
<span id="cb48-4420"><a href="#cb48-4420" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-4421"><a href="#cb48-4421" aria-hidden="true" tabindex="-1"></a>  rate <span class="ot">&lt;-</span> shelter_damage_functions <span class="sc">%&gt;%</span></span>
<span id="cb48-4422"><a href="#cb48-4422" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-4423"><a href="#cb48-4423" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator,</span>
<span id="cb48-4424"><a href="#cb48-4424" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute)),</span>
<span id="cb48-4425"><a href="#cb48-4425" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-4426"><a href="#cb48-4426" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4427"><a href="#cb48-4427" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="sc">!!</span>intensity_col)</span>
<span id="cb48-4428"><a href="#cb48-4428" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-4429"><a href="#cb48-4429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(rate) <span class="sc">&gt;</span> <span class="dv">0</span>, rate, <span class="dv">0</span>))</span>
<span id="cb48-4430"><a href="#cb48-4430" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-4431"><a href="#cb48-4431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4432"><a href="#cb48-4432" aria-hidden="true" tabindex="-1"></a><span class="co"># Get baseline shelter data at council level</span></span>
<span id="cb48-4433"><a href="#cb48-4433" aria-hidden="true" tabindex="-1"></a>shelter_baseline <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-4434"><a href="#cb48-4434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4435"><a href="#cb48-4435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4436"><a href="#cb48-4436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4437"><a href="#cb48-4437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb48-4438"><a href="#cb48-4438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4439"><a href="#cb48-4439" aria-hidden="true" tabindex="-1"></a><span class="co"># Get private households</span></span>
<span id="cb48-4440"><a href="#cb48-4440" aria-hidden="true" tabindex="-1"></a>private_households <span class="ot">&lt;-</span> shelter_baseline <span class="sc">%&gt;%</span></span>
<span id="cb48-4441"><a href="#cb48-4441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"private households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4442"><a href="#cb48-4442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-4443"><a href="#cb48-4443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">private_households =</span> Value)</span>
<span id="cb48-4444"><a href="#cb48-4444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4445"><a href="#cb48-4445" aria-hidden="true" tabindex="-1"></a><span class="co"># Get roof materials</span></span>
<span id="cb48-4446"><a href="#cb48-4446" aria-hidden="true" tabindex="-1"></a>roof_materials <span class="ot">&lt;-</span> shelter_baseline <span class="sc">%&gt;%</span></span>
<span id="cb48-4447"><a href="#cb48-4447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Roof Material"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4448"><a href="#cb48-4448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">material =</span> <span class="fu">paste0</span>(<span class="st">"roof_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb48-4449"><a href="#cb48-4449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, material, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-4450"><a href="#cb48-4450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-4451"><a href="#cb48-4451" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> material,</span>
<span id="cb48-4452"><a href="#cb48-4452" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb48-4453"><a href="#cb48-4453" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-4454"><a href="#cb48-4454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4455"><a href="#cb48-4455" aria-hidden="true" tabindex="-1"></a><span class="co"># Get wall materials</span></span>
<span id="cb48-4456"><a href="#cb48-4456" aria-hidden="true" tabindex="-1"></a>wall_materials <span class="ot">&lt;-</span> shelter_baseline <span class="sc">%&gt;%</span></span>
<span id="cb48-4457"><a href="#cb48-4457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Wall Material"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4458"><a href="#cb48-4458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">material =</span> <span class="fu">paste0</span>(<span class="st">"wall_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb48-4459"><a href="#cb48-4459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, material, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-4460"><a href="#cb48-4460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-4461"><a href="#cb48-4461" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> material,</span>
<span id="cb48-4462"><a href="#cb48-4462" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb48-4463"><a href="#cb48-4463" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-4464"><a href="#cb48-4464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4465"><a href="#cb48-4465" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine baseline data</span></span>
<span id="cb48-4466"><a href="#cb48-4466" aria-hidden="true" tabindex="-1"></a>shelter_baseline_wide <span class="ot">&lt;-</span> private_households <span class="sc">%&gt;%</span></span>
<span id="cb48-4467"><a href="#cb48-4467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(roof_materials, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4468"><a href="#cb48-4468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(wall_materials, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4469"><a href="#cb48-4469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-4470"><a href="#cb48-4470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4471"><a href="#cb48-4471" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with hazard intensity from config</span></span>
<span id="cb48-4472"><a href="#cb48-4472" aria-hidden="true" tabindex="-1"></a>shelter_with_intensity <span class="ot">&lt;-</span> shelter_baseline_wide <span class="sc">%&gt;%</span></span>
<span id="cb48-4473"><a href="#cb48-4473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb48-4474"><a href="#cb48-4474" aria-hidden="true" tabindex="-1"></a>    config <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>, Intensity),</span>
<span id="cb48-4475"><a href="#cb48-4475" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>)</span>
<span id="cb48-4476"><a href="#cb48-4476" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4477"><a href="#cb48-4477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intensity =</span> <span class="fu">replace_na</span>(Intensity, <span class="dv">0</span>))</span>
<span id="cb48-4478"><a href="#cb48-4478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4479"><a href="#cb48-4479" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage for each household type/material</span></span>
<span id="cb48-4480"><a href="#cb48-4480" aria-hidden="true" tabindex="-1"></a>shelter_damage_raw <span class="ot">&lt;-</span> shelter_with_intensity <span class="sc">%&gt;%</span></span>
<span id="cb48-4481"><a href="#cb48-4481" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-4482"><a href="#cb48-4482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-4483"><a href="#cb48-4483" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Private households damaged</span></span>
<span id="cb48-4484"><a href="#cb48-4484" aria-hidden="true" tabindex="-1"></a>    <span class="at">private_households_damaged =</span> private_households <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Type"</span>, <span class="st">"private households"</span>, Region, Intensity),</span>
<span id="cb48-4485"><a href="#cb48-4485" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4486"><a href="#cb48-4486" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Roof materials damaged</span></span>
<span id="cb48-4487"><a href="#cb48-4487" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_concrete_damaged =</span> roof_concrete <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"concrete"</span>, Region, Intensity),</span>
<span id="cb48-4488"><a href="#cb48-4488" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_metal_damaged =</span> roof_metal <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"metal"</span>, Region, Intensity),</span>
<span id="cb48-4489"><a href="#cb48-4489" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_wood_damaged =</span> roof_wood <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"wood"</span>, Region, Intensity),</span>
<span id="cb48-4490"><a href="#cb48-4490" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4491"><a href="#cb48-4491" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Wall materials damaged</span></span>
<span id="cb48-4492"><a href="#cb48-4492" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_concrete_damaged =</span> wall_concrete <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"concrete"</span>, Region, Intensity),</span>
<span id="cb48-4493"><a href="#cb48-4493" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_metal_damaged =</span> wall_metal <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"metal"</span>, Region, Intensity),</span>
<span id="cb48-4494"><a href="#cb48-4494" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_wood_damaged =</span> wall_wood <span class="sc">*</span> <span class="fu">get_shelter_damage_rate</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"wood"</span>, Region, Intensity)</span>
<span id="cb48-4495"><a href="#cb48-4495" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4496"><a href="#cb48-4496" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb48-4497"><a href="#cb48-4497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4498"><a href="#cb48-4498" aria-hidden="true" tabindex="-1"></a><span class="co"># Round for presentation</span></span>
<span id="cb48-4499"><a href="#cb48-4499" aria-hidden="true" tabindex="-1"></a>shelter_damage_rounded <span class="ot">&lt;-</span> shelter_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb48-4500"><a href="#cb48-4500" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Intensity <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb48-4501"><a href="#cb48-4501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">ends_with</span>(<span class="st">"_damaged"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4502"><a href="#cb48-4502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-4503"><a href="#cb48-4503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4504"><a href="#cb48-4504" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-4505"><a href="#cb48-4505" aria-hidden="true" tabindex="-1"></a>shelter_damage_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(shelter_damage_rounded)</span>
<span id="cb48-4506"><a href="#cb48-4506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4507"><a href="#cb48-4507" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-4508"><a href="#cb48-4508" aria-hidden="true" tabindex="-1"></a>shelter_damage_ordered <span class="ot">&lt;-</span> shelter_damage_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-4509"><a href="#cb48-4509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, private_households_damaged,</span>
<span id="cb48-4510"><a href="#cb48-4510" aria-hidden="true" tabindex="-1"></a>         roof_concrete_damaged, roof_metal_damaged, roof_wood_damaged,</span>
<span id="cb48-4511"><a href="#cb48-4511" aria-hidden="true" tabindex="-1"></a>         wall_concrete_damaged, wall_metal_damaged, wall_wood_damaged)</span>
<span id="cb48-4512"><a href="#cb48-4512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4513"><a href="#cb48-4513" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-4514"><a href="#cb48-4514" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-4515"><a href="#cb48-4515" aria-hidden="true" tabindex="-1"></a>  shelter_damage_ordered,</span>
<span id="cb48-4516"><a href="#cb48-4516" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Shelter_02_estimated_damage.csv"</span>),</span>
<span id="cb48-4517"><a href="#cb48-4517" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-4518"><a href="#cb48-4518" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4519"><a href="#cb48-4519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4520"><a href="#cb48-4520" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-4521"><a href="#cb48-4521" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(shelter_damage_ordered)</span>
<span id="cb48-4522"><a href="#cb48-4522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4523"><a href="#cb48-4523" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-4524"><a href="#cb48-4524" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-4525"><a href="#cb48-4525" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-4526"><a href="#cb48-4526" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4527"><a href="#cb48-4527" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb48-4528"><a href="#cb48-4528" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-4529"><a href="#cb48-4529" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4530"><a href="#cb48-4530" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-4531"><a href="#cb48-4531" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4532"><a href="#cb48-4532" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-4533"><a href="#cb48-4533" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4534"><a href="#cb48-4534" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4535"><a href="#cb48-4535" aria-hidden="true" tabindex="-1"></a>    <span class="at">private_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Total Private Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4536"><a href="#cb48-4536" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4537"><a href="#cb48-4537" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_concrete_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4538"><a href="#cb48-4538" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_metal_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4539"><a href="#cb48-4539" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_wood_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4540"><a href="#cb48-4540" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4541"><a href="#cb48-4541" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_concrete_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Concrete"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4542"><a href="#cb48-4542" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_metal_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Metal"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4543"><a href="#cb48-4543" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_wood_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Wood"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-4544"><a href="#cb48-4544" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4545"><a href="#cb48-4545" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-4546"><a href="#cb48-4546" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-4547"><a href="#cb48-4547" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Number of Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"private_households_damaged"</span>)),</span>
<span id="cb48-4548"><a href="#cb48-4548" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Roof Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"roof_concrete_damaged"</span>, <span class="st">"roof_metal_damaged"</span>, <span class="st">"roof_wood_damaged"</span>)),</span>
<span id="cb48-4549"><a href="#cb48-4549" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Wall Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"wall_concrete_damaged"</span>, <span class="st">"wall_metal_damaged"</span>, <span class="st">"wall_wood_damaged"</span>))</span>
<span id="cb48-4550"><a href="#cb48-4550" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4551"><a href="#cb48-4551" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4552"><a href="#cb48-4552" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4553"><a href="#cb48-4553" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4554"><a href="#cb48-4554" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-4555"><a href="#cb48-4555" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-4556"><a href="#cb48-4556" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-4557"><a href="#cb48-4557" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4558"><a href="#cb48-4558" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-4559"><a href="#cb48-4559" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-4560"><a href="#cb48-4560" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4561"><a href="#cb48-4561" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-4562"><a href="#cb48-4562" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4563"><a href="#cb48-4563" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-4564"><a href="#cb48-4564" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4565"><a href="#cb48-4565" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4566"><a href="#cb48-4566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-4567"><a href="#cb48-4567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4568"><a href="#cb48-4568" aria-hidden="true" tabindex="-1"></a><span class="fu">## Immediate Response Resources</span></span>
<span id="cb48-4569"><a href="#cb48-4569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4572"><a href="#cb48-4572" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-4573"><a href="#cb48-4573" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-4574"><a href="#cb48-4574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4575"><a href="#cb48-4575" aria-hidden="true" tabindex="-1"></a><span class="co"># Load resources configuration</span></span>
<span id="cb48-4576"><a href="#cb48-4576" aria-hidden="true" tabindex="-1"></a>resource_config <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb48-4577"><a href="#cb48-4577" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"3aii Input- Resources Sent.csv"</span>),</span>
<span id="cb48-4578"><a href="#cb48-4578" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-4579"><a href="#cb48-4579" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4580"><a href="#cb48-4580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4581"><a href="#cb48-4581" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Shelter resources</span></span>
<span id="cb48-4582"><a href="#cb48-4582" aria-hidden="true" tabindex="-1"></a>shelter_resources <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb48-4583"><a href="#cb48-4583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"Shelter"</span>)</span>
<span id="cb48-4584"><a href="#cb48-4584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4585"><a href="#cb48-4585" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get resource quantity per household</span></span>
<span id="cb48-4586"><a href="#cb48-4586" aria-hidden="true" tabindex="-1"></a>get_shelter_resource_quantity <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb48-4587"><a href="#cb48-4587" aria-hidden="true" tabindex="-1"></a>  quantity <span class="ot">&lt;-</span> shelter_resources <span class="sc">%&gt;%</span></span>
<span id="cb48-4588"><a href="#cb48-4588" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-4589"><a href="#cb48-4589" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Indicator)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(resource_type)),</span>
<span id="cb48-4590"><a href="#cb48-4590" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-4591"><a href="#cb48-4591" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4592"><a href="#cb48-4592" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-4593"><a href="#cb48-4593" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-4594"><a href="#cb48-4594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(quantity) <span class="sc">&gt;</span> <span class="dv">0</span>, quantity, <span class="dv">0</span>))</span>
<span id="cb48-4595"><a href="#cb48-4595" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-4596"><a href="#cb48-4596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4597"><a href="#cb48-4597" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the damaged households from previous section</span></span>
<span id="cb48-4598"><a href="#cb48-4598" aria-hidden="true" tabindex="-1"></a>shelter_resources_calc <span class="ot">&lt;-</span> shelter_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb48-4599"><a href="#cb48-4599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Intensity <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span>  <span class="co"># &lt;-- ADD THIS LINE</span></span>
<span id="cb48-4600"><a href="#cb48-4600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, private_households_damaged) <span class="sc">%&gt;%</span></span>
<span id="cb48-4601"><a href="#cb48-4601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-4602"><a href="#cb48-4602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-4603"><a href="#cb48-4603" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate resource needs based on damaged households</span></span>
<span id="cb48-4604"><a href="#cb48-4604" aria-hidden="true" tabindex="-1"></a>    <span class="at">tent =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"tent"</span>, Region),</span>
<span id="cb48-4605"><a href="#cb48-4605" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_lamp =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"solar lamp"</span>, Region),</span>
<span id="cb48-4606"><a href="#cb48-4606" aria-hidden="true" tabindex="-1"></a>    <span class="at">kitchen_set =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"kitchen set"</span>, Region),</span>
<span id="cb48-4607"><a href="#cb48-4607" aria-hidden="true" tabindex="-1"></a>    <span class="at">jerrycan_10l =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"jerrycan 10l"</span>, Region),</span>
<span id="cb48-4608"><a href="#cb48-4608" aria-hidden="true" tabindex="-1"></a>    <span class="at">sleeping_mat =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"sleeping mat"</span>, Region),</span>
<span id="cb48-4609"><a href="#cb48-4609" aria-hidden="true" tabindex="-1"></a>    <span class="at">blanket =</span> private_households_damaged <span class="sc">*</span> <span class="fu">get_shelter_resource_quantity</span>(<span class="st">"blanket"</span>, Region)</span>
<span id="cb48-4610"><a href="#cb48-4610" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4611"><a href="#cb48-4611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb48-4612"><a href="#cb48-4612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4613"><a href="#cb48-4613" aria-hidden="true" tabindex="-1"></a><span class="co"># Round for presentation</span></span>
<span id="cb48-4614"><a href="#cb48-4614" aria-hidden="true" tabindex="-1"></a>shelter_resources_rounded <span class="ot">&lt;-</span> shelter_resources_calc <span class="sc">%&gt;%</span></span>
<span id="cb48-4615"><a href="#cb48-4615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-4616"><a href="#cb48-4616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4617"><a href="#cb48-4617" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-4618"><a href="#cb48-4618" aria-hidden="true" tabindex="-1"></a>shelter_resources_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(shelter_resources_rounded)</span>
<span id="cb48-4619"><a href="#cb48-4619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4620"><a href="#cb48-4620" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-4621"><a href="#cb48-4621" aria-hidden="true" tabindex="-1"></a>shelter_resources_ordered <span class="ot">&lt;-</span> shelter_resources_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-4622"><a href="#cb48-4622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, private_households_damaged, tent, solar_lamp, kitchen_set, </span>
<span id="cb48-4623"><a href="#cb48-4623" aria-hidden="true" tabindex="-1"></a>         jerrycan_10l, sleeping_mat, blanket)</span>
<span id="cb48-4624"><a href="#cb48-4624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4625"><a href="#cb48-4625" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-4626"><a href="#cb48-4626" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-4627"><a href="#cb48-4627" aria-hidden="true" tabindex="-1"></a>  shelter_resources_ordered,</span>
<span id="cb48-4628"><a href="#cb48-4628" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Shelter_03_resources.csv"</span>),</span>
<span id="cb48-4629"><a href="#cb48-4629" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-4630"><a href="#cb48-4630" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4631"><a href="#cb48-4631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4632"><a href="#cb48-4632" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-4633"><a href="#cb48-4633" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(shelter_resources_ordered)</span>
<span id="cb48-4634"><a href="#cb48-4634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4635"><a href="#cb48-4635" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-4636"><a href="#cb48-4636" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-4637"><a href="#cb48-4637" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-4638"><a href="#cb48-4638" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4639"><a href="#cb48-4639" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb48-4640"><a href="#cb48-4640" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-4641"><a href="#cb48-4641" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4642"><a href="#cb48-4642" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-4643"><a href="#cb48-4643" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4644"><a href="#cb48-4644" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-4645"><a href="#cb48-4645" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4646"><a href="#cb48-4646" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4647"><a href="#cb48-4647" aria-hidden="true" tabindex="-1"></a>    <span class="at">private_households_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Number of Households"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4648"><a href="#cb48-4648" aria-hidden="true" tabindex="-1"></a>    <span class="at">tent =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tent"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4649"><a href="#cb48-4649" aria-hidden="true" tabindex="-1"></a>    <span class="at">solar_lamp =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Solar Lamp"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4650"><a href="#cb48-4650" aria-hidden="true" tabindex="-1"></a>    <span class="at">kitchen_set =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Kitchen Set"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4651"><a href="#cb48-4651" aria-hidden="true" tabindex="-1"></a>    <span class="at">jerrycan_10l =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Jerrycan 10L"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4652"><a href="#cb48-4652" aria-hidden="true" tabindex="-1"></a>    <span class="at">sleeping_mat =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Sleeping Mat"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4653"><a href="#cb48-4653" aria-hidden="true" tabindex="-1"></a>    <span class="at">blanket =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Blanket"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-4654"><a href="#cb48-4654" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4655"><a href="#cb48-4655" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-4656"><a href="#cb48-4656" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-4657"><a href="#cb48-4657" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Number of Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"private_households_damaged"</span>)),</span>
<span id="cb48-4658"><a href="#cb48-4658" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Resources"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"tent"</span>, <span class="st">"solar_lamp"</span>, <span class="st">"kitchen_set"</span>, </span>
<span id="cb48-4659"><a href="#cb48-4659" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">"jerrycan_10l"</span>, <span class="st">"sleeping_mat"</span>, <span class="st">"blanket"</span>))</span>
<span id="cb48-4660"><a href="#cb48-4660" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4661"><a href="#cb48-4661" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4662"><a href="#cb48-4662" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4663"><a href="#cb48-4663" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4664"><a href="#cb48-4664" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-4665"><a href="#cb48-4665" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-4666"><a href="#cb48-4666" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-4667"><a href="#cb48-4667" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4668"><a href="#cb48-4668" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-4669"><a href="#cb48-4669" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-4670"><a href="#cb48-4670" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4671"><a href="#cb48-4671" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-4672"><a href="#cb48-4672" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4673"><a href="#cb48-4673" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-4674"><a href="#cb48-4674" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4675"><a href="#cb48-4675" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4676"><a href="#cb48-4676" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-4677"><a href="#cb48-4677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4678"><a href="#cb48-4678" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimated Financial Damage</span></span>
<span id="cb48-4679"><a href="#cb48-4679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4682"><a href="#cb48-4682" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-4683"><a href="#cb48-4683" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-4684"><a href="#cb48-4684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4685"><a href="#cb48-4685" aria-hidden="true" tabindex="-1"></a><span class="co"># Load financial configuration</span></span>
<span id="cb48-4686"><a href="#cb48-4686" aria-hidden="true" tabindex="-1"></a>financial_config <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(</span>
<span id="cb48-4687"><a href="#cb48-4687" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"Data"</span>, <span class="st">"4a Input- Finance Estimates.csv"</span>),</span>
<span id="cb48-4688"><a href="#cb48-4688" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-4689"><a href="#cb48-4689" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4690"><a href="#cb48-4690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4691"><a href="#cb48-4691" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Shelter financial costs</span></span>
<span id="cb48-4692"><a href="#cb48-4692" aria-hidden="true" tabindex="-1"></a>shelter_financial <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb48-4693"><a href="#cb48-4693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"Shelter"</span>)</span>
<span id="cb48-4694"><a href="#cb48-4694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4695"><a href="#cb48-4695" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get unit cost for shelter items</span></span>
<span id="cb48-4696"><a href="#cb48-4696" aria-hidden="true" tabindex="-1"></a>get_shelter_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(indicator, attribute, area_council) {</span>
<span id="cb48-4697"><a href="#cb48-4697" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> shelter_financial <span class="sc">%&gt;%</span></span>
<span id="cb48-4698"><a href="#cb48-4698" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-4699"><a href="#cb48-4699" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator,</span>
<span id="cb48-4700"><a href="#cb48-4700" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute)),</span>
<span id="cb48-4701"><a href="#cb48-4701" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-4702"><a href="#cb48-4702" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4703"><a href="#cb48-4703" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-4704"><a href="#cb48-4704" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-4705"><a href="#cb48-4705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb48-4706"><a href="#cb48-4706" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-4707"><a href="#cb48-4707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4708"><a href="#cb48-4708" aria-hidden="true" tabindex="-1"></a><span class="co"># Get baseline appliance data at council level</span></span>
<span id="cb48-4709"><a href="#cb48-4709" aria-hidden="true" tabindex="-1"></a>appliance_baseline <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-4710"><a href="#cb48-4710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>, Indicator <span class="sc">==</span> <span class="st">"Household Appliances"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4711"><a href="#cb48-4711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4712"><a href="#cb48-4712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4713"><a href="#cb48-4713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4714"><a href="#cb48-4714" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Attribute, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-4715"><a href="#cb48-4715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-4716"><a href="#cb48-4716" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> Attribute,</span>
<span id="cb48-4717"><a href="#cb48-4717" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value,</span>
<span id="cb48-4718"><a href="#cb48-4718" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_prefix =</span> <span class="st">"appliance_"</span></span>
<span id="cb48-4719"><a href="#cb48-4719" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4720"><a href="#cb48-4720" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-4721"><a href="#cb48-4721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4722"><a href="#cb48-4722" aria-hidden="true" tabindex="-1"></a><span class="co"># Get baseline private households (needed for damage rate calculation)</span></span>
<span id="cb48-4723"><a href="#cb48-4723" aria-hidden="true" tabindex="-1"></a>baseline_private_households <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-4724"><a href="#cb48-4724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>, Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"private households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4725"><a href="#cb48-4725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4726"><a href="#cb48-4726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4727"><a href="#cb48-4727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4728"><a href="#cb48-4728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-4729"><a href="#cb48-4729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">private_households_baseline =</span> Value)</span>
<span id="cb48-4730"><a href="#cb48-4730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4731"><a href="#cb48-4731" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the raw damage estimates (before rounding) for financial calculations</span></span>
<span id="cb48-4732"><a href="#cb48-4732" aria-hidden="true" tabindex="-1"></a>shelter_financial_calc <span class="ot">&lt;-</span> shelter_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb48-4733"><a href="#cb48-4733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Intensity <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span>  <span class="co"># &lt;-- ADD THIS LIN</span></span>
<span id="cb48-4734"><a href="#cb48-4734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(appliance_baseline, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4735"><a href="#cb48-4735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(baseline_private_households, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4736"><a href="#cb48-4736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-4737"><a href="#cb48-4737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-4738"><a href="#cb48-4738" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for roof materials</span></span>
<span id="cb48-4739"><a href="#cb48-4739" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_concrete_financial =</span> roof_concrete_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"concrete"</span>, Region),</span>
<span id="cb48-4740"><a href="#cb48-4740" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_metal_financial =</span> roof_metal_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"metal"</span>, Region),</span>
<span id="cb48-4741"><a href="#cb48-4741" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_wood_financial =</span> roof_wood_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Roof Material"</span>, <span class="st">"wood"</span>, Region),</span>
<span id="cb48-4742"><a href="#cb48-4742" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4743"><a href="#cb48-4743" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for wall materials</span></span>
<span id="cb48-4744"><a href="#cb48-4744" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_concrete_financial =</span> wall_concrete_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"concrete"</span>, Region),</span>
<span id="cb48-4745"><a href="#cb48-4745" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_metal_financial =</span> wall_metal_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"metal"</span>, Region),</span>
<span id="cb48-4746"><a href="#cb48-4746" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_wood_financial =</span> wall_wood_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Wall Material"</span>, <span class="st">"wood"</span>, Region),</span>
<span id="cb48-4747"><a href="#cb48-4747" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4748"><a href="#cb48-4748" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate damaged appliances based on household damage rate</span></span>
<span id="cb48-4749"><a href="#cb48-4749" aria-hidden="true" tabindex="-1"></a>    <span class="at">damage_rate =</span> <span class="fu">ifelse</span>(private_households_baseline <span class="sc">&gt;</span> <span class="dv">0</span>, private_households_damaged <span class="sc">/</span> private_households_baseline, <span class="dv">0</span>),</span>
<span id="cb48-4750"><a href="#cb48-4750" aria-hidden="true" tabindex="-1"></a>    <span class="at">freezer_damaged =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(appliance_freezer), appliance_freezer <span class="sc">*</span> damage_rate, <span class="dv">0</span>),</span>
<span id="cb48-4751"><a href="#cb48-4751" aria-hidden="true" tabindex="-1"></a>    <span class="at">refrigerator_damaged =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(appliance_refrigerator), appliance_refrigerator <span class="sc">*</span> damage_rate, <span class="dv">0</span>),</span>
<span id="cb48-4752"><a href="#cb48-4752" aria-hidden="true" tabindex="-1"></a>    <span class="at">tv_damaged =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(appliance_tv), appliance_tv <span class="sc">*</span> damage_rate, <span class="dv">0</span>),</span>
<span id="cb48-4753"><a href="#cb48-4753" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4754"><a href="#cb48-4754" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate financial damage for appliances</span></span>
<span id="cb48-4755"><a href="#cb48-4755" aria-hidden="true" tabindex="-1"></a>    <span class="at">freezer_financial =</span> freezer_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Appliances"</span>, <span class="st">"freezer"</span>, Region),</span>
<span id="cb48-4756"><a href="#cb48-4756" aria-hidden="true" tabindex="-1"></a>    <span class="at">refrigerator_financial =</span> refrigerator_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Appliances"</span>, <span class="st">"refridgerator"</span>, Region),</span>
<span id="cb48-4757"><a href="#cb48-4757" aria-hidden="true" tabindex="-1"></a>    <span class="at">tv_financial =</span> tv_damaged <span class="sc">*</span> <span class="fu">get_shelter_unit_cost</span>(<span class="st">"Household Appliances"</span>, <span class="st">"tv"</span>, Region),</span>
<span id="cb48-4758"><a href="#cb48-4758" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4759"><a href="#cb48-4759" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate total household financial damage (sum of all components)</span></span>
<span id="cb48-4760"><a href="#cb48-4760" aria-hidden="true" tabindex="-1"></a>    <span class="at">private_households_financial =</span> roof_concrete_financial <span class="sc">+</span> roof_metal_financial <span class="sc">+</span> roof_wood_financial <span class="sc">+</span></span>
<span id="cb48-4761"><a href="#cb48-4761" aria-hidden="true" tabindex="-1"></a>                                   wall_concrete_financial <span class="sc">+</span> wall_metal_financial <span class="sc">+</span> wall_wood_financial <span class="sc">+</span></span>
<span id="cb48-4762"><a href="#cb48-4762" aria-hidden="true" tabindex="-1"></a>                                   freezer_financial <span class="sc">+</span> refrigerator_financial <span class="sc">+</span> tv_financial,</span>
<span id="cb48-4763"><a href="#cb48-4763" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4764"><a href="#cb48-4764" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total financial damage (same as private households since that's the sum of all components)</span></span>
<span id="cb48-4765"><a href="#cb48-4765" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial =</span> private_households_financial</span>
<span id="cb48-4766"><a href="#cb48-4766" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-4767"><a href="#cb48-4767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-4768"><a href="#cb48-4768" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial, private_households_financial,</span>
<span id="cb48-4769"><a href="#cb48-4769" aria-hidden="true" tabindex="-1"></a>         roof_concrete_financial, roof_metal_financial, roof_wood_financial,</span>
<span id="cb48-4770"><a href="#cb48-4770" aria-hidden="true" tabindex="-1"></a>         wall_concrete_financial, wall_metal_financial, wall_wood_financial,</span>
<span id="cb48-4771"><a href="#cb48-4771" aria-hidden="true" tabindex="-1"></a>         freezer_financial, refrigerator_financial, tv_financial)</span>
<span id="cb48-4772"><a href="#cb48-4772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4773"><a href="#cb48-4773" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-4774"><a href="#cb48-4774" aria-hidden="true" tabindex="-1"></a>shelter_financial_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(shelter_financial_calc)</span>
<span id="cb48-4775"><a href="#cb48-4775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4776"><a href="#cb48-4776" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-4777"><a href="#cb48-4777" aria-hidden="true" tabindex="-1"></a>shelter_financial_ordered <span class="ot">&lt;-</span> shelter_financial_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-4778"><a href="#cb48-4778" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial, private_households_financial,</span>
<span id="cb48-4779"><a href="#cb48-4779" aria-hidden="true" tabindex="-1"></a>         roof_concrete_financial, roof_metal_financial, roof_wood_financial,</span>
<span id="cb48-4780"><a href="#cb48-4780" aria-hidden="true" tabindex="-1"></a>         wall_concrete_financial, wall_metal_financial, wall_wood_financial,</span>
<span id="cb48-4781"><a href="#cb48-4781" aria-hidden="true" tabindex="-1"></a>         freezer_financial, refrigerator_financial, tv_financial)</span>
<span id="cb48-4782"><a href="#cb48-4782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4783"><a href="#cb48-4783" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-4784"><a href="#cb48-4784" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-4785"><a href="#cb48-4785" aria-hidden="true" tabindex="-1"></a>  shelter_financial_ordered,</span>
<span id="cb48-4786"><a href="#cb48-4786" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Shelter_04_financial_damage.csv"</span>),</span>
<span id="cb48-4787"><a href="#cb48-4787" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-4788"><a href="#cb48-4788" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4789"><a href="#cb48-4789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4790"><a href="#cb48-4790" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-4791"><a href="#cb48-4791" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(shelter_financial_ordered)</span>
<span id="cb48-4792"><a href="#cb48-4792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4793"><a href="#cb48-4793" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-4794"><a href="#cb48-4794" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-4795"><a href="#cb48-4795" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-4796"><a href="#cb48-4796" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4797"><a href="#cb48-4797" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb48-4798"><a href="#cb48-4798" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-4799"><a href="#cb48-4799" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-4800"><a href="#cb48-4800" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4801"><a href="#cb48-4801" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4802"><a href="#cb48-4802" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4803"><a href="#cb48-4803" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4804"><a href="#cb48-4804" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb48-4805"><a href="#cb48-4805" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4806"><a href="#cb48-4806" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4807"><a href="#cb48-4807" aria-hidden="true" tabindex="-1"></a>    <span class="at">private_households_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4808"><a href="#cb48-4808" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Private Households"</span>,</span>
<span id="cb48-4809"><a href="#cb48-4809" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4810"><a href="#cb48-4810" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4811"><a href="#cb48-4811" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4812"><a href="#cb48-4812" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_concrete_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4813"><a href="#cb48-4813" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Concrete"</span>,</span>
<span id="cb48-4814"><a href="#cb48-4814" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4815"><a href="#cb48-4815" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4816"><a href="#cb48-4816" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_metal_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4817"><a href="#cb48-4817" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Metal"</span>,</span>
<span id="cb48-4818"><a href="#cb48-4818" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4819"><a href="#cb48-4819" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4820"><a href="#cb48-4820" aria-hidden="true" tabindex="-1"></a>    <span class="at">roof_wood_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4821"><a href="#cb48-4821" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Wood"</span>,</span>
<span id="cb48-4822"><a href="#cb48-4822" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4823"><a href="#cb48-4823" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4824"><a href="#cb48-4824" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4825"><a href="#cb48-4825" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_concrete_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4826"><a href="#cb48-4826" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Concrete"</span>,</span>
<span id="cb48-4827"><a href="#cb48-4827" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4828"><a href="#cb48-4828" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4829"><a href="#cb48-4829" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_metal_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4830"><a href="#cb48-4830" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Metal"</span>,</span>
<span id="cb48-4831"><a href="#cb48-4831" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4832"><a href="#cb48-4832" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4833"><a href="#cb48-4833" aria-hidden="true" tabindex="-1"></a>    <span class="at">wall_wood_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4834"><a href="#cb48-4834" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Wood"</span>,</span>
<span id="cb48-4835"><a href="#cb48-4835" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4836"><a href="#cb48-4836" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4837"><a href="#cb48-4837" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4838"><a href="#cb48-4838" aria-hidden="true" tabindex="-1"></a>    <span class="at">freezer_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4839"><a href="#cb48-4839" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Freezer"</span>,</span>
<span id="cb48-4840"><a href="#cb48-4840" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4841"><a href="#cb48-4841" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4842"><a href="#cb48-4842" aria-hidden="true" tabindex="-1"></a>    <span class="at">refrigerator_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4843"><a href="#cb48-4843" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Refrigerator"</span>,</span>
<span id="cb48-4844"><a href="#cb48-4844" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4845"><a href="#cb48-4845" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4846"><a href="#cb48-4846" aria-hidden="true" tabindex="-1"></a>    <span class="at">tv_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4847"><a href="#cb48-4847" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"TV"</span>,</span>
<span id="cb48-4848"><a href="#cb48-4848" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-4849"><a href="#cb48-4849" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-4850"><a href="#cb48-4850" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4851"><a href="#cb48-4851" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-4852"><a href="#cb48-4852" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-4853"><a href="#cb48-4853" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Value"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_financial"</span>)),</span>
<span id="cb48-4854"><a href="#cb48-4854" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Private Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"private_households_financial"</span>)),</span>
<span id="cb48-4855"><a href="#cb48-4855" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Roof Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"roof_concrete_financial"</span>, <span class="st">"roof_metal_financial"</span>, <span class="st">"roof_wood_financial"</span>)),</span>
<span id="cb48-4856"><a href="#cb48-4856" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Main Wall Materials"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"wall_concrete_financial"</span>, <span class="st">"wall_metal_financial"</span>, <span class="st">"wall_wood_financial"</span>)),</span>
<span id="cb48-4857"><a href="#cb48-4857" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Household Appliances"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"freezer_financial"</span>, <span class="st">"refrigerator_financial"</span>, <span class="st">"tv_financial"</span>))</span>
<span id="cb48-4858"><a href="#cb48-4858" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4859"><a href="#cb48-4859" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4860"><a href="#cb48-4860" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4861"><a href="#cb48-4861" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4862"><a href="#cb48-4862" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-4863"><a href="#cb48-4863" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-4864"><a href="#cb48-4864" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-4865"><a href="#cb48-4865" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4866"><a href="#cb48-4866" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-4867"><a href="#cb48-4867" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-4868"><a href="#cb48-4868" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4869"><a href="#cb48-4869" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-4870"><a href="#cb48-4870" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4871"><a href="#cb48-4871" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-4872"><a href="#cb48-4872" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4873"><a href="#cb48-4873" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4874"><a href="#cb48-4874" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-4875"><a href="#cb48-4875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4876"><a href="#cb48-4876" aria-hidden="true" tabindex="-1"></a><span class="fu"># WASH</span></span>
<span id="cb48-4877"><a href="#cb48-4877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4878"><a href="#cb48-4878" aria-hidden="true" tabindex="-1"></a><span class="fu">## Baseline</span></span>
<span id="cb48-4879"><a href="#cb48-4879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4882"><a href="#cb48-4882" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-4883"><a href="#cb48-4883" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-4884"><a href="#cb48-4884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4885"><a href="#cb48-4885" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for WASH baseline at Area Council level</span></span>
<span id="cb48-4886"><a href="#cb48-4886" aria-hidden="true" tabindex="-1"></a>wash_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-4887"><a href="#cb48-4887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"WASH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4888"><a href="#cb48-4888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4889"><a href="#cb48-4889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4890"><a href="#cb48-4890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb48-4891"><a href="#cb48-4891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4892"><a href="#cb48-4892" aria-hidden="true" tabindex="-1"></a><span class="co"># Get total households from Shelter baseline (since WASH doesn't have it)</span></span>
<span id="cb48-4893"><a href="#cb48-4893" aria-hidden="true" tabindex="-1"></a>total_households <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-4894"><a href="#cb48-4894" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Shelter"</span>, Indicator <span class="sc">==</span> <span class="st">"Household Type"</span>, Attribute <span class="sc">==</span> <span class="st">"number households"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4895"><a href="#cb48-4895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4896"><a href="#cb48-4896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-4897"><a href="#cb48-4897" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4898"><a href="#cb48-4898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-4899"><a href="#cb48-4899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">total_households =</span> Value)</span>
<span id="cb48-4900"><a href="#cb48-4900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4901"><a href="#cb48-4901" aria-hidden="true" tabindex="-1"></a><span class="co"># Get drinking water sources</span></span>
<span id="cb48-4902"><a href="#cb48-4902" aria-hidden="true" tabindex="-1"></a>drinking_water <span class="ot">&lt;-</span> wash_data <span class="sc">%&gt;%</span></span>
<span id="cb48-4903"><a href="#cb48-4903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Drinking Water"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4904"><a href="#cb48-4904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">water_type =</span> <span class="fu">paste0</span>(<span class="st">"water_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb48-4905"><a href="#cb48-4905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, water_type, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-4906"><a href="#cb48-4906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-4907"><a href="#cb48-4907" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> water_type,</span>
<span id="cb48-4908"><a href="#cb48-4908" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb48-4909"><a href="#cb48-4909" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-4910"><a href="#cb48-4910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4911"><a href="#cb48-4911" aria-hidden="true" tabindex="-1"></a><span class="co"># Get toilet types</span></span>
<span id="cb48-4912"><a href="#cb48-4912" aria-hidden="true" tabindex="-1"></a>toilet_type <span class="ot">&lt;-</span> wash_data <span class="sc">%&gt;%</span></span>
<span id="cb48-4913"><a href="#cb48-4913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Household Toilet"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4914"><a href="#cb48-4914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">toilet_type =</span> <span class="fu">paste0</span>(<span class="st">"toilet_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb48-4915"><a href="#cb48-4915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, toilet_type, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-4916"><a href="#cb48-4916" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-4917"><a href="#cb48-4917" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> toilet_type,</span>
<span id="cb48-4918"><a href="#cb48-4918" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb48-4919"><a href="#cb48-4919" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-4920"><a href="#cb48-4920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4921"><a href="#cb48-4921" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine all data</span></span>
<span id="cb48-4922"><a href="#cb48-4922" aria-hidden="true" tabindex="-1"></a>wash_wide <span class="ot">&lt;-</span> total_households <span class="sc">%&gt;%</span></span>
<span id="cb48-4923"><a href="#cb48-4923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(drinking_water, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4924"><a href="#cb48-4924" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(toilet_type, <span class="at">by =</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4925"><a href="#cb48-4925" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-4926"><a href="#cb48-4926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4927"><a href="#cb48-4927" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-4928"><a href="#cb48-4928" aria-hidden="true" tabindex="-1"></a>wash_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(wash_wide)</span>
<span id="cb48-4929"><a href="#cb48-4929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4930"><a href="#cb48-4930" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-4931"><a href="#cb48-4931" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-4932"><a href="#cb48-4932" aria-hidden="true" tabindex="-1"></a>  wash_aggregated <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb48-4933"><a href="#cb48-4933" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"WASH_01_baseline.csv"</span>),</span>
<span id="cb48-4934"><a href="#cb48-4934" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-4935"><a href="#cb48-4935" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4936"><a href="#cb48-4936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4937"><a href="#cb48-4937" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-4938"><a href="#cb48-4938" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(wash_aggregated)</span>
<span id="cb48-4939"><a href="#cb48-4939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4940"><a href="#cb48-4940" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-4941"><a href="#cb48-4941" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-4942"><a href="#cb48-4942" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-4943"><a href="#cb48-4943" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-4944"><a href="#cb48-4944" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb48-4945"><a href="#cb48-4945" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-4946"><a href="#cb48-4946" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4947"><a href="#cb48-4947" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-4948"><a href="#cb48-4948" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4949"><a href="#cb48-4949" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-4950"><a href="#cb48-4950" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4951"><a href="#cb48-4951" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4952"><a href="#cb48-4952" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_households =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4953"><a href="#cb48-4953" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4954"><a href="#cb48-4954" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_piped =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Piped"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4955"><a href="#cb48-4955" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_well =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Well"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4956"><a href="#cb48-4956" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_tank =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tank"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4957"><a href="#cb48-4957" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-4958"><a href="#cb48-4958" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">toilet_pit latrine</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Pit Latrine"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4959"><a href="#cb48-4959" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_vip =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"VIP"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4960"><a href="#cb48-4960" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_flush =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Flush"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-4961"><a href="#cb48-4961" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">toilet_water sealed</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water Sealed"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-4962"><a href="#cb48-4962" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4963"><a href="#cb48-4963" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-4964"><a href="#cb48-4964" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-4965"><a href="#cb48-4965" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Households"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_households"</span>)),</span>
<span id="cb48-4966"><a href="#cb48-4966" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Drinking Water"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"water_piped"</span>, <span class="st">"water_well"</span>, <span class="st">"water_tank"</span>)),</span>
<span id="cb48-4967"><a href="#cb48-4967" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Toilet Type"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"toilet_pit latrine"</span>, <span class="st">"toilet_vip"</span>, <span class="st">"toilet_flush"</span>, <span class="st">"toilet_water sealed"</span>))</span>
<span id="cb48-4968"><a href="#cb48-4968" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4969"><a href="#cb48-4969" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4970"><a href="#cb48-4970" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4971"><a href="#cb48-4971" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4972"><a href="#cb48-4972" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-4973"><a href="#cb48-4973" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-4974"><a href="#cb48-4974" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-4975"><a href="#cb48-4975" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-4976"><a href="#cb48-4976" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-4977"><a href="#cb48-4977" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-4978"><a href="#cb48-4978" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-4979"><a href="#cb48-4979" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-4980"><a href="#cb48-4980" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-4981"><a href="#cb48-4981" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-4982"><a href="#cb48-4982" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-4983"><a href="#cb48-4983" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-4984"><a href="#cb48-4984" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-4985"><a href="#cb48-4985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4986"><a href="#cb48-4986" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimated Hazard Damage</span></span>
<span id="cb48-4987"><a href="#cb48-4987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4990"><a href="#cb48-4990" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-4991"><a href="#cb48-4991" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-4992"><a href="#cb48-4992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4993"><a href="#cb48-4993" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for WASH damage functions</span></span>
<span id="cb48-4994"><a href="#cb48-4994" aria-hidden="true" tabindex="-1"></a>wash_damage_functions <span class="ot">&lt;-</span> baseline_factors <span class="sc">%&gt;%</span></span>
<span id="cb48-4995"><a href="#cb48-4995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"WASH"</span>)</span>
<span id="cb48-4996"><a href="#cb48-4996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4997"><a href="#cb48-4997" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get damage rate for WASH items</span></span>
<span id="cb48-4998"><a href="#cb48-4998" aria-hidden="true" tabindex="-1"></a>get_wash_damage_rate <span class="ot">&lt;-</span> <span class="cf">function</span>(indicator, attribute, area_council, intensity) {</span>
<span id="cb48-4999"><a href="#cb48-4999" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (intensity <span class="sc">==</span> <span class="dv">0</span>) <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb48-5000"><a href="#cb48-5000" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-5001"><a href="#cb48-5001" aria-hidden="true" tabindex="-1"></a>  intensity_col <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Intensity "</span>, intensity)</span>
<span id="cb48-5002"><a href="#cb48-5002" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-5003"><a href="#cb48-5003" aria-hidden="true" tabindex="-1"></a>  rate <span class="ot">&lt;-</span> wash_damage_functions <span class="sc">%&gt;%</span></span>
<span id="cb48-5004"><a href="#cb48-5004" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-5005"><a href="#cb48-5005" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator,</span>
<span id="cb48-5006"><a href="#cb48-5006" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute)),</span>
<span id="cb48-5007"><a href="#cb48-5007" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-5008"><a href="#cb48-5008" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-5009"><a href="#cb48-5009" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(<span class="sc">!!</span>intensity_col)</span>
<span id="cb48-5010"><a href="#cb48-5010" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-5011"><a href="#cb48-5011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(rate) <span class="sc">&gt;</span> <span class="dv">0</span>, rate, <span class="dv">0</span>))</span>
<span id="cb48-5012"><a href="#cb48-5012" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-5013"><a href="#cb48-5013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5014"><a href="#cb48-5014" aria-hidden="true" tabindex="-1"></a><span class="co"># Get baseline WASH data at council level</span></span>
<span id="cb48-5015"><a href="#cb48-5015" aria-hidden="true" tabindex="-1"></a>wash_baseline <span class="ot">&lt;-</span> wash_wide</span>
<span id="cb48-5016"><a href="#cb48-5016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5017"><a href="#cb48-5017" aria-hidden="true" tabindex="-1"></a><span class="co"># Join with hazard intensity from config</span></span>
<span id="cb48-5018"><a href="#cb48-5018" aria-hidden="true" tabindex="-1"></a>wash_with_intensity <span class="ot">&lt;-</span> wash_baseline <span class="sc">%&gt;%</span></span>
<span id="cb48-5019"><a href="#cb48-5019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb48-5020"><a href="#cb48-5020" aria-hidden="true" tabindex="-1"></a>    config <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>, Intensity),</span>
<span id="cb48-5021"><a href="#cb48-5021" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Region"</span> <span class="ot">=</span> <span class="st">"Area Council"</span>)</span>
<span id="cb48-5022"><a href="#cb48-5022" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-5023"><a href="#cb48-5023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Intensity =</span> <span class="fu">replace_na</span>(Intensity, <span class="dv">0</span>))</span>
<span id="cb48-5024"><a href="#cb48-5024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5025"><a href="#cb48-5025" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate damage for each WASH type</span></span>
<span id="cb48-5026"><a href="#cb48-5026" aria-hidden="true" tabindex="-1"></a>wash_damage_raw <span class="ot">&lt;-</span> wash_with_intensity <span class="sc">%&gt;%</span></span>
<span id="cb48-5027"><a href="#cb48-5027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-5028"><a href="#cb48-5028" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-5029"><a href="#cb48-5029" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Drinking water damaged</span></span>
<span id="cb48-5030"><a href="#cb48-5030" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_piped_damaged =</span> water_piped <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"piped"</span>, Region, Intensity),</span>
<span id="cb48-5031"><a href="#cb48-5031" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_well_damaged =</span> water_well <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"well"</span>, Region, Intensity),</span>
<span id="cb48-5032"><a href="#cb48-5032" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_tank_damaged =</span> water_tank <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"tank"</span>, Region, Intensity),</span>
<span id="cb48-5033"><a href="#cb48-5033" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-5034"><a href="#cb48-5034" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Toilet types damaged</span></span>
<span id="cb48-5035"><a href="#cb48-5035" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_pit_latrine_damaged =</span> <span class="st">`</span><span class="at">toilet_pit latrine</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Toilet"</span>, <span class="st">"pit latrine"</span>, Region, Intensity),</span>
<span id="cb48-5036"><a href="#cb48-5036" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_vip_damaged =</span> toilet_vip <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Toilet"</span>, <span class="st">"vip"</span>, Region, Intensity),</span>
<span id="cb48-5037"><a href="#cb48-5037" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_flush_damaged =</span> toilet_flush <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Toilet"</span>, <span class="st">"flush"</span>, Region, Intensity),</span>
<span id="cb48-5038"><a href="#cb48-5038" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_water_sealed_damaged =</span> <span class="st">`</span><span class="at">toilet_water sealed</span><span class="st">`</span> <span class="sc">*</span> <span class="fu">get_wash_damage_rate</span>(<span class="st">"Household Toilet"</span>, <span class="st">"water sealed"</span>, Region, Intensity)</span>
<span id="cb48-5039"><a href="#cb48-5039" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-5040"><a href="#cb48-5040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb48-5041"><a href="#cb48-5041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5042"><a href="#cb48-5042" aria-hidden="true" tabindex="-1"></a><span class="co"># Round for presentation</span></span>
<span id="cb48-5043"><a href="#cb48-5043" aria-hidden="true" tabindex="-1"></a>wash_damage_rounded <span class="ot">&lt;-</span> wash_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb48-5044"><a href="#cb48-5044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, <span class="fu">ends_with</span>(<span class="st">"_damaged"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-5045"><a href="#cb48-5045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-5046"><a href="#cb48-5046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5047"><a href="#cb48-5047" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-5048"><a href="#cb48-5048" aria-hidden="true" tabindex="-1"></a>wash_damage_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(wash_damage_rounded)</span>
<span id="cb48-5049"><a href="#cb48-5049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5050"><a href="#cb48-5050" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-5051"><a href="#cb48-5051" aria-hidden="true" tabindex="-1"></a>wash_damage_ordered <span class="ot">&lt;-</span> wash_damage_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-5052"><a href="#cb48-5052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, water_piped_damaged, water_well_damaged, water_tank_damaged,</span>
<span id="cb48-5053"><a href="#cb48-5053" aria-hidden="true" tabindex="-1"></a>         toilet_pit_latrine_damaged, toilet_vip_damaged, toilet_flush_damaged, toilet_water_sealed_damaged)</span>
<span id="cb48-5054"><a href="#cb48-5054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5055"><a href="#cb48-5055" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-5056"><a href="#cb48-5056" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-5057"><a href="#cb48-5057" aria-hidden="true" tabindex="-1"></a>  wash_damage_ordered,</span>
<span id="cb48-5058"><a href="#cb48-5058" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"WASH_02_estimated_damage.csv"</span>),</span>
<span id="cb48-5059"><a href="#cb48-5059" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-5060"><a href="#cb48-5060" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5061"><a href="#cb48-5061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5062"><a href="#cb48-5062" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-5063"><a href="#cb48-5063" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(wash_damage_ordered)</span>
<span id="cb48-5064"><a href="#cb48-5064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5065"><a href="#cb48-5065" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-5066"><a href="#cb48-5066" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-5067"><a href="#cb48-5067" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-5068"><a href="#cb48-5068" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5069"><a href="#cb48-5069" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb48-5070"><a href="#cb48-5070" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-5071"><a href="#cb48-5071" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5072"><a href="#cb48-5072" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-5073"><a href="#cb48-5073" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5074"><a href="#cb48-5074" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-5075"><a href="#cb48-5075" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5076"><a href="#cb48-5076" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-5077"><a href="#cb48-5077" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_piped_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Piped"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-5078"><a href="#cb48-5078" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_well_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Well"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-5079"><a href="#cb48-5079" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_tank_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tank"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-5080"><a href="#cb48-5080" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-5081"><a href="#cb48-5081" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_pit_latrine_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Pit Latrine"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-5082"><a href="#cb48-5082" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_vip_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"VIP"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-5083"><a href="#cb48-5083" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_flush_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Flush"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-5084"><a href="#cb48-5084" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_water_sealed_damaged =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Water Sealed"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-5085"><a href="#cb48-5085" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-5086"><a href="#cb48-5086" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-5087"><a href="#cb48-5087" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-5088"><a href="#cb48-5088" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Drinking Water"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"water_piped_damaged"</span>, <span class="st">"water_well_damaged"</span>, <span class="st">"water_tank_damaged"</span>)),</span>
<span id="cb48-5089"><a href="#cb48-5089" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Toilet Type"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"toilet_pit_latrine_damaged"</span>, <span class="st">"toilet_vip_damaged"</span>, <span class="st">"toilet_flush_damaged"</span>, <span class="st">"toilet_water_sealed_damaged"</span>))</span>
<span id="cb48-5090"><a href="#cb48-5090" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-5091"><a href="#cb48-5091" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5092"><a href="#cb48-5092" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5093"><a href="#cb48-5093" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5094"><a href="#cb48-5094" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-5095"><a href="#cb48-5095" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-5096"><a href="#cb48-5096" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-5097"><a href="#cb48-5097" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5098"><a href="#cb48-5098" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-5099"><a href="#cb48-5099" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-5100"><a href="#cb48-5100" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-5101"><a href="#cb48-5101" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-5102"><a href="#cb48-5102" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5103"><a href="#cb48-5103" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-5104"><a href="#cb48-5104" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-5105"><a href="#cb48-5105" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5106"><a href="#cb48-5106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-5107"><a href="#cb48-5107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5108"><a href="#cb48-5108" aria-hidden="true" tabindex="-1"></a><span class="fu">## Immediate Response Resources</span></span>
<span id="cb48-5109"><a href="#cb48-5109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5112"><a href="#cb48-5112" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-5113"><a href="#cb48-5113" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-5114"><a href="#cb48-5114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5115"><a href="#cb48-5115" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for WASH resources</span></span>
<span id="cb48-5116"><a href="#cb48-5116" aria-hidden="true" tabindex="-1"></a>wash_resources <span class="ot">&lt;-</span> resource_config <span class="sc">%&gt;%</span></span>
<span id="cb48-5117"><a href="#cb48-5117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"WASH"</span>)</span>
<span id="cb48-5118"><a href="#cb48-5118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5119"><a href="#cb48-5119" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get resource quantity</span></span>
<span id="cb48-5120"><a href="#cb48-5120" aria-hidden="true" tabindex="-1"></a>get_wash_resource_quantity <span class="ot">&lt;-</span> <span class="cf">function</span>(resource_type, area_council) {</span>
<span id="cb48-5121"><a href="#cb48-5121" aria-hidden="true" tabindex="-1"></a>  quantity <span class="ot">&lt;-</span> wash_resources <span class="sc">%&gt;%</span></span>
<span id="cb48-5122"><a href="#cb48-5122" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-5123"><a href="#cb48-5123" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Indicator)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(resource_type)),</span>
<span id="cb48-5124"><a href="#cb48-5124" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-5125"><a href="#cb48-5125" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-5126"><a href="#cb48-5126" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-5127"><a href="#cb48-5127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-5128"><a href="#cb48-5128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(quantity) <span class="sc">&gt;</span> <span class="dv">0</span>, quantity, <span class="dv">0</span>))</span>
<span id="cb48-5129"><a href="#cb48-5129" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-5130"><a href="#cb48-5130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5131"><a href="#cb48-5131" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate resource needs based on damaged facilities</span></span>
<span id="cb48-5132"><a href="#cb48-5132" aria-hidden="true" tabindex="-1"></a>wash_resources_calc <span class="ot">&lt;-</span> wash_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb48-5133"><a href="#cb48-5133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, water_piped_damaged, water_well_damaged, water_tank_damaged,</span>
<span id="cb48-5134"><a href="#cb48-5134" aria-hidden="true" tabindex="-1"></a>         toilet_pit_latrine_damaged) <span class="sc">%&gt;%</span></span>
<span id="cb48-5135"><a href="#cb48-5135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-5136"><a href="#cb48-5136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-5137"><a href="#cb48-5137" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Keep damaged facility counts (these become the columns)</span></span>
<span id="cb48-5138"><a href="#cb48-5138" aria-hidden="true" tabindex="-1"></a>    <span class="at">piped =</span> water_piped_damaged,</span>
<span id="cb48-5139"><a href="#cb48-5139" aria-hidden="true" tabindex="-1"></a>    <span class="at">well =</span> water_well_damaged,</span>
<span id="cb48-5140"><a href="#cb48-5140" aria-hidden="true" tabindex="-1"></a>    <span class="at">tank =</span> water_tank_damaged,</span>
<span id="cb48-5141"><a href="#cb48-5141" aria-hidden="true" tabindex="-1"></a>    <span class="at">pit_latrine =</span> toilet_pit_latrine_damaged</span>
<span id="cb48-5142"><a href="#cb48-5142" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-5143"><a href="#cb48-5143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-5144"><a href="#cb48-5144" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, piped, well, tank, pit_latrine)</span>
<span id="cb48-5145"><a href="#cb48-5145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5146"><a href="#cb48-5146" aria-hidden="true" tabindex="-1"></a><span class="co"># Round for presentation</span></span>
<span id="cb48-5147"><a href="#cb48-5147" aria-hidden="true" tabindex="-1"></a>wash_resources_rounded <span class="ot">&lt;-</span> wash_resources_calc <span class="sc">%&gt;%</span></span>
<span id="cb48-5148"><a href="#cb48-5148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-5149"><a href="#cb48-5149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5150"><a href="#cb48-5150" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-5151"><a href="#cb48-5151" aria-hidden="true" tabindex="-1"></a>wash_resources_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(wash_resources_rounded)</span>
<span id="cb48-5152"><a href="#cb48-5152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5153"><a href="#cb48-5153" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-5154"><a href="#cb48-5154" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-5155"><a href="#cb48-5155" aria-hidden="true" tabindex="-1"></a>  wash_resources_aggregated,</span>
<span id="cb48-5156"><a href="#cb48-5156" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"WASH_03_immediate_response_resources.csv"</span>),</span>
<span id="cb48-5157"><a href="#cb48-5157" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-5158"><a href="#cb48-5158" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5159"><a href="#cb48-5159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5160"><a href="#cb48-5160" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-5161"><a href="#cb48-5161" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(wash_resources_aggregated)</span>
<span id="cb48-5162"><a href="#cb48-5162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5163"><a href="#cb48-5163" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-5164"><a href="#cb48-5164" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-5165"><a href="#cb48-5165" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-5166"><a href="#cb48-5166" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5167"><a href="#cb48-5167" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb48-5168"><a href="#cb48-5168" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-5169"><a href="#cb48-5169" aria-hidden="true" tabindex="-1"></a>      <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5170"><a href="#cb48-5170" aria-hidden="true" tabindex="-1"></a>      <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-5171"><a href="#cb48-5171" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5172"><a href="#cb48-5172" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-5173"><a href="#cb48-5173" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5174"><a href="#cb48-5174" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-5175"><a href="#cb48-5175" aria-hidden="true" tabindex="-1"></a>    <span class="at">piped =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Piped"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-5176"><a href="#cb48-5176" aria-hidden="true" tabindex="-1"></a>    <span class="at">well =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Well"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-5177"><a href="#cb48-5177" aria-hidden="true" tabindex="-1"></a>    <span class="at">tank =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Tank"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)),</span>
<span id="cb48-5178"><a href="#cb48-5178" aria-hidden="true" tabindex="-1"></a>    <span class="at">pit_latrine =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">"Pit Latrine"</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-5179"><a href="#cb48-5179" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-5180"><a href="#cb48-5180" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-5181"><a href="#cb48-5181" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-5182"><a href="#cb48-5182" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Water Tank"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"piped"</span>)),</span>
<span id="cb48-5183"><a href="#cb48-5183" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Water Purifier Tablets"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"well"</span>)),</span>
<span id="cb48-5184"><a href="#cb48-5184" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Hygiene Kit"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"tank"</span>)),</span>
<span id="cb48-5185"><a href="#cb48-5185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Pit Latrine"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"pit_latrine"</span>))</span>
<span id="cb48-5186"><a href="#cb48-5186" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-5187"><a href="#cb48-5187" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5188"><a href="#cb48-5188" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5189"><a href="#cb48-5189" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5190"><a href="#cb48-5190" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-5191"><a href="#cb48-5191" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-5192"><a href="#cb48-5192" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-5193"><a href="#cb48-5193" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5194"><a href="#cb48-5194" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-5195"><a href="#cb48-5195" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-5196"><a href="#cb48-5196" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-5197"><a href="#cb48-5197" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-5198"><a href="#cb48-5198" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5199"><a href="#cb48-5199" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-5200"><a href="#cb48-5200" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-5201"><a href="#cb48-5201" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5202"><a href="#cb48-5202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-5203"><a href="#cb48-5203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5204"><a href="#cb48-5204" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimated Financial Damage </span></span>
<span id="cb48-5205"><a href="#cb48-5205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5208"><a href="#cb48-5208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-5209"><a href="#cb48-5209" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-5210"><a href="#cb48-5210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5211"><a href="#cb48-5211" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for WASH financial costs</span></span>
<span id="cb48-5212"><a href="#cb48-5212" aria-hidden="true" tabindex="-1"></a>wash_financial <span class="ot">&lt;-</span> financial_config <span class="sc">%&gt;%</span></span>
<span id="cb48-5213"><a href="#cb48-5213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Cluster <span class="sc">==</span> <span class="st">"WASH"</span>)</span>
<span id="cb48-5214"><a href="#cb48-5214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5215"><a href="#cb48-5215" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to get unit cost for WASH items</span></span>
<span id="cb48-5216"><a href="#cb48-5216" aria-hidden="true" tabindex="-1"></a>get_wash_unit_cost <span class="ot">&lt;-</span> <span class="cf">function</span>(indicator, attribute, area_council) {</span>
<span id="cb48-5217"><a href="#cb48-5217" aria-hidden="true" tabindex="-1"></a>  unit_cost <span class="ot">&lt;-</span> wash_financial <span class="sc">%&gt;%</span></span>
<span id="cb48-5218"><a href="#cb48-5218" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb48-5219"><a href="#cb48-5219" aria-hidden="true" tabindex="-1"></a>      Indicator <span class="sc">==</span> indicator,</span>
<span id="cb48-5220"><a href="#cb48-5220" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)) <span class="sc">==</span> <span class="fu">tolower</span>(<span class="fu">trimws</span>(attribute)),</span>
<span id="cb48-5221"><a href="#cb48-5221" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span> <span class="sc">==</span> area_council</span>
<span id="cb48-5222"><a href="#cb48-5222" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-5223"><a href="#cb48-5223" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(Value)</span>
<span id="cb48-5224"><a href="#cb48-5224" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-5225"><a href="#cb48-5225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">ifelse</span>(<span class="fu">length</span>(unit_cost) <span class="sc">&gt;</span> <span class="dv">0</span>, unit_cost, <span class="dv">0</span>))</span>
<span id="cb48-5226"><a href="#cb48-5226" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-5227"><a href="#cb48-5227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5228"><a href="#cb48-5228" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the raw damage estimates (before rounding) for financial calculations</span></span>
<span id="cb48-5229"><a href="#cb48-5229" aria-hidden="true" tabindex="-1"></a>wash_financial_calc <span class="ot">&lt;-</span> wash_damage_raw <span class="sc">%&gt;%</span></span>
<span id="cb48-5230"><a href="#cb48-5230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-5231"><a href="#cb48-5231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb48-5232"><a href="#cb48-5232" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for drinking water (in VT)</span></span>
<span id="cb48-5233"><a href="#cb48-5233" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_piped_financial =</span> water_piped_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"piped"</span>, Region),</span>
<span id="cb48-5234"><a href="#cb48-5234" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_well_financial =</span> water_well_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"well"</span>, Region),</span>
<span id="cb48-5235"><a href="#cb48-5235" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_tank_financial =</span> water_tank_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Drinking Water"</span>, <span class="st">"tank"</span>, Region),</span>
<span id="cb48-5236"><a href="#cb48-5236" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-5237"><a href="#cb48-5237" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Financial damage for toilet types</span></span>
<span id="cb48-5238"><a href="#cb48-5238" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_pit_latrine_financial =</span> toilet_pit_latrine_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Toilet"</span>, <span class="st">"pit latrine"</span>, Region),</span>
<span id="cb48-5239"><a href="#cb48-5239" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_vip_financial =</span> toilet_vip_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Toilet"</span>, <span class="st">"vip"</span>, Region),</span>
<span id="cb48-5240"><a href="#cb48-5240" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_flush_financial =</span> toilet_flush_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Toilet"</span>, <span class="st">"flush"</span>, Region),</span>
<span id="cb48-5241"><a href="#cb48-5241" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_water_sealed_financial =</span> toilet_water_sealed_damaged <span class="sc">*</span> <span class="fu">get_wash_unit_cost</span>(<span class="st">"Household Toilet"</span>, <span class="st">"water sealed"</span>, Region),</span>
<span id="cb48-5242"><a href="#cb48-5242" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-5243"><a href="#cb48-5243" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Total financial damage</span></span>
<span id="cb48-5244"><a href="#cb48-5244" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial =</span> water_piped_financial <span class="sc">+</span> water_well_financial <span class="sc">+</span> water_tank_financial <span class="sc">+</span></span>
<span id="cb48-5245"><a href="#cb48-5245" aria-hidden="true" tabindex="-1"></a>                     toilet_pit_latrine_financial <span class="sc">+</span> toilet_vip_financial <span class="sc">+</span> toilet_flush_financial <span class="sc">+</span> toilet_water_sealed_financial</span>
<span id="cb48-5246"><a href="#cb48-5246" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-5247"><a href="#cb48-5247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-5248"><a href="#cb48-5248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial, water_piped_financial, water_well_financial, water_tank_financial,</span>
<span id="cb48-5249"><a href="#cb48-5249" aria-hidden="true" tabindex="-1"></a>         toilet_pit_latrine_financial, toilet_vip_financial, toilet_flush_financial, toilet_water_sealed_financial)</span>
<span id="cb48-5250"><a href="#cb48-5250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5251"><a href="#cb48-5251" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate to province and national levels</span></span>
<span id="cb48-5252"><a href="#cb48-5252" aria-hidden="true" tabindex="-1"></a>wash_financial_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(wash_financial_calc)</span>
<span id="cb48-5253"><a href="#cb48-5253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5254"><a href="#cb48-5254" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder columns</span></span>
<span id="cb48-5255"><a href="#cb48-5255" aria-hidden="true" tabindex="-1"></a>wash_financial_ordered <span class="ot">&lt;-</span> wash_financial_aggregated <span class="sc">%&gt;%</span></span>
<span id="cb48-5256"><a href="#cb48-5256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_financial, water_piped_financial, water_well_financial, water_tank_financial,</span>
<span id="cb48-5257"><a href="#cb48-5257" aria-hidden="true" tabindex="-1"></a>         toilet_pit_latrine_financial, toilet_vip_financial, toilet_flush_financial, toilet_water_sealed_financial)</span>
<span id="cb48-5258"><a href="#cb48-5258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5259"><a href="#cb48-5259" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-5260"><a href="#cb48-5260" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-5261"><a href="#cb48-5261" aria-hidden="true" tabindex="-1"></a>  wash_financial_ordered,</span>
<span id="cb48-5262"><a href="#cb48-5262" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"WASH_04_financial_damage.csv"</span>),</span>
<span id="cb48-5263"><a href="#cb48-5263" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-5264"><a href="#cb48-5264" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5265"><a href="#cb48-5265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5266"><a href="#cb48-5266" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-5267"><a href="#cb48-5267" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(wash_financial_ordered)</span>
<span id="cb48-5268"><a href="#cb48-5268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5269"><a href="#cb48-5269" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-5270"><a href="#cb48-5270" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-5271"><a href="#cb48-5271" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> <span class="fu">list</span>(</span>
<span id="cb48-5272"><a href="#cb48-5272" aria-hidden="true" tabindex="-1"></a>    <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5273"><a href="#cb48-5273" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb48-5274"><a href="#cb48-5274" aria-hidden="true" tabindex="-1"></a>      <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-5275"><a href="#cb48-5275" aria-hidden="true" tabindex="-1"></a>      <span class="at">sticky =</span> <span class="st">"left"</span>,</span>
<span id="cb48-5276"><a href="#cb48-5276" aria-hidden="true" tabindex="-1"></a>      <span class="at">html =</span> <span class="cn">TRUE</span></span>
<span id="cb48-5277"><a href="#cb48-5277" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5278"><a href="#cb48-5278" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-5279"><a href="#cb48-5279" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5280"><a href="#cb48-5280" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Total Value"</span>,</span>
<span id="cb48-5281"><a href="#cb48-5281" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-5282"><a href="#cb48-5282" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5283"><a href="#cb48-5283" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-5284"><a href="#cb48-5284" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_piped_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5285"><a href="#cb48-5285" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Piped"</span>,</span>
<span id="cb48-5286"><a href="#cb48-5286" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-5287"><a href="#cb48-5287" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5288"><a href="#cb48-5288" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_well_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5289"><a href="#cb48-5289" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Well"</span>,</span>
<span id="cb48-5290"><a href="#cb48-5290" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-5291"><a href="#cb48-5291" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5292"><a href="#cb48-5292" aria-hidden="true" tabindex="-1"></a>    <span class="at">water_tank_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5293"><a href="#cb48-5293" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Tank"</span>,</span>
<span id="cb48-5294"><a href="#cb48-5294" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-5295"><a href="#cb48-5295" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5296"><a href="#cb48-5296" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-5297"><a href="#cb48-5297" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_pit_latrine_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5298"><a href="#cb48-5298" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Pit Latrine"</span>,</span>
<span id="cb48-5299"><a href="#cb48-5299" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-5300"><a href="#cb48-5300" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5301"><a href="#cb48-5301" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_vip_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5302"><a href="#cb48-5302" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"VIP"</span>,</span>
<span id="cb48-5303"><a href="#cb48-5303" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-5304"><a href="#cb48-5304" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5305"><a href="#cb48-5305" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_flush_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5306"><a href="#cb48-5306" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Flush"</span>,</span>
<span id="cb48-5307"><a href="#cb48-5307" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-5308"><a href="#cb48-5308" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5309"><a href="#cb48-5309" aria-hidden="true" tabindex="-1"></a>    <span class="at">toilet_water_sealed_financial =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5310"><a href="#cb48-5310" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Water Sealed"</span>,</span>
<span id="cb48-5311"><a href="#cb48-5311" aria-hidden="true" tabindex="-1"></a>      <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">suffix =</span> <span class="st">" VT"</span>, <span class="at">separators =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-5312"><a href="#cb48-5312" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-5313"><a href="#cb48-5313" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-5314"><a href="#cb48-5314" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> <span class="fu">list</span>(</span>
<span id="cb48-5315"><a href="#cb48-5315" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-5316"><a href="#cb48-5316" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Value"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_financial"</span>)),</span>
<span id="cb48-5317"><a href="#cb48-5317" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Drinking Water"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"water_piped_financial"</span>, <span class="st">"water_well_financial"</span>, <span class="st">"water_tank_financial"</span>)),</span>
<span id="cb48-5318"><a href="#cb48-5318" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Toilet Type"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"toilet_pit_latrine_financial"</span>, <span class="st">"toilet_vip_financial"</span>, <span class="st">"toilet_flush_financial"</span>, <span class="st">"toilet_water_sealed_financial"</span>))</span>
<span id="cb48-5319"><a href="#cb48-5319" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-5320"><a href="#cb48-5320" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5321"><a href="#cb48-5321" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5322"><a href="#cb48-5322" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5323"><a href="#cb48-5323" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-5324"><a href="#cb48-5324" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-5325"><a href="#cb48-5325" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-5326"><a href="#cb48-5326" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5327"><a href="#cb48-5327" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-5328"><a href="#cb48-5328" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-5329"><a href="#cb48-5329" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-5330"><a href="#cb48-5330" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-5331"><a href="#cb48-5331" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5332"><a href="#cb48-5332" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-5333"><a href="#cb48-5333" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-5334"><a href="#cb48-5334" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5335"><a href="#cb48-5335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-5336"><a href="#cb48-5336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5337"><a href="#cb48-5337" aria-hidden="true" tabindex="-1"></a><span class="fu"># Business</span></span>
<span id="cb48-5338"><a href="#cb48-5338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5339"><a href="#cb48-5339" aria-hidden="true" tabindex="-1"></a><span class="fu">## Baseline</span></span>
<span id="cb48-5340"><a href="#cb48-5340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5343"><a href="#cb48-5343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-5344"><a href="#cb48-5344" aria-hidden="true" tabindex="-1"></a><span class="co"># === DATA WRANGLING ===</span></span>
<span id="cb48-5345"><a href="#cb48-5345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5346"><a href="#cb48-5346" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for Business baseline at Area Council level</span></span>
<span id="cb48-5347"><a href="#cb48-5347" aria-hidden="true" tabindex="-1"></a>business_data <span class="ot">&lt;-</span> full_data <span class="sc">%&gt;%</span></span>
<span id="cb48-5348"><a href="#cb48-5348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Baseline <span class="sc">==</span> <span class="st">"Business"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-5349"><a href="#cb48-5349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="fu">max</span>(Year, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-5350"><a href="#cb48-5350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(<span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-5351"><a href="#cb48-5351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Region =</span> <span class="st">`</span><span class="at">Area Council</span><span class="st">`</span>)</span>
<span id="cb48-5352"><a href="#cb48-5352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5353"><a href="#cb48-5353" aria-hidden="true" tabindex="-1"></a><span class="co"># Get businesses by industry type and sum them by Region and Attribute</span></span>
<span id="cb48-5354"><a href="#cb48-5354" aria-hidden="true" tabindex="-1"></a>industry_types <span class="ot">&lt;-</span> business_data <span class="sc">%&gt;%</span></span>
<span id="cb48-5355"><a href="#cb48-5355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Indicator <span class="sc">==</span> <span class="st">"Industry Type"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-5356"><a href="#cb48-5356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Region, Attribute) <span class="sc">%&gt;%</span></span>
<span id="cb48-5357"><a href="#cb48-5357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Value =</span> <span class="fu">sum</span>(Value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-5358"><a href="#cb48-5358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">industry =</span> <span class="fu">paste0</span>(<span class="st">"industry_"</span>, <span class="fu">tolower</span>(<span class="fu">trimws</span>(Attribute)))) <span class="sc">%&gt;%</span></span>
<span id="cb48-5359"><a href="#cb48-5359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, industry, Value) <span class="sc">%&gt;%</span></span>
<span id="cb48-5360"><a href="#cb48-5360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb48-5361"><a href="#cb48-5361" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> industry,</span>
<span id="cb48-5362"><a href="#cb48-5362" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> Value</span>
<span id="cb48-5363"><a href="#cb48-5363" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb48-5364"><a href="#cb48-5364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span><span class="fu">replace_na</span>(.x, <span class="dv">0</span>)))</span>
<span id="cb48-5365"><a href="#cb48-5365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5366"><a href="#cb48-5366" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate total businesses</span></span>
<span id="cb48-5367"><a href="#cb48-5367" aria-hidden="true" tabindex="-1"></a>business_wide <span class="ot">&lt;-</span> industry_types <span class="sc">%&gt;%</span></span>
<span id="cb48-5368"><a href="#cb48-5368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_businesses =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="fu">starts_with</span>(<span class="st">"industry_"</span>)), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb48-5369"><a href="#cb48-5369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Region, total_businesses, <span class="fu">everything</span>())</span>
<span id="cb48-5370"><a href="#cb48-5370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5371"><a href="#cb48-5371" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute aggregates (province and national levels)</span></span>
<span id="cb48-5372"><a href="#cb48-5372" aria-hidden="true" tabindex="-1"></a>business_aggregated <span class="ot">&lt;-</span> <span class="fu">compute_council_aggregates</span>(business_wide)</span>
<span id="cb48-5373"><a href="#cb48-5373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5374"><a href="#cb48-5374" aria-hidden="true" tabindex="-1"></a><span class="co"># === EXPORT TO CSV ===</span></span>
<span id="cb48-5375"><a href="#cb48-5375" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(</span>
<span id="cb48-5376"><a href="#cb48-5376" aria-hidden="true" tabindex="-1"></a>  business_aggregated <span class="sc">%&gt;%</span> <span class="fu">select</span>(Region, <span class="fu">everything</span>()),</span>
<span id="cb48-5377"><a href="#cb48-5377" aria-hidden="true" tabindex="-1"></a>  here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"output"</span>, <span class="st">"Business_01_baseline.csv"</span>),</span>
<span id="cb48-5378"><a href="#cb48-5378" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names =</span> <span class="cn">FALSE</span></span>
<span id="cb48-5379"><a href="#cb48-5379" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5380"><a href="#cb48-5380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5381"><a href="#cb48-5381" aria-hidden="true" tabindex="-1"></a><span class="co"># === PRESENTATION ===</span></span>
<span id="cb48-5382"><a href="#cb48-5382" aria-hidden="true" tabindex="-1"></a>formatted <span class="ot">&lt;-</span> <span class="fu">format_table</span>(business_aggregated)</span>
<span id="cb48-5383"><a href="#cb48-5383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5384"><a href="#cb48-5384" aria-hidden="true" tabindex="-1"></a><span class="co"># Get all industry columns (excluding Region and total_businesses)</span></span>
<span id="cb48-5385"><a href="#cb48-5385" aria-hidden="true" tabindex="-1"></a>industry_cols <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(formatted), <span class="fu">c</span>(<span class="st">"Region"</span>, <span class="st">"total_businesses"</span>))</span>
<span id="cb48-5386"><a href="#cb48-5386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5387"><a href="#cb48-5387" aria-hidden="true" tabindex="-1"></a><span class="co"># Create column definitions dynamically</span></span>
<span id="cb48-5388"><a href="#cb48-5388" aria-hidden="true" tabindex="-1"></a>column_defs <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb48-5389"><a href="#cb48-5389" aria-hidden="true" tabindex="-1"></a>  <span class="at">Region =</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5390"><a href="#cb48-5390" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="st">"Region"</span>,   </span>
<span id="cb48-5391"><a href="#cb48-5391" aria-hidden="true" tabindex="-1"></a>    <span class="at">minWidth =</span> <span class="dv">150</span>,</span>
<span id="cb48-5392"><a href="#cb48-5392" aria-hidden="true" tabindex="-1"></a>    <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5393"><a href="#cb48-5393" aria-hidden="true" tabindex="-1"></a>    <span class="at">defaultSortOrder =</span> <span class="st">"asc"</span>,</span>
<span id="cb48-5394"><a href="#cb48-5394" aria-hidden="true" tabindex="-1"></a>    <span class="at">html =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5395"><a href="#cb48-5395" aria-hidden="true" tabindex="-1"></a>    <span class="at">sticky =</span> <span class="st">"left"</span></span>
<span id="cb48-5396"><a href="#cb48-5396" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-5397"><a href="#cb48-5397" aria-hidden="true" tabindex="-1"></a>  <span class="at">total_businesses =</span> <span class="fu">colDef</span>(<span class="at">name =</span> <span class="st">""</span>, <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>))</span>
<span id="cb48-5398"><a href="#cb48-5398" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5399"><a href="#cb48-5399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5400"><a href="#cb48-5400" aria-hidden="true" tabindex="-1"></a><span class="co"># Add definitions for all industry columns</span></span>
<span id="cb48-5401"><a href="#cb48-5401" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> industry_cols) {</span>
<span id="cb48-5402"><a href="#cb48-5402" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create readable name from column name</span></span>
<span id="cb48-5403"><a href="#cb48-5403" aria-hidden="true" tabindex="-1"></a>  readable_name <span class="ot">&lt;-</span> <span class="fu">gsub</span>(<span class="st">"industry_"</span>, <span class="st">""</span>, col)</span>
<span id="cb48-5404"><a href="#cb48-5404" aria-hidden="true" tabindex="-1"></a>  readable_name <span class="ot">&lt;-</span> tools<span class="sc">::</span><span class="fu">toTitleCase</span>(readable_name)</span>
<span id="cb48-5405"><a href="#cb48-5405" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-5406"><a href="#cb48-5406" aria-hidden="true" tabindex="-1"></a>  column_defs[[col]] <span class="ot">&lt;-</span> <span class="fu">colDef</span>(</span>
<span id="cb48-5407"><a href="#cb48-5407" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> readable_name,</span>
<span id="cb48-5408"><a href="#cb48-5408" aria-hidden="true" tabindex="-1"></a>    <span class="at">format =</span> <span class="fu">colFormat</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span>
<span id="cb48-5409"><a href="#cb48-5409" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-5410"><a href="#cb48-5410" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-5411"><a href="#cb48-5411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5412"><a href="#cb48-5412" aria-hidden="true" tabindex="-1"></a><span class="co"># Create column groups - single "Industry Type" group spanning all industry columns</span></span>
<span id="cb48-5413"><a href="#cb48-5413" aria-hidden="true" tabindex="-1"></a>all_groups <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb48-5414"><a href="#cb48-5414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Region"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Region"</span>)),</span>
<span id="cb48-5415"><a href="#cb48-5415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Total Businesses"</span>, <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"total_businesses"</span>)),</span>
<span id="cb48-5416"><a href="#cb48-5416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colGroup</span>(<span class="at">name =</span> <span class="st">"Industry Type"</span>, <span class="at">columns =</span> industry_cols)</span>
<span id="cb48-5417"><a href="#cb48-5417" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5418"><a href="#cb48-5418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5419"><a href="#cb48-5419" aria-hidden="true" tabindex="-1"></a><span class="fu">reactable</span>(</span>
<span id="cb48-5420"><a href="#cb48-5420" aria-hidden="true" tabindex="-1"></a>  formatted,</span>
<span id="cb48-5421"><a href="#cb48-5421" aria-hidden="true" tabindex="-1"></a>  <span class="at">columns =</span> column_defs,</span>
<span id="cb48-5422"><a href="#cb48-5422" aria-hidden="true" tabindex="-1"></a>  <span class="at">columnGroups =</span> all_groups,</span>
<span id="cb48-5423"><a href="#cb48-5423" aria-hidden="true" tabindex="-1"></a>  <span class="at">striped =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5424"><a href="#cb48-5424" aria-hidden="true" tabindex="-1"></a>  <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5425"><a href="#cb48-5425" aria-hidden="true" tabindex="-1"></a>  <span class="at">bordered =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5426"><a href="#cb48-5426" aria-hidden="true" tabindex="-1"></a>  <span class="at">theme =</span> <span class="fu">reactableTheme</span>(</span>
<span id="cb48-5427"><a href="#cb48-5427" aria-hidden="true" tabindex="-1"></a>    <span class="at">headerStyle =</span> <span class="fu">list</span>(</span>
<span id="cb48-5428"><a href="#cb48-5428" aria-hidden="true" tabindex="-1"></a>      <span class="st">"&amp;:hover"</span> <span class="ot">=</span> <span class="fu">list</span>(<span class="at">background =</span> <span class="st">"#eee"</span>)</span>
<span id="cb48-5429"><a href="#cb48-5429" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb48-5430"><a href="#cb48-5430" aria-hidden="true" tabindex="-1"></a>    <span class="at">borderColor =</span> <span class="st">"#ddd"</span>,</span>
<span id="cb48-5431"><a href="#cb48-5431" aria-hidden="true" tabindex="-1"></a>    <span class="at">stripedColor =</span> <span class="st">"#f6f8fa"</span></span>
<span id="cb48-5432"><a href="#cb48-5432" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb48-5433"><a href="#cb48-5433" aria-hidden="true" tabindex="-1"></a>  <span class="at">defaultPageSize =</span> <span class="dv">15</span>,</span>
<span id="cb48-5434"><a href="#cb48-5434" aria-hidden="true" tabindex="-1"></a>  <span class="at">showPageSizeOptions =</span> <span class="cn">TRUE</span>,</span>
<span id="cb48-5435"><a href="#cb48-5435" aria-hidden="true" tabindex="-1"></a>  <span class="at">pageSizeOptions =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">75</span>, <span class="dv">100</span>),</span>
<span id="cb48-5436"><a href="#cb48-5436" aria-hidden="true" tabindex="-1"></a>  <span class="at">showSortable =</span> <span class="cn">TRUE</span></span>
<span id="cb48-5437"><a href="#cb48-5437" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-5438"><a href="#cb48-5438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>